"use strict";(self.webpackChunkVitesseVent=self.webpackChunkVitesseVent||[]).push([[179],{606:(Gc,Hu,Wc)=>{var zs={};function Mt(i){return"function"==typeof i}function Hr(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Wc.r(zs),Wc.d(zs,{ACESFilmicToneMapping:()=>D0,AddEquation:()=>tc,AddOperation:()=>eA,AdditiveAnimationBlendMode:()=>J0,AdditiveBlending:()=>x0,AlphaFormat:()=>uA,AlwaysDepth:()=>qC,AlwaysStencilFunc:()=>DA,AmbientLight:()=>MP,AmbientLightProbe:()=>dj,AnimationClip:()=>Eu,AnimationLoader:()=>tj,AnimationMixer:()=>Pj,AnimationObjectGroup:()=>Cj,AnimationUtils:()=>K8,ArcCurve:()=>GI,ArrayCamera:()=>xI,ArrowHelper:()=>Kj,Audio:()=>NP,AudioAnalyser:()=>yj,AudioContext:()=>gb,AudioListener:()=>mj,AudioLoader:()=>uj,AxesHelper:()=>Jj,BackSide:()=>yr,BasicDepthPacking:()=>SA,BasicShadowMap:()=>oG,Bone:()=>sg,BooleanKeyframeTrack:()=>xc,Box2:()=>kj,Box3:()=>da,Box3Helper:()=>Zj,BoxBufferGeometry:()=>r9,BoxGeometry:()=>ya,BoxHelper:()=>Xj,BufferAttribute:()=>fn,BufferGeometry:()=>Nt,BufferGeometryLoader:()=>DP,ByteType:()=>sA,Cache:()=>wc,Camera:()=>Wm,CameraHelper:()=>qj,CanvasTexture:()=>b8,CapsuleBufferGeometry:()=>s9,CapsuleGeometry:()=>Pd,CatmullRomCurve3:()=>WI,CineonToneMapping:()=>iA,CircleBufferGeometry:()=>o9,CircleGeometry:()=>Rd,ClampToEdgeWrapping:()=>ki,Clock:()=>_b,Color:()=>Re,ColorKeyframeTrack:()=>cb,ColorManagement:()=>fi,CompressedArrayTexture:()=>x8,CompressedTexture:()=>jx,CompressedTextureLoader:()=>nj,ConeBufferGeometry:()=>a9,ConeGeometry:()=>Ld,CubeCamera:()=>jA,CubeReflectionMapping:()=>sa,CubeRefractionMapping:()=>oa,CubeTexture:()=>xd,CubeTextureLoader:()=>ij,CubeUVReflectionMapping:()=>Vl,CubicBezierCurve:()=>Yx,CubicBezierCurve3:()=>$I,CubicInterpolant:()=>pP,CullFaceBack:()=>_0,CullFaceFront:()=>LC,CullFaceFrontBack:()=>sG,CullFaceNone:()=>RC,Curve:()=>Fs,CurvePath:()=>XI,CustomBlending:()=>OC,CustomToneMapping:()=>rA,CylinderBufferGeometry:()=>c9,CylinderGeometry:()=>gc,Cylindrical:()=>Fj,Data3DTexture:()=>lx,DataArrayTexture:()=>Im,DataTexture:()=>gu,DataTextureLoader:()=>rj,DataUtils:()=>i9,DecrementStencilOp:()=>gG,DecrementWrapStencilOp:()=>yG,DefaultLoadingManager:()=>_P,DepthFormat:()=>ua,DepthStencilFormat:()=>ic,DepthTexture:()=>bI,DirectionalLight:()=>mb,DirectionalLightHelper:()=>$j,DiscreteInterpolant:()=>mP,DodecahedronBufferGeometry:()=>l9,DodecahedronGeometry:()=>Od,DoubleSide:()=>eo,DstAlphaFactor:()=>VC,DstColorFactor:()=>GC,DynamicCopyUsage:()=>LG,DynamicDrawUsage:()=>DG,DynamicReadUsage:()=>IG,EdgesGeometry:()=>ZI,EllipseCurve:()=>fg,EqualDepth:()=>ZC,EqualStencilFunc:()=>wG,EquirectangularReflectionMapping:()=>rd,EquirectangularRefractionMapping:()=>sd,Euler:()=>NA,EventDispatcher:()=>no,ExtrudeBufferGeometry:()=>u9,ExtrudeGeometry:()=>Bd,FileLoader:()=>Bs,Float16BufferAttribute:()=>h4,Float32BufferAttribute:()=>We,Float64BufferAttribute:()=>p4,FloatType:()=>Co,Fog:()=>Qm,FogExp2:()=>Jm,FramebufferTexture:()=>v8,FrontSide:()=>Qs,Frustum:()=>$m,GLBufferAttribute:()=>Nj,GLSL1:()=>NG,GLSL3:()=>ex,GreaterDepth:()=>KC,GreaterEqualDepth:()=>YC,GreaterEqualStencilFunc:()=>TG,GreaterStencilFunc:()=>SG,GridHelper:()=>Wj,Group:()=>ko,HalfFloatType:()=>Wl,HemisphereLight:()=>vP,HemisphereLightHelper:()=>Gj,HemisphereLightProbe:()=>fj,IcosahedronBufferGeometry:()=>f9,IcosahedronGeometry:()=>Ud,ImageBitmapLoader:()=>IP,ImageLoader:()=>qd,ImageUtils:()=>ax,IncrementStencilOp:()=>mG,IncrementWrapStencilOp:()=>_G,InstancedBufferAttribute:()=>_u,InstancedBufferGeometry:()=>TP,InstancedInterleavedBuffer:()=>Oj,InstancedMesh:()=>zx,Int16BufferAttribute:()=>f4,Int32BufferAttribute:()=>d4,Int8BufferAttribute:()=>c4,IntType:()=>aA,InterleavedBuffer:()=>wd,InterleavedBufferAttribute:()=>xa,Interpolant:()=>wu,InterpolateDiscrete:()=>jl,InterpolateLinear:()=>rc,InterpolateSmooth:()=>bm,InvertStencilOp:()=>vG,KeepStencilOp:()=>Sm,KeyframeTrack:()=>ks,LOD:()=>CI,LatheBufferGeometry:()=>d9,LatheGeometry:()=>yu,Layers:()=>hc,LessDepth:()=>XC,LessEqualDepth:()=>hm,LessEqualStencilFunc:()=>MG,LessStencilFunc:()=>bG,Light:()=>wa,LightProbe:()=>xg,Line:()=>Bo,Line3:()=>Bj,LineBasicMaterial:()=>$i,LineCurve:()=>hg,LineCurve3:()=>qI,LineDashedMaterial:()=>dP,LineLoop:()=>Hx,LineSegments:()=>Ns,LinearEncoding:()=>Ao,LinearFilter:()=>Hn,LinearInterpolant:()=>ab,LinearMipMapLinearFilter:()=>fG,LinearMipMapNearestFilter:()=>uG,LinearMipmapLinearFilter:()=>to,LinearMipmapNearestFilter:()=>mm,LinearSRGBColorSpace:()=>$l,LinearToneMapping:()=>tA,Loader:()=>vr,LoaderUtils:()=>Tu,LoadingManager:()=>lb,LoopOnce:()=>xA,LoopPingPong:()=>wA,LoopRepeat:()=>bA,LuminanceAlphaFormat:()=>dA,LuminanceFormat:()=>fA,MOUSE:()=>Ja,Material:()=>wi,MaterialLoader:()=>bg,MathUtils:()=>ix,Matrix3:()=>or,Matrix4:()=>gt,MaxEquation:()=>S0,Mesh:()=>Kn,MeshBasicMaterial:()=>Lr,MeshDepthMaterial:()=>Ox,MeshDistanceMaterial:()=>Nx,MeshLambertMaterial:()=>uP,MeshMatcapMaterial:()=>fP,MeshNormalMaterial:()=>lP,MeshPhongMaterial:()=>aP,MeshPhysicalMaterial:()=>zo,MeshStandardMaterial:()=>$d,MeshToonMaterial:()=>cP,MinEquation:()=>M0,MirroredRepeatWrapping:()=>Hl,MixOperation:()=>QC,MultiplyBlending:()=>w0,MultiplyOperation:()=>id,NearestFilter:()=>Yn,NearestMipMapLinearFilter:()=>lG,NearestMipMapNearestFilter:()=>cG,NearestMipmapLinearFilter:()=>Gl,NearestMipmapNearestFilter:()=>od,NeverDepth:()=>$C,NeverStencilFunc:()=>xG,NoBlending:()=>Do,NoColorSpace:()=>dG,NoToneMapping:()=>Cs,NormalAnimationBlendMode:()=>wm,NormalBlending:()=>ec,NotEqualDepth:()=>JC,NotEqualStencilFunc:()=>EG,NumberKeyframeTrack:()=>Mu,Object3D:()=>wn,ObjectLoader:()=>cj,ObjectSpaceNormalMap:()=>TA,OctahedronBufferGeometry:()=>h9,OctahedronGeometry:()=>xu,OneFactor:()=>BC,OneMinusDstAlphaFactor:()=>HC,OneMinusDstColorFactor:()=>WC,OneMinusSrcAlphaFactor:()=>T0,OneMinusSrcColorFactor:()=>zC,OrthographicCamera:()=>Fo,PCFShadowMap:()=>y0,PCFSoftShadowMap:()=>v0,PMREMGenerator:()=>Ix,Path:()=>Id,PerspectiveCamera:()=>Fn,Plane:()=>va,PlaneBufferGeometry:()=>p9,PlaneGeometry:()=>cu,PlaneHelper:()=>Yj,PointLight:()=>pb,PointLightHelper:()=>Vj,Points:()=>Wx,PointsMaterial:()=>cg,PolarGridHelper:()=>jj,PolyhedronBufferGeometry:()=>m9,PolyhedronGeometry:()=>Uo,PositionalAudio:()=>_j,PropertyBinding:()=>Mn,PropertyMixer:()=>kP,QuadraticBezierCurve:()=>Kx,QuadraticBezierCurve3:()=>Jx,Quaternion:()=>Ci,QuaternionKeyframeTrack:()=>ba,QuaternionLinearInterpolant:()=>gP,RED_GREEN_RGTC2_Format:()=>Y0,RED_RGTC1_Format:()=>vA,REVISION:()=>dm,RGBADepthPacking:()=>EA,RGBAFormat:()=>Ir,RGBAIntegerFormat:()=>_A,RGBA_ASTC_10x10_Format:()=>$0,RGBA_ASTC_10x5_Format:()=>G0,RGBA_ASTC_10x6_Format:()=>W0,RGBA_ASTC_10x8_Format:()=>j0,RGBA_ASTC_12x10_Format:()=>q0,RGBA_ASTC_12x12_Format:()=>X0,RGBA_ASTC_4x4_Format:()=>N0,RGBA_ASTC_5x4_Format:()=>F0,RGBA_ASTC_5x5_Format:()=>k0,RGBA_ASTC_6x5_Format:()=>B0,RGBA_ASTC_6x6_Format:()=>U0,RGBA_ASTC_8x5_Format:()=>z0,RGBA_ASTC_8x6_Format:()=>V0,RGBA_ASTC_8x8_Format:()=>H0,RGBA_BPTC_Format:()=>xm,RGBA_ETC2_EAC_Format:()=>O0,RGBA_PVRTC_2BPPV1_Format:()=>R0,RGBA_PVRTC_4BPPV1_Format:()=>P0,RGBA_S3TC_DXT1_Format:()=>_m,RGBA_S3TC_DXT3_Format:()=>ym,RGBA_S3TC_DXT5_Format:()=>vm,RGB_ETC1_Format:()=>yA,RGB_ETC2_Format:()=>L0,RGB_PVRTC_2BPPV1_Format:()=>I0,RGB_PVRTC_4BPPV1_Format:()=>A0,RGB_S3TC_DXT1_Format:()=>gm,RGFormat:()=>mA,RGIntegerFormat:()=>gA,RawShaderMaterial:()=>oP,Ray:()=>pd,Raycaster:()=>bb,RectAreaLight:()=>SP,RedFormat:()=>hA,RedIntegerFormat:()=>pA,ReinhardToneMapping:()=>nA,RepeatWrapping:()=>aa,ReplaceStencilOp:()=>pG,ReverseSubtractEquation:()=>FC,RingBufferGeometry:()=>g9,RingGeometry:()=>zd,SIGNED_RED_GREEN_RGTC2_Format:()=>K0,SIGNED_RED_RGTC1_Format:()=>Z0,SRGBColorSpace:()=>As,Scene:()=>eg,ShaderChunk:()=>Ft,ShaderLib:()=>Os,ShaderMaterial:()=>io,ShadowMaterial:()=>sP,Shape:()=>_c,ShapeBufferGeometry:()=>_9,ShapeGeometry:()=>Vd,ShapePath:()=>Qj,ShapeUtils:()=>ro,ShortType:()=>oA,Skeleton:()=>Td,SkeletonHelper:()=>zj,SkinnedMesh:()=>Ux,Source:()=>lc,Sphere:()=>ma,SphereBufferGeometry:()=>y9,SphereGeometry:()=>bu,Spherical:()=>Mb,SphericalHarmonics3:()=>EP,SplineCurve:()=>Qx,SpotLight:()=>db,SpotLightHelper:()=>Uj,Sprite:()=>TI,SpriteMaterial:()=>kx,SrcAlphaFactor:()=>E0,SrcAlphaSaturateFactor:()=>jC,SrcColorFactor:()=>UC,StaticCopyUsage:()=>RG,StaticDrawUsage:()=>cd,StaticReadUsage:()=>AG,StereoCamera:()=>hj,StreamCopyUsage:()=>OG,StreamDrawUsage:()=>CG,StreamReadUsage:()=>PG,StringKeyframeTrack:()=>bc,SubtractEquation:()=>NC,SubtractiveBlending:()=>b0,TOUCH:()=>Qa,TangentSpaceNormalMap:()=>fa,TetrahedronBufferGeometry:()=>v9,TetrahedronGeometry:()=>Hd,Texture:()=>Bi,TextureLoader:()=>yP,TorusBufferGeometry:()=>x9,TorusGeometry:()=>Gd,TorusKnotBufferGeometry:()=>b9,TorusKnotGeometry:()=>Wd,Triangle:()=>ts,TriangleFanDrawMode:()=>Mm,TriangleStripDrawMode:()=>Q0,TrianglesDrawMode:()=>MA,TubeBufferGeometry:()=>w9,TubeGeometry:()=>jd,TwoPassDoubleSide:()=>aG,UVMapping:()=>pm,Uint16BufferAttribute:()=>bx,Uint32BufferAttribute:()=>wx,Uint8BufferAttribute:()=>l4,Uint8ClampedBufferAttribute:()=>u4,Uniform:()=>xb,UniformsGroup:()=>Lj,UniformsLib:()=>Ae,UniformsUtils:()=>WA,UnsignedByteType:()=>ca,UnsignedInt248Type:()=>nc,UnsignedIntType:()=>la,UnsignedShort4444Type:()=>cA,UnsignedShort5551Type:()=>lA,UnsignedShortType:()=>C0,VSMShadowMap:()=>zl,Vector2:()=>oe,Vector3:()=>D,Vector4:()=>mn,VectorKeyframeTrack:()=>Su,VideoTexture:()=>y8,WebGL1Renderer:()=>wI,WebGL3DRenderTarget:()=>JG,WebGLArrayRenderTarget:()=>KG,WebGLCubeRenderTarget:()=>$A,WebGLMultipleRenderTargets:()=>QG,WebGLRenderTarget:()=>Ps,WebGLRenderer:()=>Km,WebGLUtils:()=>vI,WireframeGeometry:()=>nP,WrapAroundEnding:()=>ad,ZeroCurvatureEnding:()=>sc,ZeroFactor:()=>kC,ZeroSlopeEnding:()=>oc,ZeroStencilOp:()=>hG,_SRGBAFormat:()=>Em,sRGBEncoding:()=>rn}),Wc(609);const Sr=Hr(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Vs(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class kn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Mt(n))try{n()}catch(s){e=s instanceof Sr?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{$c(s)}catch(o){e=e??[],o instanceof Sr?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Sr(e)}}add(e){var t;if(e&&e!==this)if(this.closed)$c(e);else{if(e instanceof kn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Vs(t,e)}remove(e){const{_finalizers:t}=this;t&&Vs(t,e),e instanceof kn&&e._removeParent(this)}}kn.EMPTY=(()=>{const i=new kn;return i.closed=!0,i})();const jc=kn.EMPTY;function Gr(i){return i instanceof kn||i&&"closed"in i&&Mt(i.remove)&&Mt(i.add)&&Mt(i.unsubscribe)}function $c(i){Mt(i)?i():i.unsubscribe()}const hs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Yo={setTimeout(i,e,...t){const{delegate:n}=Yo;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=Yo;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function Wr(i){Yo.setTimeout(()=>{const{onUnhandledError:e}=hs;if(!e)throw i;e(i)})}function Ki(){}const Oa=tn("C",void 0,void 0);function tn(i,e,t){return{kind:i,value:e,error:t}}let jr=null;function ps(i){if(hs.useDeprecatedSynchronousErrorHandling){const e=!jr;if(e&&(jr={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=jr;if(jr=null,t)throw n}}else i()}class ju extends kn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Gr(e)&&e.add(this)):this.destination=Xc}static create(e,t,n){return new Ko(e,t,n)}next(e){this.isStopped?qc(function Wu(i){return tn("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?qc(function Gu(i){return tn("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?qc(Oa,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const $u=Function.prototype.bind;function qu(i,e){return $u.call(i,e)}class wh{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){co(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){co(n)}else co(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){co(t)}}}class Ko extends ju{constructor(e,t,n){let r;if(super(),Mt(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&hs.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&qu(e.next,s),error:e.error&&qu(e.error,s),complete:e.complete&&qu(e.complete,s)}):r=e}this.destination=new wh(r)}}function co(i){hs.useDeprecatedSynchronousErrorHandling?function ai(i){hs.useDeprecatedSynchronousErrorHandling&&jr&&(jr.errorThrown=!0,jr.error=i)}(i):Wr(i)}function qc(i,e){const{onStoppedNotification:t}=hs;t&&Yo.setTimeout(()=>t(i,e))}const Xc={closed:!0,next:Ki,error:function Xu(i){throw i},complete:Ki},Zc="function"==typeof Symbol&&Symbol.observable||"@@observable";function ms(i){return i}function ur(i){return 0===i.length?ms:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}let gn=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function gs(i){return i&&i instanceof ju||function Zg(i){return i&&Mt(i.next)&&Mt(i.error)&&Mt(i.complete)}(i)&&Gr(i)}(t)?t:new Ko(t,n,r);return ps(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=$r(n))((r,s)=>{const o=new Ko({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Zc](){return this}pipe(...t){return ur(t)(this)}toPromise(t){return new(t=$r(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function $r(i){var e;return null!==(e=i??hs.Promise)&&void 0!==e?e:Promise}const Sh=Hr(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let fr=(()=>{class i extends gn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new Eh(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new Sh}next(t){ps(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){ps(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ps(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?jc:(this.currentObservers=null,s.push(t),new kn(()=>{this.currentObservers=null,Vs(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new gn;return t.source=this,t}}return i.create=(e,t)=>new Eh(e,t),i})();class Eh extends fr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:jc}}function Th(i){return Mt(i?.lift)}function Tn(i){return e=>{if(Th(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function vn(i,e,t,n,r){return new Yg(i,e,t,n,r)}class Yg extends ju{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Dn(i,e){return Tn((t,n)=>{let r=0;t.subscribe(vn(n,s=>{n.next(i.call(e,s,r++))}))})}function _s(i){return this instanceof _s?(this.v=i,this):new _s(i)}function s_(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function Ku(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=i[s](o)).done,o.value)})}}}function Ah(i,e,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?i!==e||!n:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(i):n?n.value:e.get(i)}const Ju=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function Ih(i){return Mt(i?.then)}function Ph(i){return Mt(i[Zc])}function Qu(i){return Symbol.asyncIterator&&Mt(i?.[Symbol.asyncIterator])}function Rh(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Fa=function a_(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function uo(i){return Mt(i?.[Fa])}function Lh(i){return function Ch(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){n[d]&&(r[d]=function(h){return new Promise(function(m,p){s.push([d,h,m,p])>1||a(d,h)})})}function a(d,h){try{!function c(d){d.value instanceof _s?Promise.resolve(d.value.v).then(l,u):f(s[0][2],d)}(n[d](h))}catch(m){f(s[0][3],m)}}function l(d){a("next",d)}function u(d){a("throw",d)}function f(d,h){d(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield _s(t.read());if(r)return yield _s(void 0);yield yield _s(n)}}finally{t.releaseLock()}})}function Oh(i){return Mt(i?.getReader)}function Ti(i){if(i instanceof gn)return i;if(null!=i){if(Ph(i))return function C(i){return new gn(e=>{const t=i[Zc]();if(Mt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Ju(i))return function R(i){return new gn(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(Ih(i))return function B(i){return new gn(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Wr)})}(i);if(Qu(i))return ee(i);if(uo(i))return function G(i){return new gn(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(Oh(i))return function ie(i){return ee(Lh(i))}(i)}throw Rh(i)}function ee(i){return new gn(e=>{(function _e(i,e){var t,n,r,s;return function n_(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=s_(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function we(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function He(i,e,t=1/0){return Mt(e)?He((n,r)=>Dn((s,o)=>e(n,s,r,o))(Ti(i(n,r))),t):("number"==typeof e&&(t=e),Tn((n,r)=>function ke(i,e,t,n,r,s,o,a){const c=[];let l=0,u=0,f=!1;const d=()=>{f&&!c.length&&!l&&e.complete()},h=p=>l<n?m(p):c.push(p),m=p=>{s&&e.next(p),l++;let g=!1;Ti(t(p,u++)).subscribe(vn(e,y=>{r?.(y),s?h(y):e.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<n;){const y=c.shift();o?we(e,o,()=>m(y)):m(y)}d()}catch(y){e.error(y)}}))};return i.subscribe(vn(e,h,()=>{f=!0,d()})),()=>{a?.()}}(n,r,i,t)))}function Ie(i=1/0){return He(ms,i)}const Ge=new gn(i=>i.complete());function yt(i){return i&&Mt(i.schedule)}function kt(i){return i[i.length-1]}function Ln(i){return Mt(kt(i))?i.pop():void 0}function Gt(i){return yt(kt(i))?i.pop():void 0}function St(i,e=0){return Tn((t,n)=>{t.subscribe(vn(n,r=>we(n,i,()=>n.next(r),e),()=>we(n,i,()=>n.complete(),e),r=>we(n,i,()=>n.error(r),e)))})}function je(i,e=0){return Tn((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function Qe(i,e){if(!i)throw new Error("Iterable cannot be null");return new gn(t=>{we(t,e,()=>{const n=i[Symbol.asyncIterator]();we(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function et(i,e){return e?function Ct(i,e){if(null!=i){if(Ph(i))return function _n(i,e){return Ti(i).pipe(je(e),St(e))}(i,e);if(Ju(i))return function Wt(i,e){return new gn(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(Ih(i))return function zt(i,e){return Ti(i).pipe(je(e),St(e))}(i,e);if(Qu(i))return Qe(i,e);if(uo(i))return function qt(i,e){return new gn(t=>{let n;return we(t,e,()=>{n=i[Fa](),we(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Mt(n?.return)&&n.return()})}(i,e);if(Oh(i))return function xn(i,e){return Qe(Lh(i),e)}(i,e)}throw Rh(i)}(i,e):Ti(i)}function At(...i){const e=Gt(i),t=function Cn(i,e){return"number"==typeof kt(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?Ti(n[0]):Ie(t)(et(n,e)):Ge}function st(i={}){const{connector:e=(()=>new fr),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o,a,c,l=0,u=!1,f=!1;const d=()=>{a?.unsubscribe(),a=void 0},h=()=>{d(),o=c=void 0,u=f=!1},m=()=>{const p=o;h(),p?.unsubscribe()};return Tn((p,g)=>{l++,!f&&!u&&d();const y=c=c??e();g.add(()=>{l--,0===l&&!f&&!u&&(a=hn(m,r))}),y.subscribe(g),!o&&l>0&&(o=new Ko({next:v=>y.next(v),error:v=>{f=!0,d(),a=hn(h,t,v),y.error(v)},complete:()=>{u=!0,d(),a=hn(h,n),y.complete()}}),Ti(p).subscribe(o))})(s)}}function hn(i,e,...t){if(!0===e)return void i();if(!1===e)return;const n=new Ko({next:()=>{n.unsubscribe(),i()}});return Ti(e(...t)).subscribe(n)}function tt(i){for(let e in i)if(i[e]===tt)return e;throw Error("Could not find renamed property on target object.")}function Di(i,e){for(const t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function ot(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(ot).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function pn(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const Me=tt({__forward_ref__:tt});function H(i){return i.__forward_ref__=H,i.toString=function(){return ot(this())},i}function F(i){return Y(i)?i():i}function Y(i){return"function"==typeof i&&i.hasOwnProperty(Me)&&i.__forward_ref__===H}function nt(i){return i&&!!i.\u0275providers}class W extends Error{constructor(e,t){super(Ce(e,t)),this.code=e}}function Ce(i,e){return`NG0${Math.abs(i)}${e?": "+e.trim():""}`}function re(i){return"string"==typeof i?i:null==i?"":String(i)}function K(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():re(i)}function vt(i,e){throw new W(-201,!1)}function _i(i,e){null==i&&function nn(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function Xt(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Nh(i){return Xw(i,Fh)||Xw(i,Yw)}function Xw(i,e){return i.hasOwnProperty(e)?i[e]:null}function Zw(i){return i&&(i.hasOwnProperty(d_)||i.hasOwnProperty(KL))?i[d_]:null}const Fh=tt({\u0275prov:tt}),d_=tt({\u0275inj:tt}),Yw=tt({ngInjectableDef:tt}),KL=tt({ngInjectorDef:tt});var mt=(()=>((mt=mt||{})[mt.Default=0]="Default",mt[mt.Host=1]="Host",mt[mt.Self=2]="Self",mt[mt.SkipSelf=4]="SkipSelf",mt[mt.Optional=8]="Optional",mt))();let h_;function qr(i){const e=h_;return h_=i,e}function Kw(i,e,t){const n=Nh(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&mt.Optional?null:void 0!==e?e:void vt(ot(i))}const On=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),nf={},p_="__NG_DI_FLAG__",kh="ngTempTokenPath",QL="ngTokenPath",eO=/\n/gm,tO="\u0275",Jw="__source";let rf;function Kc(i){const e=rf;return rf=i,e}function nO(i,e=mt.Default){if(void 0===rf)throw new W(-203,!1);return null===rf?Kw(i,void 0,e):rf.get(i,e&mt.Optional?null:void 0,e)}function ln(i,e=mt.Default){return(function JL(){return h_}()||nO)(F(i),e)}function Un(i,e=mt.Default){return ln(i,Bh(e))}function Bh(i){return typeof i>"u"||"number"==typeof i?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function m_(i){const e=[];for(let t=0;t<i.length;t++){const n=F(i[t]);if(Array.isArray(n)){if(0===n.length)throw new W(900,!1);let r,s=mt.Default;for(let o=0;o<n.length;o++){const a=n[o],c=iO(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(ln(r,s))}else e.push(ln(n))}return e}function iO(i){return i[p_]}function ho(i){return{toString:i}.toString()}var Gs=(()=>((Gs=Gs||{})[Gs.OnPush=0]="OnPush",Gs[Gs.Default=1]="Default",Gs))(),Ws=(()=>{return(i=Ws||(Ws={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Ws;var i})();const po={},an=[],Uh=tt({\u0275cmp:tt}),g_=tt({\u0275dir:tt}),__=tt({\u0275pipe:tt}),mo=tt({\u0275fac:tt}),of=tt({__NG_ELEMENT_ID__:tt});let oO=0;function af(i){return ho(()=>{const e=iM(i),t={...e,decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===Gs.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,data:i.data||{},encapsulation:i.encapsulation||Ws.Emulated,id:"c"+oO++,styles:i.styles||an,_:null,schemas:i.schemas||null,tView:null};rM(t);const n=i.dependencies;return t.directiveDefs=zh(n,!1),t.pipeDefs=zh(n,!0),t})}function cO(i){return un(i)||zi(i)}function lO(i){return null!==i}function nM(i,e){if(null==i)return po;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}function Li(i){return ho(()=>{const e=iM(i);return rM(e),e})}function Ji(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,standalone:!0===i.standalone,onDestroy:i.type.prototype.ngOnDestroy||null}}function un(i){return i[Uh]||null}function zi(i){return i[g_]||null}function hr(i){return i[__]||null}function iM(i){const e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,exportAs:i.exportAs||null,standalone:!0===i.standalone,selectors:i.selectors||an,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:nM(i.inputs,e),outputs:nM(i.outputs)}}function rM(i){i.features?.forEach(e=>e(i))}function zh(i,e){if(!i)return null;const t=e?hr:cO;return()=>("function"==typeof i?i():i).map(n=>t(n)).filter(lO)}const go=0,Be=1,Pt=2,Xn=3,ys=4,ka=5,Vi=6,Jc=7,ti=8,Vh=9,Hh=10,Ot=11,y_=12,lf=13,sM=14,Qc=15,Hi=16,uf=17,el=18,js=19,ff=20,oM=21,Nn=22,v_=1,aM=2,Gh=7,Wh=8,tl=9,Qi=10;function Tr(i){return Array.isArray(i)&&"object"==typeof i[v_]}function vs(i){return Array.isArray(i)&&!0===i[v_]}function x_(i){return 0!=(4&i.flags)}function df(i){return i.componentOffset>-1}function jh(i){return 1==(1&i.flags)}function xs(i){return!!i.template}function fO(i){return 0!=(256&i[Pt])}function Ba(i,e){return i.hasOwnProperty(mo)?i[mo]:null}class pO{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function hf(){return uM}function uM(i){return i.type.prototype.ngOnChanges&&(i.setInput=gO),mO}function mO(){const i=dM(this),e=i?.current;if(e){const t=i.previous;if(t===po)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function gO(i,e,t,n){const r=this.declaredInputs[t],s=dM(i)||function _O(i,e){return i[fM]=e}(i,{previous:po,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[r];o[r]=new pO(c&&c.currentValue,e,a===po),i[n]=e}hf.ngInherit=!0;const fM="__ngSimpleChanges__";function dM(i){return i[fM]||null}const Xr=function(i,e,t){};function Oi(i){for(;Array.isArray(i);)i=i[go];return i}function Dr(i,e){return Oi(e[i.index])}function mM(i,e){return i.data[e]}function pr(i,e){const t=e[i];return Tr(t)?t:t[go]}function qh(i){return 64==(64&i[Pt])}function Qo(i,e){return null==e?null:i[e]}function gM(i){i[el]=0}function w_(i,e){i[ka]+=e;let t=i,n=i[Xn];for(;null!==n&&(1===e&&1===t[ka]||-1===e&&0===t[ka]);)n[ka]+=e,t=n,n=n[Xn]}const bt={lFrame:TM(null),bindingsEnabled:!0};function yM(){return bt.bindingsEnabled}function he(){return bt.lFrame.lView}function Zt(){return bt.lFrame.tView}function M_(i){return bt.lFrame.contextLView=i,i[ti]}function S_(i){return bt.lFrame.contextLView=null,i}function Ni(){let i=vM();for(;null!==i&&64===i.type;)i=i.parent;return i}function vM(){return bt.lFrame.currentTNode}function $s(i,e){const t=bt.lFrame;t.currentTNode=i,t.isParent=e}function E_(){return bt.lFrame.isParent}function T_(){bt.lFrame.isParent=!1}function er(){const i=bt.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function IO(i,e){const t=bt.lFrame;t.bindingIndex=t.bindingRootIndex=i,D_(e)}function D_(i){bt.lFrame.currentDirectiveIndex=i}function MM(){return bt.lFrame.currentQueryIndex}function A_(i){bt.lFrame.currentQueryIndex=i}function RO(i){const e=i[Be];return 2===e.type?e.declTNode:1===e.type?i[Vi]:null}function SM(i,e,t){if(t&mt.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&mt.Host||(r=RO(s),null===r||(s=s[Qc],10&r.type))););if(null===r)return!1;e=r,i=s}const n=bt.lFrame=EM();return n.currentTNode=e,n.lView=i,!0}function I_(i){const e=EM(),t=i[Be];bt.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function EM(){const i=bt.lFrame,e=null===i?null:i.child;return null===e?TM(i):e}function TM(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function DM(){const i=bt.lFrame;return bt.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const CM=DM;function P_(){const i=DM();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function tr(){return bt.lFrame.selectedIndex}function Ua(i){bt.lFrame.selectedIndex=i}function Xh(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(i.contentHooks??(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks??(i.contentHooks=[])).push(t,a),(i.contentCheckHooks??(i.contentCheckHooks=[])).push(t,a)),c&&(i.viewHooks??(i.viewHooks=[])).push(-t,c),l&&((i.viewHooks??(i.viewHooks=[])).push(t,l),(i.viewCheckHooks??(i.viewCheckHooks=[])).push(t,l)),null!=u&&(i.destroyHooks??(i.destroyHooks=[])).push(t,u)}}function Zh(i,e,t){AM(i,e,3,t)}function Yh(i,e,t,n){(3&i[Pt])===t&&AM(i,e,t,n)}function R_(i,e){let t=i[Pt];(3&t)===e&&(t&=2047,t+=1,i[Pt]=t)}function AM(i,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let c=void 0!==n?65535&i[el]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(i[el]+=65536),(a<s||-1==s)&&(VO(i,t,e,c),i[el]=(4294901760&i[el])+c+2),c++}function VO(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[Pt]>>11<i[el]>>16&&(3&i[Pt])===e){i[Pt]+=2048,Xr(4,a,s);try{s.call(a)}finally{Xr(5,a,s)}}}else{Xr(4,a,s);try{s.call(a)}finally{Xr(5,a,s)}}}const rl=-1;class mf{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function O_(i,e,t){let n=0;for(;n<t.length;){const r=t[n];if("number"==typeof r){if(0!==r)break;n++;const s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{const s=r,o=t[++n];PM(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function IM(i){return 3===i||4===i||6===i}function PM(i){return 64===i.charCodeAt(0)}function gf(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||RM(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function RM(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function LM(i){return i!==rl}function Kh(i){return 32767&i}function Jh(i,e){let t=function jO(i){return i>>16}(i),n=e;for(;t>0;)n=n[Qc],t--;return n}let N_=!0;function Qh(i){const e=N_;return N_=i,e}const OM=255,NM=5;let $O=0;const qs={};function ep(i,e){const t=FM(i,e);if(-1!==t)return t;const n=e[Be];n.firstCreatePass&&(i.injectorIndex=e.length,F_(n.data,i),F_(e,null),F_(n.blueprint,null));const r=k_(i,e),s=i.injectorIndex;if(LM(r)){const o=Kh(r),a=Jh(r,e),c=a[Be].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function F_(i,e){i.push(0,0,0,0,0,0,0,0,e)}function FM(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function k_(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){if(n=GM(r),null===n)return rl;if(t++,r=r[Qc],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return rl}function B_(i,e,t){!function qO(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(of)&&(n=t[of]),null==n&&(n=t[of]=$O++);const r=n&OM;e.data[i+(r>>NM)]|=1<<r}(i,e,t)}function kM(i,e,t){if(t&mt.Optional||void 0!==i)return i;vt()}function BM(i,e,t,n){if(t&mt.Optional&&void 0===n&&(n=null),!(t&(mt.Self|mt.Host))){const r=i[Vh],s=qr(void 0);try{return r?r.get(e,n,t&mt.Optional):Kw(e,n,t&mt.Optional)}finally{qr(s)}}return kM(n,0,t)}function UM(i,e,t,n=mt.Default,r){if(null!==i){if(1024&e[Pt]){const o=function JO(i,e,t,n,r){let s=i,o=e;for(;null!==s&&null!==o&&1024&o[Pt]&&!(256&o[Pt]);){const a=zM(s,o,t,n|mt.Self,qs);if(a!==qs)return a;let c=s.parent;if(!c){const l=o[oM];if(l){const u=l.get(t,qs,n);if(u!==qs)return u}c=GM(o),o=o[Qc]}s=c}return r}(i,e,t,n,qs);if(o!==qs)return o}const s=zM(i,e,t,n,qs);if(s!==qs)return s}return BM(e,t,n,r)}function zM(i,e,t,n,r){const s=function YO(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(of)?i[of]:void 0;return"number"==typeof e?e>=0?e&OM:KO:e}(t);if("function"==typeof s){if(!SM(e,i,n))return n&mt.Host?kM(r,0,n):BM(e,t,n,r);try{const o=s(n);if(null!=o||n&mt.Optional)return o;vt()}finally{CM()}}else if("number"==typeof s){let o=null,a=FM(i,e),c=rl,l=n&mt.Host?e[Hi][Vi]:null;for((-1===a||n&mt.SkipSelf)&&(c=-1===a?k_(i,e):e[a+8],c!==rl&&HM(n,!1)?(o=e[Be],a=Kh(c),e=Jh(c,e)):a=-1);-1!==a;){const u=e[Be];if(VM(s,a,u.data)){const f=ZO(a,e,t,o,n,l);if(f!==qs)return f}c=e[a+8],c!==rl&&HM(n,e[Be].data[a+8]===l)&&VM(s,a,e)?(o=u,a=Kh(c),e=Jh(c,e)):a=-1}}return r}function ZO(i,e,t,n,r,s){const o=e[Be],a=o.data[i+8],u=tp(a,o,t,null==n?df(a)&&N_:n!=o&&0!=(3&a.type),r&mt.Host&&s===a);return null!==u?za(e,o,u,a):qs}function tp(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,c=i.directiveStart,u=s>>20,d=r?a+u:i.directiveEnd;for(let h=n?a:a+u;h<d;h++){const m=o[h];if(h<c&&t===m||h>=c&&m.type===t)return h}if(r){const h=o[c];if(h&&xs(h)&&h.type===t)return c}return null}function za(i,e,t,n){let r=i[t];const s=e.data;if(function HO(i){return i instanceof mf}(r)){const o=r;o.resolving&&function Ve(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new W(-200,`Circular dependency in DI detected for ${i}${t}`)}(K(s[t]));const a=Qh(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?qr(o.injectImpl):null;SM(i,n,mt.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function zO(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=uM(e);(t.preOrderHooks??(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks??(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks??(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==c&&qr(c),Qh(a),o.resolving=!1,CM()}}return r}function VM(i,e,t){return!!(t[e+(i>>NM)]&1<<i)}function HM(i,e){return!(i&mt.Self||i&mt.Host&&e)}class sl{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return UM(this._tNode,this._lView,e,Bh(n),t)}}function KO(){return new sl(Ni(),he())}function _f(i){return ho(()=>{const e=i.prototype.constructor,t=e[mo]||U_(e),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[mo]||U_(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function U_(i){return Y(i)?()=>{const e=U_(F(i));return e&&e()}:Ba(i)}function GM(i){const e=i[Be],t=e.type;return 2===t?e.declTNode:1===t?i[Vi]:null}class Et{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Xt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Va(i,e){i.forEach(t=>Array.isArray(t)?Va(t,e):e(t))}function jM(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function np(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Cr(i,e,t){let n=ul(i,e);return n>=0?i[1|n]=t:(n=~n,function nN(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(1===r)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;)i[r]=i[r-2],r--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function G_(i,e){const t=ul(i,e);if(t>=0)return i[1|t]}function ul(i,e){return function $M(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){const s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}(i,e,1)}var mr=(()=>((mr=mr||{})[mr.Important=1]="Important",mr[mr.DashCase=2]="DashCase",mr))();const Z_=new Map;let SN=0;function sS(i){return Z_.get(i)||null}class CN{get lView(){return sS(this.lViewId)}constructor(e,t,n){this.lViewId=e,this.nodeIndex=t,this.native=n}}function gr(i){let e=Mf(i);if(e){if(Tr(e)){const t=e;let n,r,s;if(cS(i)){if(n=function uS(i,e){const t=i[Be].components;if(t)for(let n=0;n<t.length;n++){const r=t[n];if(pr(r,i)[ti]===e)return r}else if(pr(Nn,i)[ti]===e)return Nn;return-1}(t,i),-1==n)throw new Error("The provided component was not found in the application");r=i}else if(function AN(i){return i&&i.constructor&&i.constructor.\u0275dir}(i)){if(n=function PN(i,e){let t=i[Be].firstChild;for(;t;){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++)if(i[s]===e)return t.index;t=IN(t)}return-1}(t,i),-1==n)throw new Error("The provided directive was not found in the application");s=function fS(i,e){const t=e[Be].data[i];if(0===t.directiveStart)return an;const n=[];for(let r=t.directiveStart;r<t.directiveEnd;r++){const s=e[r];cS(s)||n.push(s)}return n}(n,t)}else if(n=lS(t,i),-1==n)return null;const o=Oi(t[n]),a=Mf(o),c=a&&!Array.isArray(a)?a:Y_(t,n,o);if(r&&void 0===c.component&&(c.component=r,Gi(c.component,c)),s&&void 0===c.directives){c.directives=s;for(let l=0;l<s.length;l++)Gi(s[l],c)}Gi(c.native,c),e=c}}else{const t=i;let n=t;for(;n=n.parentNode;){const r=Mf(n);if(r){const s=Array.isArray(r)?r:r.lView;if(!s)return null;const o=lS(s,t);if(o>=0){const a=Oi(s[o]),c=Y_(s,o,a);Gi(a,c),e=c;break}}}}return e||null}function Y_(i,e,t){return new CN(i[ff],e,t)}const K_="__ngContext__";function Gi(i,e){Tr(e)?(i[K_]=e[ff],function TN(i){Z_.set(i[ff],i)}(e)):i[K_]=e}function Mf(i){const e=i[K_];return"number"==typeof e?sS(e):e||null}function cS(i){return i&&i.constructor&&i.constructor.\u0275cmp}function lS(i,e){const t=i[Be];for(let n=Nn;n<t.bindingStartIndex;n++)if(Oi(i[n])===e)return n;return-1}function IN(i){if(i.child)return i.child;if(i.next)return i.next;for(;i.parent&&!i.parent.next;)i=i.parent;return i.parent&&i.parent.next}let J_;function Q_(i,e){return J_(i,e)}function Sf(i){const e=i[Xn];return vs(e)?e[Xn]:e}function ey(i){return dS(i[lf])}function ty(i){return dS(i[ys])}function dS(i){for(;null!==i&&!vs(i);)i=i[ys];return i}function dl(i,e,t,n,r){if(null!=n){let s,o=!1;vs(n)?s=n:Tr(n)&&(o=!0,n=n[go]);const a=Oi(n);0===i&&null!==t?null==r?yS(e,t,a):Ha(e,t,a,r||null,!0):1===i&&null!==t?Ha(e,t,a,r||null,!0):2===i?function cy(i,e,t){const n=cp(i,e);n&&function $N(i,e,t,n){i.removeChild(e,t,n)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function ZN(i,e,t,n,r){const s=t[Gh];s!==Oi(t)&&dl(e,i,n,s,r);for(let a=Qi;a<t.length;a++){const c=t[a];Ef(c[Be],c,i,e,n,s)}}(e,i,s,t,r)}}function iy(i,e,t){return i.createElement(e,t)}function pS(i,e){const t=i[tl],n=t.indexOf(e),r=e[Xn];512&e[Pt]&&(e[Pt]&=-513,w_(r,-1)),t.splice(n,1)}function ry(i,e){if(i.length<=Qi)return;const t=Qi+e,n=i[t];if(n){const r=n[uf];null!==r&&r!==i&&pS(r,n),e>0&&(i[t-1][ys]=n[ys]);const s=np(i,Qi+e);!function BN(i,e){Ef(i,e,e[Ot],2,null,null),e[go]=null,e[Vi]=null}(n[Be],n);const o=s[js];null!==o&&o.detachView(s[Be]),n[Xn]=null,n[ys]=null,n[Pt]&=-65}return n}function mS(i,e){if(!(128&e[Pt])){const t=e[Ot];t.destroyNode&&Ef(i,e,t,3,null,null),function VN(i){let e=i[lf];if(!e)return sy(i[Be],i);for(;e;){let t=null;if(Tr(e))t=e[lf];else{const n=e[Qi];n&&(t=n)}if(!t){for(;e&&!e[ys]&&e!==i;)Tr(e)&&sy(e[Be],e),e=e[Xn];null===e&&(e=i),Tr(e)&&sy(e[Be],e),t=e&&e[ys]}e=t}}(e)}}function sy(i,e){if(!(128&e[Pt])){e[Pt]&=-65,e[Pt]|=128,function jN(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof mf)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];Xr(4,a,c);try{c.call(a)}finally{Xr(5,a,c)}}else{Xr(4,r,s);try{s.call(r)}finally{Xr(5,r,s)}}}}}(i,e),function WN(i,e){const t=i.cleanup,n=e[Jc];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[r=o]():n[r=-o].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)(0,n[s])();e[Jc]=null}}(i,e),1===e[Be].type&&e[Ot].destroy();const t=e[uf];if(null!==t&&vs(e[Xn])){t!==e[Xn]&&pS(t,e);const n=e[js];null!==n&&n.detachView(i)}!function DN(i){Z_.delete(i[ff])}(e)}}function gS(i,e,t){return function _S(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[go];{const{componentOffset:r}=n;if(r>-1){const{encapsulation:s}=i.data[n.directiveStart+r];if(s===Ws.None||s===Ws.Emulated)return null}return Dr(n,t)}}(i,e.parent,t)}function Ha(i,e,t,n,r){i.insertBefore(e,t,n,r)}function yS(i,e,t){i.appendChild(e,t)}function vS(i,e,t,n,r){null!==n?Ha(i,e,t,n,r):yS(i,e,t)}function cp(i,e){return i.parentNode(e)}let oy,fy,wS=function bS(i,e,t){return 40&i.type?Dr(i,t):null};function lp(i,e,t,n){const r=gS(i,n,e),s=e[Ot],a=function xS(i,e,t){return wS(i,e,t)}(n.parent||e[Vi],n,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)vS(s,r,t[c],a,!1);else vS(s,r,t,a,!1);void 0!==oy&&oy(s,n,e,t,r)}function up(i,e){if(null!==e){const t=e.type;if(3&t)return Dr(e,i);if(4&t)return ay(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return up(i,n);{const r=i[e.index];return vs(r)?ay(-1,r):Oi(r)}}if(32&t)return Q_(e,i)()||Oi(i[e.index]);{const n=SS(i,e);return null!==n?Array.isArray(n)?n[0]:up(Sf(i[Hi]),n):up(i,e.next)}}return null}function SS(i,e){return null!==e?i[Hi][Vi].projection[e.projection]:null}function ay(i,e){const t=Qi+i+1;if(t<e.length){const n=e[t],r=n[Be].firstChild;if(null!==r)return up(n,r)}return e[Gh]}function ly(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],c=t.type;if(o&&0===e&&(a&&Gi(Oi(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)ly(i,e,t.child,n,r,s,!1),dl(e,i,r,a,s);else if(32&c){const l=Q_(t,n);let u;for(;u=l();)dl(e,i,r,u,s);dl(e,i,r,a,s)}else 16&c?ES(i,e,n,t,r,s):dl(e,i,r,a,s);t=o?t.projectionNext:t.next}}function Ef(i,e,t,n,r,s){ly(t,n,i.firstChild,e,r,s,!1)}function ES(i,e,t,n,r,s){const o=t[Hi],c=o[Vi].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)dl(e,i,r,c[l],s);else ly(i,e,c,o[Xn],r,s,!0)}function TS(i,e,t){""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function DS(i,e,t){const{mergedAttrs:n,classes:r,styles:s}=t;null!==n&&O_(i,e,n),null!==r&&TS(i,e,r),null!==s&&function KN(i,e,t){i.setAttribute(e,"style",t)}(i,e,s)}class RS{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}const VS=new Et("ENVIRONMENT_INITIALIZER"),HS=new Et("INJECTOR",-1),GS=new Et("INJECTOR_DEF_TYPES");class WS{get(e,t=nf){if(t===nf){const n=new Error(`NullInjectorError: No provider for ${ot(e)}!`);throw n.name="NullInjectorError",n}return t}}function T2(...i){return{\u0275providers:jS(0,i),\u0275fromNgModule:!0}}function jS(i,...e){const t=[],n=new Set;let r;return Va(e,s=>{const o=s;_y(o,t,[],n)&&(r||(r=[]),r.push(o))}),void 0!==r&&$S(r,t),t}function $S(i,e){for(let t=0;t<i.length;t++){const{providers:r}=i[t];yy(r,s=>{e.push(s)})}}function _y(i,e,t,n){if(!(i=F(i)))return!1;let r=null,s=Zw(i);const o=!s&&un(i);if(s||o){if(o&&!o.standalone)return!1;r=i}else{const c=i.ngModule;if(s=Zw(c),!s)return!1;r=c}const a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)_y(l,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;n.add(r);try{Va(s.imports,u=>{_y(u,e,t,n)&&(l||(l=[]),l.push(u))})}finally{}void 0!==l&&$S(l,e)}if(!a){const l=Ba(r)||(()=>new r);e.push({provide:r,useFactory:l,deps:an},{provide:GS,useValue:r,multi:!0},{provide:VS,useValue:()=>ln(r),multi:!0})}const c=s.providers;null==c||a||yy(c,u=>{e.push(u)})}}return r!==i&&void 0!==i.providers}function yy(i,e){for(let t of i)nt(t)&&(t=t.\u0275providers),Array.isArray(t)?yy(t,e):e(t)}const D2=tt({provide:String,useValue:tt});function vy(i){return null!==i&&"object"==typeof i&&D2 in i}function Ga(i){return"function"==typeof i}const xy=new Et("Set Injector scope."),pp={},A2={};let by;function mp(){return void 0===by&&(by=new WS),by}class Wa{}class ZS extends Wa{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,My(e,o=>this.processProvider(o)),this.records.set(HS,pl(void 0,this)),r.has("environment")&&this.records.set(Wa,pl(void 0,this));const s=this.records.get(xy);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(GS.multi,an,mt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Kc(this),n=qr(void 0);try{return e()}finally{Kc(t),qr(n)}}get(e,t=nf,n=mt.Default){this.assertNotDestroyed(),n=Bh(n);const r=Kc(this),s=qr(void 0);try{if(!(n&mt.SkipSelf)){let a=this.records.get(e);if(void 0===a){const c=function O2(i){return"function"==typeof i||"object"==typeof i&&i instanceof Et}(e)&&Nh(e);a=c&&this.injectableDefInScope(c)?pl(wy(e),pp):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&mt.Self?mp():this.parent).get(e,t=n&mt.Optional&&t===nf?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[kh]=o[kh]||[]).unshift(ot(e)),r)throw o;return function rO(i,e,t,n){const r=i[kh];throw e[Jw]&&r.unshift(e[Jw]),i.message=function sO(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&i.charAt(1)==tO?i.slice(2):i;let r=ot(e);if(Array.isArray(e))r=e.map(ot).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):ot(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(eO,"\n  ")}`}("\n"+i.message,r,t,n),i[QL]=r,i[kh]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{qr(s),Kc(r)}}resolveInjectorInitializers(){const e=Kc(this),t=qr(void 0);try{const n=this.get(VS.multi,an,mt.Self);for(const r of n)r()}finally{Kc(e),qr(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(ot(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new W(205,!1)}processProvider(e){let t=Ga(e=F(e))?e:F(e&&e.provide);const n=function P2(i){return vy(i)?pl(void 0,i.useValue):pl(YS(i),pp)}(e);if(Ga(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=pl(void 0,pp,!0),r.factory=()=>m_(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===pp&&(t.value=A2,t.value=t.factory()),"object"==typeof t.value&&t.value&&function L2(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=F(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function wy(i){const e=Nh(i),t=null!==e?e.factory:Ba(i);if(null!==t)return t;if(i instanceof Et)throw new W(204,!1);if(i instanceof Function)return function I2(i){const e=i.length;if(e>0)throw function xf(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}(e,"?"),new W(204,!1);const t=function ZL(i){const e=i&&(i[Fh]||i[Yw]);return e?(function YL(i){if(i.hasOwnProperty("name"))return i.name;(""+i).match(/^function\s*([^\s(]+)/)}(i),e):null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new W(204,!1)}function YS(i,e,t){let n;if(Ga(i)){const r=F(i);return Ba(r)||wy(r)}if(vy(i))n=()=>F(i.useValue);else if(function XS(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...m_(i.deps||[]));else if(function qS(i){return!(!i||!i.useExisting)}(i))n=()=>ln(F(i.useExisting));else{const r=F(i&&(i.useClass||i.provide));if(!function R2(i){return!!i.deps}(i))return Ba(r)||wy(r);n=()=>new r(...m_(i.deps))}return n}function pl(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function My(i,e){for(const t of i)Array.isArray(t)?My(t,e):t&&nt(t)?My(t.\u0275providers,e):e(t)}class N2{}class KS{}class k2{resolveComponentFactory(e){throw function F2(i){const e=Error(`No component factory found for ${ot(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let gp=(()=>{class i{}return i.NULL=new k2,i})();function B2(){return ml(Ni(),he())}function ml(i,e){return new Xs(Dr(i,e))}let Xs=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=B2,i})();function U2(i){return i instanceof Xs?i.nativeElement:i}class _p{}let V2=(()=>{class i{}return i.\u0275prov=Xt({token:i,providedIn:"root",factory:()=>null}),i})();class Sy{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const H2=new Sy("15.2.7"),Ey={},Ty="ngOriginalError";function Dy(i){return i[Ty]}class gl{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Dy(e);for(;t&&Dy(t);)t=Dy(t);return t||null}}function tE(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const nE="ng-template";function Q2(i,e,t){let n=0,r=!0;for(;n<i.length;){let s=i[n++];if("string"==typeof s&&r){const o=i[n++];if(t&&"class"===s&&-1!==tE(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;n<i.length&&"string"==typeof(s=i[n++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function iE(i){return 4===i.type&&i.value!==nE}function eF(i,e,t){return e===(4!==i.type||t?i.value:nE)}function tF(i,e,t){let n=4;const r=i.attrs||[],s=function rF(i){for(let e=0;e<i.length;e++)if(IM(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&n){if(n=2|1&n,""!==c&&!eF(i,c,t)||""===c&&1===e.length){if(bs(n))return!1;o=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==i.attrs){if(!Q2(i.attrs,l,t)){if(bs(n))return!1;o=!0}continue}const f=nF(8&n?"class":c,r,iE(i),t);if(-1===f){if(bs(n))return!1;o=!0;continue}if(""!==l){let d;d=f>s?"":r[f+1].toLowerCase();const h=8&n?d:null;if(h&&-1!==tE(h,l,0)||2&n&&l!==d){if(bs(n))return!1;o=!0}}}}else{if(!o&&!bs(n)&&!bs(c))return!1;if(o&&bs(c))continue;o=!1,n=c|1&n}}return bs(n)||o}function bs(i){return 0==(1&i)}function nF(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function sF(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function rE(i,e,t=!1){for(let n=0;n<e.length;n++)if(tF(i,e[n],t))return!0;return!1}function sE(i,e){return i?":not("+e.trim()+")":e}function aF(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!bs(o)&&(e+=sE(s,r),r=""),n=o,s=s||!bs(n);t++}return""!==r&&(e+=sE(s,r)),e}const wt={};function ja(i){oE(Zt(),he(),tr()+i,!1)}function oE(i,e,t,n){if(!n)if(3==(3&e[Pt])){const s=i.preOrderCheckHooks;null!==s&&Zh(e,s,t)}else{const s=i.preOrderHooks;null!==s&&Yh(e,s,0,t)}Ua(t)}function uE(i,e=null,t=null,n){const r=function fE(i,e=null,t=null,n,r=new Set){const s=[t||an,T2(i)];return n=n||("object"==typeof i?void 0:ot(i)),new ZS(s,e||mp(),n||null,r)}(i,e,t,n);return r.resolveInjectorInitializers(),r}let $a=(()=>{class i{static create(t,n){if(Array.isArray(t))return uE({name:""},n,t,"");{const r=t.name??"";return uE({name:r},t.parent,t.providers,r)}}}return i.THROW_IF_NOT_FOUND=nf,i.NULL=new WS,i.\u0275prov=Xt({token:i,providedIn:"any",factory:()=>ln(HS)}),i.__NG_ELEMENT_ID__=-1,i})();function xt(i,e=mt.Default){const t=he();return null===t?ln(i,e):UM(Ni(),t,F(i),e)}function yE(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=i.data[s];A_(t[n]),o.contentQueries(2,e[s],s)}}}function vp(i,e,t,n,r,s,o,a,c,l,u){const f=e.blueprint.slice();return f[go]=r,f[Pt]=76|n,(null!==u||i&&1024&i[Pt])&&(f[Pt]|=1024),gM(f),f[Xn]=f[Qc]=i,f[ti]=t,f[Hh]=o||i&&i[Hh],f[Ot]=a||i&&i[Ot],f[y_]=c||i&&i[y_]||null,f[Vh]=l||i&&i[Vh]||null,f[Vi]=s,f[ff]=function EN(){return SN++}(),f[oM]=u,f[Hi]=2==e.type?i[Hi]:f,f}function vl(i,e,t,n,r){let s=i.data[e];if(null===s)s=function Ry(i,e,t,n,r){const s=vM(),o=E_(),c=i.data[e]=function OF(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(i,e,t,n,r),function AO(){return bt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function pf(){const i=bt.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return $s(s,!0),s}function Af(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function Ly(i,e,t){I_(e);try{const n=i.viewQuery;null!==n&&Hy(1,n,t);const r=i.template;null!==r&&vE(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&yE(i,e),i.staticViewQueries&&Hy(2,i.viewQuery,t);const s=i.components;null!==s&&function PF(i,e){for(let t=0;t<e.length;t++)e3(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[Pt]&=-5,P_()}}function xp(i,e,t,n){const r=e[Pt];if(128!=(128&r)){I_(e);try{gM(e),function bM(i){return bt.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&vE(i,e,t,2,n);const o=3==(3&r);if(o){const l=i.preOrderCheckHooks;null!==l&&Zh(e,l,null)}else{const l=i.preOrderHooks;null!==l&&Yh(e,l,0,null),R_(e,0)}if(function JF(i){for(let e=ey(i);null!==e;e=ty(e)){if(!e[aM])continue;const t=e[tl];for(let n=0;n<t.length;n++){const r=t[n];512&r[Pt]||w_(r[Xn],1),r[Pt]|=512}}}(e),function KF(i){for(let e=ey(i);null!==e;e=ty(e))for(let t=Qi;t<e.length;t++){const n=e[t],r=n[Be];qh(n)&&xp(r,n,r.template,n[ti])}}(e),null!==i.contentQueries&&yE(i,e),o){const l=i.contentCheckHooks;null!==l&&Zh(e,l)}else{const l=i.contentHooks;null!==l&&Yh(e,l,1),R_(e,1)}!function AF(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)Ua(~r);else{const s=r,o=t[++n],a=t[++n];IO(o,s),a(2,e[s])}}}finally{Ua(-1)}}(i,e);const a=i.components;null!==a&&function IF(i,e){for(let t=0;t<e.length;t++)QF(i,e[t])}(e,a);const c=i.viewQuery;if(null!==c&&Hy(2,c,n),o){const l=i.viewCheckHooks;null!==l&&Zh(e,l)}else{const l=i.viewHooks;null!==l&&Yh(e,l,2),R_(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),e[Pt]&=-41,512&e[Pt]&&(e[Pt]&=-513,w_(e[Xn],-1))}finally{P_()}}}function vE(i,e,t,n,r){const s=tr(),o=2&n;try{Ua(-1),o&&e.length>Nn&&oE(i,e,Nn,!1),Xr(o?2:0,r),t(n,r)}finally{Ua(s),Xr(o?3:1,r)}}function Oy(i,e,t){if(x_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function Ny(i,e,t){yM()&&(function VF(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;df(t)&&function XF(i,e,t){const n=Dr(e,i),r=xE(t),s=i[Hh],o=bp(i,vp(i,r,null,t.onPush?32:16,n,e,s,s.createRenderer(n,t),null,null,null));i[e.index]=o}(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||ep(t,e),Gi(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=i.data[a],l=za(e,i,a,t);Gi(l,e),null!==o&&ZF(0,a-r,l,c,0,o),xs(c)&&(pr(t.index,e)[ti]=za(e,i,a,t))}}(i,e,t,Dr(t,e)),64==(64&t.flags)&&EE(i,e,t))}function Fy(i,e,t=Dr){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}function xE(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=ky(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function ky(i,e,t,n,r,s,o,a,c,l){const u=Nn+n,f=u+r,d=function RF(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:wt);return t}(u,f),h="function"==typeof l?l():l;return d[Be]={type:i,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:h,incompleteFirstPass:!1}}function bE(i,e,t,n){const r=DE(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&CE(i).push(n,r.length-1))}function wE(i,e,t,n){for(let r in i)if(i.hasOwnProperty(r)){t=null===t?{}:t;const s=i[r];null===n?ME(t,e,r,s):n.hasOwnProperty(r)&&ME(t,e,n[r],s)}return t}function ME(i,e,t,n){i.hasOwnProperty(t)?i[t].push(e,n):i[t]=[e,n]}function By(i,e,t,n){if(yM()){const r=null===n?null:{"":-1},s=function GF(i,e){const t=i.directiveRegistry;let n=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(rE(e,o.selectors,!1))if(n||(n=[]),xs(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o),Uy(i,e,a.length)}else n.unshift(o),Uy(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return null===n?null:[n,r]}(i,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&SE(i,e,t,o,r,a),r&&function WF(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new W(-301,!1);n.push(e[r],s)}}}(t,n,r)}t.mergedAttrs=gf(t.mergedAttrs,t.attrs)}function SE(i,e,t,n,r,s){for(let l=0;l<n.length;l++)B_(ep(t,e),i,n[l].type);!function $F(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}(t,i.data.length,n.length);for(let l=0;l<n.length;l++){const u=n[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=Af(i,e,n.length,null);for(let l=0;l<n.length;l++){const u=n[l];t.mergedAttrs=gf(t.mergedAttrs,u.hostAttrs),qF(i,t,e,c,u),jF(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const f=u.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((i.preOrderHooks??(i.preOrderHooks=[])).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((i.preOrderCheckHooks??(i.preOrderCheckHooks=[])).push(t.index),a=!0),c++}!function NF(i,e,t){const r=e.directiveEnd,s=i.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const f=s[u],d=t?t.get(f):null,m=d?d.outputs:null;c=wE(f.inputs,u,c,d?d.inputs:null),l=wE(f.outputs,u,l,m);const p=null===c||null===o||iE(e)?null:YF(c,u,o);a.push(p)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(i,t,s)}function EE(i,e,t){const n=t.directiveStart,r=t.directiveEnd,s=t.index,o=function PO(){return bt.lFrame.currentDirectiveIndex}();try{Ua(s);for(let a=n;a<r;a++){const c=i.data[a],l=e[a];D_(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&HF(c,l)}}finally{Ua(-1),D_(o)}}function HF(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function Uy(i,e,t){e.componentOffset=t,(i.components??(i.components=[])).push(e.index)}function jF(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;xs(e)&&(t[""]=i)}}function qF(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=Ba(r.type)),o=new mf(s,xs(r),xt);i.blueprint[n]=o,t[n]=o,function UF(i,e,t,n,r){const s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;null===o&&(o=i.hostBindingOpCodes=[]);const a=~e.index;(function zF(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(i,e,n,Af(i,t,r.hostVars,wt),r)}function ZF(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let c=0;c<o.length;){const l=o[c++],u=o[c++],f=o[c++];null!==a?n.setInput(t,f,l,u):t[u]=f}}}function YF(i,e,t){let n=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(i.hasOwnProperty(s)){null===n&&(n=[]);const o=i[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return n}function TE(i,e,t,n){return[i,!0,!1,e,null,0,n,t,null,null]}function QF(i,e){const t=pr(e,i);if(qh(t)){const n=t[Be];48&t[Pt]?xp(n,t,n.template,t[ti]):t[ka]>0&&Vy(t)}}function Vy(i){for(let n=ey(i);null!==n;n=ty(n))for(let r=Qi;r<n.length;r++){const s=n[r];if(qh(s))if(512&s[Pt]){const o=s[Be];xp(o,s,o.template,s[ti])}else s[ka]>0&&Vy(s)}const t=i[Be].components;if(null!==t)for(let n=0;n<t.length;n++){const r=pr(t[n],i);qh(r)&&r[ka]>0&&Vy(r)}}function e3(i,e){const t=pr(e,i),n=t[Be];(function t3(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),Ly(n,t,t[ti])}function bp(i,e){return i[lf]?i[sM][ys]=e:i[lf]=e,i[sM]=e,e}function wp(i){for(;i;){i[Pt]|=32;const e=Sf(i);if(fO(i)&&!e)return i;i=e}return null}function Mp(i,e,t,n=!0){const r=e[Hh];r.begin&&r.begin();try{xp(i,e,i.template,t)}catch(o){throw n&&IE(e,o),o}finally{r.end&&r.end()}}function Hy(i,e,t){A_(0),e(i,t)}function DE(i){return i[Jc]||(i[Jc]=[])}function CE(i){return i.cleanup||(i.cleanup=[])}function IE(i,e){const t=i[Vh],n=t?t.get(gl,null):null;n&&n.handleError(e)}function Gy(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],c=e[o],l=i.data[o];null!==l.setInput?l.setInput(c,r,n,a):c[a]=r}}function Sp(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=pn(r,a):2==s&&(n=pn(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}function Ep(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(Oi(s)),vs(s))for(let a=Qi;a<s.length;a++){const c=s[a],l=c[Be].firstChild;null!==l&&Ep(c[Be],c,l,n)}const o=t.type;if(8&o)Ep(i,e,t.child,n);else if(32&o){const a=Q_(t,e);let c;for(;c=a();)n.push(c)}else if(16&o){const a=SS(e,t);if(Array.isArray(a))n.push(...a);else{const c=Sf(e[Hi]);Ep(c[Be],c,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class If{get rootNodes(){const e=this._lView,t=e[Be];return Ep(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ti]}set context(e){this._lView[ti]=e}get destroyed(){return 128==(128&this._lView[Pt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Xn];if(vs(e)){const t=e[Wh],n=t?t.indexOf(this):-1;n>-1&&(ry(e,n),np(t,n))}this._attachedToViewContainer=!1}mS(this._lView[Be],this._lView)}onDestroy(e){bE(this._lView[Be],this._lView,null,e)}markForCheck(){wp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Pt]&=-65}reattach(){this._lView[Pt]|=64}detectChanges(){Mp(this._lView[Be],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new W(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function zN(i,e){Ef(i,e,e[Ot],2,null,null)}(this._lView[Be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new W(902,!1);this._appRef=e}}class n3 extends If{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Mp(e[Be],e,e[ti],!1)}checkNoChanges(){}get context(){return null}}class PE extends gp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=un(e);return new Pf(t,this.ngModule)}}function RE(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class r3{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Bh(n);const r=this.injector.get(e,Ey,n);return r!==Ey||t===Ey?r:this.parentInjector.get(e,t,n)}}class Pf extends KS{get inputs(){return RE(this.componentDef.inputs)}get outputs(){return RE(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function cF(i){return i.map(aF).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=(r=r||this.ngModule)instanceof Wa?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new r3(e,s):e,a=o.get(_p,null);if(null===a)throw new W(407,!1);const c=o.get(V2,null),l=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",f=n?function LF(i,e,t){return i.selectRootElement(e,t===Ws.ShadowDom)}(l,n,this.componentDef.encapsulation):iy(l,u,function i3(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),d=this.componentDef.onPush?288:272,h=ky(0,null,null,1,0,null,null,null,null,null),m=vp(null,h,null,d,null,null,a,l,c,o,null);let p,g;I_(m);try{const y=this.componentDef;let v,_=null;y.findHostDirectiveDefs?(v=[],_=new Map,y.findHostDirectiveDefs(y,v,_),v.push(y)):v=[y];const x=function o3(i,e){const t=i[Be],n=Nn;return i[n]=e,vl(t,n,2,"#host",null)}(m,f),w=function a3(i,e,t,n,r,s,o,a){const c=r[Be];!function c3(i,e,t,n){for(const r of i)e.mergedAttrs=gf(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Sp(e,e.mergedAttrs,!0),null!==t&&DS(n,t,e))}(n,i,e,o);const l=s.createRenderer(e,t),u=vp(r,xE(t),null,t.onPush?32:16,r[i.index],i,s,l,a||null,null,null);return c.firstCreatePass&&Uy(c,i,n.length-1),bp(r,u),r[i.index]=u}(x,f,y,v,m,a,l);g=mM(h,Nn),f&&function u3(i,e,t,n){if(n)O_(i,t,["ng-version",H2.full]);else{const{attrs:r,classes:s}=function lF(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!bs(r))break;r=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);r&&O_(i,t,r),s&&s.length>0&&TS(i,t,s.join(" "))}}(l,y,f,n),void 0!==t&&function f3(i,e,t){const n=i.projection=[];for(let r=0;r<e.length;r++){const s=t[r];n.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),p=function l3(i,e,t,n,r,s){const o=Ni(),a=r[Be],c=Dr(o,r);SE(a,r,o,t,null,n);for(let u=0;u<t.length;u++)Gi(za(r,a,o.directiveStart+u,o),r);EE(a,r,o),c&&Gi(c,r);const l=za(r,a,o.directiveStart+o.componentOffset,o);if(i[ti]=r[ti]=l,null!==s)for(const u of s)u(l,e);return Oy(a,o,i),l}(w,y,v,_,m,[d3]),Ly(h,m,null)}finally{P_()}return new s3(this.componentType,p,ml(g,m),m,g)}}class s3 extends N2{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new n3(r),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let r;if(null!==n&&(r=n[e])){const s=this._rootLView;Gy(s[Be],s,r,e,t),wp(pr(this._tNode.index,s))}}get injector(){return new sl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function d3(){const i=Ni();Xh(he()[Be],i)}function Rf(i){let e=function LE(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),t=!0;const n=[i];for(;e;){let r;if(xs(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new W(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);const o=i;o.inputs=Wy(i.inputs),o.declaredInputs=Wy(i.declaredInputs),o.outputs=Wy(i.outputs);const a=r.hostBindings;a&&g3(i,a);const c=r.viewQuery,l=r.contentQueries;if(c&&p3(i,c),l&&m3(i,l),Di(i.inputs,r.inputs),Di(i.declaredInputs,r.declaredInputs),Di(i.outputs,r.outputs),xs(r)&&r.data.animation){const u=i.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(i),a===Rf&&(t=!1)}}e=Object.getPrototypeOf(e)}!function h3(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){const r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=gf(r.hostAttrs,t=gf(t,r.hostAttrs))}}(n)}function Wy(i){return i===po?{}:i===an?[]:i}function p3(i,e){const t=i.viewQuery;i.viewQuery=t?(n,r)=>{e(n,r),t(n,r)}:e}function m3(i,e){const t=i.contentQueries;i.contentQueries=t?(n,r,s)=>{e(n,r,s),t(n,r,s)}:e}function g3(i,e){const t=i.hostBindings;i.hostBindings=t?(n,r)=>{e(n,r),t(n,r)}:e}function Ys(i,e,t){return i[e]=t}function Wi(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function Cp(i,e,t,n,r,s,o,a){const c=he(),l=Zt(),u=i+Nn,f=l.firstCreatePass?function T3(i,e,t,n,r,s,o,a,c){const l=e.consts,u=vl(e,i,4,o||null,Qo(l,a));By(e,t,u,Qo(l,c)),Xh(e,u);const f=u.tView=ky(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l);return null!==e.queries&&(e.queries.template(e,u),f.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,t,n,r,s,o):l.data[u];$s(f,!1);const d=c[Ot].createComment("");lp(l,c,d,f),Gi(d,c),bp(c,c[u]=TE(d,c,d,f)),jh(f)&&Ny(l,c,f),null!=o&&Fy(c,f,a)}function Kr(i,e,t){const n=he();return Wi(n,function il(){return bt.lFrame.bindingIndex++}(),e)&&function Ar(i,e,t,n,r,s,o,a){const c=Dr(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[n])?(Gy(i,t,u,n,r),df(e)&&function kF(i,e){const t=pr(e,i);16&t[Pt]||(t[Pt]|=32)}(t,e.index)):3&e.type&&(n=function FF(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=o?o(r,e.value||"",n):r,s.setProperty(c,n,r))}(Zt(),function zn(){const i=bt.lFrame;return mM(i.tView,i.selectedIndex)}(),n,i,e,n[Ot],t,!1),Kr}function $y(i,e,t,n,r){const o=r?"class":"style";Gy(i,t,e.inputs[o],o,n)}function wo(i,e,t,n){const r=he(),s=Zt(),o=Nn+i,a=r[Ot],c=s.firstCreatePass?function A3(i,e,t,n,r,s){const o=e.consts,c=vl(e,i,2,n,Qo(o,r));return By(e,t,c,Qo(o,s)),null!==c.attrs&&Sp(c,c.attrs,!1),null!==c.mergedAttrs&&Sp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,n):s.data[o],l=r[o]=iy(a,e,function UO(){return bt.lFrame.currentNamespace}()),u=jh(c);return $s(c,!0),DS(a,l,c),32!=(32&c.flags)&&lp(s,r,l,c),0===function MO(){return bt.lFrame.elementDepthCount}()&&Gi(l,r),function SO(){bt.lFrame.elementDepthCount++}(),u&&(Ny(s,r,c),Oy(s,c,r)),null!==n&&Fy(r,c),wo}function ta(){let i=Ni();E_()?T_():(i=i.parent,$s(i,!1));const e=i;!function EO(){bt.lFrame.elementDepthCount--}();const t=Zt();return t.firstCreatePass&&(Xh(t,i),x_(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function GO(i){return 0!=(8&i.flags)}(e)&&$y(t,e,he(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function WO(i){return 0!=(16&i.flags)}(e)&&$y(t,e,he(),e.stylesWithoutHost,!1),ta}function Of(i,e,t,n){return wo(i,e,t,n),ta(),Of}function Ap(i,e,t){const n=he(),r=Zt(),s=i+Nn,o=r.firstCreatePass?function I3(i,e,t,n,r){const s=e.consts,o=Qo(s,n),a=vl(e,i,8,"ng-container",o);return null!==o&&Sp(a,o,!0),By(e,t,a,Qo(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,n,e,t):r.data[s];$s(o,!0);const a=n[s]=n[Ot].createComment("");return lp(r,n,a,o),Gi(a,n),jh(o)&&(Ny(r,n,o),Oy(r,o,n)),null!=t&&Fy(n,o),Ap}function Ip(){let i=Ni();const e=Zt();return E_()?T_():(i=i.parent,$s(i,!1)),e.firstCreatePass&&(Xh(e,i),x_(i)&&e.queries.elementEnd(i)),Ip}function qy(){return he()}function Xy(i){return!!i&&"function"==typeof i.then}const P3=function XE(i){return!!i&&"function"==typeof i.subscribe};function Al(i,e,t,n){const r=he(),s=Zt(),o=Ni();return function YE(i,e,t,n,r,s,o){const a=jh(n),l=i.firstCreatePass&&CE(i),u=e[ti],f=DE(e);let d=!0;if(3&n.type||o){const p=Dr(n,e),g=o?o(p):p,y=f.length,v=o?x=>o(Oi(x[n.index])):n.index;let _=null;if(!o&&a&&(_=function R3(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[Jc],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,d=!1;else{s=JE(n,e,u,s,!1);const x=t.listen(g,r,s);f.push(s,x),l&&l.push(r,v,y,y+1)}}else s=JE(n,e,u,s,!1);const h=n.outputs;let m;if(d&&null!==h&&(m=h[r])){const p=m.length;if(p)for(let g=0;g<p;g+=2){const w=e[m[g]][m[g+1]].subscribe(s),M=f.length;f.push(s,w),l&&l.push(r,n.index,M,-(M+1))}}}(s,r,r[Ot],o,i,e,n),Al}function KE(i,e,t,n){try{return Xr(6,e,t),!1!==t(n)}catch(r){return IE(i,r),!1}finally{Xr(7,e,t)}}function JE(i,e,t,n,r){return function s(o){if(o===Function)return n;wp(i.componentOffset>-1?pr(i.index,e):e);let c=KE(e,t,n,o),l=s.__ngNextListenerFn__;for(;l;)c=KE(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&(o.preventDefault(),o.returnValue=!1),c}}function Pp(i=1){return function LO(i){return(bt.lFrame.contextLView=function OO(i,e){for(;i>0;)e=e[Qc],i--;return e}(i,bt.lFrame.contextLView))[ti]}(i)}function Rp(i,e){return i<<17|e<<2}function na(i){return i>>17&32767}function Yy(i){return 2|i}function Xa(i){return(131068&i)>>2}function Ky(i,e){return-131069&i|e<<2}function Jy(i){return 1|i}function cT(i,e,t,n,r){const s=i[t+1],o=null===e;let a=n?na(s):Xa(s),c=!1;for(;0!==a&&(!1===c||o);){const u=i[a+1];V3(i[a],e)&&(c=!0,i[a+1]=n?Jy(u):Yy(u)),a=n?na(u):Xa(u)}c&&(i[t+1]=n?Yy(s):Jy(s))}function V3(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&ul(i,e)>=0}function Qy(i,e,t){return ws(i,e,t,!1),Qy}function ev(i,e){return ws(i,e,null,!0),ev}function ws(i,e,t,n){const r=he(),s=Zt(),o=function yo(i){const e=bt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}(2);s.firstUpdatePass&&function gT(i,e,t,n){const r=i.data;if(null===r[t+1]){const s=r[tr()],o=function mT(i,e){return e>=i.expandoStartIndex}(i,t);(function xT(i,e){return 0!=(i.flags&(e?8:16))})(s,n)&&null===e&&!o&&(e=!1),e=function Y3(i,e,t,n){const r=function C_(i){const e=bt.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}(i);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(t=Nf(t=tv(null,i,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||i[o]!==r)if(t=tv(r,i,e,t,n),null===s){let c=function K3(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==Xa(n))return i[na(n)]}(i,e,n);void 0!==c&&Array.isArray(c)&&(c=tv(null,i,e,c[1],n),c=Nf(c,e.attrs,n),function J3(i,e,t,n){i[na(t?e.classBindings:e.styleBindings)]=n}(i,e,n,c))}else s=function Q3(i,e,t){let n;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=Nf(n,i[s].hostAttrs,t);return Nf(n,e.attrs,t)}(i,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,n),function U3(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=na(o),c=Xa(o);i[n]=t;let u,l=!1;if(Array.isArray(t)?(u=t[1],(null===u||ul(t,u)>0)&&(l=!0)):u=t,r)if(0!==c){const d=na(i[a+1]);i[n+1]=Rp(d,a),0!==d&&(i[d+1]=Ky(i[d+1],n)),i[a+1]=function k3(i,e){return 131071&i|e<<17}(i[a+1],n)}else i[n+1]=Rp(a,0),0!==a&&(i[a+1]=Ky(i[a+1],n)),a=n;else i[n+1]=Rp(c,0),0===a?a=n:i[c+1]=Ky(i[c+1],n),c=n;l&&(i[n+1]=Yy(i[n+1])),cT(i,u,n,!0),cT(i,u,n,!1),function z3(i,e,t,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof e&&ul(s,e)>=0&&(t[n+1]=Jy(t[n+1]))}(e,u,i,n,s),o=Rp(a,c),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,n)}}(s,i,o,n),e!==wt&&Wi(r,o,e)&&function yT(i,e,t,n,r,s,o,a){if(!(3&e.type))return;const c=i.data,l=c[a+1],u=function B3(i){return 1==(1&i)}(l)?vT(c,e,t,r,Xa(l),o):void 0;Lp(u)||(Lp(s)||function F3(i){return 2==(2&i)}(l)&&(s=vT(c,null,t,r,a,o)),function YN(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:mr.DashCase;null==r?i.removeStyle(t,n,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=mr.Important),i.setStyle(t,n,r,s))}}(n,o,function $h(i,e){return Oi(e[i])}(tr(),t),r,s))}(s,s.data[tr()],r,r[Ot],i,r[o+1]=function nk(i,e){return null==i||""===i||("string"==typeof e?i+=e:"object"==typeof i&&(i=ot(function ea(i){return i instanceof RS?i.changingThisBreaksApplicationSecurity:i}(i)))),i}(e,t),n,o)}function tv(i,e,t,n,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=Nf(n,s.hostAttrs,r),s!==i);)a++;return null!==i&&(t.directiveStylingLast=a),n}function Nf(i,e,t){const n=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Cr(i,o,!!t||e[++s]))}return void 0===i?null:i}function vT(i,e,t,n,r,s){const o=null===e;let a;for(;r>0;){const c=i[r],l=Array.isArray(c),u=l?c[1]:c,f=null===u;let d=t[r+1];d===wt&&(d=f?an:void 0);let h=f?G_(d,n):u===n?d:void 0;if(l&&!Lp(h)&&(h=G_(c,n)),Lp(h)&&(a=h,o))return a;const m=i[r+1];r=o?na(m):Xa(m)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=G_(c,n))}return a}function Lp(i){return void 0!==i}function nv(i,e=""){const t=he(),n=Zt(),r=i+Nn,s=n.firstCreatePass?vl(n,r,1,e,null):n.data[r],o=t[r]=function ny(i,e){return i.createText(e)}(t[Ot],e);lp(n,t,o,s),$s(s,!1)}const Rl="en-US";let GT=Rl;function ov(i,e,t,n,r){if(i=F(i),Array.isArray(i))for(let s=0;s<i.length;s++)ov(i[s],e,t,n,r);else{const s=Zt(),o=he();let a=Ga(i)?i:F(i.provide),c=YS(i);const l=Ni(),u=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(Ga(i)||!i.multi){const h=new mf(c,r,xt),m=cv(a,e,r?u:u+d,f);-1===m?(B_(ep(l,o),s,a),av(s,i,e.length),e.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(h),o.push(h)):(t[m]=h,o[m]=h)}else{const h=cv(a,e,u+d,f),m=cv(a,e,u,u+d),g=m>=0&&t[m];if(r&&!g||!r&&!(h>=0&&t[h])){B_(ep(l,o),s,a);const y=function xB(i,e,t,n,r){const s=new mf(i,t,xt);return s.multi=[],s.index=e,s.componentProviders=0,pD(s,r,n&&!t),s}(r?vB:yB,t.length,r,n,c);!r&&g&&(t[m].providerFactory=y),av(s,i,e.length,0),e.push(a),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(y),o.push(y)}else av(s,i,h>-1?h:m,pD(t[r?m:h],c,!r&&n));!r&&n&&g&&t[m].componentProviders++}}}function av(i,e,t,n){const r=Ga(e),s=function C2(i){return!!i.useClass}(e);if(r||s){const c=(s?F(e.useClass):e).prototype.ngOnDestroy;if(c){const l=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(t);-1===u?l.push(t,[n,c]):l[u+1].push(n,c)}else l.push(t,c)}}}function pD(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function cv(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function yB(i,e,t,n){return lv(this.multi,[])}function vB(i,e,t,n){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=za(t,t[Be],this.providerFactory.index,n);s=a.slice(0,o),lv(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],lv(r,s);return s}function lv(i,e){for(let t=0;t<i.length;t++)e.push((0,i[t])());return e}function uv(i,e=[]){return t=>{t.providersResolver=(n,r)=>function _B(i,e,t){const n=Zt();if(n.firstCreatePass){const r=xs(i);ov(t,n.data,n.blueprint,r,!0),ov(e,n.data,n.blueprint,r,!1)}}(n,r?r(i):i,e)}}class Ll{}class MB extends Ll{constructor(e,t,n){super(),this.componentFactoryResolver=new PE(this),this.instance=null;const r=new ZS([...e,{provide:Ll,useValue:this},{provide:gp,useValue:this.componentFactoryResolver}],t||mp(),n,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function dv(i,e,t=null){return new MB(i,e,t).injector}let SB=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const n=jS(0,t.type),r=n.length>0?dv([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=Xt({token:i,providedIn:"environment",factory:()=>new i(ln(Wa))}),i})();function Vf(i){i.getStandaloneInjector=e=>e.get(SB).getOrCreateStandaloneInjector(i)}function hv(i){const e=gr(i);if(null===e)return null;if(void 0===e.component){const t=e.lView;if(null===t)return null;e.component=function RN(i,e){const t=e[Be].data[i],{directiveStart:n,componentOffset:r}=t;return r>-1?e[n+r]:null}(e.nodeIndex,t)}return e.component}function AB(i,e){return i.name==e.name?0:i.name<e.name?-1:1}function IB(i){return void 0!==i.type&&void 0!==i.declaredInputs&&void 0!==i.findHostDirectiveDefs}function pv(i,e,t,n){return SD(he(),er(),i,e,t,n)}function MD(i,e,t,n,r){return function ED(i,e,t,n,r,s,o){const a=e+t;return function qa(i,e,t,n){const r=Wi(i,e,t);return Wi(i,e+1,n)||r}(i,a,r,s)?Ys(i,a+2,o?n.call(o,r,s):n(r,s)):Hf(i,a+2)}(he(),er(),i,e,t,n,r)}function Hf(i,e){const t=i[e];return t===wt?void 0:t}function SD(i,e,t,n,r,s){const o=e+t;return Wi(i,o,r)?Ys(i,o+1,s?n.call(s,r):n(r)):Hf(i,o+1)}function ID(i,e,t){const n=i+Nn,r=he(),s=function nl(i,e){return i[e]}(r,n);return function Gf(i,e){return i[Be].data[e].pure}(r,n)?SD(r,er(),e,s.transform,t,s):s.transform(t)}function mv(i){return e=>{setTimeout(i,void 0,e)}}const ir=class jB extends fr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=mv(s),r&&(r=mv(r)),o&&(o=mv(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof kn&&e.add(a),a}};function $B(){return this._results[Symbol.iterator]()}class gv{get changes(){return this._changes||(this._changes=new ir)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=gv.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=$B)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=function Zr(i){return i.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function eN(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ss=(()=>{class i{}return i.__NG_ELEMENT_ID__=ZB,i})();const qB=Ss,XB=class extends qB{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e,t){const n=this._declarationTContainer.tView,r=vp(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null,t||null);r[uf]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[js];return null!==o&&(r[js]=o.createEmbeddedView(n)),Ly(n,r,e),new If(r)}};function ZB(){return Bp(Ni(),he())}function Bp(i,e){return 4&i.type?new XB(e,i,ml(i,e)):null}let rr=(()=>{class i{}return i.__NG_ELEMENT_ID__=YB,i})();function YB(){return LD(Ni(),he())}const KB=rr,PD=class extends KB{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return ml(this._hostTNode,this._hostLView)}get injector(){return new sl(this._hostTNode,this._hostLView)}get parentInjector(){const e=k_(this._hostTNode,this._hostLView);if(LM(e)){const t=Jh(e,this._hostLView),n=Kh(e);return new sl(t[Be].data[n+8],t)}return new sl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=RD(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Qi}createEmbeddedView(e,t,n){let r,s;"number"==typeof n?r=n:null!=n&&(r=n.index,s=n.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,n,r,s){const o=e&&!function vf(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const f=t||{};a=f.index,n=f.injector,r=f.projectableNodes,s=f.environmentInjector||f.ngModuleRef}const c=o?e:new Pf(un(e)),l=n||this.parentInjector;if(!s&&null==c.ngModule){const d=(o?l:this.parentInjector).get(Wa,null);d&&(s=d)}const u=c.create(l,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const n=e._lView,r=n[Be];if(function wO(i){return vs(i[Xn])}(n)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const f=n[Xn],d=new PD(f,f[Vi],f[Xn]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function HN(i,e,t,n){const r=Qi+n,s=t.length;n>0&&(t[r-1][ys]=e),n<s-Qi?(e[ys]=t[r],jM(t,Qi+n,e)):(t.push(e),e[ys]=null),e[Xn]=t;const o=e[uf];null!==o&&t!==o&&function GN(i,e){const t=i[tl];e[Hi]!==e[Xn][Xn][Hi]&&(i[aM]=!0),null===t?i[tl]=[e]:t.push(e)}(o,e);const a=e[js];null!==a&&a.insertView(i),e[Pt]|=64}(r,n,o,s);const a=ay(s,o),c=n[Ot],l=cp(c,o[Gh]);return null!==l&&function UN(i,e,t,n,r,s){n[go]=r,n[Vi]=e,Ef(i,n,t,1,r,s)}(r,o[Vi],c,n,l,a),e.attachToViewContainerRef(),jM(_v(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=RD(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=ry(this._lContainer,t);n&&(np(_v(this._lContainer),t),mS(n[Be],n))}detach(e){const t=this._adjustIndex(e,-1),n=ry(this._lContainer,t);return n&&null!=np(_v(this._lContainer),t)?new If(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function RD(i){return i[Wh]}function _v(i){return i[Wh]||(i[Wh]=[])}function LD(i,e){let t;const n=e[i.index];if(vs(n))t=n;else{let r;if(8&i.type)r=Oi(n);else{const s=e[Ot];r=s.createComment("");const o=Dr(i,e);Ha(s,cp(s,o),r,function qN(i,e){return i.nextSibling(e)}(s,o),!1)}e[i.index]=t=TE(n,e,r,i),bp(e,t)}return new PD(t,i,e)}class yv{constructor(e){this.queryList=e,this.matches=null}clone(){return new yv(this.queryList)}setDirty(){this.queryList.setDirty()}}class vv{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new vv(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==UD(e,t).matches&&this.queries[t].setDirty()}}class OD{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class xv{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new xv(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class bv{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new bv(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(e,t,JB(t,s)),this.matchTNodeWithReadOption(e,t,tp(t,e,s,!1,!1))}else n===Ss?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,tp(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Xs||r===rr||r===Ss&&4&t.type)this.addMatch(t.index,-2);else{const s=tp(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function JB(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function eU(i,e,t,n){return-1===t?function QB(i,e){return 11&i.type?ml(i,e):4&i.type?Bp(i,e):null}(e,i):-2===t?function tU(i,e,t){return t===Xs?ml(e,i):t===Ss?Bp(e,i):t===rr?LD(e,i):void 0}(i,e,n):za(i,i[Be],t,e)}function ND(i,e,t,n){const r=e[js].queries[n];if(null===r.matches){const s=i.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:eU(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function wv(i,e,t,n){const r=i.queries.getByIndex(t),s=r.matches;if(null!==s){const o=ND(i,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)n.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let f=Qi;f<u.length;f++){const d=u[f];d[uf]===d[Xn]&&wv(d[Be],d,l,n)}if(null!==u[tl]){const f=u[tl];for(let d=0;d<f.length;d++){const h=f[d];wv(h[Be],h,l,n)}}}}}return n}function Wf(i){const e=he(),t=Zt(),n=MM();A_(n+1);const r=UD(t,n);if(i.dirty&&function bO(i){return 4==(4&i[Pt])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?wv(t,e,n,[]):ND(t,e,r,n);i.reset(s,U2),i.notifyOnChanges()}return!0}return!1}function Up(i,e,t){const n=Zt();n.firstCreatePass&&(BD(n,new OD(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),kD(n,he(),e)}function jf(){return function nU(i,e){return i[js].queries[e].queryList}(he(),MM())}function kD(i,e,t){const n=new gv(4==(4&t));bE(i,e,n,n.destroy),null===e[js]&&(e[js]=new vv),e[js].queries.push(new yv(n))}function BD(i,e,t){null===i.queries&&(i.queries=new xv),i.queries.track(new bv(e,t))}function UD(i,e){return i.queries.getByIndex(e)}function Vp(...i){}const r1=new Et("Application Initializer");let Hp=(()=>{class i{constructor(t){this.appInits=t,this.resolve=Vp,this.reject=Vp,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Xy(s))t.push(s);else if(P3(s)){const o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(ln(r1,8))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Dv=new Et("AppId",{providedIn:"root",factory:function s1(){return`${Cv()}${Cv()}${Cv()}`}});function Cv(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const o1=new Et("Platform Initializer"),a1=new Et("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Mo=new Et("LocaleId",{providedIn:"root",factory:()=>Un(Mo,mt.Optional|mt.SkipSelf)||function SU(){return typeof $localize<"u"&&$localize.locale||Rl}()}),AU=(()=>Promise.resolve(0))();class Fi{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ir(!1),this.onMicrotaskEmpty=new ir(!1),this.onStable=new ir(!1),this.onError=new ir(!1),typeof Zone>"u")throw new W(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function IU(){let i=On.requestAnimationFrame,e=On.cancelAnimationFrame;if(typeof Zone<"u"&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function LU(i){const e=()=>{!function RU(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(On,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,Pv(i),i.isCheckStableRunning=!0,Iv(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),Pv(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return u1(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),f1(i)}},onInvoke:(t,n,r,s,o,a,c)=>{try{return u1(i),t.invoke(r,s,o,a,c)}finally{i.shouldCoalesceRunChangeDetection&&e(),f1(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,Pv(i),Iv(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Fi.isInAngularZone())throw new W(909,!1)}static assertNotInAngularZone(){if(Fi.isInAngularZone())throw new W(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,PU,Vp,Vp);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const PU={};function Iv(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function Pv(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function u1(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function f1(i){i._nesting--,Iv(i)}class OU{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ir,this.onMicrotaskEmpty=new ir,this.onStable=new ir,this.onError=new ir}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}const d1=new Et(""),So=!1;let ia=null;const Nv=new Et("PlatformDestroyListeners"),FU=new Et("appBootstrapListener");function VU(i){const{rootComponent:e,appProviders:t,platformProviders:n}=i;So&&void 0!==e&&function K2(i){if(function J2(i){if(!un(i))throw new W(906,`The ${K(i)} is not an Angular component, make sure it has the \`@Component\` decorator.`)}(i),!un(i).standalone)throw new W(907,`The ${K(i)} component is not marked as standalone, but Angular expects to have a standalone component here. Please make sure the ${K(i)} component has the \`standalone: true\` flag in the decorator.`)}(e);const r=function zU(i=[]){if(ia)return ia;const e=function m1(i=[],e){return $a.create({name:e,providers:[{provide:xy,useValue:"platform"},{provide:Nv,useValue:new Set([()=>ia=null])},...i]})}(i);return ia=e,function p1(i){const e=i.get(o1,null);e&&e.forEach(t=>t())}(e),e}(n),s=function y1(i,e){let t;return t="noop"===i?new OU:("zone.js"===i?void 0:i)||new Fi(e),t}("zone.js",function _1(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}());return s.run(()=>{const a=dv([{provide:Fi,useValue:s},...t||[]],r,"Environment Injector"),c=a.get(gl,null);if(So&&!c)throw new W(402,"No `ErrorHandler` found in the Dependency Injection tree.");let l;s.runOutsideAngular(()=>{l=s.onError.subscribe({next:d=>{c.handleError(d)}})});const u=()=>a.destroy(),f=r.get(Nv);return f.add(u),a.onDestroy(()=>{l.unsubscribe(),f.delete(u)}),function v1(i,e,t){try{const n=t();return Xy(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(c,s,()=>{const d=a.get(Hp);return d.runInitializers(),d.donePromise.then(()=>{!function WT(i){_i(i,"Expected localeId to be defined"),"string"==typeof i&&(GT=i.toLowerCase().replace(/_/g,"-"))}(a.get(Mo,Rl)||Rl);const m=a.get(kv);return void 0!==e&&m.bootstrap(e),m})})})}let kv=(()=>{class i{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,n,r){this._zone=t,this._injector=n,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new gn(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new gn(a=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{Fi.assertNotInAngularZone(),function Av(i){typeof Zone>"u"?AU.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const l=this._zone.onUnstable.subscribe(()=>{Fi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{c.unsubscribe(),l.unsubscribe()}});this.isStable=At(s,o.pipe(st()))}bootstrap(t,n){So&&this.warnIfDestroyed();const r=t instanceof KS;if(!this._injector.get(Hp).done){const h="Cannot bootstrap as there are still asynchronous initializers running."+(!r&&function cf(i){const e=un(i)||zi(i)||hr(i);return null!==e&&e.standalone}(t)?"":" Bootstrap components in the `ngDoBootstrap` method of the root module.");throw new W(405,So&&h)}let o;o=r?t:this._injector.get(gp).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function BU(i){return i.isBoundToModule}(o)?void 0:this._injector.get(Ll),l=o.create($a.NULL,[],n||o.selector,a),u=l.location.nativeElement,f=l.injector.get(d1,null);return f?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),Wp(this.components,l),f?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){if(So&&this.warnIfDestroyed(),this._runningTick)throw new W(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){So&&this.warnIfDestroyed();const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){So&&this.warnIfDestroyed();const n=t;Wp(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const n=this._injector.get(FU,[]);n.push(...this._bootstrapListeners),n.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return So&&this.warnIfDestroyed(),this._destroyListeners.push(t),()=>Wp(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new W(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){So&&this._destroyed&&console.warn(Ce(406,"This instance of the `ApplicationRef` has already been destroyed."))}}return i.\u0275fac=function(t){return new(t||i)(ln(Fi),ln(Wa),ln(gl))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Wp(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let Eo=(()=>{class i{}return i.__NG_ELEMENT_ID__=WU,i})();function WU(i){return function jU(i,e,t){if(df(i)&&!t){const n=pr(i.index,e);return new If(n,n)}return 47&i.type?new If(e[Hi],e):null}(Ni(),he(),16==(16&i))}class M1{constructor(e){this.nativeNode=e}get parent(){const e=this.nativeNode.parentNode;return e?new jp(e):null}get injector(){return function vD(i){const e=gr(i),t=e?e.lView:null;return null===t?$a.NULL:new sl(t[Be].data[e.nodeIndex],t)}(this.nativeNode)}get componentInstance(){const e=this.nativeNode;return e&&(hv(e)||function _D(i){const e=gr(i);let n,t=e?e.lView:null;if(null===t)return null;for(;2===t[Be].type&&(n=Sf(t));)t=n;return 256&t[Pt]?null:t[ti]}(e))}get context(){return hv(this.nativeNode)||function gD(i){!function PB(i){if(typeof Element<"u"&&!(i instanceof Element))throw new Error("Expecting instance of DOM Element")}(i);const e=gr(i),t=e?e.lView:null;return null===t?null:t[ti]}(this.nativeNode)}get listeners(){return function bD(i){const e=gr(i),t=null===e?null:e.lView;if(null===t)return[];const r=t[Jc],s=t[Be].cleanup,o=[];if(s&&r)for(let a=0;a<s.length;){const c=s[a++],l=s[a++];if("string"==typeof c){const u=c,f=Oi(t[l]),d=r[s[a++]],h=s[a++];i==f&&o.push({element:i,name:u,callback:d,useCapture:"boolean"==typeof h&&h,type:"boolean"==typeof h||h>=0?"dom":"output"})}}return o.sort(AB),o}(this.nativeNode).filter(e=>"dom"===e.type)}get references(){return function CB(i){const e=gr(i);if(null===e)return{};if(void 0===e.localRefs){const t=e.lView;if(null===t)return{};e.localRefs=function LN(i,e){const t=i[Be].data[e];if(t&&t.localNames){const n={};let r=t.index+1;for(let s=0;s<t.localNames.length;s+=2)n[t.localNames[s]]=i[r],r++;return n}return null}(t,e.nodeIndex)}return e.localRefs||{}}(this.nativeNode)}get providerTokens(){return function EB(i){const e=gr(i),t=e?e.lView:null;if(null===t)return[];const n=t[Be],r=n.data[e.nodeIndex],s=[],a=r.directiveEnd;for(let c=1048575&r.providerIndexes;c<a;c++){let l=n.data[c];IB(l)&&(l=l.type),s.push(l)}return s}(this.nativeNode)}}class jp extends M1{constructor(e){super(e)}get nativeElement(){return this.nativeNode.nodeType==Node.ELEMENT_NODE?this.nativeNode:null}get name(){const e=gr(this.nativeNode),t=e?e.lView:null;return null!==t?t[Be].data[e.nodeIndex].value:this.nativeNode.nodeName}get properties(){const e=gr(this.nativeNode),t=e?e.lView:null;if(null===t)return{};const n=t[Be].data,r=n[e.nodeIndex],s={};return function $U(i,e){if(i){let t=Object.getPrototypeOf(i);const n=Node.prototype;for(;null!==t&&t!==n;){const r=Object.getOwnPropertyDescriptors(t);for(let s in r)if(!s.startsWith("__")&&!s.startsWith("on")){const o=i[s];qU(o)&&(e[s]=o)}t=Object.getPrototypeOf(t)}}}(this.nativeElement,s),function XU(i,e,t,n){let r=e.propertyBindings;if(null!==r)for(let s=0;s<r.length;s++){const o=r[s],c=n[o].split("\ufffd"),l=c[0];if(c.length>1){let u=c[1];for(let f=1;f<c.length-1;f++)u+=re(t[o+f-1])+c[f+1];i[l]=u}else i[l]=t[o]}}(s,r,t,n),s}get attributes(){const e={},t=this.nativeElement;if(!t)return e;const n=gr(t),r=n?n.lView:null;if(null===r)return{};const s=r[Be].data[n.nodeIndex].attrs,o=[];if(s){let c=0;for(;c<s.length;){const l=s[c];if("string"!=typeof l)break;e[l]=s[c+1],o.push(l.toLowerCase()),c+=2}}const a=t.attributes;for(let c=0;c<a.length;c++){const l=a[c],u=l.name.toLowerCase();-1===o.indexOf(u)&&(e[u]=l.value)}return e}get styles(){return this.nativeElement&&this.nativeElement.style?this.nativeElement.style:{}}get classes(){const e={},n=this.nativeElement.className;return("string"!=typeof n?n.baseVal.split(" "):n.split(" ")).forEach(s=>e[s]=!0),e}get childNodes(){const e=this.nativeNode.childNodes,t=[];for(let n=0;n<e.length;n++)t.push(Fl(e[n]));return t}get children(){const e=this.nativeElement;if(!e)return[];const t=e.children,n=[];for(let r=0;r<t.length;r++)n.push(Fl(t[r]));return n}query(e){return this.queryAll(e)[0]||null}queryAll(e){const t=[];return S1(this,e,t,!0),t}queryAllNodes(e){const t=[];return S1(this,e,t,!1),t}triggerEventHandler(e,t){const n=this.nativeNode,r=[];this.listeners.forEach(s=>{if(s.name===e){const o=s.callback;o.call(n,t),r.push(o)}}),"function"==typeof n.eventListeners&&n.eventListeners(e).forEach(s=>{if(-1!==s.toString().indexOf("__ngUnwrap__")){const o=s("__ngUnwrap__");return-1===r.indexOf(o)&&o.call(n,t)}})}}function qU(i){return"string"==typeof i||"boolean"==typeof i||"number"==typeof i||null===i}function S1(i,e,t,n){const r=gr(i.nativeNode),s=r?r.lView:null;null!==s?Ya(s[Be].data[r.nodeIndex],s,e,t,n,i.nativeNode):Uv(i.nativeNode,e,t,n)}function Ya(i,e,t,n,r,s){const o=function xO(i,e){const t=null===i?-1:i.index;return-1!==t?Oi(e[t]):null}(i,e);if(11&i.type){if(Bv(o,t,n,r,s),df(i)){const c=pr(i.index,e);c&&c[Be].firstChild&&Ya(c[Be].firstChild,c,t,n,r,s)}else i.child&&Ya(i.child,e,t,n,r,s),o&&Uv(o,t,n,r);const a=e[i.index];vs(a)&&E1(a,t,n,r,s)}else if(4&i.type){const a=e[i.index];Bv(a[Gh],t,n,r,s),E1(a,t,n,r,s)}else if(16&i.type){const a=e[Hi],l=a[Vi].projection[i.projection];if(Array.isArray(l))for(let u of l)Bv(u,t,n,r,s);else if(l){const u=a[Xn];Ya(u[Be].data[l.index],u,t,n,r,s)}}else i.child&&Ya(i.child,e,t,n,r,s);if(s!==o){const a=2&i.flags?i.projectionNext:i.next;a&&Ya(a,e,t,n,r,s)}}function E1(i,e,t,n,r){for(let s=Qi;s<i.length;s++){const o=i[s],a=o[Be].firstChild;a&&Ya(a,o,e,t,n,r)}}function Bv(i,e,t,n,r){if(r!==i){const s=Fl(i);if(!s)return;(n&&s instanceof jp&&e(s)&&-1===t.indexOf(s)||!n&&e(s)&&-1===t.indexOf(s))&&t.push(s)}}function Uv(i,e,t,n){const r=i.childNodes,s=r.length;for(let o=0;o<s;o++){const a=r[o],c=Fl(a);c&&((n&&c instanceof jp&&e(c)&&-1===t.indexOf(c)||!n&&e(c)&&-1===t.indexOf(c))&&t.push(c),Uv(a,e,t,n))}}const Vv="__ng_debug__";function Fl(i){return i instanceof Node?(i.hasOwnProperty(Vv)||(i[Vv]=i.nodeType==Node.ELEMENT_NODE?new jp(i):new M1(i)),i[Vv]):null}let Hv=null;function qp(){return Hv}class sz{}const Jr=new Et("DocumentToken");let j1=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new Yz,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){$1("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){$1("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(xt(rr),xt(Ss))},i.\u0275dir=Li({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class Yz{constructor(){this.$implicit=null,this.ngIf=null}}function $1(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${ot(e)}'.`)}class JV extends sz{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class o0 extends JV{static makeCurrent(){!function rz(i){Hv||(Hv=i)}(new o0)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function QV(){return Kf=Kf||document.querySelector("base"),Kf?Kf.getAttribute("href"):null}();return null==t?null:function eH(i){sm=sm||document.createElement("a"),sm.setAttribute("href",i);const e=sm.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Kf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Wz(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let sm,Kf=null,rH=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();const om=new Et("EventManagerPlugins");let am=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(ln(om),ln(Fi))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();class tC{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=qp().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let nC=(()=>{class i{constructor(){this.usageCount=new Map}addStyles(t){for(const n of t)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(t){for(const n of t)0===this.changeUsageCount(n,-1)&&this.onStyleRemoved(n)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,n){const r=this.usageCount;let s=r.get(t)??0;return s+=n,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})(),Jf=(()=>{class i extends nC{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){const n=this.styleRef;n.get(t)?.forEach(s=>s.remove()),n.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,n){const r=this.doc.createElement("style");r.textContent=n,t.appendChild(r);const s=this.styleRef.get(n);s?s.push(r):this.styleRef.set(n,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return i.\u0275fac=function(t){return new(t||i)(ln(Jr))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();const a0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},c0=/%COMP%/g,sC=new Et("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function oC(i,e){return e.flat(100).map(t=>t.replace(c0,i))}function aC(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let l0=(()=>{class i{constructor(t,n,r,s){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new u0(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,n);return r instanceof uC?r.applyToHost(t):r instanceof f0&&r.applyStyles(),r}getOrCreateRenderer(t,n){const r=this.rendererByCompId;let s=r.get(n.id);if(!s){const o=this.eventManager,a=this.sharedStylesHost,c=this.removeStylesOnCompDestory;switch(n.encapsulation){case Ws.Emulated:s=new uC(o,a,n,this.appId,c);break;case Ws.ShadowDom:return new fH(o,a,t,n);default:s=new f0(o,a,n,c)}s.onDestroy=()=>r.delete(n.id),r.set(n.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(ln(am),ln(Jf),ln(Dv),ln(sC))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();class u0{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(a0[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(lC(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(lC(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=a0[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=a0[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(mr.DashCase|mr.Important)?e.style.setProperty(t,n,r&mr.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&mr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,aC(n)):this.eventManager.addEventListener(e,t,aC(n))}}function lC(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class fH extends u0{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=oC(r.id,r.styles);for(const o of s){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class f0 extends u0{constructor(e,t,n,r,s=n.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=oC(s,n.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class uC extends f0{constructor(e,t,n,r,s){const o=r+"-"+n.id;super(e,t,n,s,o),this.contentAttr=function cH(i){return"_ngcontent-%COMP%".replace(c0,i)}(o),this.hostAttr=function lH(i){return"_nghost-%COMP%".replace(c0,i)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let dH=(()=>{class i extends tC{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(ln(Jr))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();const fC=["alt","control","meta","shift"],hH={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},pH={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let mH=(()=>{class i extends tC{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>qp().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),fC.forEach(l=>{const u=n.indexOf(l);u>-1&&(n.splice(u,1),o+=l+".")}),o+=s,0!=n.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,n){let r=hH[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),fC.forEach(o=>{o!==r&&(0,pH[o])(t)&&(s+=o+".")}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(ln(Jr))},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();function hC(i){return{appProviders:[...MH,...i?.providers??[]],platformProviders:xH}}const xH=[{provide:a1,useValue:"browser"},{provide:o1,useValue:function _H(){o0.makeCurrent()},multi:!0},{provide:Jr,useFactory:function vH(){return function t2(i){fy=i}(document),document},deps:[]}],MH=[{provide:xy,useValue:"root"},{provide:gl,useFactory:function yH(){return new gl},deps:[]},{provide:om,useClass:dH,multi:!0,deps:[Jr,Fi,a1]},{provide:om,useClass:mH,multi:!0,deps:[Jr]},{provide:l0,useClass:l0,deps:[am,Jf,Dv,sC]},{provide:_p,useExisting:l0},{provide:nC,useExisting:Jf},{provide:Jf,useClass:Jf,deps:[Jr]},{provide:am,useClass:am,deps:[om,Fi]},{provide:class EV{},useClass:rH,deps:[]},[]];typeof window<"u"&&window;const h0={now:()=>(h0.delegate||Date).now(),delegate:void 0};class kl extends fr{constructor(e=1/0,t=1/0,n=h0){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const o=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}}class PH extends kn{constructor(e,t){super()}schedule(e,t=0){return this}}const cm={setInterval(i,e,...t){const{delegate:n}=cm;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=cm;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};class gC extends PH{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return cm.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&cm.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,n=!1;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Vs(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}class Qf{constructor(e,t=Qf.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Qf.now=h0.now;class _C extends Qf{constructor(e,t=Qf.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const yC=new _C(gC),RH=yC;function vC(i,e=yC){return Tn((t,n)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const l=s;s=null,n.next(l)}};function c(){const l=o+i,u=e.now();if(u<l)return r=this.schedule(void 0,l-u),void n.add(r);a()}t.subscribe(vn(n,l=>{s=l,o=e.now(),r||(r=e.schedule(c,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function lm(i){return Tn((e,t)=>{Ti(i).subscribe(vn(t,()=>t.complete(),Ki)),!t.closed&&e.subscribe(t)})}const{isArray:LH}=Array;function p0(i){return Dn(e=>function OH(i,e){return LH(e)?i(...e):i(e)}(i,e))}const NH=["addListener","removeListener"],FH=["addEventListener","removeEventListener"],kH=["on","off"];function ed(i,e,t,n){if(Mt(t)&&(n=t,t=void 0),n)return ed(i,e,t).pipe(p0(n));const[r,s]=function zH(i){return Mt(i.addEventListener)&&Mt(i.removeEventListener)}(i)?FH.map(o=>a=>i[o](e,a,t)):function BH(i){return Mt(i.addListener)&&Mt(i.removeListener)}(i)?NH.map(xC(i,e)):function UH(i){return Mt(i.on)&&Mt(i.off)}(i)?kH.map(xC(i,e)):[];if(!r&&Ju(i))return He(o=>ed(o,e,t))(Ti(i));if(!r)throw new TypeError("Invalid event target");return new gn(o=>{const a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function xC(i,e){return t=>n=>i[t](e,n)}const bC={box:"content-box",scroll:!1,offsetSize:!1,debounce:{scroll:50,resize:0},emitInZone:!0,emitInitialResult:!1},m0=new Et("NgxResizeOptions",{factory:()=>bC});function VH(i={}){return{provide:m0,useValue:{...bC,...i}}}let HH=(()=>{class i{constructor(t,n,r,s){this.host=t,this.zone=n,this.document=r,this.resizeOptions=s,this.ngxResizeOptions={},this.ngxResize=new ir}ngOnInit(){const t={...this.resizeOptions,...this.ngxResizeOptions};this.sub=function wC({debounce:i,scroll:e,offsetSize:t,box:n,emitInZone:r,emitInitialResult:s},o,a,c){const l=a.defaultView,u=!!l?.ResizeObserver;let f,d,h=[];const m=new kl,p=SC(o,l,a.body),g=i?"number"==typeof i?i:i.scroll:null,y=i?"number"==typeof i?i:i.resize:null,v=_=>function Mh(...i){return ur(i)}(vC(_??0),lm(m));return new gn(_=>{if(u){if(s){const[x]=MC(o,l,t,[]);_.next(x)}return c.runOutsideAngular(()=>{const x=M=>{h=M;const[E,b]=MC(o,l,t,M);r?c.run(()=>{_.next(E)}):_.next(E),WH(d||{},b)||(d=b)},w=()=>{x(h)};f=new ResizeObserver(x),f.observe(o,{box:n}),e&&(p&&p.forEach(M=>{ed(M,"scroll",{capture:!0,passive:!0}).pipe(v(g)).subscribe(w)}),ed(l,"scroll",{capture:!0,passive:!0}).pipe(v(g)).subscribe(w)),ed(l,"resize").pipe(v(y)).subscribe(w)}),()=>{f&&(f.unobserve(o),f.disconnect()),m.next(),m.complete()}}_.error("[ngx-resize] your browser does not support ResizeObserver. Please consider using a polyfill")}).pipe(vC(g??0),st({connector:()=>new kl(1)}))}(t,this.host.nativeElement,this.document,this.zone).subscribe(this.ngxResize)}ngOnDestroy(){this.sub?.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(xt(Xs),xt(Fi),xt(Jr),xt(m0))},i.\u0275dir=Li({type:i,selectors:[["","ngxResize",""]],inputs:{ngxResizeOptions:"ngxResizeOptions"},outputs:{ngxResize:"ngxResize"},standalone:!0}),i})();function MC(i,e,t,n){const{left:r,top:s,width:o,height:a,bottom:c,right:l,x:u,y:f}=i.getBoundingClientRect(),d={left:r,top:s,width:o,height:a,bottom:c,right:l,x:u,y:f};return i instanceof HTMLElement&&t&&(d.height=i.offsetHeight,d.width=i.offsetWidth),Object.freeze(d),[{entries:n,dpr:e.devicePixelRatio,...d},d]}function SC(i,e,t){const n=[];if(!i||!e||i===t)return n;const{overflow:r,overflowX:s,overflowY:o}=e.getComputedStyle(i);return[r,s,o].some(a=>"auto"===a||"scroll"===a)&&n.push(i),[...n,...SC(i.parentElement,e,t)]}const GH=["x","y","top","bottom","left","right","width","height"],WH=(i,e)=>GH.every(t=>i[t]===e[t]);function Ka(i){return!!i&&(i instanceof gn||Mt(i.lift)&&Mt(i.subscribe))}function g0(...i){return et(i,Gt(i))}function td(i,e,t){const n=Mt(i)||e||t?{next:i,error:e,complete:t}:i;return n?Tn((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(vn(s,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),s.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),s.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),s.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):ms}function um(i){return Tn((e,t)=>{let s,n=null,r=!1;n=e.subscribe(vn(t,void 0,void 0,o=>{s=Ti(i(o,um(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function EC(i,e){return Tn((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(vn(n,c=>{r?.unsubscribe();let l=0;const u=s++;Ti(i(c,u)).subscribe(r=vn(n,f=>n.next(e?e(c,f,u,l++):f),()=>{r=null,a()}))},()=>{o=!0,a()}))})}const{isArray:XH}=Array,{getPrototypeOf:ZH,prototype:YH,keys:KH}=Object;function TC(i){if(1===i.length){const e=i[0];if(XH(e))return{args:e,keys:null};if(function JH(i){return i&&"object"==typeof i&&ZH(i)===YH}(e)){const t=KH(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function DC(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}class fm extends fr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function CC(i,e,t){i?we(t,i,e):e()}function AC(...i){return function iG(){return Ie(1)}()(et(i,Gt(i)))}function IC(...i){const e=Gt(i);return Tn((t,n)=>{(e?AC(i,t,e):AC(i,t)).subscribe(n)})}function Bl(i,e=ms){return i=i??rG,Tn((t,n)=>{let r,s=!0;t.subscribe(vn(n,o=>{const a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function rG(i,e){return i===e}function Ul(i,e){return Tn((t,n)=>{let r=0;t.subscribe(vn(n,s=>i.call(e,s,r++)&&n.next(s)))})}function PC(i,e,t,n,r,s,o){try{var a=i[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,r)}function nd(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(c){PC(s,n,r,o,a,"next",c)}function a(c){PC(s,n,r,o,a,"throw",c)}o(void 0)})}}const dm="149",Ja={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Qa={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},RC=0,_0=1,LC=2,sG=3,oG=0,y0=1,v0=2,zl=3,Qs=0,yr=1,eo=2,aG=2,Do=0,ec=1,x0=2,b0=3,w0=4,OC=5,tc=100,NC=101,FC=102,M0=103,S0=104,kC=200,BC=201,UC=202,zC=203,E0=204,T0=205,VC=206,HC=207,GC=208,WC=209,jC=210,$C=0,qC=1,XC=2,hm=3,ZC=4,YC=5,KC=6,JC=7,id=0,QC=1,eA=2,Cs=0,tA=1,nA=2,iA=3,D0=4,rA=5,pm=300,sa=301,oa=302,rd=303,sd=304,Vl=306,aa=1e3,ki=1001,Hl=1002,Yn=1003,od=1004,cG=1004,Gl=1005,lG=1005,Hn=1006,mm=1007,uG=1007,to=1008,fG=1008,ca=1009,sA=1010,oA=1011,C0=1012,aA=1013,la=1014,Co=1015,Wl=1016,cA=1017,lA=1018,nc=1020,uA=1021,Ir=1023,fA=1024,dA=1025,ua=1026,ic=1027,hA=1028,pA=1029,mA=1030,gA=1031,_A=1033,gm=33776,_m=33777,ym=33778,vm=33779,A0=35840,I0=35841,P0=35842,R0=35843,yA=36196,L0=37492,O0=37496,N0=37808,F0=37809,k0=37810,B0=37811,U0=37812,z0=37813,V0=37814,H0=37815,G0=37816,W0=37817,j0=37818,$0=37819,q0=37820,X0=37821,xm=36492,vA=36283,Z0=36284,Y0=36285,K0=36286,xA=2200,bA=2201,wA=2202,jl=2300,rc=2301,bm=2302,sc=2400,oc=2401,ad=2402,wm=2500,J0=2501,MA=0,Q0=1,Mm=2,Ao=3e3,rn=3001,SA=3200,EA=3201,fa=0,TA=1,dG="",As="srgb",$l="srgb-linear",hG=0,Sm=7680,pG=7681,mG=7682,gG=7683,_G=34055,yG=34056,vG=5386,xG=512,bG=513,wG=514,MG=515,SG=516,EG=517,TG=518,DA=519,cd=35044,DG=35048,CG=35040,AG=35045,IG=35049,PG=35041,RG=35046,LG=35050,OG=35042,NG="100",ex="300 es",Em=1035;class no{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const ji=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let CA=1234567;const ac=Math.PI/180,ld=180/Math.PI;function Pr(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(ji[255&i]+ji[i>>8&255]+ji[i>>16&255]+ji[i>>24&255]+"-"+ji[255&e]+ji[e>>8&255]+"-"+ji[e>>16&15|64]+ji[e>>24&255]+"-"+ji[63&t|128]+ji[t>>8&255]+"-"+ji[t>>16&255]+ji[t>>24&255]+ji[255&n]+ji[n>>8&255]+ji[n>>16&255]+ji[n>>24&255]).toLowerCase()}function ri(i,e,t){return Math.max(e,Math.min(t,i))}function tx(i,e){return(i%e+e)%e}function ud(i,e,t){return(1-t)*i+t*e}function nx(i){return 0==(i&i-1)&&0!==i}function AA(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Tm(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Io(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function bn(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}}var ix=Object.freeze({__proto__:null,DEG2RAD:ac,RAD2DEG:ld,ceilPowerOfTwo:AA,clamp:ri,damp:function BG(i,e,t,n){return ud(i,e,1-Math.exp(-t*n))},degToRad:function $G(i){return i*ac},denormalize:Io,euclideanModulo:tx,floorPowerOfTwo:Tm,generateUUID:Pr,inverseLerp:function kG(i,e,t){return i!==e?(t-i)/(e-i):0},isPowerOfTwo:nx,lerp:ud,mapLinear:function FG(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},normalize:bn,pingpong:function UG(i,e=1){return e-Math.abs(tx(i,2*e)-e)},radToDeg:function qG(i){return i*ld},randFloat:function GG(i,e){return i+Math.random()*(e-i)},randFloatSpread:function WG(i){return i*(.5-Math.random())},randInt:function HG(i,e){return i+Math.floor(Math.random()*(e-i+1))},seededRandom:function jG(i){void 0!==i&&(CA=i);let e=CA+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},setQuaternionFromProperEuler:function XG(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),l=s((e+n)/2),u=o((e+n)/2),f=s((e-n)/2),d=o((e-n)/2),h=s((n-e)/2),m=o((n-e)/2);switch(r){case"XYX":i.set(a*u,c*f,c*d,a*l);break;case"YZY":i.set(c*d,a*u,c*f,a*l);break;case"ZXZ":i.set(c*f,c*d,a*u,a*l);break;case"XZX":i.set(a*u,c*m,c*h,a*l);break;case"YXY":i.set(c*h,a*u,c*m,a*l);break;case"ZYZ":i.set(c*m,c*h,a*u,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},smootherstep:function VG(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},smoothstep:function zG(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)}});class oe{constructor(e=0,t=0){oe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class or{constructor(){or.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=n,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],c=n[6],l=n[1],u=n[4],f=n[7],d=n[2],h=n[5],m=n[8],p=r[0],g=r[3],y=r[6],v=r[1],_=r[4],x=r[7],w=r[2],M=r[5],E=r[8];return s[0]=o*p+a*v+c*w,s[3]=o*g+a*_+c*M,s[6]=o*y+a*x+c*E,s[1]=l*p+u*v+f*w,s[4]=l*g+u*_+f*M,s[7]=l*y+u*x+f*E,s[2]=d*p+h*v+m*w,s[5]=d*g+h*_+m*M,s[8]=d*y+h*x+m*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-n*s*u+n*a*c+r*s*l-r*o*c}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],f=u*o-a*l,d=a*c-u*s,h=l*s-o*c,m=t*f+n*d+r*h;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return e[0]=f*p,e[1]=(r*l-u*n)*p,e[2]=(a*n-r*o)*p,e[3]=d*p,e[4]=(u*t-r*c)*p,e[5]=(r*s-a*t)*p,e[6]=h*p,e[7]=(n*c-l*t)*p,e[8]=(o*t-n*s)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(n*c,n*l,-n*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(rx.makeScale(e,t)),this}rotate(e){return this.premultiply(rx.makeRotation(-e)),this}translate(e,t){return this.premultiply(rx.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const rx=new or;function IA(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const ZG={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ql(i,e){return new ZG[i](e)}function fd(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function cc(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function Dm(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const sx={[As]:{[$l]:cc},[$l]:{[As]:Dm}},fi={legacyMode:!0,get workingColorSpace(){return $l},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(sx[e]&&void 0!==sx[e][t]){const n=sx[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},PA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},bi={r:0,g:0,b:0},Is={h:0,s:0,l:0},Cm={h:0,s:0,l:0};function ox(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function Am(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let Xl,Re=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=As){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,fi.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=fi.workingColorSpace){return this.r=t,this.g=n,this.b=r,fi.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=fi.workingColorSpace){if(t=tx(t,1),n=ri(n,0,1),r=ri(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=ox(a,o,t+1/3),this.g=ox(a,o,t),this.b=ox(a,o,t-1/3)}return fi.toWorkingColorSpace(this,s),this}setStyle(t,n=As){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const c=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,fi.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,fi.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c)){const l=parseFloat(o[1])/360,u=parseFloat(o[2])/100,f=parseFloat(o[3])/100;return r(o[4]),this.setHSL(l,u,f,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,fi.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,fi.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=As){const r=PA[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=cc(t.r),this.g=cc(t.g),this.b=cc(t.b),this}copyLinearToSRGB(t){return this.r=Dm(t.r),this.g=Dm(t.g),this.b=Dm(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=As){return fi.fromWorkingColorSpace(Am(this,bi),t),ri(255*bi.r,0,255)<<16^ri(255*bi.g,0,255)<<8^ri(255*bi.b,0,255)<<0}getHexString(t=As){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=fi.workingColorSpace){fi.fromWorkingColorSpace(Am(this,bi),n);const r=bi.r,s=bi.g,o=bi.b,a=Math.max(r,s,o),c=Math.min(r,s,o);let l,u;const f=(c+a)/2;if(c===a)l=0,u=0;else{const d=a-c;switch(u=f<=.5?d/(a+c):d/(2-a-c),a){case r:l=(s-o)/d+(s<o?6:0);break;case s:l=(o-r)/d+2;break;case o:l=(r-s)/d+4}l/=6}return t.h=l,t.s=u,t.l=f,t}getRGB(t,n=fi.workingColorSpace){return fi.fromWorkingColorSpace(Am(this,bi),n),t.r=bi.r,t.g=bi.g,t.b=bi.b,t}getStyle(t=As){return fi.fromWorkingColorSpace(Am(this,bi),t),t!==As?`color(${t} ${bi.r} ${bi.g} ${bi.b})`:`rgb(${255*bi.r|0},${255*bi.g|0},${255*bi.b|0})`}offsetHSL(t,n,r){return this.getHSL(Is),Is.h+=t,Is.s+=n,Is.l+=r,this.setHSL(Is.h,Is.s,Is.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(Is),t.getHSL(Cm);const r=ud(Is.h,Cm.h,n),s=ud(Is.s,Cm.s,n),o=ud(Is.l,Cm.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=PA,i})();class ax{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Xl&&(Xl=fd("canvas")),Xl.width=e.width,Xl.height=e.height;const n=Xl.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Xl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=fd("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*cc(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*cc(t[n]/255)):cc(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class lc{constructor(e=null){this.isSource=!0,this.uuid=Pr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(cx(r[o].isDataTexture?r[o].image:r[o]))}else s=cx(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function cx(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?ax.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let YG=0,Bi=(()=>{class i extends no{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=ki,s=ki,o=Hn,a=to,c=Ir,l=ca,u=i.DEFAULT_ANISOTROPY,f=Ao){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:YG++}),this.uuid=Pr(),this.name="",this.source=new lc(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new oe(0,0),this.repeat=new oe(1,1),this.center=new oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new or,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==pm)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case aa:t.x=t.x-Math.floor(t.x);break;case ki:t.x=t.x<0?0:1;break;case Hl:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case aa:t.y=t.y-Math.floor(t.y);break;case ki:t.y=t.y<0?0:1;break;case Hl:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=pm,i.DEFAULT_ANISOTROPY=1,i})();class mn{constructor(e=0,t=0,n=0,r=1){mn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const c=e.elements,l=c[0],u=c[4],f=c[8],d=c[1],h=c[5],m=c[9],p=c[2],g=c[6],y=c[10];if(Math.abs(u-d)<.01&&Math.abs(f-p)<.01&&Math.abs(m-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(f+p)<.1&&Math.abs(m+g)<.1&&Math.abs(l+h+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const _=(l+1)/2,x=(h+1)/2,w=(y+1)/2,M=(u+d)/4,E=(f+p)/4,b=(m+g)/4;return _>x&&_>w?_<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(_),r=M/n,s=E/n):x>w?x<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),n=M/r,s=b/r):w<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),n=E/s,r=b/s),this.set(n,r,s,t),this}let v=Math.sqrt((g-m)*(g-m)+(f-p)*(f-p)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(g-m)/v,this.y=(f-p)/v,this.z=(d-u)/v,this.w=Math.acos((l+h+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ps extends no{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new mn(0,0,e,t),this.scissorTest=!1,this.viewport=new mn(0,0,e,t),this.texture=new Bi({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Hn,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new lc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Im extends Bi{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Yn,this.minFilter=Yn,this.wrapR=ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class KG extends Ps{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Im(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class lx extends Bi{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Yn,this.minFilter=Yn,this.wrapR=ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class JG extends Ps{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new lx(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class QG extends Ps{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Ci{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let c=n[r+0],l=n[r+1],u=n[r+2],f=n[r+3];const d=s[o+0],h=s[o+1],m=s[o+2],p=s[o+3];if(0===a)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=f);if(1===a)return e[t+0]=d,e[t+1]=h,e[t+2]=m,void(e[t+3]=p);if(f!==p||c!==d||l!==h||u!==m){let g=1-a;const y=c*d+l*h+u*m+f*p,v=y>=0?1:-1,_=1-y*y;if(_>Number.EPSILON){const w=Math.sqrt(_),M=Math.atan2(w,y*v);g=Math.sin(g*M)/w,a=Math.sin(a*M)/w}const x=a*v;if(c=c*g+d*x,l=l*g+h*x,u=u*g+m*x,f=f*g+p*x,g===1-a){const w=1/Math.sqrt(c*c+l*l+u*u+f*f);c*=w,l*=w,u*=w,f*=w}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=f}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],c=n[r+1],l=n[r+2],u=n[r+3],f=s[o],d=s[o+1],h=s[o+2],m=s[o+3];return e[t]=a*m+u*f+c*h-l*d,e[t+1]=c*m+u*d+l*f-a*h,e[t+2]=l*m+u*h+a*d-c*f,e[t+3]=u*m-a*f-c*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(n/2),u=a(r/2),f=a(s/2),d=c(n/2),h=c(r/2),m=c(s/2);switch(o){case"XYZ":this._x=d*u*f+l*h*m,this._y=l*h*f-d*u*m,this._z=l*u*m+d*h*f,this._w=l*u*f-d*h*m;break;case"YXZ":this._x=d*u*f+l*h*m,this._y=l*h*f-d*u*m,this._z=l*u*m-d*h*f,this._w=l*u*f+d*h*m;break;case"ZXY":this._x=d*u*f-l*h*m,this._y=l*h*f+d*u*m,this._z=l*u*m+d*h*f,this._w=l*u*f-d*h*m;break;case"ZYX":this._x=d*u*f-l*h*m,this._y=l*h*f+d*u*m,this._z=l*u*m-d*h*f,this._w=l*u*f+d*h*m;break;case"YZX":this._x=d*u*f+l*h*m,this._y=l*h*f+d*u*m,this._z=l*u*m-d*h*f,this._w=l*u*f-d*h*m;break;case"XZY":this._x=d*u*f-l*h*m,this._y=l*h*f-d*u*m,this._z=l*u*m+d*h*f,this._w=l*u*f+d*h*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],f=t[10],d=n+a+f;if(d>0){const h=.5/Math.sqrt(d+1);this._w=.25/h,this._x=(u-c)*h,this._y=(s-l)*h,this._z=(o-r)*h}else if(n>a&&n>f){const h=2*Math.sqrt(1+n-a-f);this._w=(u-c)/h,this._x=.25*h,this._y=(r+o)/h,this._z=(s+l)/h}else if(a>f){const h=2*Math.sqrt(1+a-n-f);this._w=(s-l)/h,this._x=(r+o)/h,this._y=.25*h,this._z=(c+u)/h}else{const h=2*Math.sqrt(1+f-n-a);this._w=(o-r)/h,this._x=(s+l)/h,this._y=(c+u)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ri(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=n*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-n*l,this._z=s*u+o*l+n*c-r*a,this._w=o*u-n*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const h=1-t;return this._w=h*o+t*this._w,this._x=h*n+t*this._x,this._y=h*r+t*this._y,this._z=h*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,a),f=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=o*f+this._w*d,this._x=n*f+this._x*d,this._y=r*f+this._y*d,this._z=s*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(e=0,t=0,n=0){D.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(RA.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(RA.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=c*t+o*r-a*n,u=c*n+a*t-s*r,f=c*r+s*n-o*t,d=-s*t-o*n-a*r;return this.x=l*c+d*-s+u*-a-f*-o,this.y=u*c+d*-o+f*-s-l*-a,this.z=f*c+d*-a+l*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-n*c,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ux.copy(this).projectOnVector(e),this.sub(ux)}reflect(e){return this.sub(ux.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ri(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ux=new D,RA=new Ci;class da{constructor(e=new D(1/0,1/0,1/0),t=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,l=e.length;c<l;c+=3){const u=e[c],f=e[c+1],d=e[c+2];u<t&&(t=u),f<n&&(n=f),d<r&&(r=d),u>s&&(s=u),f>o&&(o=f),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let c=0,l=e.count;c<l;c++){const u=e.getX(c),f=e.getY(c),d=e.getZ(c);u<t&&(t=u),f<n&&(n=f),d<r&&(r=d),u>s&&(s=u),f>o&&(o=f),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=uc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)uc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(uc)}else null===n.boundingBox&&n.computeBoundingBox(),fx.copy(n.boundingBox),fx.applyMatrix4(e.matrixWorld),this.union(fx);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,uc),uc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(dd),Pm.subVectors(this.max,dd),Zl.subVectors(e.a,dd),Yl.subVectors(e.b,dd),Kl.subVectors(e.c,dd),ha.subVectors(Yl,Zl),pa.subVectors(Kl,Yl),fc.subVectors(Zl,Kl);let t=[0,-ha.z,ha.y,0,-pa.z,pa.y,0,-fc.z,fc.y,ha.z,0,-ha.x,pa.z,0,-pa.x,fc.z,0,-fc.x,-ha.y,ha.x,0,-pa.y,pa.x,0,-fc.y,fc.x,0];return!(!dx(t,Zl,Yl,Kl,Pm)||(t=[1,0,0,0,1,0,0,0,1],!dx(t,Zl,Yl,Kl,Pm)))&&(Rm.crossVectors(ha,pa),t=[Rm.x,Rm.y,Rm.z],dx(t,Zl,Yl,Kl,Pm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return uc.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(uc).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Po[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Po[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Po[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Po[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Po[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Po[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Po[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Po[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Po)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Po=[new D,new D,new D,new D,new D,new D,new D,new D],uc=new D,fx=new da,Zl=new D,Yl=new D,Kl=new D,ha=new D,pa=new D,fc=new D,dd=new D,Pm=new D,Rm=new D,dc=new D;function dx(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){dc.fromArray(i,s);const a=r.x*Math.abs(dc.x)+r.y*Math.abs(dc.y)+r.z*Math.abs(dc.z),c=e.dot(dc),l=t.dot(dc),u=n.dot(dc);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const e4=new da,hd=new D,hx=new D;class ma{constructor(e=new D,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):e4.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;hd.subVectors(e,this.center);const t=hd.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(hd,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(hx.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(hd.copy(e.center).add(hx)),this.expandByPoint(hd.copy(e.center).sub(hx))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ro=new D,px=new D,Lm=new D,ga=new D,mx=new D,Om=new D,gx=new D;class pd{constructor(e=new D,t=new D(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ro)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ro.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ro.copy(this.direction).multiplyScalar(t).add(this.origin),Ro.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){px.copy(e).add(t).multiplyScalar(.5),Lm.copy(t).sub(e).normalize(),ga.copy(this.origin).sub(px);const s=.5*e.distanceTo(t),o=-this.direction.dot(Lm),a=ga.dot(this.direction),c=-ga.dot(Lm),l=ga.lengthSq(),u=Math.abs(1-o*o);let f,d,h,m;if(u>0)if(f=o*c-a,d=o*a-c,m=s*u,f>=0)if(d>=-m)if(d<=m){const p=1/u;f*=p,d*=p,h=f*(f+o*d+2*a)+d*(o*f+d+2*c)+l}else d=s,f=Math.max(0,-(o*d+a)),h=-f*f+d*(d+2*c)+l;else d=-s,f=Math.max(0,-(o*d+a)),h=-f*f+d*(d+2*c)+l;else d<=-m?(f=Math.max(0,-(-o*s+a)),d=f>0?-s:Math.min(Math.max(-s,-c),s),h=-f*f+d*(d+2*c)+l):d<=m?(f=0,d=Math.min(Math.max(-s,-c),s),h=d*(d+2*c)+l):(f=Math.max(0,-(o*s+a)),d=f>0?s:Math.min(Math.max(-s,-c),s),h=-f*f+d*(d+2*c)+l);else d=o>0?-s:s,f=Math.max(0,-(o*d+a)),h=-f*f+d*(d+2*c)+l;return n&&n.copy(this.direction).multiplyScalar(f).add(this.origin),r&&r.copy(Lm).multiplyScalar(d).add(px),h}intersectSphere(e,t){Ro.subVectors(e.center,this.origin);const n=Ro.dot(this.direction),r=Ro.dot(Ro)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,c=n+o;return a<0&&c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,c;const l=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),f>=0?(a=(e.min.z-d.z)*f,c=(e.max.z-d.z)*f):(a=(e.max.z-d.z)*f,c=(e.min.z-d.z)*f),n>c||a>r)||((a>n||n!=n)&&(n=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Ro)}intersectTriangle(e,t,n,r,s){mx.subVectors(t,e),Om.subVectors(n,e),gx.crossVectors(mx,Om);let a,o=this.direction.dot(gx);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ga.subVectors(this.origin,e);const c=a*this.direction.dot(Om.crossVectors(ga,Om));if(c<0)return null;const l=a*this.direction.dot(mx.cross(ga));if(l<0||c+l>o)return null;const u=-a*ga.dot(gx);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class gt{constructor(){gt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,s,o,a,c,l,u,f,d,h,m,p,g){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=c,y[2]=l,y[6]=u,y[10]=f,y[14]=d,y[3]=h,y[7]=m,y[11]=p,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new gt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Jl.setFromMatrixColumn(e,0).length(),s=1/Jl.setFromMatrixColumn(e,1).length(),o=1/Jl.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),f=Math.sin(s);if("XYZ"===e.order){const d=o*u,h=o*f,m=a*u,p=a*f;t[0]=c*u,t[4]=-c*f,t[8]=l,t[1]=h+m*l,t[5]=d-p*l,t[9]=-a*c,t[2]=p-d*l,t[6]=m+h*l,t[10]=o*c}else if("YXZ"===e.order){const d=c*u,h=c*f,m=l*u,p=l*f;t[0]=d+p*a,t[4]=m*a-h,t[8]=o*l,t[1]=o*f,t[5]=o*u,t[9]=-a,t[2]=h*a-m,t[6]=p+d*a,t[10]=o*c}else if("ZXY"===e.order){const d=c*u,h=c*f,m=l*u,p=l*f;t[0]=d-p*a,t[4]=-o*f,t[8]=m+h*a,t[1]=h+m*a,t[5]=o*u,t[9]=p-d*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if("ZYX"===e.order){const d=o*u,h=o*f,m=a*u,p=a*f;t[0]=c*u,t[4]=m*l-h,t[8]=d*l+p,t[1]=c*f,t[5]=p*l+d,t[9]=h*l-m,t[2]=-l,t[6]=a*c,t[10]=o*c}else if("YZX"===e.order){const d=o*c,h=o*l,m=a*c,p=a*l;t[0]=c*u,t[4]=p-d*f,t[8]=m*f+h,t[1]=f,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=h*f+m,t[10]=d-p*f}else if("XZY"===e.order){const d=o*c,h=o*l,m=a*c,p=a*l;t[0]=c*u,t[4]=-f,t[8]=l*u,t[1]=d*f+p,t[5]=o*u,t[9]=h*f-m,t[2]=m*f-h,t[6]=a*u,t[10]=p*f+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(t4,e,n4)}lookAt(e,t,n){const r=this.elements;return Rr.subVectors(e,t),0===Rr.lengthSq()&&(Rr.z=1),Rr.normalize(),_a.crossVectors(n,Rr),0===_a.lengthSq()&&(1===Math.abs(n.z)?Rr.x+=1e-4:Rr.z+=1e-4,Rr.normalize(),_a.crossVectors(n,Rr)),_a.normalize(),Nm.crossVectors(Rr,_a),r[0]=_a.x,r[4]=Nm.x,r[8]=Rr.x,r[1]=_a.y,r[5]=Nm.y,r[9]=Rr.y,r[2]=_a.z,r[6]=Nm.z,r[10]=Rr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],c=n[8],l=n[12],u=n[1],f=n[5],d=n[9],h=n[13],m=n[2],p=n[6],g=n[10],y=n[14],v=n[3],_=n[7],x=n[11],w=n[15],M=r[0],E=r[4],b=r[8],S=r[12],A=r[1],O=r[5],U=r[9],k=r[13],L=r[2],V=r[6],Z=r[10],ae=r[14],J=r[3],pe=r[7],de=r[11],Le=r[15];return s[0]=o*M+a*A+c*L+l*J,s[4]=o*E+a*O+c*V+l*pe,s[8]=o*b+a*U+c*Z+l*de,s[12]=o*S+a*k+c*ae+l*Le,s[1]=u*M+f*A+d*L+h*J,s[5]=u*E+f*O+d*V+h*pe,s[9]=u*b+f*U+d*Z+h*de,s[13]=u*S+f*k+d*ae+h*Le,s[2]=m*M+p*A+g*L+y*J,s[6]=m*E+p*O+g*V+y*pe,s[10]=m*b+p*U+g*Z+y*de,s[14]=m*S+p*k+g*ae+y*Le,s[3]=v*M+_*A+x*L+w*J,s[7]=v*E+_*O+x*V+w*pe,s[11]=v*b+_*U+x*Z+w*de,s[15]=v*S+_*k+x*ae+w*Le,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],f=e[6],d=e[10],h=e[14];return e[3]*(+s*c*f-r*l*f-s*a*d+n*l*d+r*a*h-n*c*h)+e[7]*(+t*c*h-t*l*d+s*o*d-r*o*h+r*l*u-s*c*u)+e[11]*(+t*l*f-t*a*h-s*o*f+n*o*h+s*a*u-n*l*u)+e[15]*(-r*a*u-t*c*f+t*a*d+r*o*f-n*o*d+n*c*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],f=e[9],d=e[10],h=e[11],m=e[12],p=e[13],g=e[14],y=e[15],v=f*g*l-p*d*l+p*c*h-a*g*h-f*c*y+a*d*y,_=m*d*l-u*g*l-m*c*h+o*g*h+u*c*y-o*d*y,x=u*p*l-m*f*l+m*a*h-o*p*h-u*a*y+o*f*y,w=m*f*c-u*p*c-m*a*d+o*p*d+u*a*g-o*f*g,M=t*v+n*_+r*x+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/M;return e[0]=v*E,e[1]=(p*d*s-f*g*s-p*r*h+n*g*h+f*r*y-n*d*y)*E,e[2]=(a*g*s-p*c*s+p*r*l-n*g*l-a*r*y+n*c*y)*E,e[3]=(f*c*s-a*d*s-f*r*l+n*d*l+a*r*h-n*c*h)*E,e[4]=_*E,e[5]=(u*g*s-m*d*s+m*r*h-t*g*h-u*r*y+t*d*y)*E,e[6]=(m*c*s-o*g*s-m*r*l+t*g*l+o*r*y-t*c*y)*E,e[7]=(o*d*s-u*c*s+u*r*l-t*d*l-o*r*h+t*c*h)*E,e[8]=x*E,e[9]=(m*f*s-u*p*s-m*n*h+t*p*h+u*n*y-t*f*y)*E,e[10]=(o*p*s-m*a*s+m*n*l-t*p*l-o*n*y+t*a*y)*E,e[11]=(u*a*s-o*f*s-u*n*l+t*f*l+o*n*h-t*a*h)*E,e[12]=w*E,e[13]=(u*p*r-m*f*r+m*n*d-t*p*d-u*n*g+t*f*g)*E,e[14]=(m*a*r-o*p*r-m*n*c+t*p*c+o*n*g-t*a*g)*E,e[15]=(o*f*r-u*a*r+u*n*c-t*f*c-o*n*d+t*a*d)*E,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+n,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+n,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,f=a+a,d=s*l,h=s*u,m=s*f,p=o*u,g=o*f,y=a*f,v=c*l,_=c*u,x=c*f,w=n.x,M=n.y,E=n.z;return r[0]=(1-(p+y))*w,r[1]=(h+x)*w,r[2]=(m-_)*w,r[3]=0,r[4]=(h-x)*M,r[5]=(1-(d+y))*M,r[6]=(g+v)*M,r[7]=0,r[8]=(m+_)*E,r[9]=(g-v)*E,r[10]=(1-(d+p))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Jl.set(r[0],r[1],r[2]).length();const o=Jl.set(r[4],r[5],r[6]).length(),a=Jl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Rs.copy(this);const l=1/s,u=1/o,f=1/a;return Rs.elements[0]*=l,Rs.elements[1]*=l,Rs.elements[2]*=l,Rs.elements[4]*=u,Rs.elements[5]*=u,Rs.elements[6]*=u,Rs.elements[8]*=f,Rs.elements[9]*=f,Rs.elements[10]*=f,t.setFromRotationMatrix(Rs),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){const a=this.elements,l=2*s/(n-r),u=(t+e)/(t-e),f=(n+r)/(n-r),d=-(o+s)/(o-s),h=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=f,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,c=1/(t-e),l=1/(n-r),u=1/(o-s),f=(t+e)*c,d=(n+r)*l,h=(o+s)*u;return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-f,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Jl=new D,Rs=new gt,t4=new D(0,0,0),n4=new D(1,1,1),_a=new D,Nm=new D,Rr=new D,LA=new gt,OA=new Ci;let NA=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],f=s[9],d=s[2],h=s[6],m=s[10];switch(n){case"XYZ":this._y=Math.asin(ri(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,m),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ri(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(c,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(ri(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-ri(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,m),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(ri(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(c,m));break;case"XZY":this._z=Math.asin(-ri(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-f,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return LA.makeRotationFromQuaternion(t),this.setFromRotationMatrix(LA,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return OA.setFromEuler(this),this.setFromQuaternion(OA,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})();class hc{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let i4=0;const FA=new D,Ql=new Ci,Lo=new gt,Fm=new D,md=new D,r4=new D,s4=new Ci,kA=new D(1,0,0),BA=new D(0,1,0),UA=new D(0,0,1),o4={type:"added"},zA={type:"removed"};let wn=(()=>{class i extends no{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:i4++}),this.uuid=Pr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();const t=new D,n=new NA,r=new Ci,s=new D(1,1,1);n._onChange(function o(){r.setFromEuler(n,!1)}),r._onChange(function a(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new gt},normalMatrix:{value:new or}}),this.matrix=new gt,this.matrixWorld=new gt,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new hc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Ql.setFromAxisAngle(t,n),this.quaternion.multiply(Ql),this}rotateOnWorldAxis(t,n){return Ql.setFromAxisAngle(t,n),this.quaternion.premultiply(Ql),this}rotateX(t){return this.rotateOnAxis(kA,t)}rotateY(t){return this.rotateOnAxis(BA,t)}rotateZ(t){return this.rotateOnAxis(UA,t)}translateOnAxis(t,n){return FA.copy(t).applyQuaternion(this.quaternion),this.position.add(FA.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(kA,t)}translateY(t){return this.translateOnAxis(BA,t)}translateZ(t){return this.translateOnAxis(UA,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Lo.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?Fm.copy(t):Fm.set(t,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),md.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Lo.lookAt(md,Fm,this.up):Lo.lookAt(Fm,md,this.up),this.quaternion.setFromRotationMatrix(Lo),s&&(Lo.extractRotation(s.matrixWorld),Ql.setFromRotationMatrix(Lo),this.quaternion.premultiply(Ql.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(o4)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(zA)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(zA)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Lo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Lo.multiply(t.parent.matrixWorld)),t.applyMatrix4(Lo),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,n);if(void 0!==a)return a}}getObjectsByProperty(t,n){let r=[];this[t]===n&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,n);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(md,t,r4),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(md,s4,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++){const o=n[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const s=this.children;for(let o=0,a=s.length;o<a;o++){const c=s[o];!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,f=l.length;u<f;u++)o(t.shapes,l[u]);else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++)s.animations.push(o(t.animations,this.animations[c]))}if(n){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),f=a(t.images),d=a(t.shapes),h=a(t.skeletons),m=a(t.animations),p=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),f.length>0&&(r.images=f),d.length>0&&(r.shapes=d),h.length>0&&(r.skeletons=h),m.length>0&&(r.animations=m),p.length>0&&(r.nodes=p)}return r.object=s,r;function a(c){const l=[];for(const u in c){const f=c[u];delete f.metadata,l.push(f)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DEFAULT_UP=new D(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})();const Ls=new D,Oo=new D,_x=new D,No=new D,eu=new D,tu=new D,VA=new D,yx=new D,vx=new D,xx=new D;class ts{constructor(e=new D,t=new D,n=new D){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ls.subVectors(e,t),r.cross(Ls);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Ls.subVectors(r,t),Oo.subVectors(n,t),_x.subVectors(e,t);const o=Ls.dot(Ls),a=Ls.dot(Oo),c=Ls.dot(_x),l=Oo.dot(Oo),u=Oo.dot(_x),f=o*l-a*a;if(0===f)return s.set(-2,-1,-1);const d=1/f,h=(l*c-a*u)*d,m=(o*u-a*c)*d;return s.set(1-h-m,m,h)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,No),No.x>=0&&No.y>=0&&No.x+No.y<=1}static getUV(e,t,n,r,s,o,a,c){return this.getBarycoord(e,t,n,r,No),c.set(0,0),c.addScaledVector(s,No.x),c.addScaledVector(o,No.y),c.addScaledVector(a,No.z),c}static isFrontFacing(e,t,n,r){return Ls.subVectors(n,t),Oo.subVectors(e,t),Ls.cross(Oo).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ls.subVectors(this.c,this.b),Oo.subVectors(this.a,this.b),.5*Ls.cross(Oo).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ts.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ts.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return ts.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return ts.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ts.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;eu.subVectors(r,n),tu.subVectors(s,n),yx.subVectors(e,n);const c=eu.dot(yx),l=tu.dot(yx);if(c<=0&&l<=0)return t.copy(n);vx.subVectors(e,r);const u=eu.dot(vx),f=tu.dot(vx);if(u>=0&&f<=u)return t.copy(r);const d=c*f-u*l;if(d<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(n).addScaledVector(eu,o);xx.subVectors(e,s);const h=eu.dot(xx),m=tu.dot(xx);if(m>=0&&h<=m)return t.copy(s);const p=h*l-c*m;if(p<=0&&l>=0&&m<=0)return a=l/(l-m),t.copy(n).addScaledVector(tu,a);const g=u*m-h*f;if(g<=0&&f-u>=0&&h-m>=0)return VA.subVectors(s,r),a=(f-u)/(f-u+(h-m)),t.copy(r).addScaledVector(VA,a);const y=1/(g+p+d);return o=p*y,a=d*y,t.copy(n).addScaledVector(eu,o).addScaledVector(tu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let a4=0;class wi extends no{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:a4++}),this.uuid=Pr(),this.name="",this.type="Material",this.blending=ec,this.side=Qs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=E0,this.blendDst=T0,this.blendEquation=tc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=hm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=DA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Sm,this.stencilZFail=Sm,this.stencilZPass=Sm,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==ec&&(n.blending=this.blending),this.side!==Qs&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Lr extends wi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Re(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=id,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const di=new D,km=new oe;class fn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=cd,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)km.fromBufferAttribute(this,t),km.applyMatrix3(e),this.setXY(t,km.x,km.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)di.fromBufferAttribute(this,t),di.applyMatrix3(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)di.fromBufferAttribute(this,t),di.applyMatrix4(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)di.fromBufferAttribute(this,t),di.applyNormalMatrix(e),this.setXYZ(t,di.x,di.y,di.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)di.fromBufferAttribute(this,t),di.transformDirection(e),this.setXYZ(t,di.x,di.y,di.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Io(t,this.array)),t}setX(e,t){return this.normalized&&(t=bn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Io(t,this.array)),t}setY(e,t){return this.normalized&&(t=bn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Io(t,this.array)),t}setZ(e,t){return this.normalized&&(t=bn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Io(t,this.array)),t}setW(e,t){return this.normalized&&(t=bn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=bn(t,this.array),n=bn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=bn(t,this.array),n=bn(n,this.array),r=bn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=bn(t,this.array),n=bn(n,this.array),r=bn(r,this.array),s=bn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==cd&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class c4 extends fn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class l4 extends fn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class u4 extends fn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class f4 extends fn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class bx extends fn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class d4 extends fn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class wx extends fn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class h4 extends fn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class We extends fn{constructor(e,t,n){super(new Float32Array(e),t,n)}}class p4 extends fn{constructor(e,t,n){super(new Float64Array(e),t,n)}}let m4=0;const ns=new gt,Mx=new wn,nu=new D,Or=new da,gd=new da,Ai=new D;class Nt extends no{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:m4++}),this.uuid=Pr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(IA(e)?wx:bx)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new or).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ns.makeRotationFromQuaternion(e),this.applyMatrix4(ns),this}rotateX(e){return ns.makeRotationX(e),this.applyMatrix4(ns),this}rotateY(e){return ns.makeRotationY(e),this.applyMatrix4(ns),this}rotateZ(e){return ns.makeRotationZ(e),this.applyMatrix4(ns),this}translate(e,t,n){return ns.makeTranslation(e,t,n),this.applyMatrix4(ns),this}scale(e,t,n){return ns.makeScale(e,t,n),this.applyMatrix4(ns),this}lookAt(e){return Mx.lookAt(e),Mx.updateMatrix(),this.applyMatrix4(Mx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(nu).negate(),this.translate(nu.x,nu.y,nu.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new We(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new da);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)Or.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Ai.addVectors(this.boundingBox.min,Or.min),this.boundingBox.expandByPoint(Ai),Ai.addVectors(this.boundingBox.max,Or.max),this.boundingBox.expandByPoint(Ai)):(this.boundingBox.expandByPoint(Or.min),this.boundingBox.expandByPoint(Or.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ma);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new D,1/0);if(e){const n=this.boundingSphere.center;if(Or.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)gd.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Ai.addVectors(Or.min,gd.min),Or.expandByPoint(Ai),Ai.addVectors(Or.max,gd.max),Or.expandByPoint(Ai)):(Or.expandByPoint(gd.min),Or.expandByPoint(gd.max));Or.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Ai.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Ai));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Ai.fromBufferAttribute(a,l),c&&(nu.fromBufferAttribute(e,l),Ai.add(nu)),r=Math.max(r,n.distanceToSquared(Ai))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new fn(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let A=0;A<a;A++)l[A]=new D,u[A]=new D;const f=new D,d=new D,h=new D,m=new oe,p=new oe,g=new oe,y=new D,v=new D;function _(A,O,U){f.fromArray(r,3*A),d.fromArray(r,3*O),h.fromArray(r,3*U),m.fromArray(o,2*A),p.fromArray(o,2*O),g.fromArray(o,2*U),d.sub(f),h.sub(f),p.sub(m),g.sub(m);const k=1/(p.x*g.y-g.x*p.y);isFinite(k)&&(y.copy(d).multiplyScalar(g.y).addScaledVector(h,-p.y).multiplyScalar(k),v.copy(h).multiplyScalar(p.x).addScaledVector(d,-g.x).multiplyScalar(k),l[A].add(y),l[O].add(y),l[U].add(y),u[A].add(v),u[O].add(v),u[U].add(v))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let A=0,O=x.length;A<O;++A){const U=x[A],k=U.start;for(let V=k,Z=k+U.count;V<Z;V+=3)_(n[V+0],n[V+1],n[V+2])}const w=new D,M=new D,E=new D,b=new D;function S(A){E.fromArray(s,3*A),b.copy(E);const O=l[A];w.copy(O),w.sub(E.multiplyScalar(E.dot(O))).normalize(),M.crossVectors(b,O);const k=M.dot(u[A])<0?-1:1;c[4*A]=w.x,c[4*A+1]=w.y,c[4*A+2]=w.z,c[4*A+3]=k}for(let A=0,O=x.length;A<O;++A){const U=x[A],k=U.start;for(let V=k,Z=k+U.count;V<Z;V+=3)S(n[V+0]),S(n[V+1]),S(n[V+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new fn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let d=0,h=n.count;d<h;d++)n.setXYZ(d,0,0,0);const r=new D,s=new D,o=new D,a=new D,c=new D,l=new D,u=new D,f=new D;if(e)for(let d=0,h=e.count;d<h;d+=3){const m=e.getX(d+0),p=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,m),s.fromBufferAttribute(t,p),o.fromBufferAttribute(t,g),u.subVectors(o,s),f.subVectors(r,s),u.cross(f),a.fromBufferAttribute(n,m),c.fromBufferAttribute(n,p),l.fromBufferAttribute(n,g),a.add(u),c.add(u),l.add(u),n.setXYZ(m,a.x,a.y,a.z),n.setXYZ(p,c.x,c.y,c.z),n.setXYZ(g,l.x,l.y,l.z)}else for(let d=0,h=t.count;d<h;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),f.subVectors(r,s),u.cross(f),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ai.fromBufferAttribute(e,t),Ai.normalize(),e.setXYZ(t,Ai.x,Ai.y,Ai.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,f=a.normalized,d=new l.constructor(c.length*u);let h=0,m=0;for(let p=0,g=c.length;p<g;p++){h=a.isInterleavedBufferAttribute?c[p]*a.data.stride+a.offset:c[p]*u;for(let y=0;y<u;y++)d[m++]=l[h++]}return new fn(d,u,f)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Nt,n=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],n);t.setAttribute(a,l)}const s=this.morphAttributes;for(const a in s){const c=[],l=s[a];for(let u=0,f=l.length;u<f;u++){const h=e(l[u],n);c.push(h)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const c in n)e.data.attributes[c]=n[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let f=0,d=l.length;f<d;f++)u.push(l[f].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const s=e.morphAttributes;for(const l in s){const u=[],f=s[l];for(let d=0,h=f.length;d<h;d++)u.push(f[d].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,u=o.length;l<u;l++){const f=o[l];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const HA=new gt,iu=new pd,Sx=new ma,_d=new D,yd=new D,vd=new D,Ex=new D,Bm=new D,Um=new oe,zm=new oe,Vm=new oe,Tx=new D,Hm=new D;class Kn extends wn{constructor(e=new Nt,t=new Lr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const n=this.geometry,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(n.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Bm.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=a[c];0!==u&&(Ex.fromBufferAttribute(s[c],e),Bm.addScaledVector(o?Ex:Ex.sub(t),u))}t.add(Bm)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Sx.copy(n.boundingSphere),Sx.applyMatrix4(s),!1===e.ray.intersectsSphere(Sx))||(HA.copy(s).invert(),iu.copy(e.ray).applyMatrix4(HA),null!==n.boundingBox&&!1===iu.intersectsBox(n.boundingBox)))return;let o;const a=n.index,c=n.attributes.position,l=n.attributes.uv,u=n.attributes.uv2,f=n.groups,d=n.drawRange;if(null!==a)if(Array.isArray(r))for(let h=0,m=f.length;h<m;h++){const p=f[h],g=r[p.materialIndex];for(let _=Math.max(p.start,d.start),x=Math.min(a.count,Math.min(p.start+p.count,d.start+d.count));_<x;_+=3){const w=a.getX(_),M=a.getX(_+1),E=a.getX(_+2);o=Gm(this,g,e,iu,l,u,w,M,E),o&&(o.faceIndex=Math.floor(_/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else for(let p=Math.max(0,d.start),g=Math.min(a.count,d.start+d.count);p<g;p+=3){const y=a.getX(p),v=a.getX(p+1),_=a.getX(p+2);o=Gm(this,r,e,iu,l,u,y,v,_),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}else if(void 0!==c)if(Array.isArray(r))for(let h=0,m=f.length;h<m;h++){const p=f[h],g=r[p.materialIndex];for(let _=Math.max(p.start,d.start),x=Math.min(c.count,Math.min(p.start+p.count,d.start+d.count));_<x;_+=3)o=Gm(this,g,e,iu,l,u,_,_+1,_+2),o&&(o.faceIndex=Math.floor(_/3),o.face.materialIndex=p.materialIndex,t.push(o))}else for(let p=Math.max(0,d.start),g=Math.min(c.count,d.start+d.count);p<g;p+=3)o=Gm(this,r,e,iu,l,u,p,p+1,p+2),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}}function Gm(i,e,t,n,r,s,o,a,c){i.getVertexPosition(o,_d),i.getVertexPosition(a,yd),i.getVertexPosition(c,vd);const l=function g4(i,e,t,n,r,s,o,a){let c;if(c=e.side===yr?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,e.side===Qs,a),null===c)return null;Hm.copy(a),Hm.applyMatrix4(i.matrixWorld);const l=t.ray.origin.distanceTo(Hm);return l<t.near||l>t.far?null:{distance:l,point:Hm.clone(),object:i}}(i,e,t,n,_d,yd,vd,Tx);if(l){r&&(Um.fromBufferAttribute(r,o),zm.fromBufferAttribute(r,a),Vm.fromBufferAttribute(r,c),l.uv=ts.getUV(Tx,_d,yd,vd,Um,zm,Vm,new oe)),s&&(Um.fromBufferAttribute(s,o),zm.fromBufferAttribute(s,a),Vm.fromBufferAttribute(s,c),l.uv2=ts.getUV(Tx,_d,yd,vd,Um,zm,Vm,new oe));const u={a:o,b:a,c,normal:new D,materialIndex:0};ts.getNormal(_d,yd,vd,u.normal),l.face=u}return l}class ya extends Nt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],l=[],u=[],f=[];let d=0,h=0;function m(p,g,y,v,_,x,w,M,E,b,S){const A=x/E,O=w/b,U=x/2,k=w/2,L=M/2,V=E+1,Z=b+1;let ae=0,J=0;const pe=new D;for(let de=0;de<Z;de++){const Le=de*O-k;for(let $=0;$<V;$++)pe[p]=($*A-U)*v,pe[g]=Le*_,pe[y]=L,l.push(pe.x,pe.y,pe.z),pe[p]=0,pe[g]=0,pe[y]=M>0?1:-1,u.push(pe.x,pe.y,pe.z),f.push($/E),f.push(1-de/b),ae+=1}for(let de=0;de<b;de++)for(let Le=0;Le<E;Le++){const me=d+Le+V*(de+1),ye=d+(Le+1)+V*(de+1),xe=d+(Le+1)+V*de;c.push(d+Le+V*de,me,xe),c.push(me,ye,xe),J+=6}a.addGroup(h,J,S),h+=J,d+=ae}m("z","y","x",-1,-1,n,t,e,o,s,0),m("z","y","x",1,-1,n,t,-e,o,s,1),m("x","z","y",1,1,e,n,t,r,o,2),m("x","z","y",1,-1,e,n,-t,r,o,3),m("x","y","z",1,-1,e,t,n,r,s,4),m("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(c),this.setAttribute("position",new We(l,3)),this.setAttribute("normal",new We(u,3)),this.setAttribute("uv",new We(f,2))}static fromJSON(e){return new ya(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ru(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function ar(i){const e={};for(let t=0;t<i.length;t++){const n=ru(i[t]);for(const r in n)e[r]=n[r]}return e}function GA(i){return null===i.getRenderTarget()&&i.outputEncoding===rn?As:$l}const WA={clone:ru,merge:ar};class io extends wi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ru(e.uniforms),this.uniformsGroups=function _4(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Wm extends wn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new gt,this.projectionMatrix=new gt,this.projectionMatrixInverse=new gt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Fn extends Wm{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ld*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ac*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ld*Math.atan(Math.tan(.5*ac*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ac*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*n/l,r*=o.width/c,n*=o.height/l}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class jA extends wn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new Fn(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new Fn(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new Fn(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Fn(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const c=new Fn(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,1),this.add(c);const l=new Fn(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,c,l]=this.children,u=e.getRenderTarget(),f=e.toneMapping,d=e.xr.enabled;e.toneMapping=Cs,e.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(u),e.toneMapping=f,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class xd extends Bi{constructor(e,t,n,r,s,o,a,c,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:sa,n,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class $A extends Ps{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new xd([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Hn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new ya(5,5,5),s=new io({name:"CubemapFromEquirect",uniforms:ru(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:yr,blending:Do});s.uniforms.tEquirect.value=t;const o=new Kn(r,s),a=t.minFilter;return t.minFilter===to&&(t.minFilter=Hn),new jA(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const Dx=new D,x4=new D,b4=new or;class va{constructor(e=new D(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Dx.subVectors(n,t).cross(x4.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Dx),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||b4.getNormalMatrix(e),r=this.coplanarPoint(Dx).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const au=new ma,jm=new D;class $m{constructor(e=new va,t=new va,n=new va,r=new va,s=new va,o=new va){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],c=n[4],l=n[5],u=n[6],f=n[7],d=n[8],h=n[9],m=n[10],p=n[11],g=n[12],y=n[13],v=n[14],_=n[15];return t[0].setComponents(a-r,f-c,p-d,_-g).normalize(),t[1].setComponents(a+r,f+c,p+d,_+g).normalize(),t[2].setComponents(a+s,f+l,p+h,_+y).normalize(),t[3].setComponents(a-s,f-l,p-h,_-y).normalize(),t[4].setComponents(a-o,f-u,p-m,_-v).normalize(),t[5].setComponents(a+o,f+u,p+m,_+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),au.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(au)}intersectsSprite(e){return au.center.set(0,0,0),au.radius=.7071067811865476,au.applyMatrix4(e.matrixWorld),this.intersectsSphere(au)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(jm.x=r.normal.x>0?e.max.x:e.min.x,jm.y=r.normal.y>0?e.max.y:e.min.y,jm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(jm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function qA(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function w4(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),n.get(l)},remove:function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=n.get(l);u&&(i.deleteBuffer(u.buffer),n.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const d=n.get(l);return void((!d||d.version<l.version)&&n.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const f=n.get(l);void 0===f?n.set(l,function r(l,u){const f=l.array,d=l.usage,h=i.createBuffer();let m;if(i.bindBuffer(u,h),i.bufferData(u,f,d),l.onUploadCallback(),f instanceof Float32Array)m=5126;else if(f instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=5131}else m=5123;else if(f instanceof Int16Array)m=5122;else if(f instanceof Uint32Array)m=5125;else if(f instanceof Int32Array)m=5124;else if(f instanceof Int8Array)m=5120;else if(f instanceof Uint8Array)m=5121;else{if(!(f instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);m=5121}return{buffer:h,type:m,bytesPerElement:f.BYTES_PER_ELEMENT,version:l.version}}(l,u)):f.version<l.version&&(function s(l,u,f){const d=u.array,h=u.updateRange;i.bindBuffer(f,l),-1===h.count?i.bufferSubData(f,0,d):(t?i.bufferSubData(f,h.offset*d.BYTES_PER_ELEMENT,d,h.offset,h.count):i.bufferSubData(f,h.offset*d.BYTES_PER_ELEMENT,d.subarray(h.offset,h.offset+h.count)),h.count=-1),u.onUploadCallback()}(f.buffer,l,u),f.version=l.version)}}}class cu extends Nt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),c=Math.floor(r),l=a+1,u=c+1,f=e/a,d=t/c,h=[],m=[],p=[],g=[];for(let y=0;y<u;y++){const v=y*d-o;for(let _=0;_<l;_++)m.push(_*f-s,-v,0),p.push(0,0,1),g.push(_/a),g.push(1-y/c)}for(let y=0;y<c;y++)for(let v=0;v<a;v++){const x=v+l*(y+1),w=v+1+l*(y+1),M=v+1+l*y;h.push(v+l*y,x,M),h.push(x,w,M)}this.setIndex(h),this.setAttribute("position",new We(m,3)),this.setAttribute("normal",new We(p,3)),this.setAttribute("uv",new We(g,2))}static fromJSON(e){return new cu(e.width,e.height,e.widthSegments,e.heightSegments)}}const Ft={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ae={common:{diffuse:{value:new Re(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new or},uv2Transform:{value:new or},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Re(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Re(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new or}},sprite:{diffuse:{value:new Re(16777215)},opacity:{value:1},center:{value:new oe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new or}}},Os={basic:{uniforms:ar([Ae.common,Ae.specularmap,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.fog]),vertexShader:Ft.meshbasic_vert,fragmentShader:Ft.meshbasic_frag},lambert:{uniforms:ar([Ae.common,Ae.specularmap,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.fog,Ae.lights,{emissive:{value:new Re(0)}}]),vertexShader:Ft.meshlambert_vert,fragmentShader:Ft.meshlambert_frag},phong:{uniforms:ar([Ae.common,Ae.specularmap,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.fog,Ae.lights,{emissive:{value:new Re(0)},specular:{value:new Re(1118481)},shininess:{value:30}}]),vertexShader:Ft.meshphong_vert,fragmentShader:Ft.meshphong_frag},standard:{uniforms:ar([Ae.common,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.roughnessmap,Ae.metalnessmap,Ae.fog,Ae.lights,{emissive:{value:new Re(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ft.meshphysical_vert,fragmentShader:Ft.meshphysical_frag},toon:{uniforms:ar([Ae.common,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.gradientmap,Ae.fog,Ae.lights,{emissive:{value:new Re(0)}}]),vertexShader:Ft.meshtoon_vert,fragmentShader:Ft.meshtoon_frag},matcap:{uniforms:ar([Ae.common,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.fog,{matcap:{value:null}}]),vertexShader:Ft.meshmatcap_vert,fragmentShader:Ft.meshmatcap_frag},points:{uniforms:ar([Ae.points,Ae.fog]),vertexShader:Ft.points_vert,fragmentShader:Ft.points_frag},dashed:{uniforms:ar([Ae.common,Ae.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ft.linedashed_vert,fragmentShader:Ft.linedashed_frag},depth:{uniforms:ar([Ae.common,Ae.displacementmap]),vertexShader:Ft.depth_vert,fragmentShader:Ft.depth_frag},normal:{uniforms:ar([Ae.common,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,{opacity:{value:1}}]),vertexShader:Ft.meshnormal_vert,fragmentShader:Ft.meshnormal_frag},sprite:{uniforms:ar([Ae.sprite,Ae.fog]),vertexShader:Ft.sprite_vert,fragmentShader:Ft.sprite_frag},background:{uniforms:{uvTransform:{value:new or},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ft.background_vert,fragmentShader:Ft.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ft.backgroundCube_vert,fragmentShader:Ft.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ft.cube_vert,fragmentShader:Ft.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ft.equirect_vert,fragmentShader:Ft.equirect_frag},distanceRGBA:{uniforms:ar([Ae.common,Ae.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ft.distanceRGBA_vert,fragmentShader:Ft.distanceRGBA_frag},shadow:{uniforms:ar([Ae.lights,Ae.fog,{color:{value:new Re(0)},opacity:{value:1}}]),vertexShader:Ft.shadow_vert,fragmentShader:Ft.shadow_frag}};Os.physical={uniforms:ar([Os.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new oe(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Re(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new oe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Re(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Re(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Ft.meshphysical_vert,fragmentShader:Ft.meshphysical_frag};const qm={r:0,b:0,g:0};function bW(i,e,t,n,r,s,o){const a=new Re(0);let l,u,c=!0===s?0:1,f=null,d=0,h=null;function p(g,y){g.getRGB(qm,GA(i)),n.buffers.color.setClear(qm.r,qm.g,qm.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(g,y=1){a.set(g),c=y,p(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(g){c=g,p(a,c)},render:function m(g,y){let v=!1,_=!0===y.isScene?y.background:null;_&&_.isTexture&&(_=(y.backgroundBlurriness>0?t:e).get(_));const x=i.xr,w=x.getSession&&x.getSession();w&&"additive"===w.environmentBlendMode&&(_=null),null===_?p(a,c):_&&_.isColor&&(p(_,1),v=!0),(i.autoClear||v)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Vl)?(void 0===u&&(u=new Kn(new ya(1,1,1),new io({name:"BackgroundCubeMaterial",uniforms:ru(Os.backgroundCube.uniforms),vertexShader:Os.backgroundCube.vertexShader,fragmentShader:Os.backgroundCube.fragmentShader,side:yr,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,E,b){this.matrixWorld.copyPosition(b.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=_,u.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=_.encoding!==rn,(f!==_||d!==_.version||h!==i.toneMapping)&&(u.material.needsUpdate=!0,f=_,d=_.version,h=i.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):_&&_.isTexture&&(void 0===l&&(l=new Kn(new cu(2,2),new io({name:"BackgroundMaterial",uniforms:ru(Os.background.uniforms),vertexShader:Os.background.vertexShader,fragmentShader:Os.background.fragmentShader,side:Qs,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=_,l.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,l.material.toneMapped=_.encoding!==rn,!0===_.matrixAutoUpdate&&_.updateMatrix(),l.material.uniforms.uvTransform.value.copy(_.matrix),(f!==_||d!==_.version||h!==i.toneMapping)&&(l.material.needsUpdate=!0,f=_,d=_.version,h=i.toneMapping),l.layers.enableAll(),g.unshift(l,l.geometry,l.material,0,0,null))}}}function wW(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},c=g(null);let l=c,u=!1;function h(L){return n.isWebGL2?i.bindVertexArray(L):s.bindVertexArrayOES(L)}function m(L){return n.isWebGL2?i.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function g(L){const V=[],Z=[],ae=[];for(let J=0;J<r;J++)V[J]=0,Z[J]=0,ae[J]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:Z,attributeDivisors:ae,object:L,attributes:{},index:null}}function _(){const L=l.newAttributes;for(let V=0,Z=L.length;V<Z;V++)L[V]=0}function x(L){w(L,0)}function w(L,V){const ae=l.enabledAttributes,J=l.attributeDivisors;l.newAttributes[L]=1,0===ae[L]&&(i.enableVertexAttribArray(L),ae[L]=1),J[L]!==V&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,V),J[L]=V)}function M(){const L=l.newAttributes,V=l.enabledAttributes;for(let Z=0,ae=V.length;Z<ae;Z++)V[Z]!==L[Z]&&(i.disableVertexAttribArray(Z),V[Z]=0)}function E(L,V,Z,ae,J,pe){!0!==n.isWebGL2||5124!==Z&&5125!==Z?i.vertexAttribPointer(L,V,Z,ae,J,pe):i.vertexAttribIPointer(L,V,Z,J,pe)}function U(){k(),u=!0,l!==c&&(l=c,h(l.object))}function k(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function f(L,V,Z,ae,J){let pe=!1;if(o){const de=function p(L,V,Z){const ae=!0===Z.wireframe;let J=a[L.id];void 0===J&&(J={},a[L.id]=J);let pe=J[V.id];void 0===pe&&(pe={},J[V.id]=pe);let de=pe[ae];return void 0===de&&(de=g(function d(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),pe[ae]=de),de}(ae,Z,V);l!==de&&(l=de,h(l.object)),pe=function y(L,V,Z,ae){const J=l.attributes,pe=V.attributes;let de=0;const Le=Z.getAttributes();for(const $ in Le)if(Le[$].location>=0){const ye=J[$];let xe=pe[$];if(void 0===xe&&("instanceMatrix"===$&&L.instanceMatrix&&(xe=L.instanceMatrix),"instanceColor"===$&&L.instanceColor&&(xe=L.instanceColor)),void 0===ye||ye.attribute!==xe||xe&&ye.data!==xe.data)return!0;de++}return l.attributesNum!==de||l.index!==ae}(L,ae,Z,J),pe&&function v(L,V,Z,ae){const J={},pe=V.attributes;let de=0;const Le=Z.getAttributes();for(const $ in Le)if(Le[$].location>=0){let ye=pe[$];void 0===ye&&("instanceMatrix"===$&&L.instanceMatrix&&(ye=L.instanceMatrix),"instanceColor"===$&&L.instanceColor&&(ye=L.instanceColor));const xe={};xe.attribute=ye,ye&&ye.data&&(xe.data=ye.data),J[$]=xe,de++}l.attributes=J,l.attributesNum=de,l.index=ae}(L,ae,Z,J)}else{const de=!0===V.wireframe;(l.geometry!==ae.id||l.program!==Z.id||l.wireframe!==de)&&(l.geometry=ae.id,l.program=Z.id,l.wireframe=de,pe=!0)}null!==J&&t.update(J,34963),(pe||u)&&(u=!1,function b(L,V,Z,ae){if(!1===n.isWebGL2&&(L.isInstancedMesh||ae.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;_();const J=ae.attributes,pe=Z.getAttributes(),de=V.defaultAttributeValues;for(const Le in pe){const $=pe[Le];if($.location>=0){let me=J[Le];if(void 0===me&&("instanceMatrix"===Le&&L.instanceMatrix&&(me=L.instanceMatrix),"instanceColor"===Le&&L.instanceColor&&(me=L.instanceColor)),void 0!==me){const ye=me.normalized,xe=me.itemSize,q=t.get(me);if(void 0===q)continue;const Ze=q.buffer,Ue=q.type,$e=q.bytesPerElement;if(me.isInterleavedBufferAttribute){const Se=me.data,It=Se.stride,fe=me.offset;if(Se.isInstancedInterleavedBuffer){for(let ue=0;ue<$.locationSize;ue++)w($.location+ue,Se.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===ae._maxInstanceCount&&(ae._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let ue=0;ue<$.locationSize;ue++)x($.location+ue);i.bindBuffer(34962,Ze);for(let ue=0;ue<$.locationSize;ue++)E($.location+ue,xe/$.locationSize,Ue,ye,It*$e,(fe+xe/$.locationSize*ue)*$e)}else{if(me.isInstancedBufferAttribute){for(let Se=0;Se<$.locationSize;Se++)w($.location+Se,me.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===ae._maxInstanceCount&&(ae._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let Se=0;Se<$.locationSize;Se++)x($.location+Se);i.bindBuffer(34962,Ze);for(let Se=0;Se<$.locationSize;Se++)E($.location+Se,xe/$.locationSize,Ue,ye,xe*$e,xe/$.locationSize*Se*$e)}}else if(void 0!==de){const ye=de[Le];if(void 0!==ye)switch(ye.length){case 2:i.vertexAttrib2fv($.location,ye);break;case 3:i.vertexAttrib3fv($.location,ye);break;case 4:i.vertexAttrib4fv($.location,ye);break;default:i.vertexAttrib1fv($.location,ye)}}}}M()}(L,V,Z,ae),null!==J&&i.bindBuffer(34963,t.get(J).buffer))},reset:U,resetDefaultState:k,dispose:function S(){U();for(const L in a){const V=a[L];for(const Z in V){const ae=V[Z];for(const J in ae)m(ae[J].object),delete ae[J];delete V[Z]}delete a[L]}},releaseStatesOfGeometry:function A(L){if(void 0===a[L.id])return;const V=a[L.id];for(const Z in V){const ae=V[Z];for(const J in ae)m(ae[J].object),delete ae[J];delete V[Z]}delete a[L.id]},releaseStatesOfProgram:function O(L){for(const V in a){const Z=a[V];if(void 0===Z[L.id])continue;const ae=Z[L.id];for(const J in ae)m(ae[J].object),delete ae[J];delete Z[L.id]}},initAttributes:_,enableAttribute:x,disableUnusedAttributes:M}}function MW(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(l){s=l},this.render=function a(l,u){i.drawArrays(s,l,u),t.update(u,s,1)},this.renderInstances=function c(l,u,f){if(0===f)return;let d,h;if(r)d=i,h="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[h](s,l,u,f),t.update(u,s,f)}}function SW(i,e,t){let n;function s(E){if("highp"===E){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return"mediump"===E&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext;let a=void 0!==t.precision?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const l=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,f=i.getParameter(34930),d=i.getParameter(35660),h=i.getParameter(3379),m=i.getParameter(34076),p=i.getParameter(34921),g=i.getParameter(36347),y=i.getParameter(36348),v=i.getParameter(36349),_=d>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const E=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:f,maxVertexTextures:d,maxTextureSize:h,maxCubemapSize:m,maxAttributes:p,maxVertexUniforms:g,maxVaryings:y,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:x,floatVertexTextures:_&&x,maxSamples:o?i.getParameter(36183):0}}function EW(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new va,a=new or,c={value:null,needsUpdate:!1};function u(f,d,h,m){const p=null!==f?f.length:0;let g=null;if(0!==p){if(g=c.value,!0!==m||null===g){const y=h+4*p,v=d.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<y)&&(g=new Float32Array(y));for(let _=0,x=h;_!==p;++_,x+=4)o.copy(f[_]).applyMatrix4(v,a),o.normal.toArray(g,x),g[x+3]=o.constant}c.value=g,c.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,g}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d){const h=0!==f.length||d||0!==n||r;return r=d,n=f.length,h},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,d){t=u(f,d,0)},this.setState=function(f,d,h){const m=f.clippingPlanes,p=f.clipIntersection,g=f.clipShadows,y=i.get(f);if(!r||null===m||0===m.length||s&&!g)s?u(null):function l(){c.value!==t&&(c.value=t,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}();else{const v=s?0:n,_=4*v;let x=y.clippingState||null;c.value=x,x=u(m,d,_,h);for(let w=0;w!==_;++w)x[w]=t[w];y.clippingState=x,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=v}}}function TW(i){let e=new WeakMap;function t(o,a){return a===rd?o.mapping=sa:a===sd&&(o.mapping=oa),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===rd||a===sd){if(e.has(o))return t(e.get(o).texture,o.mapping);{const c=o.image;if(c&&c.height>0){const l=new $A(c.height/2);return l.fromEquirectangularTexture(i,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Fo extends Wm{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const XA=[.125,.215,.35,.446,.526,.582],Cx=new Fo,ZA=new Re;let Ax=null;const mc=(1+Math.sqrt(5))/2,uu=1/mc,YA=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,mc,uu),new D(0,mc,-uu),new D(uu,0,mc),new D(-uu,0,mc),new D(mc,uu,0),new D(-mc,uu,0)];class Ix{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Ax=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=QA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=JA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ax),e.scissorTest=!1,Xm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===sa||e.mapping===oa?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Ax=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Hn,minFilter:Hn,generateMipmaps:!1,type:Wl,format:Ir,encoding:Ao,depthBuffer:!1},r=KA(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=KA(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function DW(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+XA.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>i-4?c=XA[o-i+4-1]:0===o&&(c=0),n.push(c);const l=1/(a-2),u=-l,f=1+l,d=[u,u,f,u,f,f,u,u,f,f,u,f],h=6,m=6,p=3,g=2,y=1,v=new Float32Array(p*m*h),_=new Float32Array(g*m*h),x=new Float32Array(y*m*h);for(let M=0;M<h;M++){const E=M%3*2/3-1,b=M>2?0:-1;v.set([E,b,0,E+2/3,b,0,E+2/3,b+1,0,E,b,0,E+2/3,b+1,0,E,b+1,0],p*m*M),_.set(d,g*m*M),x.set([M,M,M,M,M,M],y*m*M)}const w=new Nt;w.setAttribute("position",new fn(v,p)),w.setAttribute("uv",new fn(_,g)),w.setAttribute("faceIndex",new fn(x,y)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function CW(i,e,t){const n=new Float32Array(20),r=new D(0,1,0);return new io({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Do,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Kn(this._lodPlanes[0],e);this._renderer.compile(t,Cx)}_sceneToCubeUV(e,t,n,r){const a=new Fn(90,1,t,n),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,f=u.autoClear,d=u.toneMapping;u.getClearColor(ZA),u.toneMapping=Cs,u.autoClear=!1;const h=new Lr({name:"PMREM.Background",side:yr,depthWrite:!1,depthTest:!1}),m=new Kn(new ya,h);let p=!1;const g=e.background;g?g.isColor&&(h.color.copy(g),e.background=null,p=!0):(h.color.copy(ZA),p=!0);for(let y=0;y<6;y++){const v=y%3;0===v?(a.up.set(0,c[y],0),a.lookAt(l[y],0,0)):1===v?(a.up.set(0,0,c[y]),a.lookAt(0,l[y],0)):(a.up.set(0,c[y],0),a.lookAt(0,0,l[y]));const _=this._cubeSize;Xm(r,v*_,y>2?_:0,_,_),u.setRenderTarget(r),p&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=d,u.autoClear=f,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===sa||e.mapping===oa;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=QA()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=JA());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Kn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;Xm(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(o,Cx)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,YA[(r-1)%YA.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const f=new Kn(this._lodPlanes[r],l),d=l.uniforms,h=this._sizeLods[n]-1,m=isFinite(s)?Math.PI/(2*h):2*Math.PI/39,p=s/m,g=isFinite(s)?1+Math.floor(3*p):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const y=[];let v=0;for(let E=0;E<20;++E){const b=E/p,S=Math.exp(-b*b/2);y.push(S),0===E?v+=S:E<g&&(v+=2*S)}for(let E=0;E<y.length;E++)y[E]=y[E]/v;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=y,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:_}=this;d.dTheta.value=m,d.mipInt.value=_-n;const x=this._sizeLods[r];Xm(t,3*x*(r>_-4?r-_+4:0),4*(this._cubeSize-x),3*x,2*x),c.setRenderTarget(t),c.render(f,Cx)}}function KA(i,e,t){const n=new Ps(i,e,t);return n.texture.mapping=Vl,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Xm(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function JA(){return new io({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Do,depthTest:!1,depthWrite:!1})}function QA(){return new io({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Do,depthTest:!1,depthWrite:!1})}function AW(i){let e=new WeakMap,t=null;function s(a){const c=a.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function n(a){if(a&&a.isTexture){const c=a.mapping,l=c===rd||c===sd,u=c===sa||c===oa;if(l||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let f=e.get(a);return null===t&&(t=new Ix(i)),f=l?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}if(e.has(a))return e.get(a).texture;{const f=a.image;if(l&&f&&f.height>0||u&&f&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(f)){null===t&&(t=new Ix(i));const d=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function IW(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function PW(i,e,t,n){const r={},s=new WeakMap;function o(f){const d=f.target;null!==d.index&&e.remove(d.index);for(const m in d.attributes)e.remove(d.attributes[m]);d.removeEventListener("dispose",o),delete r[d.id];const h=s.get(d);h&&(e.remove(h),s.delete(d)),n.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function l(f){const d=[],h=f.index,m=f.attributes.position;let p=0;if(null!==h){const v=h.array;p=h.version;for(let _=0,x=v.length;_<x;_+=3){const w=v[_+0],M=v[_+1],E=v[_+2];d.push(w,M,M,E,E,w)}}else{p=m.version;for(let _=0,x=m.array.length/3-1;_<x;_+=3){const w=_+0,M=_+1,E=_+2;d.push(w,M,M,E,E,w)}}const g=new(IA(d)?wx:bx)(d,1);g.version=p;const y=s.get(f);y&&e.remove(y),s.set(f,g)}return{get:function a(f,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function c(f){const d=f.attributes;for(const m in d)e.update(d[m],34962);const h=f.morphAttributes;for(const m in h){const p=h[m];for(let g=0,y=p.length;g<y;g++)e.update(p[g],34962)}},getWireframeAttribute:function u(f){const d=s.get(f);if(d){const h=f.index;null!==h&&d.version<h.version&&l(f)}else l(f);return s.get(f)}}}function RW(i,e,t,n){const r=n.isWebGL2;let s,a,c;this.setMode=function o(d){s=d},this.setIndex=function l(d){a=d.type,c=d.bytesPerElement},this.render=function u(d,h){i.drawElements(s,h,a,d*c),t.update(h,s,1)},this.renderInstances=function f(d,h,m){if(0===m)return;let p,g;if(r)p=i,g="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[g](s,h,a,d*c,m),t.update(h,s,m)}}function LW(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function OW(i,e){return i[0]-e[0]}function NW(i,e){return Math.abs(e[1])-Math.abs(i[1])}function FW(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new mn,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function c(l,u,f,d){const h=l.morphTargetInfluences;if(!0===e.isWebGL2){const m=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==m?m.length:0;let g=s.get(u);if(void 0===g||g.count!==p){let V=function(){k.dispose(),s.delete(u),u.removeEventListener("dispose",V)};void 0!==g&&g.texture.dispose();const _=void 0!==u.morphAttributes.position,x=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],E=u.morphAttributes.normal||[],b=u.morphAttributes.color||[];let S=0;!0===_&&(S=1),!0===x&&(S=2),!0===w&&(S=3);let A=u.attributes.position.count*S,O=1;A>e.maxTextureSize&&(O=Math.ceil(A/e.maxTextureSize),A=e.maxTextureSize);const U=new Float32Array(A*O*4*p),k=new Im(U,A,O,p);k.type=Co,k.needsUpdate=!0;const L=4*S;for(let Z=0;Z<p;Z++){const ae=M[Z],J=E[Z],pe=b[Z],de=A*O*4*Z;for(let Le=0;Le<ae.count;Le++){const $=Le*L;!0===_&&(o.fromBufferAttribute(ae,Le),U[de+$+0]=o.x,U[de+$+1]=o.y,U[de+$+2]=o.z,U[de+$+3]=0),!0===x&&(o.fromBufferAttribute(J,Le),U[de+$+4]=o.x,U[de+$+5]=o.y,U[de+$+6]=o.z,U[de+$+7]=0),!0===w&&(o.fromBufferAttribute(pe,Le),U[de+$+8]=o.x,U[de+$+9]=o.y,U[de+$+10]=o.z,U[de+$+11]=4===pe.itemSize?o.w:1)}}g={count:p,texture:k,size:new oe(A,O)},s.set(u,g),u.addEventListener("dispose",V)}let y=0;for(let _=0;_<h.length;_++)y+=h[_];const v=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(i,"morphTargetBaseInfluence",v),d.getUniforms().setValue(i,"morphTargetInfluences",h),d.getUniforms().setValue(i,"morphTargetsTexture",g.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",g.size)}else{const m=void 0===h?0:h.length;let p=n[u.id];if(void 0===p||p.length!==m){p=[];for(let x=0;x<m;x++)p[x]=[x,0];n[u.id]=p}for(let x=0;x<m;x++){const w=p[x];w[0]=x,w[1]=h[x]}p.sort(NW);for(let x=0;x<8;x++)x<m&&p[x][1]?(a[x][0]=p[x][0],a[x][1]=p[x][1]):(a[x][0]=Number.MAX_SAFE_INTEGER,a[x][1]=0);a.sort(OW);const g=u.morphAttributes.position,y=u.morphAttributes.normal;let v=0;for(let x=0;x<8;x++){const w=a[x],M=w[0],E=w[1];M!==Number.MAX_SAFE_INTEGER&&E?(g&&u.getAttribute("morphTarget"+x)!==g[M]&&u.setAttribute("morphTarget"+x,g[M]),y&&u.getAttribute("morphNormal"+x)!==y[M]&&u.setAttribute("morphNormal"+x,y[M]),r[x]=E,v+=E):(g&&!0===u.hasAttribute("morphTarget"+x)&&u.deleteAttribute("morphTarget"+x),y&&!0===u.hasAttribute("morphNormal"+x)&&u.deleteAttribute("morphNormal"+x),r[x]=0)}const _=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(i,"morphTargetBaseInfluence",_),d.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function kW(i,e,t,n){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function s(c){const l=n.render.frame,f=e.get(c,c.geometry);return r.get(f)!==l&&(e.update(f),r.set(f,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,34962),null!==c.instanceColor&&t.update(c.instanceColor,34962)),f},dispose:function o(){r=new WeakMap}}}const eI=new Bi,tI=new Im,nI=new lx,iI=new xd,rI=[],sI=[],oI=new Float32Array(16),aI=new Float32Array(9),cI=new Float32Array(4);function fu(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=rI[r];if(void 0===s&&(s=new Float32Array(r),rI[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function Mi(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Si(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Zm(i,e){let t=sI[e];void 0===t&&(t=new Int32Array(e),sI[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function BW(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function UW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mi(t,e))return;i.uniform2fv(this.addr,e),Si(t,e)}}function zW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Mi(t,e))return;i.uniform3fv(this.addr,e),Si(t,e)}}function VW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mi(t,e))return;i.uniform4fv(this.addr,e),Si(t,e)}}function HW(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Mi(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Si(t,e)}else{if(Mi(t,n))return;cI.set(n),i.uniformMatrix2fv(this.addr,!1,cI),Si(t,n)}}function GW(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Mi(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Si(t,e)}else{if(Mi(t,n))return;aI.set(n),i.uniformMatrix3fv(this.addr,!1,aI),Si(t,n)}}function WW(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Mi(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Si(t,e)}else{if(Mi(t,n))return;oI.set(n),i.uniformMatrix4fv(this.addr,!1,oI),Si(t,n)}}function jW(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function $W(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mi(t,e))return;i.uniform2iv(this.addr,e),Si(t,e)}}function qW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mi(t,e))return;i.uniform3iv(this.addr,e),Si(t,e)}}function XW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mi(t,e))return;i.uniform4iv(this.addr,e),Si(t,e)}}function ZW(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function YW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Mi(t,e))return;i.uniform2uiv(this.addr,e),Si(t,e)}}function KW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Mi(t,e))return;i.uniform3uiv(this.addr,e),Si(t,e)}}function JW(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Mi(t,e))return;i.uniform4uiv(this.addr,e),Si(t,e)}}function QW(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||eI,r)}function e6(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||nI,r)}function t6(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||iI,r)}function n6(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||tI,r)}function r6(i,e){i.uniform1fv(this.addr,e)}function s6(i,e){const t=fu(e,this.size,2);i.uniform2fv(this.addr,t)}function o6(i,e){const t=fu(e,this.size,3);i.uniform3fv(this.addr,t)}function a6(i,e){const t=fu(e,this.size,4);i.uniform4fv(this.addr,t)}function c6(i,e){const t=fu(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function l6(i,e){const t=fu(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function u6(i,e){const t=fu(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function f6(i,e){i.uniform1iv(this.addr,e)}function d6(i,e){i.uniform2iv(this.addr,e)}function h6(i,e){i.uniform3iv(this.addr,e)}function p6(i,e){i.uniform4iv(this.addr,e)}function m6(i,e){i.uniform1uiv(this.addr,e)}function g6(i,e){i.uniform2uiv(this.addr,e)}function _6(i,e){i.uniform3uiv(this.addr,e)}function y6(i,e){i.uniform4uiv(this.addr,e)}function v6(i,e,t){const n=this.cache,r=e.length,s=Zm(t,r);Mi(n,s)||(i.uniform1iv(this.addr,s),Si(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||eI,s[o])}function x6(i,e,t){const n=this.cache,r=e.length,s=Zm(t,r);Mi(n,s)||(i.uniform1iv(this.addr,s),Si(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||nI,s[o])}function b6(i,e,t){const n=this.cache,r=e.length,s=Zm(t,r);Mi(n,s)||(i.uniform1iv(this.addr,s),Si(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||iI,s[o])}function w6(i,e,t){const n=this.cache,r=e.length,s=Zm(t,r);Mi(n,s)||(i.uniform1iv(this.addr,s),Si(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||tI,s[o])}class S6{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function i6(i){switch(i){case 5126:return BW;case 35664:return UW;case 35665:return zW;case 35666:return VW;case 35674:return HW;case 35675:return GW;case 35676:return WW;case 5124:case 35670:return jW;case 35667:case 35671:return $W;case 35668:case 35672:return qW;case 35669:case 35673:return XW;case 5125:return ZW;case 36294:return YW;case 36295:return KW;case 36296:return JW;case 35678:case 36198:case 36298:case 36306:case 35682:return QW;case 35679:case 36299:case 36307:return e6;case 35680:case 36300:case 36308:case 36293:return t6;case 36289:case 36303:case 36311:case 36292:return n6}}(t.type)}}class E6{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function M6(i){switch(i){case 5126:return r6;case 35664:return s6;case 35665:return o6;case 35666:return a6;case 35674:return c6;case 35675:return l6;case 35676:return u6;case 5124:case 35670:return f6;case 35667:case 35671:return d6;case 35668:case 35672:return h6;case 35669:case 35673:return p6;case 5125:return m6;case 36294:return g6;case 36295:return _6;case 36296:return y6;case 35678:case 36198:case 36298:case 36306:case 35682:return v6;case 35679:case 36299:case 36307:return x6;case 35680:case 36300:case 36308:case 36293:return b6;case 36289:case 36303:case 36311:case 36292:return w6}}(t.type)}}class T6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const Rx=/(\w+)(\])?(\[|\.)?/g;function lI(i,e){i.seq.push(e),i.map[e.id]=e}function D6(i,e,t){const n=i.name,r=n.length;for(Rx.lastIndex=0;;){const s=Rx.exec(n);let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&Rx.lastIndex+2===r){lI(t,void 0===l?new S6(a,i,e):new E6(a,i,e));break}{let f=t.map[a];void 0===f&&(f=new T6(a),lI(t,f)),t=f}}}class Ym{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);D6(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=n[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function uI(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let C6=0;function fI(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function A6(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function P6(i,e){const t=function I6(i){switch(i){case Ao:return["Linear","( value )"];case rn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function R6(i,e){let t;switch(e){case tA:t="Linear";break;case nA:t="Reinhard";break;case iA:t="OptimizedCineon";break;case D0:t="ACESFilmic";break;case rA:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function bd(i){return""!==i}function dI(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function hI(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const F6=/^[ \t]*#include +<([\w\d./]+)>/gm;function Lx(i){return i.replace(F6,k6)}function k6(i,e){const t=Ft[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return Lx(t)}const B6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pI(i){return i.replace(B6,U6)}function U6(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function mI(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function j6(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=function z6(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===y0?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===v0?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===zl&&(e="SHADOWMAP_TYPE_VSM"),e}(t),l=function V6(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case sa:case oa:e="ENVMAP_TYPE_CUBE";break;case Vl:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function H6(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&i.envMapMode===oa&&(e="ENVMAP_MODE_REFRACTION"),e}(t),f=function G6(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case id:e="ENVMAP_BLENDING_MULTIPLY";break;case QC:e="ENVMAP_BLENDING_MIX";break;case eA:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function W6(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),h=t.isWebGL2?"":function L6(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(bd).join("\n")}(t),m=function O6(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),p=r.createProgram();let g,y,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[m].filter(bd).join("\n"),g.length>0&&(g+="\n"),y=[h,m].filter(bd).join("\n"),y.length>0&&(y+="\n")):(g=[mI(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(bd).join("\n"),y=[h,mI(t),"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Cs?"#define TONE_MAPPING":"",t.toneMapping!==Cs?Ft.tonemapping_pars_fragment:"",t.toneMapping!==Cs?R6("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Ft.encodings_pars_fragment,P6("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(bd).join("\n")),o=Lx(o),o=dI(o,t),o=hI(o,t),a=Lx(a),a=dI(a,t),a=hI(a,t),o=pI(o),a=pI(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in",t.glslVersion===ex?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===ex?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const x=v+y+a,w=uI(r,35633,v+g+o),M=uI(r,35632,x);if(r.attachShader(p,w),r.attachShader(p,M),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),i.debug.checkShaderErrors){const S=r.getProgramInfoLog(p).trim(),A=r.getShaderInfoLog(w).trim(),O=r.getShaderInfoLog(M).trim();let U=!0,k=!0;if(!1===r.getProgramParameter(p,35714)){U=!1;const L=fI(r,w,"vertex"),V=fI(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+S+"\n"+L+"\n"+V)}else""!==S?console.warn("THREE.WebGLProgram: Program Info Log:",S):(""===A||""===O)&&(k=!1);k&&(this.diagnostics={runnable:U,programLog:S,vertexShader:{log:A,prefix:g},fragmentShader:{log:O,prefix:y}})}let E,b;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===E&&(E=new Ym(r,p)),E},this.getAttributes=function(){return void 0===b&&(b=function N6(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,p)),b},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=C6++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=w,this.fragmentShader=M,this}let $6=0;class q6{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new X6(e),t.set(e,n)),n}}class X6{constructor(e){this.id=$6++,this.code=e,this.usedTimes=0}}function Z6(i,e,t,n,r,s,o){const a=new hc,c=new q6,l=[],u=r.isWebGL2,f=r.logarithmicDepthBuffer,d=r.vertexTextures;let h=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function p(b,S,A,O,U){const k=O.fog,L=U.geometry,Z=(b.isMeshStandardMaterial?t:e).get(b.envMap||(b.isMeshStandardMaterial?O.environment:null)),ae=Z&&Z.mapping===Vl?Z.image.height:null,J=m[b.type];null!==b.precision&&(h=r.getMaxPrecision(b.precision),h!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",h,"instead."));const pe=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,de=void 0!==pe?pe.length:0;let $,me,ye,xe,Le=0;if(void 0!==L.morphAttributes.position&&(Le=1),void 0!==L.morphAttributes.normal&&(Le=2),void 0!==L.morphAttributes.color&&(Le=3),J){const It=Os[J];$=It.vertexShader,me=It.fragmentShader}else $=b.vertexShader,me=b.fragmentShader,c.update(b),ye=c.getVertexShaderID(b),xe=c.getFragmentShaderID(b);const q=i.getRenderTarget(),Ue=b.clearcoat>0,$e=b.iridescence>0;return{isWebGL2:u,shaderID:J,shaderName:b.type,vertexShader:$,fragmentShader:me,defines:b.defines,customVertexShaderID:ye,customFragmentShaderID:xe,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:h,instancing:!0===U.isInstancedMesh,instancingColor:!0===U.isInstancedMesh&&null!==U.instanceColor,supportsVertexTextures:d,outputEncoding:null===q?i.outputEncoding:!0===q.isXRRenderTarget?q.texture.encoding:Ao,map:!!b.map,matcap:!!b.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:ae,lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,objectSpaceNormalMap:b.normalMapType===TA,tangentSpaceNormalMap:b.normalMapType===fa,decodeVideoTexture:!!b.map&&!0===b.map.isVideoTexture&&b.map.encoding===rn,clearcoat:Ue,clearcoatMap:Ue&&!!b.clearcoatMap,clearcoatRoughnessMap:Ue&&!!b.clearcoatRoughnessMap,clearcoatNormalMap:Ue&&!!b.clearcoatNormalMap,iridescence:$e,iridescenceMap:$e&&!!b.iridescenceMap,iridescenceThicknessMap:$e&&!!b.iridescenceThicknessMap,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,specularIntensityMap:!!b.specularIntensityMap,specularColorMap:!!b.specularColorMap,opaque:!1===b.transparent&&b.blending===ec,alphaMap:!!b.alphaMap,alphaTest:b.alphaTest>0,gradientMap:!!b.gradientMap,sheen:b.sheen>0,sheenColorMap:!!b.sheenColorMap,sheenRoughnessMap:!!b.sheenRoughnessMap,transmission:b.transmission>0,transmissionMap:!!b.transmissionMap,thicknessMap:!!b.thicknessMap,combine:b.combine,vertexTangents:!!b.normalMap&&!!L.attributes.tangent,vertexColors:b.vertexColors,vertexAlphas:!0===b.vertexColors&&!!L.attributes.color&&4===L.attributes.color.itemSize,vertexUvs:!!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatMap||b.clearcoatRoughnessMap||b.clearcoatNormalMap||b.iridescenceMap||b.iridescenceThicknessMap||b.displacementMap||b.transmissionMap||b.thicknessMap||b.specularIntensityMap||b.specularColorMap||b.sheenColorMap||b.sheenRoughnessMap),uvsVertexOnly:!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatNormalMap||b.iridescenceMap||b.iridescenceThicknessMap||b.transmission>0||b.transmissionMap||b.thicknessMap||b.specularIntensityMap||b.specularColorMap||b.sheen>0||b.sheenColorMap||b.sheenRoughnessMap||!b.displacementMap),fog:!!k,useFog:!0===b.fog,fogExp2:k&&k.isFogExp2,flatShading:!!b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===U.isSkinnedMesh,morphTargets:void 0!==L.morphAttributes.position,morphNormals:void 0!==L.morphAttributes.normal,morphColors:void 0!==L.morphAttributes.color,morphTargetsCount:de,morphTextureStride:Le,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:i.shadowMap.enabled&&A.length>0,shadowMapType:i.shadowMap.type,toneMapping:b.toneMapped?i.toneMapping:Cs,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,doubleSided:b.side===eo,flipSided:b.side===yr,useDepthPacking:!!b.depthPacking,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionDerivatives:b.extensions&&b.extensions.derivatives,extensionFragDepth:b.extensions&&b.extensions.fragDepth,extensionDrawBuffers:b.extensions&&b.extensions.drawBuffers,extensionShaderTextureLOD:b.extensions&&b.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function g(b){const S=[];if(b.shaderID?S.push(b.shaderID):(S.push(b.customVertexShaderID),S.push(b.customFragmentShaderID)),void 0!==b.defines)for(const A in b.defines)S.push(A),S.push(b.defines[A]);return!1===b.isRawShaderMaterial&&(function y(b,S){b.push(S.precision),b.push(S.outputEncoding),b.push(S.envMapMode),b.push(S.envMapCubeUVHeight),b.push(S.combine),b.push(S.vertexUvs),b.push(S.fogExp2),b.push(S.sizeAttenuation),b.push(S.morphTargetsCount),b.push(S.morphAttributeCount),b.push(S.numDirLights),b.push(S.numPointLights),b.push(S.numSpotLights),b.push(S.numSpotLightMaps),b.push(S.numHemiLights),b.push(S.numRectAreaLights),b.push(S.numDirLightShadows),b.push(S.numPointLightShadows),b.push(S.numSpotLightShadows),b.push(S.numSpotLightShadowsWithMaps),b.push(S.shadowMapType),b.push(S.toneMapping),b.push(S.numClippingPlanes),b.push(S.numClipIntersection),b.push(S.depthPacking)}(S,b),function v(b,S){a.disableAll(),S.isWebGL2&&a.enable(0),S.supportsVertexTextures&&a.enable(1),S.instancing&&a.enable(2),S.instancingColor&&a.enable(3),S.map&&a.enable(4),S.matcap&&a.enable(5),S.envMap&&a.enable(6),S.lightMap&&a.enable(7),S.aoMap&&a.enable(8),S.emissiveMap&&a.enable(9),S.bumpMap&&a.enable(10),S.normalMap&&a.enable(11),S.objectSpaceNormalMap&&a.enable(12),S.tangentSpaceNormalMap&&a.enable(13),S.clearcoat&&a.enable(14),S.clearcoatMap&&a.enable(15),S.clearcoatRoughnessMap&&a.enable(16),S.clearcoatNormalMap&&a.enable(17),S.iridescence&&a.enable(18),S.iridescenceMap&&a.enable(19),S.iridescenceThicknessMap&&a.enable(20),S.displacementMap&&a.enable(21),S.specularMap&&a.enable(22),S.roughnessMap&&a.enable(23),S.metalnessMap&&a.enable(24),S.gradientMap&&a.enable(25),S.alphaMap&&a.enable(26),S.alphaTest&&a.enable(27),S.vertexColors&&a.enable(28),S.vertexAlphas&&a.enable(29),S.vertexUvs&&a.enable(30),S.vertexTangents&&a.enable(31),S.uvsVertexOnly&&a.enable(32),b.push(a.mask),a.disableAll(),S.fog&&a.enable(0),S.useFog&&a.enable(1),S.flatShading&&a.enable(2),S.logarithmicDepthBuffer&&a.enable(3),S.skinning&&a.enable(4),S.morphTargets&&a.enable(5),S.morphNormals&&a.enable(6),S.morphColors&&a.enable(7),S.premultipliedAlpha&&a.enable(8),S.shadowMapEnabled&&a.enable(9),S.physicallyCorrectLights&&a.enable(10),S.doubleSided&&a.enable(11),S.flipSided&&a.enable(12),S.useDepthPacking&&a.enable(13),S.dithering&&a.enable(14),S.specularIntensityMap&&a.enable(15),S.specularColorMap&&a.enable(16),S.transmission&&a.enable(17),S.transmissionMap&&a.enable(18),S.thicknessMap&&a.enable(19),S.sheen&&a.enable(20),S.sheenColorMap&&a.enable(21),S.sheenRoughnessMap&&a.enable(22),S.decodeVideoTexture&&a.enable(23),S.opaque&&a.enable(24),b.push(a.mask)}(S,b),S.push(i.outputEncoding)),S.push(b.customProgramCacheKey),S.join()},getUniforms:function _(b){const S=m[b.type];let A;return A=S?WA.clone(Os[S].uniforms):b.uniforms,A},acquireProgram:function x(b,S){let A;for(let O=0,U=l.length;O<U;O++){const k=l[O];if(k.cacheKey===S){A=k,++A.usedTimes;break}}return void 0===A&&(A=new j6(i,S,b,s),l.push(A)),A},releaseProgram:function w(b){if(0==--b.usedTimes){const S=l.indexOf(b);l[S]=l[l.length-1],l.pop(),b.destroy()}},releaseShaderCache:function M(b){c.remove(b)},programs:l,dispose:function E(){c.dispose()}}}function Y6(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function K6(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function gI(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function _I(){const i=[];let e=0;const t=[],n=[],r=[];function o(f,d,h,m,p,g){let y=i[e];return void 0===y?(y={id:f.id,object:f,geometry:d,material:h,groupOrder:m,renderOrder:f.renderOrder,z:p,group:g},i[e]=y):(y.id=f.id,y.object=f,y.geometry=d,y.material=h,y.groupOrder=m,y.renderOrder=f.renderOrder,y.z=p,y.group=g),e++,y}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(f,d,h,m,p,g){const y=o(f,d,h,m,p,g);h.transmission>0?n.push(y):!0===h.transparent?r.push(y):t.push(y)},unshift:function c(f,d,h,m,p,g){const y=o(f,d,h,m,p,g);h.transmission>0?n.unshift(y):!0===h.transparent?r.unshift(y):t.unshift(y)},finish:function u(){for(let f=e,d=i.length;f<d;f++){const h=i[f];if(null===h.id)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}},sort:function l(f,d){t.length>1&&t.sort(f||K6),n.length>1&&n.sort(d||gI),r.length>1&&r.sort(d||gI)}}}function J6(){let i=new WeakMap;return{get:function e(n,r){const s=i.get(n);let o;return void 0===s?(o=new _I,i.set(n,[o])):r>=s.length?(o=new _I,s.push(o)):o=s[r],o},dispose:function t(){i=new WeakMap}}}function Q6(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new D,color:new Re};break;case"SpotLight":t={position:new D,direction:new D,color:new Re,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new D,color:new Re,distance:0,decay:0};break;case"HemisphereLight":t={direction:new D,skyColor:new Re,groundColor:new Re};break;case"RectAreaLight":t={color:new Re,position:new D,halfWidth:new D,halfHeight:new D}}return i[e.id]=t,t}}}let t8=0;function n8(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function i8(i,e){const t=new Q6,n=function e8(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new D);const s=new D,o=new gt,a=new gt;return{setup:function c(u,f){let d=0,h=0,m=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let p=0,g=0,y=0,v=0,_=0,x=0,w=0,M=0,E=0,b=0;u.sort(n8);const S=!0!==f?Math.PI:1;for(let O=0,U=u.length;O<U;O++){const k=u[O],L=k.color,V=k.intensity,Z=k.distance,ae=k.shadow&&k.shadow.map?k.shadow.map.texture:null;if(k.isAmbientLight)d+=L.r*V*S,h+=L.g*V*S,m+=L.b*V*S;else if(k.isLightProbe)for(let J=0;J<9;J++)r.probe[J].addScaledVector(k.sh.coefficients[J],V);else if(k.isDirectionalLight){const J=t.get(k);if(J.color.copy(k.color).multiplyScalar(k.intensity*S),k.castShadow){const pe=k.shadow,de=n.get(k);de.shadowBias=pe.bias,de.shadowNormalBias=pe.normalBias,de.shadowRadius=pe.radius,de.shadowMapSize=pe.mapSize,r.directionalShadow[p]=de,r.directionalShadowMap[p]=ae,r.directionalShadowMatrix[p]=k.shadow.matrix,x++}r.directional[p]=J,p++}else if(k.isSpotLight){const J=t.get(k);J.position.setFromMatrixPosition(k.matrixWorld),J.color.copy(L).multiplyScalar(V*S),J.distance=Z,J.coneCos=Math.cos(k.angle),J.penumbraCos=Math.cos(k.angle*(1-k.penumbra)),J.decay=k.decay,r.spot[y]=J;const pe=k.shadow;if(k.map&&(r.spotLightMap[E]=k.map,E++,pe.updateMatrices(k),k.castShadow&&b++),r.spotLightMatrix[y]=pe.matrix,k.castShadow){const de=n.get(k);de.shadowBias=pe.bias,de.shadowNormalBias=pe.normalBias,de.shadowRadius=pe.radius,de.shadowMapSize=pe.mapSize,r.spotShadow[y]=de,r.spotShadowMap[y]=ae,M++}y++}else if(k.isRectAreaLight){const J=t.get(k);J.color.copy(L).multiplyScalar(V),J.halfWidth.set(.5*k.width,0,0),J.halfHeight.set(0,.5*k.height,0),r.rectArea[v]=J,v++}else if(k.isPointLight){const J=t.get(k);if(J.color.copy(k.color).multiplyScalar(k.intensity*S),J.distance=k.distance,J.decay=k.decay,k.castShadow){const pe=k.shadow,de=n.get(k);de.shadowBias=pe.bias,de.shadowNormalBias=pe.normalBias,de.shadowRadius=pe.radius,de.shadowMapSize=pe.mapSize,de.shadowCameraNear=pe.camera.near,de.shadowCameraFar=pe.camera.far,r.pointShadow[g]=de,r.pointShadowMap[g]=ae,r.pointShadowMatrix[g]=k.shadow.matrix,w++}r.point[g]=J,g++}else if(k.isHemisphereLight){const J=t.get(k);J.skyColor.copy(k.color).multiplyScalar(V*S),J.groundColor.copy(k.groundColor).multiplyScalar(V*S),r.hemi[_]=J,_++}}v>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ae.LTC_FLOAT_1,r.rectAreaLTC2=Ae.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ae.LTC_HALF_1,r.rectAreaLTC2=Ae.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=h,r.ambient[2]=m;const A=r.hash;(A.directionalLength!==p||A.pointLength!==g||A.spotLength!==y||A.rectAreaLength!==v||A.hemiLength!==_||A.numDirectionalShadows!==x||A.numPointShadows!==w||A.numSpotShadows!==M||A.numSpotMaps!==E)&&(r.directional.length=p,r.spot.length=y,r.rectArea.length=v,r.point.length=g,r.hemi.length=_,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=M+E-b,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=b,A.directionalLength=p,A.pointLength=g,A.spotLength=y,A.rectAreaLength=v,A.hemiLength=_,A.numDirectionalShadows=x,A.numPointShadows=w,A.numSpotShadows=M,A.numSpotMaps=E,r.version=t8++)},setupView:function l(u,f){let d=0,h=0,m=0,p=0,g=0;const y=f.matrixWorldInverse;for(let v=0,_=u.length;v<_;v++){const x=u[v];if(x.isDirectionalLight){const w=r.directional[d];w.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(y),d++}else if(x.isSpotLight){const w=r.spot[m];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(y),m++}else if(x.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),a.identity(),o.copy(x.matrixWorld),o.premultiply(y),a.extractRotation(o),w.halfWidth.set(.5*x.width,0,0),w.halfHeight.set(0,.5*x.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),p++}else if(x.isPointLight){const w=r.point[h];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),h++}else if(x.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(x.matrixWorld),w.direction.transformDirection(y),g++}}},state:r}}function yI(i,e){const t=new i8(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function c(f){t.setup(n,f)},setupLightsView:function l(f){t.setupView(n,f)},pushLight:function o(f){n.push(f)},pushShadow:function a(f){r.push(f)}}}function r8(i,e){let t=new WeakMap;return{get:function n(s,o=0){const a=t.get(s);let c;return void 0===a?(c=new yI(i,e),t.set(s,[c])):o>=a.length?(c=new yI(i,e),a.push(c)):c=a[o],c},dispose:function r(){t=new WeakMap}}}class Ox extends wi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=SA,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Nx extends wi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new D,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const s8="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",o8="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function a8(i,e,t){let n=new $m;const r=new oe,s=new oe,o=new mn,a=new Ox({depthPacking:EA}),c=new Nx,l={},u=t.maxTextureSize,f={[Qs]:yr,[yr]:Qs,[eo]:eo},d=new io({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new oe},radius:{value:4}},vertexShader:s8,fragmentShader:o8}),h=d.clone();h.defines.HORIZONTAL_PASS=1;const m=new Nt;m.setAttribute("position",new fn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new Kn(m,d),g=this;function y(x,w){const M=e.update(p);d.defines.VSM_SAMPLES!==x.blurSamples&&(d.defines.VSM_SAMPLES=x.blurSamples,h.defines.VSM_SAMPLES=x.blurSamples,d.needsUpdate=!0,h.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new Ps(r.x,r.y)),d.uniforms.shadow_pass.value=x.map.texture,d.uniforms.resolution.value=x.mapSize,d.uniforms.radius.value=x.radius,i.setRenderTarget(x.mapPass),i.clear(),i.renderBufferDirect(w,null,M,d,p,null),h.uniforms.shadow_pass.value=x.mapPass.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,i.setRenderTarget(x.map),i.clear(),i.renderBufferDirect(w,null,M,h,p,null)}function v(x,w,M,E,b,S){let A=null;const O=!0===M.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==O)A=O;else if(A=!0===M.isPointLight?c:a,i.localClippingEnabled&&!0===w.clipShadows&&Array.isArray(w.clippingPlanes)&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){const U=A.uuid,k=w.uuid;let L=l[U];void 0===L&&(L={},l[U]=L);let V=L[k];void 0===V&&(V=A.clone(),L[k]=V),A=V}return A.visible=w.visible,A.wireframe=w.wireframe,A.side=S===zl?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:f[w.side],A.alphaMap=w.alphaMap,A.alphaTest=w.alphaTest,A.map=w.map,A.clipShadows=w.clipShadows,A.clippingPlanes=w.clippingPlanes,A.clipIntersection=w.clipIntersection,A.displacementMap=w.displacementMap,A.displacementScale=w.displacementScale,A.displacementBias=w.displacementBias,A.wireframeLinewidth=w.wireframeLinewidth,A.linewidth=w.linewidth,!0===M.isPointLight&&!0===A.isMeshDistanceMaterial&&(A.referencePosition.setFromMatrixPosition(M.matrixWorld),A.nearDistance=E,A.farDistance=b),A}function _(x,w,M,E,b){if(!1===x.visible)return;if(x.layers.test(w.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&b===zl)&&(!x.frustumCulled||n.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,x.matrixWorld);const O=e.update(x),U=x.material;if(Array.isArray(U)){const k=O.groups;for(let L=0,V=k.length;L<V;L++){const Z=k[L],ae=U[Z.materialIndex];if(ae&&ae.visible){const J=v(x,ae,E,M.near,M.far,b);i.renderBufferDirect(M,null,O,J,x,Z)}}}else if(U.visible){const k=v(x,U,E,M.near,M.far,b);i.renderBufferDirect(M,null,O,k,x,null)}}const A=x.children;for(let O=0,U=A.length;O<U;O++)_(A[O],w,M,E,b)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=y0,this.render=function(x,w,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===x.length)return;const E=i.getRenderTarget(),b=i.getActiveCubeFace(),S=i.getActiveMipmapLevel(),A=i.state;A.setBlending(Do),A.buffers.color.setClear(1,1,1,1),A.buffers.depth.setTest(!0),A.setScissorTest(!1);for(let O=0,U=x.length;O<U;O++){const k=x[O],L=k.shadow;if(void 0===L){console.warn("THREE.WebGLShadowMap:",k,"has no shadow.");continue}if(!1===L.autoUpdate&&!1===L.needsUpdate)continue;r.copy(L.mapSize);const V=L.getFrameExtents();r.multiply(V),s.copy(L.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/V.x),r.x=s.x*V.x,L.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/V.y),r.y=s.y*V.y,L.mapSize.y=s.y)),null===L.map&&(L.map=new Ps(r.x,r.y,this.type!==zl?{minFilter:Yn,magFilter:Yn}:{}),L.map.texture.name=k.name+".shadowMap",L.camera.updateProjectionMatrix()),i.setRenderTarget(L.map),i.clear();const Z=L.getViewportCount();for(let ae=0;ae<Z;ae++){const J=L.getViewport(ae);o.set(s.x*J.x,s.y*J.y,s.x*J.z,s.y*J.w),A.viewport(o),L.updateMatrices(k,ae),n=L.getFrustum(),_(w,M,L.camera,k,this.type)}!0!==L.isPointLightShadow&&this.type===zl&&y(L,M),L.needsUpdate=!1}g.needsUpdate=!1,i.setRenderTarget(E,b,S)}}function c8(i,e,t){const n=t.isWebGL2,a=new function r(){let z=!1;const ne=new mn;let ge=null;const ze=new mn(0,0,0,0);return{setMask:function(Je){ge!==Je&&!z&&(i.colorMask(Je,Je,Je,Je),ge=Je)},setLocked:function(Je){z=Je},setClear:function(Je,dn,Pi,Yi,Uc){!0===Uc&&(Je*=Yi,dn*=Yi,Pi*=Yi),ne.set(Je,dn,Pi,Yi),!1===ze.equals(ne)&&(i.clearColor(Je,dn,Pi,Yi),ze.copy(ne))},reset:function(){z=!1,ge=null,ze.set(-1,0,0,0)}}},c=new function s(){let z=!1,ne=null,ge=null,ze=null;return{setTest:function(Je){Je?Ze(2929):Ue(2929)},setMask:function(Je){ne!==Je&&!z&&(i.depthMask(Je),ne=Je)},setFunc:function(Je){if(ge!==Je){switch(Je){case $C:i.depthFunc(512);break;case qC:i.depthFunc(519);break;case XC:i.depthFunc(513);break;case hm:i.depthFunc(515);break;case ZC:i.depthFunc(514);break;case YC:i.depthFunc(518);break;case KC:i.depthFunc(516);break;case JC:i.depthFunc(517);break;default:i.depthFunc(515)}ge=Je}},setLocked:function(Je){z=Je},setClear:function(Je){ze!==Je&&(i.clearDepth(Je),ze=Je)},reset:function(){z=!1,ne=null,ge=null,ze=null}}},l=new function o(){let z=!1,ne=null,ge=null,ze=null,Je=null,dn=null,Pi=null,Yi=null,Uc=null;return{setTest:function(Bn){z||(Bn?Ze(2960):Ue(2960))},setMask:function(Bn){ne!==Bn&&!z&&(i.stencilMask(Bn),ne=Bn)},setFunc:function(Bn,Xo,ds){(ge!==Bn||ze!==Xo||Je!==ds)&&(i.stencilFunc(Bn,Xo,ds),ge=Bn,ze=Xo,Je=ds)},setOp:function(Bn,Xo,ds){(dn!==Bn||Pi!==Xo||Yi!==ds)&&(i.stencilOp(Bn,Xo,ds),dn=Bn,Pi=Xo,Yi=ds)},setLocked:function(Bn){z=Bn},setClear:function(Bn){Uc!==Bn&&(i.clearStencil(Bn),Uc=Bn)},reset:function(){z=!1,ne=null,ge=null,ze=null,Je=null,dn=null,Pi=null,Yi=null,Uc=null}}},u=new WeakMap,f=new WeakMap;let d={},h={},m=new WeakMap,p=[],g=null,y=!1,v=null,_=null,x=null,w=null,M=null,E=null,b=null,S=!1,A=null,O=null,U=null,k=null,L=null;const V=i.getParameter(35661);let Z=!1,ae=0;const J=i.getParameter(7938);-1!==J.indexOf("WebGL")?(ae=parseFloat(/^WebGL (\d)/.exec(J)[1]),Z=ae>=1):-1!==J.indexOf("OpenGL ES")&&(ae=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),Z=ae>=2);let pe=null,de={};const Le=i.getParameter(3088),$=i.getParameter(2978),me=(new mn).fromArray(Le),ye=(new mn).fromArray($);function xe(z,ne,ge){const ze=new Uint8Array(4),Je=i.createTexture();i.bindTexture(z,Je),i.texParameteri(z,10241,9728),i.texParameteri(z,10240,9728);for(let dn=0;dn<ge;dn++)i.texImage2D(ne+dn,0,6408,1,1,0,6408,5121,ze);return Je}const q={};function Ze(z){!0!==d[z]&&(i.enable(z),d[z]=!0)}function Ue(z){!1!==d[z]&&(i.disable(z),d[z]=!1)}q[3553]=xe(3553,3553,1),q[34067]=xe(34067,34069,6),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Ze(2929),c.setFunc(hm),Pe(!1),_t(_0),Ze(2884),De(Do);const fe={[tc]:32774,[NC]:32778,[FC]:32779};if(n)fe[M0]=32775,fe[S0]=32776;else{const z=e.get("EXT_blend_minmax");null!==z&&(fe[M0]=z.MIN_EXT,fe[S0]=z.MAX_EXT)}const ue={[kC]:0,[BC]:1,[UC]:768,[E0]:770,[jC]:776,[GC]:774,[VC]:772,[zC]:769,[T0]:771,[WC]:775,[HC]:773};function De(z,ne,ge,ze,Je,dn,Pi,Yi){if(z!==Do){if(!1===y&&(Ze(3042),y=!0),z===OC)Je=Je||ne,dn=dn||ge,Pi=Pi||ze,(ne!==_||Je!==M)&&(i.blendEquationSeparate(fe[ne],fe[Je]),_=ne,M=Je),(ge!==x||ze!==w||dn!==E||Pi!==b)&&(i.blendFuncSeparate(ue[ge],ue[ze],ue[dn],ue[Pi]),x=ge,w=ze,E=dn,b=Pi),v=z,S=!1;else if(z!==v||Yi!==S){if((_!==tc||M!==tc)&&(i.blendEquation(32774),_=tc,M=tc),Yi)switch(z){case ec:i.blendFuncSeparate(1,771,1,771);break;case x0:i.blendFunc(1,1);break;case b0:i.blendFuncSeparate(0,769,0,1);break;case w0:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",z)}else switch(z){case ec:i.blendFuncSeparate(770,771,1,771);break;case x0:i.blendFunc(770,1);break;case b0:i.blendFuncSeparate(0,769,0,1);break;case w0:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",z)}x=null,w=null,E=null,b=null,v=z,S=Yi}}else!0===y&&(Ue(3042),y=!1)}function Pe(z){A!==z&&(i.frontFace(z?2304:2305),A=z)}function _t(z){z!==RC?(Ze(2884),z!==O&&i.cullFace(z===_0?1029:z===LC?1028:1032)):Ue(2884),O=z}function Ye(z,ne,ge){z?(Ze(32823),(k!==ne||L!==ge)&&(i.polygonOffset(ne,ge),k=ne,L=ge)):Ue(32823)}return{buffers:{color:a,depth:c,stencil:l},enable:Ze,disable:Ue,bindFramebuffer:function $e(z,ne){return h[z]!==ne&&(i.bindFramebuffer(z,ne),h[z]=ne,n&&(36009===z&&(h[36160]=ne),36160===z&&(h[36009]=ne)),!0)},drawBuffers:function Se(z,ne){let ge=p,ze=!1;if(z)if(ge=m.get(ne),void 0===ge&&(ge=[],m.set(ne,ge)),z.isWebGLMultipleRenderTargets){const Je=z.texture;if(ge.length!==Je.length||36064!==ge[0]){for(let dn=0,Pi=Je.length;dn<Pi;dn++)ge[dn]=36064+dn;ge.length=Je.length,ze=!0}}else 36064!==ge[0]&&(ge[0]=36064,ze=!0);else 1029!==ge[0]&&(ge[0]=1029,ze=!0);ze&&(t.isWebGL2?i.drawBuffers(ge):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ge))},useProgram:function It(z){return g!==z&&(i.useProgram(z),g=z,!0)},setBlending:De,setMaterial:function Xe(z,ne){z.side===eo?Ue(2884):Ze(2884);let ge=z.side===yr;ne&&(ge=!ge),Pe(ge),z.blending===ec&&!1===z.transparent?De(Do):De(z.blending,z.blendEquation,z.blendSrc,z.blendDst,z.blendEquationAlpha,z.blendSrcAlpha,z.blendDstAlpha,z.premultipliedAlpha),c.setFunc(z.depthFunc),c.setTest(z.depthTest),c.setMask(z.depthWrite),a.setMask(z.colorWrite);const ze=z.stencilWrite;l.setTest(ze),ze&&(l.setMask(z.stencilWriteMask),l.setFunc(z.stencilFunc,z.stencilRef,z.stencilFuncMask),l.setOp(z.stencilFail,z.stencilZFail,z.stencilZPass)),Ye(z.polygonOffset,z.polygonOffsetFactor,z.polygonOffsetUnits),!0===z.alphaToCoverage?Ze(32926):Ue(32926)},setFlipSided:Pe,setCullFace:_t,setLineWidth:function rt(z){z!==U&&(Z&&i.lineWidth(z),U=z)},setPolygonOffset:Ye,setScissorTest:function yn(z){z?Ze(3089):Ue(3089)},activeTexture:function cn(z){void 0===z&&(z=33984+V-1),pe!==z&&(i.activeTexture(z),pe=z)},bindTexture:function P(z,ne,ge){void 0===ge&&(ge=null===pe?33984+V-1:pe);let ze=de[ge];void 0===ze&&(ze={type:void 0,texture:void 0},de[ge]=ze),(ze.type!==z||ze.texture!==ne)&&(pe!==ge&&(i.activeTexture(ge),pe=ge),i.bindTexture(z,ne||q[z]),ze.type=z,ze.texture=ne)},unbindTexture:function T(){const z=de[pe];void 0!==z&&void 0!==z.type&&(i.bindTexture(z.type,null),z.type=void 0,z.texture=void 0)},compressedTexImage2D:function te(){try{i.compressedTexImage2D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},compressedTexImage3D:function be(){try{i.compressedTexImage3D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},texImage2D:function N(){try{i.texImage2D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},texImage3D:function Q(){try{i.texImage3D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},updateUBOMapping:function ut(z,ne){let ge=f.get(ne);void 0===ge&&(ge=new WeakMap,f.set(ne,ge));let ze=ge.get(z);void 0===ze&&(ze=i.getUniformBlockIndex(ne,z.name),ge.set(z,ze))},uniformBlockBinding:function $t(z,ne){const ze=f.get(ne).get(z);u.get(ne)!==ze&&(i.uniformBlockBinding(ne,ze,z.__bindingPointIndex),u.set(ne,ze))},texStorage2D:function ce(){try{i.texStorage2D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},texStorage3D:function Ke(){try{i.texStorage3D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},texSubImage2D:function Ee(){try{i.texSubImage2D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},texSubImage3D:function Oe(){try{i.texSubImage3D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},compressedTexSubImage2D:function dt(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},compressedTexSubImage3D:function Fe(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(z){console.error("THREE.WebGLState:",z)}},scissor:function ve(z){!1===me.equals(z)&&(i.scissor(z.x,z.y,z.z,z.w),me.copy(z))},viewport:function Te(z){!1===ye.equals(z)&&(i.viewport(z.x,z.y,z.z,z.w),ye.copy(z))},reset:function $n(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},pe=null,de={},h={},m=new WeakMap,p=[],g=null,y=!1,v=null,_=null,x=null,w=null,M=null,E=null,b=null,S=!1,A=null,O=null,U=null,k=null,L=null,me.set(0,0,i.canvas.width,i.canvas.height),ye.set(0,0,i.canvas.width,i.canvas.height),a.reset(),c.reset(),l.reset()}}}function l8(i,e,t,n,r,s,o){const a=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,f=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let p;const g=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(P,T){return y?new OffscreenCanvas(P,T):fd("canvas")}function _(P,T,te,be){let Ee=1;if((P.width>be||P.height>be)&&(Ee=be/Math.max(P.width,P.height)),Ee<1||!0===T){if(typeof HTMLImageElement<"u"&&P instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&P instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&P instanceof ImageBitmap){const Oe=T?Tm:Math.floor,dt=Oe(Ee*P.width),Fe=Oe(Ee*P.height);void 0===p&&(p=v(dt,Fe));const ce=te?v(dt,Fe):p;return ce.width=dt,ce.height=Fe,ce.getContext("2d").drawImage(P,0,0,dt,Fe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+P.width+"x"+P.height+") to ("+dt+"x"+Fe+")."),ce}return"data"in P&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+P.width+"x"+P.height+")."),P}return P}function x(P){return nx(P.width)&&nx(P.height)}function M(P,T){return P.generateMipmaps&&T&&P.minFilter!==Yn&&P.minFilter!==Hn}function E(P){i.generateMipmap(P)}function b(P,T,te,be,Ee=!1){if(!1===a)return T;if(null!==P){if(void 0!==i[P])return i[P];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+P+"'")}let Oe=T;return 6403===T&&(5126===te&&(Oe=33326),5131===te&&(Oe=33325),5121===te&&(Oe=33321)),33319===T&&(5126===te&&(Oe=33328),5131===te&&(Oe=33327),5121===te&&(Oe=33323)),6408===T&&(5126===te&&(Oe=34836),5131===te&&(Oe=34842),5121===te&&(Oe=be===rn&&!1===Ee?35907:32856),32819===te&&(Oe=32854),32820===te&&(Oe=32855)),(33325===Oe||33326===Oe||33327===Oe||33328===Oe||34842===Oe||34836===Oe)&&e.get("EXT_color_buffer_float"),Oe}function S(P,T,te){return!0===M(P,te)||P.isFramebufferTexture&&P.minFilter!==Yn&&P.minFilter!==Hn?Math.log2(Math.max(T.width,T.height))+1:void 0!==P.mipmaps&&P.mipmaps.length>0?P.mipmaps.length:P.isCompressedTexture&&Array.isArray(P.image)?T.mipmaps.length:1}function A(P){return P===Yn||P===od||P===Gl?9728:9729}function O(P){const T=P.target;T.removeEventListener("dispose",O),function k(P){const T=n.get(P);if(void 0===T.__webglInit)return;const te=P.source,be=g.get(te);if(be){const Ee=be[T.__cacheKey];Ee.usedTimes--,0===Ee.usedTimes&&L(P),0===Object.keys(be).length&&g.delete(te)}n.remove(P)}(T),T.isVideoTexture&&m.delete(T)}function U(P){const T=P.target;T.removeEventListener("dispose",U),function V(P){const T=P.texture,te=n.get(P),be=n.get(T);if(void 0!==be.__webglTexture&&(i.deleteTexture(be.__webglTexture),o.memory.textures--),P.depthTexture&&P.depthTexture.dispose(),P.isWebGLCubeRenderTarget)for(let Ee=0;Ee<6;Ee++)i.deleteFramebuffer(te.__webglFramebuffer[Ee]),te.__webglDepthbuffer&&i.deleteRenderbuffer(te.__webglDepthbuffer[Ee]);else{if(i.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&i.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&i.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Ee=0;Ee<te.__webglColorRenderbuffer.length;Ee++)te.__webglColorRenderbuffer[Ee]&&i.deleteRenderbuffer(te.__webglColorRenderbuffer[Ee]);te.__webglDepthRenderbuffer&&i.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(P.isWebGLMultipleRenderTargets)for(let Ee=0,Oe=T.length;Ee<Oe;Ee++){const dt=n.get(T[Ee]);dt.__webglTexture&&(i.deleteTexture(dt.__webglTexture),o.memory.textures--),n.remove(T[Ee])}n.remove(T),n.remove(P)}(T)}function L(P){const T=n.get(P);i.deleteTexture(T.__webglTexture),delete g.get(P.source)[T.__cacheKey],o.memory.textures--}let Z=0;function de(P,T){const te=n.get(P);if(P.isVideoTexture&&function yn(P){const T=o.render.frame;m.get(P)!==T&&(m.set(P,T),P.update())}(P),!1===P.isRenderTargetTexture&&P.version>0&&te.__version!==P.version){const be=P.image;if(null===be)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==be.complete)return void Ue(te,P,T);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,te.__webglTexture,33984+T)}const ye={[aa]:10497,[ki]:33071,[Hl]:33648},xe={[Yn]:9728,[od]:9984,[Gl]:9986,[Hn]:9729,[mm]:9985,[to]:9987};function q(P,T,te){if(te?(i.texParameteri(P,10242,ye[T.wrapS]),i.texParameteri(P,10243,ye[T.wrapT]),(32879===P||35866===P)&&i.texParameteri(P,32882,ye[T.wrapR]),i.texParameteri(P,10240,xe[T.magFilter]),i.texParameteri(P,10241,xe[T.minFilter])):(i.texParameteri(P,10242,33071),i.texParameteri(P,10243,33071),(32879===P||35866===P)&&i.texParameteri(P,32882,33071),(T.wrapS!==ki||T.wrapT!==ki)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(P,10240,A(T.magFilter)),i.texParameteri(P,10241,A(T.minFilter)),T.minFilter!==Yn&&T.minFilter!==Hn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const be=e.get("EXT_texture_filter_anisotropic");if(T.magFilter===Yn||T.minFilter!==Gl&&T.minFilter!==to||T.type===Co&&!1===e.has("OES_texture_float_linear")||!1===a&&T.type===Wl&&!1===e.has("OES_texture_half_float_linear"))return;(T.anisotropy>1||n.get(T).__currentAnisotropy)&&(i.texParameterf(P,be.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(T.anisotropy,r.getMaxAnisotropy())),n.get(T).__currentAnisotropy=T.anisotropy)}}function Ze(P,T){let te=!1;void 0===P.__webglInit&&(P.__webglInit=!0,T.addEventListener("dispose",O));const be=T.source;let Ee=g.get(be);void 0===Ee&&(Ee={},g.set(be,Ee));const Oe=function pe(P){const T=[];return T.push(P.wrapS),T.push(P.wrapT),T.push(P.wrapR||0),T.push(P.magFilter),T.push(P.minFilter),T.push(P.anisotropy),T.push(P.internalFormat),T.push(P.format),T.push(P.type),T.push(P.generateMipmaps),T.push(P.premultiplyAlpha),T.push(P.flipY),T.push(P.unpackAlignment),T.push(P.encoding),T.join()}(T);if(Oe!==P.__cacheKey){void 0===Ee[Oe]&&(Ee[Oe]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Ee[Oe].usedTimes++;const dt=Ee[P.__cacheKey];void 0!==dt&&(Ee[P.__cacheKey].usedTimes--,0===dt.usedTimes&&L(T)),P.__cacheKey=Oe,P.__webglTexture=Ee[Oe].texture}return te}function Ue(P,T,te){let be=3553;(T.isDataArrayTexture||T.isCompressedArrayTexture)&&(be=35866),T.isData3DTexture&&(be=32879);const Ee=Ze(P,T),Oe=T.source;t.bindTexture(be,P.__webglTexture,33984+te);const dt=n.get(Oe);if(Oe.version!==dt.__version||!0===Ee){t.activeTexture(33984+te),i.pixelStorei(37440,T.flipY),i.pixelStorei(37441,T.premultiplyAlpha),i.pixelStorei(3317,T.unpackAlignment),i.pixelStorei(37443,0);const Fe=function w(P){return!a&&(P.wrapS!==ki||P.wrapT!==ki||P.minFilter!==Yn&&P.minFilter!==Hn)}(T)&&!1===x(T.image);let ce=_(T.image,Fe,!1,u);ce=cn(T,ce);const Ke=x(ce)||a,N=s.convert(T.format,T.encoding);let Te,Q=s.convert(T.type),ve=b(T.internalFormat,N,Q,T.encoding,T.isVideoTexture);q(be,T,Ke);const ut=T.mipmaps,$t=a&&!0!==T.isVideoTexture,$n=void 0===dt.__version||!0===Ee,z=S(T,ce,Ke);if(T.isDepthTexture)ve=6402,a?ve=T.type===Co?36012:T.type===la?33190:T.type===nc?35056:33189:T.type===Co&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),T.format===ua&&6402===ve&&T.type!==C0&&T.type!==la&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),T.type=la,Q=s.convert(T.type)),T.format===ic&&6402===ve&&(ve=34041,T.type!==nc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),T.type=nc,Q=s.convert(T.type))),$n&&($t?t.texStorage2D(3553,1,ve,ce.width,ce.height):t.texImage2D(3553,0,ve,ce.width,ce.height,0,N,Q,null));else if(T.isDataTexture)if(ut.length>0&&Ke){$t&&$n&&t.texStorage2D(3553,z,ve,ut[0].width,ut[0].height);for(let ne=0,ge=ut.length;ne<ge;ne++)Te=ut[ne],$t?t.texSubImage2D(3553,ne,0,0,Te.width,Te.height,N,Q,Te.data):t.texImage2D(3553,ne,ve,Te.width,Te.height,0,N,Q,Te.data);T.generateMipmaps=!1}else $t?($n&&t.texStorage2D(3553,z,ve,ce.width,ce.height),t.texSubImage2D(3553,0,0,0,ce.width,ce.height,N,Q,ce.data)):t.texImage2D(3553,0,ve,ce.width,ce.height,0,N,Q,ce.data);else if(T.isCompressedTexture)if(T.isCompressedArrayTexture){$t&&$n&&t.texStorage3D(35866,z,ve,ut[0].width,ut[0].height,ce.depth);for(let ne=0,ge=ut.length;ne<ge;ne++)Te=ut[ne],T.format!==Ir?null!==N?$t?t.compressedTexSubImage3D(35866,ne,0,0,0,Te.width,Te.height,ce.depth,N,Te.data,0,0):t.compressedTexImage3D(35866,ne,ve,Te.width,Te.height,ce.depth,0,Te.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$t?t.texSubImage3D(35866,ne,0,0,0,Te.width,Te.height,ce.depth,N,Q,Te.data):t.texImage3D(35866,ne,ve,Te.width,Te.height,ce.depth,0,N,Q,Te.data)}else{$t&&$n&&t.texStorage2D(3553,z,ve,ut[0].width,ut[0].height);for(let ne=0,ge=ut.length;ne<ge;ne++)Te=ut[ne],T.format!==Ir?null!==N?$t?t.compressedTexSubImage2D(3553,ne,0,0,Te.width,Te.height,N,Te.data):t.compressedTexImage2D(3553,ne,ve,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$t?t.texSubImage2D(3553,ne,0,0,Te.width,Te.height,N,Q,Te.data):t.texImage2D(3553,ne,ve,Te.width,Te.height,0,N,Q,Te.data)}else if(T.isDataArrayTexture)$t?($n&&t.texStorage3D(35866,z,ve,ce.width,ce.height,ce.depth),t.texSubImage3D(35866,0,0,0,0,ce.width,ce.height,ce.depth,N,Q,ce.data)):t.texImage3D(35866,0,ve,ce.width,ce.height,ce.depth,0,N,Q,ce.data);else if(T.isData3DTexture)$t?($n&&t.texStorage3D(32879,z,ve,ce.width,ce.height,ce.depth),t.texSubImage3D(32879,0,0,0,0,ce.width,ce.height,ce.depth,N,Q,ce.data)):t.texImage3D(32879,0,ve,ce.width,ce.height,ce.depth,0,N,Q,ce.data);else if(T.isFramebufferTexture){if($n)if($t)t.texStorage2D(3553,z,ve,ce.width,ce.height);else{let ne=ce.width,ge=ce.height;for(let ze=0;ze<z;ze++)t.texImage2D(3553,ze,ve,ne,ge,0,N,Q,null),ne>>=1,ge>>=1}}else if(ut.length>0&&Ke){$t&&$n&&t.texStorage2D(3553,z,ve,ut[0].width,ut[0].height);for(let ne=0,ge=ut.length;ne<ge;ne++)Te=ut[ne],$t?t.texSubImage2D(3553,ne,0,0,N,Q,Te):t.texImage2D(3553,ne,ve,N,Q,Te);T.generateMipmaps=!1}else $t?($n&&t.texStorage2D(3553,z,ve,ce.width,ce.height),t.texSubImage2D(3553,0,0,0,N,Q,ce)):t.texImage2D(3553,0,ve,N,Q,ce);M(T,Ke)&&E(be),dt.__version=Oe.version,T.onUpdate&&T.onUpdate(T)}P.__version=T.version}function Se(P,T,te,be,Ee){const Oe=s.convert(te.format,te.encoding),dt=s.convert(te.type),Fe=b(te.internalFormat,Oe,dt,te.encoding);n.get(T).__hasExternalTextures||(32879===Ee||35866===Ee?t.texImage3D(Ee,0,Fe,T.width,T.height,T.depth,0,Oe,dt,null):t.texImage2D(Ee,0,Fe,T.width,T.height,0,Oe,dt,null)),t.bindFramebuffer(36160,P),Ye(T)?d.framebufferTexture2DMultisampleEXT(36160,be,Ee,n.get(te).__webglTexture,0,rt(T)):(3553===Ee||Ee>=34069&&Ee<=34074)&&i.framebufferTexture2D(36160,be,Ee,n.get(te).__webglTexture,0),t.bindFramebuffer(36160,null)}function It(P,T,te){if(i.bindRenderbuffer(36161,P),T.depthBuffer&&!T.stencilBuffer){let be=33189;if(te||Ye(T)){const Ee=T.depthTexture;Ee&&Ee.isDepthTexture&&(Ee.type===Co?be=36012:Ee.type===la&&(be=33190));const Oe=rt(T);Ye(T)?d.renderbufferStorageMultisampleEXT(36161,Oe,be,T.width,T.height):i.renderbufferStorageMultisample(36161,Oe,be,T.width,T.height)}else i.renderbufferStorage(36161,be,T.width,T.height);i.framebufferRenderbuffer(36160,36096,36161,P)}else if(T.depthBuffer&&T.stencilBuffer){const be=rt(T);te&&!1===Ye(T)?i.renderbufferStorageMultisample(36161,be,35056,T.width,T.height):Ye(T)?d.renderbufferStorageMultisampleEXT(36161,be,35056,T.width,T.height):i.renderbufferStorage(36161,34041,T.width,T.height),i.framebufferRenderbuffer(36160,33306,36161,P)}else{const be=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let Ee=0;Ee<be.length;Ee++){const Oe=be[Ee],dt=s.convert(Oe.format,Oe.encoding),Fe=s.convert(Oe.type),ce=b(Oe.internalFormat,dt,Fe,Oe.encoding),Ke=rt(T);te&&!1===Ye(T)?i.renderbufferStorageMultisample(36161,Ke,ce,T.width,T.height):Ye(T)?d.renderbufferStorageMultisampleEXT(36161,Ke,ce,T.width,T.height):i.renderbufferStorage(36161,ce,T.width,T.height)}}i.bindRenderbuffer(36161,null)}function ue(P){const T=n.get(P),te=!0===P.isWebGLCubeRenderTarget;if(P.depthTexture&&!T.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");!function fe(P,T){if(T&&T.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,P),!T.depthTexture||!T.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(T.depthTexture).__webglTexture||T.depthTexture.image.width!==T.width||T.depthTexture.image.height!==T.height)&&(T.depthTexture.image.width=T.width,T.depthTexture.image.height=T.height,T.depthTexture.needsUpdate=!0),de(T.depthTexture,0);const be=n.get(T.depthTexture).__webglTexture,Ee=rt(T);if(T.depthTexture.format===ua)Ye(T)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,be,0,Ee):i.framebufferTexture2D(36160,36096,3553,be,0);else{if(T.depthTexture.format!==ic)throw new Error("Unknown depthTexture format");Ye(T)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,be,0,Ee):i.framebufferTexture2D(36160,33306,3553,be,0)}}(T.__webglFramebuffer,P)}else if(te){T.__webglDepthbuffer=[];for(let be=0;be<6;be++)t.bindFramebuffer(36160,T.__webglFramebuffer[be]),T.__webglDepthbuffer[be]=i.createRenderbuffer(),It(T.__webglDepthbuffer[be],P,!1)}else t.bindFramebuffer(36160,T.__webglFramebuffer),T.__webglDepthbuffer=i.createRenderbuffer(),It(T.__webglDepthbuffer,P,!1);t.bindFramebuffer(36160,null)}function rt(P){return Math.min(f,P.samples)}function Ye(P){const T=n.get(P);return a&&P.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==T.__useRenderToTexture}function cn(P,T){const te=P.encoding,be=P.format,Ee=P.type;return!0===P.isCompressedTexture||!0===P.isVideoTexture||P.format===Em||te!==Ao&&(te===rn?!1===a?!0===e.has("EXT_sRGB")&&be===Ir?(P.format=Em,P.minFilter=Hn,P.generateMipmaps=!1):T=ax.sRGBToLinear(T):(be!==Ir||Ee!==ca)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",te)),T}this.allocateTextureUnit=function J(){const P=Z;return P>=c&&console.warn("THREE.WebGLTextures: Trying to use "+P+" texture units while this GPU supports only "+c),Z+=1,P},this.resetTextureUnits=function ae(){Z=0},this.setTexture2D=de,this.setTexture2DArray=function Le(P,T){const te=n.get(P);P.version>0&&te.__version!==P.version?Ue(te,P,T):t.bindTexture(35866,te.__webglTexture,33984+T)},this.setTexture3D=function $(P,T){const te=n.get(P);P.version>0&&te.__version!==P.version?Ue(te,P,T):t.bindTexture(32879,te.__webglTexture,33984+T)},this.setTextureCube=function me(P,T){const te=n.get(P);P.version>0&&te.__version!==P.version?function $e(P,T,te){if(6!==T.image.length)return;const be=Ze(P,T),Ee=T.source;t.bindTexture(34067,P.__webglTexture,33984+te);const Oe=n.get(Ee);if(Ee.version!==Oe.__version||!0===be){t.activeTexture(33984+te),i.pixelStorei(37440,T.flipY),i.pixelStorei(37441,T.premultiplyAlpha),i.pixelStorei(3317,T.unpackAlignment),i.pixelStorei(37443,0);const dt=T.isCompressedTexture||T.image[0].isCompressedTexture,Fe=T.image[0]&&T.image[0].isDataTexture,ce=[];for(let ne=0;ne<6;ne++)ce[ne]=dt||Fe?Fe?T.image[ne].image:T.image[ne]:_(T.image[ne],!1,!0,l),ce[ne]=cn(T,ce[ne]);const Ke=ce[0],N=x(Ke)||a,Q=s.convert(T.format,T.encoding),ve=s.convert(T.type),Te=b(T.internalFormat,Q,ve,T.encoding),ut=a&&!0!==T.isVideoTexture,$t=void 0===Oe.__version||!0===be;let z,$n=S(T,Ke,N);if(q(34067,T,N),dt){ut&&$t&&t.texStorage2D(34067,$n,Te,Ke.width,Ke.height);for(let ne=0;ne<6;ne++){z=ce[ne].mipmaps;for(let ge=0;ge<z.length;ge++){const ze=z[ge];T.format!==Ir?null!==Q?ut?t.compressedTexSubImage2D(34069+ne,ge,0,0,ze.width,ze.height,Q,ze.data):t.compressedTexImage2D(34069+ne,ge,Te,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ut?t.texSubImage2D(34069+ne,ge,0,0,ze.width,ze.height,Q,ve,ze.data):t.texImage2D(34069+ne,ge,Te,ze.width,ze.height,0,Q,ve,ze.data)}}}else{z=T.mipmaps,ut&&$t&&(z.length>0&&$n++,t.texStorage2D(34067,$n,Te,ce[0].width,ce[0].height));for(let ne=0;ne<6;ne++)if(Fe){ut?t.texSubImage2D(34069+ne,0,0,0,ce[ne].width,ce[ne].height,Q,ve,ce[ne].data):t.texImage2D(34069+ne,0,Te,ce[ne].width,ce[ne].height,0,Q,ve,ce[ne].data);for(let ge=0;ge<z.length;ge++){const Je=z[ge].image[ne].image;ut?t.texSubImage2D(34069+ne,ge+1,0,0,Je.width,Je.height,Q,ve,Je.data):t.texImage2D(34069+ne,ge+1,Te,Je.width,Je.height,0,Q,ve,Je.data)}}else{ut?t.texSubImage2D(34069+ne,0,0,0,Q,ve,ce[ne]):t.texImage2D(34069+ne,0,Te,Q,ve,ce[ne]);for(let ge=0;ge<z.length;ge++){const ze=z[ge];ut?t.texSubImage2D(34069+ne,ge+1,0,0,Q,ve,ze.image[ne]):t.texImage2D(34069+ne,ge+1,Te,Q,ve,ze.image[ne])}}}M(T,N)&&E(34067),Oe.__version=Ee.version,T.onUpdate&&T.onUpdate(T)}P.__version=T.version}(te,P,T):t.bindTexture(34067,te.__webglTexture,33984+T)},this.rebindTextures=function De(P,T,te){const be=n.get(P);void 0!==T&&Se(be.__webglFramebuffer,P,P.texture,36064,3553),void 0!==te&&ue(P)},this.setupRenderTarget=function Xe(P){const T=P.texture,te=n.get(P),be=n.get(T);P.addEventListener("dispose",U),!0!==P.isWebGLMultipleRenderTargets&&(void 0===be.__webglTexture&&(be.__webglTexture=i.createTexture()),be.__version=T.version,o.memory.textures++);const Ee=!0===P.isWebGLCubeRenderTarget,Oe=!0===P.isWebGLMultipleRenderTargets,dt=x(P)||a;if(Ee){te.__webglFramebuffer=[];for(let Fe=0;Fe<6;Fe++)te.__webglFramebuffer[Fe]=i.createFramebuffer()}else{if(te.__webglFramebuffer=i.createFramebuffer(),Oe)if(r.drawBuffers){const Fe=P.texture;for(let ce=0,Ke=Fe.length;ce<Ke;ce++){const N=n.get(Fe[ce]);void 0===N.__webglTexture&&(N.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&P.samples>0&&!1===Ye(P)){const Fe=Oe?T:[T];te.__webglMultisampledFramebuffer=i.createFramebuffer(),te.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,te.__webglMultisampledFramebuffer);for(let ce=0;ce<Fe.length;ce++){const Ke=Fe[ce];te.__webglColorRenderbuffer[ce]=i.createRenderbuffer(),i.bindRenderbuffer(36161,te.__webglColorRenderbuffer[ce]);const N=s.convert(Ke.format,Ke.encoding),Q=s.convert(Ke.type),ve=b(Ke.internalFormat,N,Q,Ke.encoding,!0===P.isXRRenderTarget),Te=rt(P);i.renderbufferStorageMultisample(36161,Te,ve,P.width,P.height),i.framebufferRenderbuffer(36160,36064+ce,36161,te.__webglColorRenderbuffer[ce])}i.bindRenderbuffer(36161,null),P.depthBuffer&&(te.__webglDepthRenderbuffer=i.createRenderbuffer(),It(te.__webglDepthRenderbuffer,P,!0)),t.bindFramebuffer(36160,null)}}if(Ee){t.bindTexture(34067,be.__webglTexture),q(34067,T,dt);for(let Fe=0;Fe<6;Fe++)Se(te.__webglFramebuffer[Fe],P,T,36064,34069+Fe);M(T,dt)&&E(34067),t.unbindTexture()}else if(Oe){const Fe=P.texture;for(let ce=0,Ke=Fe.length;ce<Ke;ce++){const N=Fe[ce],Q=n.get(N);t.bindTexture(3553,Q.__webglTexture),q(3553,N,dt),Se(te.__webglFramebuffer,P,N,36064+ce,3553),M(N,dt)&&E(3553)}t.unbindTexture()}else{let Fe=3553;(P.isWebGL3DRenderTarget||P.isWebGLArrayRenderTarget)&&(a?Fe=P.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Fe,be.__webglTexture),q(Fe,T,dt),Se(te.__webglFramebuffer,P,T,36064,Fe),M(T,dt)&&E(Fe),t.unbindTexture()}P.depthBuffer&&ue(P)},this.updateRenderTargetMipmap=function Pe(P){const T=x(P)||a,te=!0===P.isWebGLMultipleRenderTargets?P.texture:[P.texture];for(let be=0,Ee=te.length;be<Ee;be++){const Oe=te[be];if(M(Oe,T)){const dt=P.isWebGLCubeRenderTarget?34067:3553,Fe=n.get(Oe).__webglTexture;t.bindTexture(dt,Fe),E(dt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function _t(P){if(a&&P.samples>0&&!1===Ye(P)){const T=P.isWebGLMultipleRenderTargets?P.texture:[P.texture],te=P.width,be=P.height;let Ee=16384;const Oe=[],dt=P.stencilBuffer?33306:36096,Fe=n.get(P),ce=!0===P.isWebGLMultipleRenderTargets;if(ce)for(let Ke=0;Ke<T.length;Ke++)t.bindFramebuffer(36160,Fe.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ke,36161,null),t.bindFramebuffer(36160,Fe.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ke,3553,null,0);t.bindFramebuffer(36008,Fe.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Fe.__webglFramebuffer);for(let Ke=0;Ke<T.length;Ke++){Oe.push(36064+Ke),P.depthBuffer&&Oe.push(dt);const N=void 0!==Fe.__ignoreDepthValues&&Fe.__ignoreDepthValues;if(!1===N&&(P.depthBuffer&&(Ee|=256),P.stencilBuffer&&(Ee|=1024)),ce&&i.framebufferRenderbuffer(36008,36064,36161,Fe.__webglColorRenderbuffer[Ke]),!0===N&&(i.invalidateFramebuffer(36008,[dt]),i.invalidateFramebuffer(36009,[dt])),ce){const Q=n.get(T[Ke]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,Q,0)}i.blitFramebuffer(0,0,te,be,0,0,te,be,Ee,9728),h&&i.invalidateFramebuffer(36008,Oe)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ce)for(let Ke=0;Ke<T.length;Ke++){t.bindFramebuffer(36160,Fe.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ke,36161,Fe.__webglColorRenderbuffer[Ke]);const N=n.get(T[Ke]).__webglTexture;t.bindFramebuffer(36160,Fe.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ke,3553,N,0)}t.bindFramebuffer(36009,Fe.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ue,this.setupFrameBufferTexture=Se,this.useMultisampledRTT=Ye}function vI(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===ca)return 5121;if(s===cA)return 32819;if(s===lA)return 32820;if(s===sA)return 5120;if(s===oA)return 5122;if(s===C0)return 5123;if(s===aA)return 5124;if(s===la)return 5125;if(s===Co)return 5126;if(s===Wl)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===uA)return 6406;if(s===Ir)return 6408;if(s===fA)return 6409;if(s===dA)return 6410;if(s===ua)return 6402;if(s===ic)return 34041;if(s===Em)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===hA)return 6403;if(s===pA)return 36244;if(s===mA)return 33319;if(s===gA)return 33320;if(s===_A)return 36249;if(s===gm||s===_m||s===ym||s===vm)if(o===rn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===gm)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===_m)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===ym)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===vm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===gm)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===_m)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===ym)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===vm)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===A0||s===I0||s===P0||s===R0){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===A0)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===I0)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===P0)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===R0)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===yA)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===L0||s===O0){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===L0)return o===rn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===O0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===N0||s===F0||s===k0||s===B0||s===U0||s===z0||s===V0||s===H0||s===G0||s===W0||s===j0||s===$0||s===q0||s===X0){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===N0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===F0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===k0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===B0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===U0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===z0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===V0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===H0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===G0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===W0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===j0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===$0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===q0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===X0)return o===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===xm){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===xm)return o===rn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(s===vA||s===Z0||s===Y0||s===K0){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(s===xm)return a.COMPRESSED_RED_RGTC1_EXT;if(s===Z0)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===Y0)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===K0)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===nc?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class xI extends Fn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ko extends wn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const u8={type:"move"};class Fx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ko,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ko,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new D,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new D),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ko,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new D,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new D),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const p of e.hand.values()){const g=t.getJointPose(p,n),y=this._getHandJoint(l,p);null!==g&&(y.matrix.fromArray(g.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=g.radius),y.visible=null!==g}const d=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),h=.02,m=.005;l.inputState.pinching&&d>h+m?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=h-m&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(u8)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new ko;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class bI extends Bi{constructor(e,t,n,r,s,o,a,c,l,u){if((u=void 0!==u?u:ua)!==ua&&u!==ic)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===ua&&(n=la),void 0===n&&u===ic&&(n=nc),super(null,r,s,o,a,c,u,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Yn,this.minFilter=void 0!==c?c:Yn,this.flipY=!1,this.generateMipmaps=!1}}class f8 extends no{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,f=null,d=null,h=null,m=null;const p=t.getContextAttributes();let g=null,y=null;const v=[],_=[],x=new Set,w=new Map,M=new Fn;M.layers.enable(1),M.viewport=new mn;const E=new Fn;E.layers.enable(2),E.viewport=new mn;const b=[M,E],S=new xI;S.layers.enable(1),S.layers.enable(2);let A=null,O=null;function U($){const me=_.indexOf($.inputSource);if(-1===me)return;const ye=v[me];void 0!==ye&&ye.dispatchEvent({type:$.type,data:$.inputSource})}function k(){r.removeEventListener("select",U),r.removeEventListener("selectstart",U),r.removeEventListener("selectend",U),r.removeEventListener("squeeze",U),r.removeEventListener("squeezestart",U),r.removeEventListener("squeezeend",U),r.removeEventListener("end",k),r.removeEventListener("inputsourceschange",L);for(let $=0;$<v.length;$++){const me=_[$];null!==me&&(_[$]=null,v[$].disconnect(me))}A=null,O=null,e.setRenderTarget(g),h=null,d=null,f=null,r=null,y=null,Le.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function L($){for(let me=0;me<$.removed.length;me++){const ye=$.removed[me],xe=_.indexOf(ye);xe>=0&&(_[xe]=null,v[xe].disconnect(ye))}for(let me=0;me<$.added.length;me++){const ye=$.added[me];let xe=_.indexOf(ye);if(-1===xe){for(let Ze=0;Ze<v.length;Ze++){if(Ze>=_.length){_.push(ye),xe=Ze;break}if(null===_[Ze]){_[Ze]=ye,xe=Ze;break}}if(-1===xe)break}const q=v[xe];q&&q.connect(ye)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($){let me=v[$];return void 0===me&&(me=new Fx,v[$]=me),me.getTargetRaySpace()},this.getControllerGrip=function($){let me=v[$];return void 0===me&&(me=new Fx,v[$]=me),me.getGripSpace()},this.getHand=function($){let me=v[$];return void 0===me&&(me=new Fx,v[$]=me),me.getHandSpace()},this.setFramebufferScaleFactor=function($){s=$,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($){a=$,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function($){l=$},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return f},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(){var $=nd(function*(me){if(r=me,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",U),r.addEventListener("selectstart",U),r.addEventListener("selectend",U),r.addEventListener("squeeze",U),r.addEventListener("squeezestart",U),r.addEventListener("squeezeend",U),r.addEventListener("end",k),r.addEventListener("inputsourceschange",L),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)h=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:h}),y=new Ps(h.framebufferWidth,h.framebufferHeight,{format:Ir,type:ca,encoding:e.outputEncoding,stencilBuffer:p.stencil});else{let ye=null,xe=null,q=null;p.depth&&(q=p.stencil?35056:33190,ye=p.stencil?ic:ua,xe=p.stencil?nc:la);const Ze={colorFormat:32856,depthFormat:q,scaleFactor:s};f=new XRWebGLBinding(r,t),d=f.createProjectionLayer(Ze),r.updateRenderState({layers:[d]}),y=new Ps(d.textureWidth,d.textureHeight,{format:Ir,type:ca,depthTexture:new bI(d.textureWidth,d.textureHeight,xe,void 0,void 0,void 0,void 0,void 0,void 0,ye),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=d.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),Le.setContext(r),Le.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(me){return $.apply(this,arguments)}}();const V=new D,Z=new D;function J($,me){null===me?$.matrixWorld.copy($.matrix):$.matrixWorld.multiplyMatrices(me.matrixWorld,$.matrix),$.matrixWorldInverse.copy($.matrixWorld).invert()}this.updateCamera=function($){if(null===r)return;S.near=E.near=M.near=$.near,S.far=E.far=M.far=$.far,(A!==S.near||O!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),A=S.near,O=S.far);const me=$.parent,ye=S.cameras;J(S,me);for(let q=0;q<ye.length;q++)J(ye[q],me);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),$.matrix.copy(S.matrix),$.matrix.decompose($.position,$.quaternion,$.scale);const xe=$.children;for(let q=0,Ze=xe.length;q<Ze;q++)xe[q].updateMatrixWorld(!0);2===ye.length?function ae($,me,ye){V.setFromMatrixPosition(me.matrixWorld),Z.setFromMatrixPosition(ye.matrixWorld);const xe=V.distanceTo(Z),q=me.projectionMatrix.elements,Ze=ye.projectionMatrix.elements,Ue=q[14]/(q[10]-1),$e=q[14]/(q[10]+1),Se=(q[9]+1)/q[5],It=(q[9]-1)/q[5],fe=(q[8]-1)/q[0],ue=(Ze[8]+1)/Ze[0],De=Ue*fe,Xe=Ue*ue,Pe=xe/(-fe+ue),_t=Pe*-fe;me.matrixWorld.decompose($.position,$.quaternion,$.scale),$.translateX(_t),$.translateZ(Pe),$.matrixWorld.compose($.position,$.quaternion,$.scale),$.matrixWorldInverse.copy($.matrixWorld).invert();const rt=Ue+Pe,Ye=$e+Pe;$.projectionMatrix.makePerspective(De-_t,Xe+(xe-_t),Se*$e/Ye*rt,It*$e/Ye*rt,rt,Ye)}(S,M,E):S.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==d||null!==h)return c},this.setFoveation=function($){c=$,null!==d&&(d.fixedFoveation=$),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=$)},this.getPlanes=function(){return x};let pe=null;const Le=new qA;Le.setAnimationLoop(function de($,me){if(u=me.getViewerPose(l||o),m=me,null!==u){const ye=u.views;null!==h&&(e.setRenderTargetFramebuffer(y,h.framebuffer),e.setRenderTarget(y));let xe=!1;ye.length!==S.cameras.length&&(S.cameras.length=0,xe=!0);for(let q=0;q<ye.length;q++){const Ze=ye[q];let Ue=null;if(null!==h)Ue=h.getViewport(Ze);else{const Se=f.getViewSubImage(d,Ze);Ue=Se.viewport,0===q&&(e.setRenderTargetTextures(y,Se.colorTexture,d.ignoreDepthValues?void 0:Se.depthStencilTexture),e.setRenderTarget(y))}let $e=b[q];void 0===$e&&($e=new Fn,$e.layers.enable(q),$e.viewport=new mn,b[q]=$e),$e.matrix.fromArray(Ze.transform.matrix),$e.projectionMatrix.fromArray(Ze.projectionMatrix),$e.viewport.set(Ue.x,Ue.y,Ue.width,Ue.height),0===q&&S.matrix.copy($e.matrix),!0===xe&&S.cameras.push($e)}}for(let ye=0;ye<v.length;ye++){const xe=_[ye],q=v[ye];null!==xe&&void 0!==q&&q.update(xe,me,l||o)}if(pe&&pe($,me),me.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:me.detectedPlanes});let ye=null;for(const xe of x)me.detectedPlanes.has(xe)||(null===ye&&(ye=[]),ye.push(xe));if(null!==ye)for(const xe of ye)x.delete(xe),w.delete(xe),n.dispatchEvent({type:"planeremoved",data:xe});for(const xe of me.detectedPlanes)if(x.has(xe)){const q=w.get(xe);xe.lastChangedTime>q&&(w.set(xe,xe.lastChangedTime),n.dispatchEvent({type:"planechanged",data:xe}))}else x.add(xe),w.set(xe,me.lastChangedTime),n.dispatchEvent({type:"planeadded",data:xe})}m=null}),this.setAnimationLoop=function($){pe=$},this.dispose=function(){}}}function d8(i,e){function r(p,g){p.opacity.value=g.opacity,g.color&&p.diffuse.value.copy(g.color),g.emissive&&p.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.bumpMap&&(p.bumpMap.value=g.bumpMap,p.bumpScale.value=g.bumpScale,g.side===yr&&(p.bumpScale.value*=-1)),g.displacementMap&&(p.displacementMap.value=g.displacementMap,p.displacementScale.value=g.displacementScale,p.displacementBias.value=g.displacementBias),g.emissiveMap&&(p.emissiveMap.value=g.emissiveMap),g.normalMap&&(p.normalMap.value=g.normalMap,p.normalScale.value.copy(g.normalScale),g.side===yr&&p.normalScale.value.negate()),g.specularMap&&(p.specularMap.value=g.specularMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest);const y=e.get(g).envMap;if(y&&(p.envMap.value=y,p.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,p.reflectivity.value=g.reflectivity,p.ior.value=g.ior,p.refractionRatio.value=g.refractionRatio),g.lightMap){p.lightMap.value=g.lightMap;const x=!0!==i.physicallyCorrectLights?Math.PI:1;p.lightMapIntensity.value=g.lightMapIntensity*x}let v,_;g.aoMap&&(p.aoMap.value=g.aoMap,p.aoMapIntensity.value=g.aoMapIntensity),g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix)),g.aoMap?_=g.aoMap:g.lightMap&&(_=g.lightMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uv2Transform.value.copy(_.matrix))}return{refreshFogUniforms:function t(p,g){g.color.getRGB(p.fogColor.value,GA(i)),g.isFog?(p.fogNear.value=g.near,p.fogFar.value=g.far):g.isFogExp2&&(p.fogDensity.value=g.density)},refreshMaterialUniforms:function n(p,g,y,v,_){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(p,g):g.isMeshToonMaterial?(r(p,g),function u(p,g){g.gradientMap&&(p.gradientMap.value=g.gradientMap)}(p,g)):g.isMeshPhongMaterial?(r(p,g),function l(p,g){p.specular.value.copy(g.specular),p.shininess.value=Math.max(g.shininess,1e-4)}(p,g)):g.isMeshStandardMaterial?(r(p,g),function f(p,g){p.roughness.value=g.roughness,p.metalness.value=g.metalness,g.roughnessMap&&(p.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(p.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(p.envMapIntensity.value=g.envMapIntensity)}(p,g),g.isMeshPhysicalMaterial&&function d(p,g,y){p.ior.value=g.ior,g.sheen>0&&(p.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),p.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(p.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(p.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(p.clearcoat.value=g.clearcoat,p.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(p.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),p.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===yr&&p.clearcoatNormalScale.value.negate())),g.iridescence>0&&(p.iridescence.value=g.iridescence,p.iridescenceIOR.value=g.iridescenceIOR,p.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(p.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(p.transmission.value=g.transmission,p.transmissionSamplerMap.value=y.texture,p.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(p.transmissionMap.value=g.transmissionMap),p.thickness.value=g.thickness,g.thicknessMap&&(p.thicknessMap.value=g.thicknessMap),p.attenuationDistance.value=g.attenuationDistance,p.attenuationColor.value.copy(g.attenuationColor)),p.specularIntensity.value=g.specularIntensity,p.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(p.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(p.specularColorMap.value=g.specularColorMap)}(p,g,_)):g.isMeshMatcapMaterial?(r(p,g),function h(p,g){g.matcap&&(p.matcap.value=g.matcap)}(p,g)):g.isMeshDepthMaterial?r(p,g):g.isMeshDistanceMaterial?(r(p,g),function m(p,g){p.referencePosition.value.copy(g.referencePosition),p.nearDistance.value=g.nearDistance,p.farDistance.value=g.farDistance}(p,g)):g.isMeshNormalMaterial?r(p,g):g.isLineBasicMaterial?(function s(p,g){p.diffuse.value.copy(g.color),p.opacity.value=g.opacity}(p,g),g.isLineDashedMaterial&&function o(p,g){p.dashSize.value=g.dashSize,p.totalSize.value=g.dashSize+g.gapSize,p.scale.value=g.scale}(p,g)):g.isPointsMaterial?function a(p,g,y,v){let _;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.size.value=g.size*y,p.scale.value=.5*v,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix))}(p,g,y,v):g.isSpriteMaterial?function c(p,g){let y;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.rotation.value=g.rotation,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uvTransform.value.copy(y.matrix))}(p,g):g.isShadowMaterial?(p.color.value.copy(g.color),p.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function h8(i,e,t,n){let r={},s={},o=[];const a=t.isWebGL2?i.getParameter(35375):0;function h(v,_,x){const w=v.value;if(void 0===x[_]){if("number"==typeof w)x[_]=w;else{const M=Array.isArray(w)?w:[w],E=[];for(let b=0;b<M.length;b++)E.push(M[b].clone());x[_]=E}return!0}if("number"==typeof w){if(x[_]!==w)return x[_]=w,!0}else{const M=Array.isArray(x[_])?x[_]:[x[_]],E=Array.isArray(w)?w:[w];for(let b=0;b<M.length;b++){const S=M[b];if(!1===S.equals(E[b]))return S.copy(E[b]),!0}}return!1}function p(v){const _={boundary:0,storage:0};return"number"==typeof v?(_.boundary=4,_.storage=4):v.isVector2?(_.boundary=8,_.storage=8):v.isVector3||v.isColor?(_.boundary=16,_.storage=12):v.isVector4?(_.boundary=16,_.storage=16):v.isMatrix3?(_.boundary=48,_.storage=48):v.isMatrix4?(_.boundary=64,_.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),_}function g(v){const _=v.target;_.removeEventListener("dispose",g);const x=o.indexOf(_.__bindingPointIndex);o.splice(x,1),i.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}return{bind:function c(v,_){n.uniformBlockBinding(v,_.program)},update:function l(v,_){let x=r[v.id];void 0===x&&(function m(v){const _=v.uniforms;let x=0;let M=0;for(let E=0,b=_.length;E<b;E++){const S=_[E],A={boundary:0,storage:0},O=Array.isArray(S.value)?S.value:[S.value];for(let U=0,k=O.length;U<k;U++){const V=p(O[U]);A.boundary+=V.boundary,A.storage+=V.storage}S.__data=new Float32Array(A.storage/Float32Array.BYTES_PER_ELEMENT),S.__offset=x,E>0&&(M=x%16,0!==M&&16-M-A.boundary<0&&(x+=16-M,S.__offset=x)),x+=A.storage}M=x%16,M>0&&(x+=16-M),v.__size=x,v.__cache={}}(v),x=function u(v){const _=function f(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=_;const x=i.createBuffer(),w=v.__size,M=v.usage;return i.bindBuffer(35345,x),i.bufferData(35345,w,M),i.bindBuffer(35345,null),i.bindBufferBase(35345,_,x),x}(v),r[v.id]=x,v.addEventListener("dispose",g)),n.updateUBOMapping(v,_.program);const M=e.render.frame;s[v.id]!==M&&(function d(v){const x=v.uniforms,w=v.__cache;i.bindBuffer(35345,r[v.id]);for(let M=0,E=x.length;M<E;M++){const b=x[M];if(!0===h(b,M,w)){const S=b.__offset,A=Array.isArray(b.value)?b.value:[b.value];let O=0;for(let U=0;U<A.length;U++){const k=A[U],L=p(k);"number"==typeof k?(b.__data[0]=k,i.bufferSubData(35345,S+O,b.__data)):k.isMatrix3?(b.__data[0]=k.elements[0],b.__data[1]=k.elements[1],b.__data[2]=k.elements[2],b.__data[3]=k.elements[0],b.__data[4]=k.elements[3],b.__data[5]=k.elements[4],b.__data[6]=k.elements[5],b.__data[7]=k.elements[0],b.__data[8]=k.elements[6],b.__data[9]=k.elements[7],b.__data[10]=k.elements[8],b.__data[11]=k.elements[0]):(k.toArray(b.__data,O),O+=L.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(35345,S,b.__data)}}i.bindBuffer(35345,null)}(v),s[v.id]=M)},dispose:function y(){for(const v in r)i.deleteBuffer(r[v]);o=[],r={},s={}}}}function Km(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function p8(){const i=fd("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,o=void 0===i.premultipliedAlpha||i.premultipliedAlpha,a=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,c=void 0!==i.powerPreference?i.powerPreference:"default",l=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let f=null,d=null;const h=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ao,this.physicallyCorrectLights=!1,this.toneMapping=Cs,this.toneMappingExposure=1;const p=this;let g=!1,y=0,v=0,_=null,x=-1,w=null;const M=new mn,E=new mn;let b=null,S=e.width,A=e.height,O=1,U=null,k=null;const L=new mn(0,0,S,A),V=new mn(0,0,S,A);let Z=!1;const ae=new $m;let J=!1,pe=!1,de=null;const Le=new gt,$=new oe,me=new D,ye={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function xe(){return null===_?O:1}let Ue,$e,Se,It,fe,ue,De,Xe,Pe,_t,rt,Ye,yn,cn,P,T,te,be,Ee,Oe,dt,Fe,ce,Ke,q=t;function Ze(I,X){for(let se=0;se<I.length;se++){const le=e.getContext(I[se],X);if(null!==le)return le}return null}try{const I={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:c,failIfMajorPerformanceCaveat:l};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${dm}`),e.addEventListener("webglcontextlost",ve,!1),e.addEventListener("webglcontextrestored",Te,!1),e.addEventListener("webglcontextcreationerror",ut,!1),null===q){const X=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&X.shift(),q=Ze(X,I),null===q)throw Ze(X)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===q.getShaderPrecisionFormat&&(q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(I){throw console.error("THREE.WebGLRenderer: "+I.message),I}function N(){Ue=new IW(q),$e=new SW(q,Ue,i),Ue.init($e),Fe=new vI(q,Ue,$e),Se=new c8(q,Ue,$e),It=new LW,fe=new Y6,ue=new l8(q,Ue,Se,fe,$e,Fe,It),De=new TW(p),Xe=new AW(p),Pe=new w4(q,$e),ce=new wW(q,Ue,Pe,$e),_t=new PW(q,Pe,It,ce),rt=new kW(q,_t,Pe,It),Ee=new FW(q,$e,ue),T=new EW(fe),Ye=new Z6(p,De,Xe,Ue,$e,ce,T),yn=new d8(p,fe),cn=new J6,P=new r8(Ue,$e),be=new bW(p,De,Xe,Se,rt,u,o),te=new a8(p,rt,$e),Ke=new h8(q,It,$e,Se),Oe=new MW(q,Ue,It,$e),dt=new RW(q,Ue,It,$e),It.programs=Ye.programs,p.capabilities=$e,p.extensions=Ue,p.properties=fe,p.renderLists=cn,p.shadowMap=te,p.state=Se,p.info=It}N();const Q=new f8(p,q);function ve(I){I.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Te(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const I=It.autoReset,X=te.enabled,se=te.autoUpdate,j=te.needsUpdate,le=te.type;N(),It.autoReset=I,te.enabled=X,te.autoUpdate=se,te.needsUpdate=j,te.type=le}function ut(I){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",I.statusMessage)}function $t(I){const X=I.target;X.removeEventListener("dispose",$t),function $n(I){(function z(I){const X=fe.get(I).programs;void 0!==X&&(X.forEach(function(se){Ye.releaseProgram(se)}),I.isShaderMaterial&&Ye.releaseShaderCache(I))})(I),fe.remove(I)}(X)}this.xr=Q,this.getContext=function(){return q},this.getContextAttributes=function(){return q.getContextAttributes()},this.forceContextLoss=function(){const I=Ue.get("WEBGL_lose_context");I&&I.loseContext()},this.forceContextRestore=function(){const I=Ue.get("WEBGL_lose_context");I&&I.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(I){void 0!==I&&(O=I,this.setSize(S,A,!1))},this.getSize=function(I){return I.set(S,A)},this.setSize=function(I,X,se){Q.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=I,A=X,e.width=Math.floor(I*O),e.height=Math.floor(X*O),!1!==se&&(e.style.width=I+"px",e.style.height=X+"px"),this.setViewport(0,0,I,X))},this.getDrawingBufferSize=function(I){return I.set(S*O,A*O).floor()},this.setDrawingBufferSize=function(I,X,se){S=I,A=X,O=se,e.width=Math.floor(I*se),e.height=Math.floor(X*se),this.setViewport(0,0,I,X)},this.getCurrentViewport=function(I){return I.copy(M)},this.getViewport=function(I){return I.copy(L)},this.setViewport=function(I,X,se,j){I.isVector4?L.set(I.x,I.y,I.z,I.w):L.set(I,X,se,j),Se.viewport(M.copy(L).multiplyScalar(O).floor())},this.getScissor=function(I){return I.copy(V)},this.setScissor=function(I,X,se,j){I.isVector4?V.set(I.x,I.y,I.z,I.w):V.set(I,X,se,j),Se.scissor(E.copy(V).multiplyScalar(O).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(I){Se.setScissorTest(Z=I)},this.setOpaqueSort=function(I){U=I},this.setTransparentSort=function(I){k=I},this.getClearColor=function(I){return I.copy(be.getClearColor())},this.setClearColor=function(){be.setClearColor.apply(be,arguments)},this.getClearAlpha=function(){return be.getClearAlpha()},this.setClearAlpha=function(){be.setClearAlpha.apply(be,arguments)},this.clear=function(I=!0,X=!0,se=!0){let j=0;I&&(j|=16384),X&&(j|=256),se&&(j|=1024),q.clear(j)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ve,!1),e.removeEventListener("webglcontextrestored",Te,!1),e.removeEventListener("webglcontextcreationerror",ut,!1),cn.dispose(),P.dispose(),fe.dispose(),De.dispose(),Xe.dispose(),rt.dispose(),ce.dispose(),Ke.dispose(),Ye.dispose(),Q.dispose(),Q.removeEventListener("sessionstart",ze),Q.removeEventListener("sessionend",Je),de&&(de.dispose(),de=null),dn.stop()},this.renderBufferDirect=function(I,X,se,j,le,ct){null===X&&(X=ye);const Dt=le.isMesh&&le.matrixWorld.determinant()<0,Ut=function Sq(I,X,se,j,le){!0!==X.isScene&&(X=ye),ue.resetTextureUnits();const ct=X.fog,Ut=null===_?p.outputEncoding:!0===_.isXRRenderTarget?_.texture.encoding:Ao,Ht=(j.isMeshStandardMaterial?Xe:De).get(j.envMap||(j.isMeshStandardMaterial?X.environment:null)),on=!0===j.vertexColors&&!!se.attributes.color&&4===se.attributes.color.itemSize,Jt=!!j.normalMap&&!!se.attributes.tangent,Qt=!!se.morphAttributes.position,pi=!!se.morphAttributes.normal,zr=!!se.morphAttributes.color,Zo=j.toneMapped?p.toneMapping:Cs,zc=se.morphAttributes.position||se.morphAttributes.normal||se.morphAttributes.color,mi=void 0!==zc?zc.length:0,en=fe.get(j),Rw=d.state.lights;!0!==J||!0!==pe&&I===w||T.setState(j,I,I===w&&j.id===x);let Ri=!1;j.version===en.__version?(en.needsLights&&en.lightsStateVersion!==Rw.state.version||en.outputEncoding!==Ut||le.isInstancedMesh&&!1===en.instancing||!le.isInstancedMesh&&!0===en.instancing||le.isSkinnedMesh&&!1===en.skinning||!le.isSkinnedMesh&&!0===en.skinning||en.envMap!==Ht||!0===j.fog&&en.fog!==ct||void 0!==en.numClippingPlanes&&(en.numClippingPlanes!==T.numPlanes||en.numIntersection!==T.numIntersection)||en.vertexAlphas!==on||en.vertexTangents!==Jt||en.morphTargets!==Qt||en.morphNormals!==pi||en.morphColors!==zr||en.toneMapping!==Zo||!0===$e.isWebGL2&&en.morphTargetsCount!==mi)&&(Ri=!0):(Ri=!0,en.__version=j.version);let Vc=en.currentProgram;!0===Ri&&(Vc=ds(j,X,le));let qL=!1,xh=!1,Lw=!1;const lr=Vc.getUniforms(),Hc=en.uniforms;if(Se.useProgram(Vc.program)&&(qL=!0,xh=!0,Lw=!0),j.id!==x&&(x=j.id,xh=!0),qL||w!==I){if(lr.setValue(q,"projectionMatrix",I.projectionMatrix),$e.logarithmicDepthBuffer&&lr.setValue(q,"logDepthBufFC",2/(Math.log(I.far+1)/Math.LN2)),w!==I&&(w=I,xh=!0,Lw=!0),j.isShaderMaterial||j.isMeshPhongMaterial||j.isMeshToonMaterial||j.isMeshStandardMaterial||j.envMap){const Vr=lr.map.cameraPosition;void 0!==Vr&&Vr.setValue(q,me.setFromMatrixPosition(I.matrixWorld))}(j.isMeshPhongMaterial||j.isMeshToonMaterial||j.isMeshLambertMaterial||j.isMeshBasicMaterial||j.isMeshStandardMaterial||j.isShaderMaterial)&&lr.setValue(q,"isOrthographic",!0===I.isOrthographicCamera),(j.isMeshPhongMaterial||j.isMeshToonMaterial||j.isMeshLambertMaterial||j.isMeshBasicMaterial||j.isMeshStandardMaterial||j.isShaderMaterial||j.isShadowMaterial||le.isSkinnedMesh)&&lr.setValue(q,"viewMatrix",I.matrixWorldInverse)}if(le.isSkinnedMesh){lr.setOptional(q,le,"bindMatrix"),lr.setOptional(q,le,"bindMatrixInverse");const Vr=le.skeleton;Vr&&($e.floatVertexTextures?(null===Vr.boneTexture&&Vr.computeBoneTexture(),lr.setValue(q,"boneTexture",Vr.boneTexture,ue),lr.setValue(q,"boneTextureSize",Vr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Ow=se.morphAttributes;if((void 0!==Ow.position||void 0!==Ow.normal||void 0!==Ow.color&&!0===$e.isWebGL2)&&Ee.update(le,se,j,Vc),(xh||en.receiveShadow!==le.receiveShadow)&&(en.receiveShadow=le.receiveShadow,lr.setValue(q,"receiveShadow",le.receiveShadow)),j.isMeshGouraudMaterial&&null!==j.envMap&&(Hc.envMap.value=Ht,Hc.flipEnvMap.value=Ht.isCubeTexture&&!1===Ht.isRenderTargetTexture?-1:1),xh&&(lr.setValue(q,"toneMappingExposure",p.toneMappingExposure),en.needsLights&&function Eq(I,X){I.ambientLightColor.needsUpdate=X,I.lightProbe.needsUpdate=X,I.directionalLights.needsUpdate=X,I.directionalLightShadows.needsUpdate=X,I.pointLights.needsUpdate=X,I.pointLightShadows.needsUpdate=X,I.spotLights.needsUpdate=X,I.spotLightShadows.needsUpdate=X,I.rectAreaLights.needsUpdate=X,I.hemisphereLights.needsUpdate=X}(Hc,Lw),ct&&!0===j.fog&&yn.refreshFogUniforms(Hc,ct),yn.refreshMaterialUniforms(Hc,j,O,A,de),Ym.upload(q,en.uniformsList,Hc,ue)),j.isShaderMaterial&&!0===j.uniformsNeedUpdate&&(Ym.upload(q,en.uniformsList,Hc,ue),j.uniformsNeedUpdate=!1),j.isSpriteMaterial&&lr.setValue(q,"center",le.center),lr.setValue(q,"modelViewMatrix",le.modelViewMatrix),lr.setValue(q,"normalMatrix",le.normalMatrix),lr.setValue(q,"modelMatrix",le.matrixWorld),j.isShaderMaterial||j.isRawShaderMaterial){const Vr=j.uniformsGroups;for(let Nw=0,Dq=Vr.length;Nw<Dq;Nw++)if($e.isWebGL2){const XL=Vr[Nw];Ke.update(XL,Vc),Ke.bind(XL,Vc)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Vc}(I,X,se,j,le);Se.setMaterial(j,Dt);let Ht=se.index,on=1;!0===j.wireframe&&(Ht=_t.getWireframeAttribute(se),on=2);const Jt=se.drawRange,Qt=se.attributes.position;let pi=Jt.start*on,zr=(Jt.start+Jt.count)*on;null!==ct&&(pi=Math.max(pi,ct.start*on),zr=Math.min(zr,(ct.start+ct.count)*on)),null!==Ht?(pi=Math.max(pi,0),zr=Math.min(zr,Ht.count)):null!=Qt&&(pi=Math.max(pi,0),zr=Math.min(zr,Qt.count));const Zo=zr-pi;if(Zo<0||Zo===1/0)return;ce.setup(le,j,Ut,se,Ht);let zc,mi=Oe;if(null!==Ht&&(zc=Pe.get(Ht),mi=dt,mi.setIndex(zc)),le.isMesh)!0===j.wireframe?(Se.setLineWidth(j.wireframeLinewidth*xe()),mi.setMode(1)):mi.setMode(4);else if(le.isLine){let en=j.linewidth;void 0===en&&(en=1),Se.setLineWidth(en*xe()),mi.setMode(le.isLineSegments?1:le.isLineLoop?2:3)}else le.isPoints?mi.setMode(0):le.isSprite&&mi.setMode(4);if(le.isInstancedMesh)mi.renderInstances(pi,Zo,le.count);else if(se.isInstancedBufferGeometry){const Rw=Math.min(se.instanceCount,void 0!==se._maxInstanceCount?se._maxInstanceCount:1/0);mi.renderInstances(pi,Zo,Rw)}else mi.render(pi,Zo)},this.compile=function(I,X){function se(j,le,ct){!0===j.transparent&&j.side===eo&&!1===j.forceSinglePass?(j.side=yr,j.needsUpdate=!0,ds(j,le,ct),j.side=Qs,j.needsUpdate=!0,ds(j,le,ct),j.side=eo):ds(j,le,ct)}d=P.get(I),d.init(),m.push(d),I.traverseVisible(function(j){j.isLight&&j.layers.test(X.layers)&&(d.pushLight(j),j.castShadow&&d.pushShadow(j))}),d.setupLights(p.physicallyCorrectLights),I.traverse(function(j){const le=j.material;if(le)if(Array.isArray(le))for(let ct=0;ct<le.length;ct++)se(le[ct],I,j);else se(le,I,j)}),m.pop(),d=null};let ne=null;function ze(){dn.stop()}function Je(){dn.start()}const dn=new qA;function Pi(I,X,se,j){if(!1===I.visible)return;if(I.layers.test(X.layers))if(I.isGroup)se=I.renderOrder;else if(I.isLOD)!0===I.autoUpdate&&I.update(X);else if(I.isLight)d.pushLight(I),I.castShadow&&d.pushShadow(I);else if(I.isSprite){if(!I.frustumCulled||ae.intersectsSprite(I)){j&&me.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Le);const Dt=rt.update(I),Ut=I.material;Ut.visible&&f.push(I,Dt,Ut,se,me.z,null)}}else if((I.isMesh||I.isLine||I.isPoints)&&(I.isSkinnedMesh&&I.skeleton.frame!==It.render.frame&&(I.skeleton.update(),I.skeleton.frame=It.render.frame),!I.frustumCulled||ae.intersectsObject(I))){j&&me.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Le);const Dt=rt.update(I),Ut=I.material;if(Array.isArray(Ut)){const Ht=Dt.groups;for(let on=0,Jt=Ht.length;on<Jt;on++){const Qt=Ht[on],pi=Ut[Qt.materialIndex];pi&&pi.visible&&f.push(I,Dt,pi,se,me.z,Qt)}}else Ut.visible&&f.push(I,Dt,Ut,se,me.z,null)}const ct=I.children;for(let Dt=0,Ut=ct.length;Dt<Ut;Dt++)Pi(ct[Dt],X,se,j)}function Yi(I,X,se,j){const le=I.opaque,ct=I.transmissive,Dt=I.transparent;d.setupLightsView(se),!0===J&&T.setGlobalState(p.clippingPlanes,se),ct.length>0&&function Uc(I,X,se){const j=$e.isWebGL2;null===de&&(de=new Ps(1,1,{generateMipmaps:!0,type:Ue.has("EXT_color_buffer_half_float")?Wl:ca,minFilter:to,samples:j&&!0===s?4:0})),p.getDrawingBufferSize($),j?de.setSize($.x,$.y):de.setSize(Tm($.x),Tm($.y));const le=p.getRenderTarget();p.setRenderTarget(de),p.clear();const ct=p.toneMapping;p.toneMapping=Cs,Bn(I,X,se),p.toneMapping=ct,ue.updateMultisampleRenderTarget(de),ue.updateRenderTargetMipmap(de),p.setRenderTarget(le)}(le,X,se),j&&Se.viewport(M.copy(j)),le.length>0&&Bn(le,X,se),ct.length>0&&Bn(ct,X,se),Dt.length>0&&Bn(Dt,X,se),Se.buffers.depth.setTest(!0),Se.buffers.depth.setMask(!0),Se.buffers.color.setMask(!0),Se.setPolygonOffset(!1)}function Bn(I,X,se){const j=!0===X.isScene?X.overrideMaterial:null;for(let le=0,ct=I.length;le<ct;le++){const Dt=I[le],Ut=Dt.object,Ht=Dt.geometry,on=null===j?Dt.material:j,Jt=Dt.group;Ut.layers.test(se.layers)&&Xo(Ut,X,se,Ht,on,Jt)}}function Xo(I,X,se,j,le,ct){I.onBeforeRender(p,X,se,j,le,ct),I.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,I.matrixWorld),I.normalMatrix.getNormalMatrix(I.modelViewMatrix),le.onBeforeRender(p,X,se,j,I,ct),!0===le.transparent&&le.side===eo&&!1===le.forceSinglePass?(le.side=yr,le.needsUpdate=!0,p.renderBufferDirect(se,X,j,le,I,ct),le.side=Qs,le.needsUpdate=!0,p.renderBufferDirect(se,X,j,le,I,ct),le.side=eo):p.renderBufferDirect(se,X,j,le,I,ct),I.onAfterRender(p,X,se,j,le,ct)}function ds(I,X,se){!0!==X.isScene&&(X=ye);const j=fe.get(I),le=d.state.lights,Dt=le.state.version,Ut=Ye.getParameters(I,le.state,d.state.shadowsArray,X,se),Ht=Ye.getProgramCacheKey(Ut);let on=j.programs;j.environment=I.isMeshStandardMaterial?X.environment:null,j.fog=X.fog,j.envMap=(I.isMeshStandardMaterial?Xe:De).get(I.envMap||j.environment),void 0===on&&(I.addEventListener("dispose",$t),on=new Map,j.programs=on);let Jt=on.get(Ht);if(void 0!==Jt){if(j.currentProgram===Jt&&j.lightsStateVersion===Dt)return $L(I,Ut),Jt}else Ut.uniforms=Ye.getUniforms(I),I.onBuild(se,Ut,p),I.onBeforeCompile(Ut,p),Jt=Ye.acquireProgram(Ut,Ht),on.set(Ht,Jt),j.uniforms=Ut.uniforms;const Qt=j.uniforms;(!I.isShaderMaterial&&!I.isRawShaderMaterial||!0===I.clipping)&&(Qt.clippingPlanes=T.uniform),$L(I,Ut),j.needsLights=function Tq(I){return I.isMeshLambertMaterial||I.isMeshToonMaterial||I.isMeshPhongMaterial||I.isMeshStandardMaterial||I.isShadowMaterial||I.isShaderMaterial&&!0===I.lights}(I),j.lightsStateVersion=Dt,j.needsLights&&(Qt.ambientLightColor.value=le.state.ambient,Qt.lightProbe.value=le.state.probe,Qt.directionalLights.value=le.state.directional,Qt.directionalLightShadows.value=le.state.directionalShadow,Qt.spotLights.value=le.state.spot,Qt.spotLightShadows.value=le.state.spotShadow,Qt.rectAreaLights.value=le.state.rectArea,Qt.ltc_1.value=le.state.rectAreaLTC1,Qt.ltc_2.value=le.state.rectAreaLTC2,Qt.pointLights.value=le.state.point,Qt.pointLightShadows.value=le.state.pointShadow,Qt.hemisphereLights.value=le.state.hemi,Qt.directionalShadowMap.value=le.state.directionalShadowMap,Qt.directionalShadowMatrix.value=le.state.directionalShadowMatrix,Qt.spotShadowMap.value=le.state.spotShadowMap,Qt.spotLightMatrix.value=le.state.spotLightMatrix,Qt.spotLightMap.value=le.state.spotLightMap,Qt.pointShadowMap.value=le.state.pointShadowMap,Qt.pointShadowMatrix.value=le.state.pointShadowMatrix);const pi=Jt.getUniforms(),zr=Ym.seqWithValue(pi.seq,Qt);return j.currentProgram=Jt,j.uniformsList=zr,Jt}function $L(I,X){const se=fe.get(I);se.outputEncoding=X.outputEncoding,se.instancing=X.instancing,se.skinning=X.skinning,se.morphTargets=X.morphTargets,se.morphNormals=X.morphNormals,se.morphColors=X.morphColors,se.morphTargetsCount=X.morphTargetsCount,se.numClippingPlanes=X.numClippingPlanes,se.numIntersection=X.numClipIntersection,se.vertexAlphas=X.vertexAlphas,se.vertexTangents=X.vertexTangents,se.toneMapping=X.toneMapping}dn.setAnimationLoop(function ge(I){ne&&ne(I)}),typeof self<"u"&&dn.setContext(self),this.setAnimationLoop=function(I){ne=I,Q.setAnimationLoop(I),null===I?dn.stop():dn.start()},Q.addEventListener("sessionstart",ze),Q.addEventListener("sessionend",Je),this.render=function(I,X){if(void 0===X||!0===X.isCamera){if(!0!==g){if(!0===I.matrixWorldAutoUpdate&&I.updateMatrixWorld(),null===X.parent&&!0===X.matrixWorldAutoUpdate&&X.updateMatrixWorld(),!0===Q.enabled&&!0===Q.isPresenting&&(!0===Q.cameraAutoUpdate&&Q.updateCamera(X),X=Q.getCamera()),!0===I.isScene&&I.onBeforeRender(p,I,X,_),d=P.get(I,m.length),d.init(),m.push(d),Le.multiplyMatrices(X.projectionMatrix,X.matrixWorldInverse),ae.setFromProjectionMatrix(Le),pe=this.localClippingEnabled,J=T.init(this.clippingPlanes,pe),f=cn.get(I,h.length),f.init(),h.push(f),Pi(I,X,0,p.sortObjects),f.finish(),!0===p.sortObjects&&f.sort(U,k),!0===J&&T.beginShadows(),te.render(d.state.shadowsArray,I,X),!0===J&&T.endShadows(),!0===this.info.autoReset&&this.info.reset(),be.render(f,I),d.setupLights(p.physicallyCorrectLights),X.isArrayCamera){const j=X.cameras;for(let le=0,ct=j.length;le<ct;le++){const Dt=j[le];Yi(f,I,Dt,Dt.viewport)}}else Yi(f,I,X);null!==_&&(ue.updateMultisampleRenderTarget(_),ue.updateRenderTargetMipmap(_)),!0===I.isScene&&I.onAfterRender(p,I,X),ce.resetDefaultState(),x=-1,w=null,m.pop(),d=m.length>0?m[m.length-1]:null,h.pop(),f=h.length>0?h[h.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(I,X,se){fe.get(I.texture).__webglTexture=X,fe.get(I.depthTexture).__webglTexture=se;const j=fe.get(I);j.__hasExternalTextures=!0,j.__hasExternalTextures&&(j.__autoAllocateDepthBuffer=void 0===se,j.__autoAllocateDepthBuffer||!0===Ue.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),j.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(I,X){const se=fe.get(I);se.__webglFramebuffer=X,se.__useDefaultFramebuffer=void 0===X},this.setRenderTarget=function(I,X=0,se=0){_=I,y=X,v=se;let j=!0,le=null,ct=!1,Dt=!1;if(I){const Ht=fe.get(I);void 0!==Ht.__useDefaultFramebuffer?(Se.bindFramebuffer(36160,null),j=!1):void 0===Ht.__webglFramebuffer?ue.setupRenderTarget(I):Ht.__hasExternalTextures&&ue.rebindTextures(I,fe.get(I.texture).__webglTexture,fe.get(I.depthTexture).__webglTexture);const on=I.texture;(on.isData3DTexture||on.isDataArrayTexture||on.isCompressedArrayTexture)&&(Dt=!0);const Jt=fe.get(I).__webglFramebuffer;I.isWebGLCubeRenderTarget?(le=Jt[X],ct=!0):le=$e.isWebGL2&&I.samples>0&&!1===ue.useMultisampledRTT(I)?fe.get(I).__webglMultisampledFramebuffer:Jt,M.copy(I.viewport),E.copy(I.scissor),b=I.scissorTest}else M.copy(L).multiplyScalar(O).floor(),E.copy(V).multiplyScalar(O).floor(),b=Z;if(Se.bindFramebuffer(36160,le)&&$e.drawBuffers&&j&&Se.drawBuffers(I,le),Se.viewport(M),Se.scissor(E),Se.setScissorTest(b),ct){const Ht=fe.get(I.texture);q.framebufferTexture2D(36160,36064,34069+X,Ht.__webglTexture,se)}else if(Dt){const Ht=fe.get(I.texture);q.framebufferTextureLayer(36160,36064,Ht.__webglTexture,se||0,X||0)}x=-1},this.readRenderTargetPixels=function(I,X,se,j,le,ct,Dt){if(!I||!I.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ut=fe.get(I).__webglFramebuffer;if(I.isWebGLCubeRenderTarget&&void 0!==Dt&&(Ut=Ut[Dt]),Ut){Se.bindFramebuffer(36160,Ut);try{const Ht=I.texture,on=Ht.format,Jt=Ht.type;if(on!==Ir&&Fe.convert(on)!==q.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Qt=Jt===Wl&&(Ue.has("EXT_color_buffer_half_float")||$e.isWebGL2&&Ue.has("EXT_color_buffer_float"));if(!(Jt===ca||Fe.convert(Jt)===q.getParameter(35738)||Jt===Co&&($e.isWebGL2||Ue.has("OES_texture_float")||Ue.has("WEBGL_color_buffer_float"))||Qt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");X>=0&&X<=I.width-j&&se>=0&&se<=I.height-le&&q.readPixels(X,se,j,le,Fe.convert(on),Fe.convert(Jt),ct)}finally{const Ht=null!==_?fe.get(_).__webglFramebuffer:null;Se.bindFramebuffer(36160,Ht)}}},this.copyFramebufferToTexture=function(I,X,se=0){const j=Math.pow(2,-se),le=Math.floor(X.image.width*j),ct=Math.floor(X.image.height*j);ue.setTexture2D(X,0),q.copyTexSubImage2D(3553,se,0,0,I.x,I.y,le,ct),Se.unbindTexture()},this.copyTextureToTexture=function(I,X,se,j=0){const le=X.image.width,ct=X.image.height,Dt=Fe.convert(se.format),Ut=Fe.convert(se.type);ue.setTexture2D(se,0),q.pixelStorei(37440,se.flipY),q.pixelStorei(37441,se.premultiplyAlpha),q.pixelStorei(3317,se.unpackAlignment),X.isDataTexture?q.texSubImage2D(3553,j,I.x,I.y,le,ct,Dt,Ut,X.image.data):X.isCompressedTexture?q.compressedTexSubImage2D(3553,j,I.x,I.y,X.mipmaps[0].width,X.mipmaps[0].height,Dt,X.mipmaps[0].data):q.texSubImage2D(3553,j,I.x,I.y,Dt,Ut,X.image),0===j&&se.generateMipmaps&&q.generateMipmap(3553),Se.unbindTexture()},this.copyTextureToTexture3D=function(I,X,se,j,le=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const ct=I.max.x-I.min.x+1,Dt=I.max.y-I.min.y+1,Ut=I.max.z-I.min.z+1,Ht=Fe.convert(j.format),on=Fe.convert(j.type);let Jt;if(j.isData3DTexture)ue.setTexture3D(j,0),Jt=32879;else{if(!j.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ue.setTexture2DArray(j,0),Jt=35866}q.pixelStorei(37440,j.flipY),q.pixelStorei(37441,j.premultiplyAlpha),q.pixelStorei(3317,j.unpackAlignment);const Qt=q.getParameter(3314),pi=q.getParameter(32878),zr=q.getParameter(3316),Zo=q.getParameter(3315),zc=q.getParameter(32877),mi=se.isCompressedTexture?se.mipmaps[0]:se.image;q.pixelStorei(3314,mi.width),q.pixelStorei(32878,mi.height),q.pixelStorei(3316,I.min.x),q.pixelStorei(3315,I.min.y),q.pixelStorei(32877,I.min.z),se.isDataTexture||se.isData3DTexture?q.texSubImage3D(Jt,le,X.x,X.y,X.z,ct,Dt,Ut,Ht,on,mi.data):se.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),q.compressedTexSubImage3D(Jt,le,X.x,X.y,X.z,ct,Dt,Ut,Ht,mi.data)):q.texSubImage3D(Jt,le,X.x,X.y,X.z,ct,Dt,Ut,Ht,on,mi),q.pixelStorei(3314,Qt),q.pixelStorei(32878,pi),q.pixelStorei(3316,zr),q.pixelStorei(3315,Zo),q.pixelStorei(32877,zc),0===le&&j.generateMipmaps&&q.generateMipmap(Jt),Se.unbindTexture()},this.initTexture=function(I){I.isCubeTexture?ue.setTextureCube(I,0):I.isData3DTexture?ue.setTexture3D(I,0):I.isDataArrayTexture||I.isCompressedArrayTexture?ue.setTexture2DArray(I,0):ue.setTexture2D(I,0),Se.unbindTexture()},this.resetState=function(){y=0,v=0,_=null,Se.reset(),ce.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class wI extends Km{}wI.prototype.isWebGL1Renderer=!0;class Jm{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Re(e),this.density=t}clone(){return new Jm(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Qm{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Re(e),this.near=t,this.far=n}clone(){return new Qm(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class eg extends wn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class wd{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=cd,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Pr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Pr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Pr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const cr=new D;class xa{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)cr.fromBufferAttribute(this,t),cr.applyMatrix4(e),this.setXYZ(t,cr.x,cr.y,cr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)cr.fromBufferAttribute(this,t),cr.applyNormalMatrix(e),this.setXYZ(t,cr.x,cr.y,cr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)cr.fromBufferAttribute(this,t),cr.transformDirection(e),this.setXYZ(t,cr.x,cr.y,cr.z);return this}setX(e,t){return this.normalized&&(t=bn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=bn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=bn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=bn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Io(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Io(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Io(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Io(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=bn(t,this.array),n=bn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=bn(t,this.array),n=bn(n,this.array),r=bn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=bn(t,this.array),n=bn(n,this.array),r=bn(r,this.array),s=bn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new fn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xa(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class kx extends wi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Re(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let du;const Md=new D,hu=new D,pu=new D,mu=new oe,Sd=new oe,MI=new gt,tg=new D,Ed=new D,ng=new D,SI=new oe,Bx=new oe,EI=new oe;class TI extends wn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===du){du=new Nt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new wd(t,5);du.setIndex([0,1,2,0,2,3]),du.setAttribute("position",new xa(n,3,0,!1)),du.setAttribute("uv",new xa(n,2,3,!1))}this.geometry=du,this.material=void 0!==e?e:new kx,this.center=new oe(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),hu.setFromMatrixScale(this.matrixWorld),MI.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),pu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&hu.multiplyScalar(-pu.z);const n=this.material.rotation;let r,s;0!==n&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;ig(tg.set(-.5,-.5,0),pu,o,hu,r,s),ig(Ed.set(.5,-.5,0),pu,o,hu,r,s),ig(ng.set(.5,.5,0),pu,o,hu,r,s),SI.set(0,0),Bx.set(1,0),EI.set(1,1);let a=e.ray.intersectTriangle(tg,Ed,ng,!1,Md);if(null===a&&(ig(Ed.set(-.5,.5,0),pu,o,hu,r,s),Bx.set(0,1),a=e.ray.intersectTriangle(tg,ng,Ed,!1,Md),null===a))return;const c=e.ray.origin.distanceTo(Md);c<e.near||c>e.far||t.push({distance:c,point:Md.clone(),uv:ts.getUV(Md,tg,Ed,ng,SI,Bx,EI,new oe),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function ig(i,e,t,n,r,s){mu.subVectors(i,t).addScalar(.5).multiply(n),void 0!==r?(Sd.x=s*mu.x-r*mu.y,Sd.y=r*mu.x+s*mu.y):Sd.copy(mu),i.copy(e),i.x+=Sd.x,i.y+=Sd.y,i.applyMatrix4(MI)}const rg=new D,DI=new D;class CI extends wn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){rg.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(rg);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){rg.setFromMatrixPosition(e.matrixWorld),DI.setFromMatrixPosition(this.matrixWorld);const n=rg.distanceTo(DI)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),!(n>=o))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const AI=new D,II=new mn,PI=new mn,m8=new D,RI=new gt;class Ux extends Kn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new gt,this.bindMatrixInverse=new gt}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new mn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;II.fromBufferAttribute(r.attributes.skinIndex,e),PI.fromBufferAttribute(r.attributes.skinWeight,e),AI.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=PI.getComponent(s);if(0!==o){const a=II.getComponent(s);RI.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(m8.copy(AI).applyMatrix4(RI),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class sg extends wn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class gu extends Bi{constructor(e=null,t=1,n=1,r,s,o,a,c,l=Yn,u=Yn,f,d){super(null,o,a,c,l,u,r,s,f,d),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const LI=new gt,g8=new gt;class Td{constructor(e=[],t=[]){this.uuid=Pr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new gt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new gt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)LI.multiplyMatrices(e[s]?e[s].matrixWorld:g8,t[s]),LI.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Td(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=AA(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new gu(t,e,e,Ir,Co);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new sg),this.bones.push(o),this.boneInverses.push((new gt).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class _u extends fn{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const OI=new gt,NI=new gt,og=[],_8=new gt,Dd=new Kn;class zx extends Kn{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new _u(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,_8)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Dd.geometry=this.geometry,Dd.material=this.material,void 0!==Dd.material)for(let s=0;s<r;s++){this.getMatrixAt(s,OI),NI.multiplyMatrices(n,OI),Dd.matrixWorld=NI,Dd.raycast(e,og);for(let o=0,a=og.length;o<a;o++){const c=og[o];c.instanceId=s,c.object=this,t.push(c)}og.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new _u(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class $i extends wi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Re(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const FI=new D,kI=new D,BI=new gt,Vx=new pd,ag=new ma;class Bo extends wn{constructor(e=new Nt,t=new $i){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)FI.fromBufferAttribute(t,r-1),kI.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=FI.distanceTo(kI);e.setAttribute("lineDistance",new We(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ag.copy(n.boundingSphere),ag.applyMatrix4(r),ag.radius+=s,!1===e.ray.intersectsSphere(ag))return;BI.copy(r).invert(),Vx.copy(e.ray).applyMatrix4(BI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=new D,u=new D,f=new D,d=new D,h=this.isLineSegments?2:1,m=n.index,g=n.attributes.position;if(null!==m)for(let _=Math.max(0,o.start),x=Math.min(m.count,o.start+o.count)-1;_<x;_+=h){const w=m.getX(_),M=m.getX(_+1);if(l.fromBufferAttribute(g,w),u.fromBufferAttribute(g,M),Vx.distanceSqToSegment(l,u,d,f)>c)continue;d.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(d);b<e.near||b>e.far||t.push({distance:b,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}else for(let _=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count)-1;_<x;_+=h){if(l.fromBufferAttribute(g,_),u.fromBufferAttribute(g,_+1),Vx.distanceSqToSegment(l,u,d,f)>c)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||t.push({distance:M,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const UI=new D,zI=new D;class Ns extends Bo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)UI.fromBufferAttribute(t,r),zI.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+UI.distanceTo(zI);e.setAttribute("lineDistance",new We(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Hx extends Bo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class cg extends wi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Re(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const VI=new gt,Gx=new pd,lg=new ma,ug=new D;class Wx extends wn{constructor(e=new Nt,t=new cg){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),lg.copy(n.boundingSphere),lg.applyMatrix4(r),lg.radius+=s,!1===e.ray.intersectsSphere(lg))return;VI.copy(r).invert(),Gx.copy(e.ray).applyMatrix4(VI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=n.index,f=n.attributes.position;if(null!==l)for(let m=Math.max(0,o.start),p=Math.min(l.count,o.start+o.count);m<p;m++){const g=l.getX(m);ug.fromBufferAttribute(f,g),HI(ug,g,c,r,e,t,this)}else for(let m=Math.max(0,o.start),p=Math.min(f.count,o.start+o.count);m<p;m++)ug.fromBufferAttribute(f,m),HI(ug,m,c,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function HI(i,e,t,n,r,s,o){const a=Gx.distanceSqToPoint(i);if(a<t){const c=new D;Gx.closestPointToPoint(i,c),c.applyMatrix4(n);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class y8 extends Bi{constructor(e,t,n,r,s,o,a,c,l){super(e,t,n,r,s,o,a,c,l),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:Hn,this.magFilter=void 0!==s?s:Hn,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class v8 extends Bi{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=Yn,this.minFilter=Yn,this.generateMipmaps=!1,this.needsUpdate=!0}}class jx extends Bi{constructor(e,t,n,r,s,o,a,c,l,u,f,d){super(null,o,a,c,l,u,r,s,f,d),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class x8 extends jx{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=ki}}class b8 extends Bi{constructor(e,t,n,r,s,o,a,c,l){super(e,t,n,r,s,o,a,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Fs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let o;o=t||e*n[s-1];let l,a=0,c=s-1;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=n[r]-o,l<0)a=r+1;else{if(!(l>0)){c=r;break}c=r-1}if(r=c,n[r]===o)return r/(s-1);const u=n[r];return(r+(o-u)/(n[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new oe:new D);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new D,r=[],s=[],o=[],a=new D,c=new gt;for(let h=0;h<=e;h++)r[h]=this.getTangentAt(h/e,new D);s[0]=new D,o[0]=new D;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),f=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,n.set(1,0,0)),f<=l&&(l=f,n.set(0,1,0)),d<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let h=1;h<=e;h++){if(s[h]=s[h-1].clone(),o[h]=o[h-1].clone(),a.crossVectors(r[h-1],r[h]),a.length()>Number.EPSILON){a.normalize();const m=Math.acos(ri(r[h-1].dot(r[h]),-1,1));s[h].applyMatrix4(c.makeRotationAxis(a,m))}o[h].crossVectors(r[h],s[h])}if(!0===t){let h=Math.acos(ri(s[0].dot(s[e]),-1,1));h/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(h=-h);for(let m=1;m<=e;m++)s[m].applyMatrix4(c.makeRotationAxis(r[m],h*m)),o[m].crossVectors(r[m],s[m])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class fg extends Fs{constructor(e=0,t=0,n=1,r=1,s=0,o=2*Math.PI,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const n=t||new oe,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=c-this.aX,h=l-this.aY;c=d*u-h*f+this.aX,l=d*f+h*u+this.aY}return n.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class GI extends fg{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function $x(){let i=0,e=0,t=0,n=0;function r(s,o,a,c){i=s,e=a,t=-3*s+3*o-2*a-c,n=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,l){r(o,a,l*(a-s),l*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,l,u,f){let d=(o-s)/l-(a-s)/(l+u)+(a-o)/u,h=(a-o)/u-(c-o)/(u+f)+(c-a)/f;d*=u,h*=u,r(o,a,d,h)},calc:function(s){const o=s*s;return i+e*s+t*o+n*(o*s)}}}const dg=new D,qx=new $x,Xx=new $x,Zx=new $x;class WI extends Fs{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new D){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let l,u,a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===c&&a===s-1&&(a=s-2,c=1),this.closed||a>0?l=r[(a-1)%s]:(dg.subVectors(r[0],r[1]).add(r[0]),l=dg);const f=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(dg.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=dg),"centripetal"===this.curveType||"chordal"===this.curveType){const h="chordal"===this.curveType?.5:.25;let m=Math.pow(l.distanceToSquared(f),h),p=Math.pow(f.distanceToSquared(d),h),g=Math.pow(d.distanceToSquared(u),h);p<1e-4&&(p=1),m<1e-4&&(m=p),g<1e-4&&(g=p),qx.initNonuniformCatmullRom(l.x,f.x,d.x,u.x,m,p,g),Xx.initNonuniformCatmullRom(l.y,f.y,d.y,u.y,m,p,g),Zx.initNonuniformCatmullRom(l.z,f.z,d.z,u.z,m,p,g)}else"catmullrom"===this.curveType&&(qx.initCatmullRom(l.x,f.x,d.x,u.x,this.tension),Xx.initCatmullRom(l.y,f.y,d.y,u.y,this.tension),Zx.initCatmullRom(l.z,f.z,d.z,u.z,this.tension));return n.set(qx.calc(c),Xx.calc(c),Zx.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new D).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function jI(i,e,t,n,r){const s=.5*(n-e),o=.5*(r-t),a=i*i;return(2*t-2*n+s+o)*(i*a)+(-3*t+3*n-2*s-o)*a+s*i+t}function Cd(i,e,t,n){return function w8(i,e){const t=1-i;return t*t*e}(i,e)+function M8(i,e){return 2*(1-i)*i*e}(i,t)+function S8(i,e){return i*i*e}(i,n)}function Ad(i,e,t,n,r){return function E8(i,e){const t=1-i;return t*t*t*e}(i,e)+function T8(i,e){const t=1-i;return 3*t*t*i*e}(i,t)+function D8(i,e){return 3*(1-i)*i*i*e}(i,n)+function C8(i,e){return i*i*i*e}(i,r)}class Yx extends Fs{constructor(e=new oe,t=new oe,n=new oe,r=new oe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new oe){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Ad(e,r.x,s.x,o.x,a.x),Ad(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class $I extends Fs{constructor(e=new D,t=new D,n=new D,r=new D){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new D){const n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Ad(e,r.x,s.x,o.x,a.x),Ad(e,r.y,s.y,o.y,a.y),Ad(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class hg extends Fs{constructor(e=new oe,t=new oe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new oe){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new oe;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class qI extends Fs{constructor(e=new D,t=new D){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new D){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Kx extends Fs{constructor(e=new oe,t=new oe,n=new oe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new oe){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Cd(e,r.x,s.x,o.x),Cd(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Jx extends Fs{constructor(e=new D,t=new D,n=new D){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new D){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Cd(e,r.x,s.x,o.x),Cd(e,r.y,s.y,o.y),Cd(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Qx extends Fs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new oe){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],f=r[o>r.length-3?r.length-1:o+2];return n.set(jI(a,c.x,l.x,u.x,f.x),jI(a,c.y,l.y,u.y,f.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push((new oe).fromArray(r))}return this}}var eb=Object.freeze({__proto__:null,ArcCurve:GI,CatmullRomCurve3:WI,CubicBezierCurve:Yx,CubicBezierCurve3:$I,EllipseCurve:fg,LineCurve:hg,LineCurve3:qI,QuadraticBezierCurve:Kx,QuadraticBezierCurve3:Jx,SplineCurve:Qx});class XI extends Fs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new hg(t,e))}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],c=a.getLength();return a.getPointAt(0===c?0:1-o/c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],c=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let l=0;l<c.length;l++){const u=c[l];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push((new eb[r.type]).fromJSON(r))}return this}}class Id extends XI{constructor(e){super(),this.type="Path",this.currentPoint=new oe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new hg(this.currentPoint.clone(),new oe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new Kx(this.currentPoint.clone(),new oe(e,t),new oe(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const a=new Yx(this.currentPoint.clone(),new oe(e,t),new oe(n,r),new oe(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Qx(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,c){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,r,s,o,a,c),this}absellipse(e,t,n,r,s,o,a,c){const l=new fg(e,t,n,r,s,o,a,c);if(this.curves.length>0){const f=l.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class yu extends Nt{constructor(e=[new oe(0,-.5),new oe(.5,0),new oe(0,.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=ri(r,0,2*Math.PI);const s=[],o=[],a=[],c=[],l=[],u=1/t,f=new D,d=new oe,h=new D,m=new D,p=new D;let g=0,y=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,y=e[v+1].y-e[v].y,h.x=1*y,h.y=-g,h.z=0*y,p.copy(h),h.normalize(),c.push(h.x,h.y,h.z);break;case e.length-1:c.push(p.x,p.y,p.z);break;default:g=e[v+1].x-e[v].x,y=e[v+1].y-e[v].y,h.x=1*y,h.y=-g,h.z=0*y,m.copy(h),h.x+=p.x,h.y+=p.y,h.z+=p.z,h.normalize(),c.push(h.x,h.y,h.z),p.copy(m)}for(let v=0;v<=t;v++){const _=n+v*u*r,x=Math.sin(_),w=Math.cos(_);for(let M=0;M<=e.length-1;M++)f.x=e[M].x*x,f.y=e[M].y,f.z=e[M].x*w,o.push(f.x,f.y,f.z),d.x=v/t,d.y=M/(e.length-1),a.push(d.x,d.y),l.push(c[3*M+0]*x,c[3*M+1],c[3*M+0]*w)}for(let v=0;v<t;v++)for(let _=0;_<e.length-1;_++){const x=_+v*e.length,M=x+e.length,E=x+e.length+1,b=x+1;s.push(x,M,b),s.push(E,b,M)}this.setIndex(s),this.setAttribute("position",new We(o,3)),this.setAttribute("uv",new We(a,2)),this.setAttribute("normal",new We(l,3))}static fromJSON(e){return new yu(e.points,e.segments,e.phiStart,e.phiLength)}}class Pd extends yu{constructor(e=1,t=1,n=4,r=8){const s=new Id;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new Pd(e.radius,e.length,e.capSegments,e.radialSegments)}}class Rd extends Nt{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],c=[],l=new D,u=new oe;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let f=0,d=3;f<=t;f++,d+=3){const h=n+f/t*r;l.x=e*Math.cos(h),l.y=e*Math.sin(h),o.push(l.x,l.y,l.z),a.push(0,0,1),u.x=(o[d]/e+1)/2,u.y=(o[d+1]/e+1)/2,c.push(u.x,u.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new We(o,3)),this.setAttribute("normal",new We(a,3)),this.setAttribute("uv",new We(c,2))}static fromJSON(e){return new Rd(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class gc extends Nt{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,a=0,c=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],f=[],d=[],h=[];let m=0;const p=[],g=n/2;let y=0;function _(x){const w=m,M=new oe,E=new D;let b=0;const S=!0===x?e:t,A=!0===x?1:-1;for(let U=1;U<=r;U++)f.push(0,g*A,0),d.push(0,A,0),h.push(.5,.5),m++;const O=m;for(let U=0;U<=r;U++){const L=U/r*c+a,V=Math.cos(L),Z=Math.sin(L);E.x=S*Z,E.y=g*A,E.z=S*V,f.push(E.x,E.y,E.z),d.push(0,A,0),M.x=.5*V+.5,M.y=.5*Z*A+.5,h.push(M.x,M.y),m++}for(let U=0;U<r;U++){const k=w+U,L=O+U;!0===x?u.push(L,L+1,k):u.push(L+1,L,k),b+=3}l.addGroup(y,b,!0===x?1:2),y+=b}(function v(){const x=new D,w=new D;let M=0;const E=(t-e)/n;for(let b=0;b<=s;b++){const S=[],A=b/s,O=A*(t-e)+e;for(let U=0;U<=r;U++){const k=U/r,L=k*c+a,V=Math.sin(L),Z=Math.cos(L);w.x=O*V,w.y=-A*n+g,w.z=O*Z,f.push(w.x,w.y,w.z),x.set(V,E,Z).normalize(),d.push(x.x,x.y,x.z),h.push(k,1-A),S.push(m++)}p.push(S)}for(let b=0;b<r;b++)for(let S=0;S<s;S++){const O=p[S+1][b],U=p[S+1][b+1],k=p[S][b+1];u.push(p[S][b],O,k),u.push(O,U,k),M+=6}l.addGroup(y,M,0),y+=M})(),!1===o&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(u),this.setAttribute("position",new We(f,3)),this.setAttribute("normal",new We(d,3)),this.setAttribute("uv",new We(h,2))}static fromJSON(e){return new gc(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ld extends gc{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Ld(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Uo extends Nt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];function c(v,_,x,w){const M=w+1,E=[];for(let b=0;b<=M;b++){E[b]=[];const S=v.clone().lerp(x,b/M),A=_.clone().lerp(x,b/M),O=M-b;for(let U=0;U<=O;U++)E[b][U]=0===U&&b===M?S:S.clone().lerp(A,U/O)}for(let b=0;b<M;b++)for(let S=0;S<2*(M-b)-1;S++){const A=Math.floor(S/2);S%2==0?(d(E[b][A+1]),d(E[b+1][A]),d(E[b][A])):(d(E[b][A+1]),d(E[b+1][A+1]),d(E[b+1][A]))}}function d(v){s.push(v.x,v.y,v.z)}function h(v,_){const x=3*v;_.x=e[x+0],_.y=e[x+1],_.z=e[x+2]}function p(v,_,x,w){w<0&&1===v.x&&(o[_]=v.x-1),0===x.x&&0===x.z&&(o[_]=w/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function y(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const _=new D,x=new D,w=new D;for(let M=0;M<t.length;M+=3)h(t[M+0],_),h(t[M+1],x),h(t[M+2],w),c(_,x,w,v)})(r),function l(v){const _=new D;for(let x=0;x<s.length;x+=3)_.x=s[x+0],_.y=s[x+1],_.z=s[x+2],_.normalize().multiplyScalar(v),s[x+0]=_.x,s[x+1]=_.y,s[x+2]=_.z}(n),function u(){const v=new D;for(let _=0;_<s.length;_+=3){v.x=s[_+0],v.y=s[_+1],v.z=s[_+2];const x=g(v)/2/Math.PI+.5,w=y(v)/Math.PI+.5;o.push(x,1-w)}(function m(){const v=new D,_=new D,x=new D,w=new D,M=new oe,E=new oe,b=new oe;for(let S=0,A=0;S<s.length;S+=9,A+=6){v.set(s[S+0],s[S+1],s[S+2]),_.set(s[S+3],s[S+4],s[S+5]),x.set(s[S+6],s[S+7],s[S+8]),M.set(o[A+0],o[A+1]),E.set(o[A+2],o[A+3]),b.set(o[A+4],o[A+5]),w.copy(v).add(_).add(x).divideScalar(3);const O=g(w);p(M,A+0,v,O),p(E,A+2,_,O),p(b,A+4,x,O)}})(),function f(){for(let v=0;v<o.length;v+=6){const _=o[v+0],x=o[v+2],w=o[v+4],M=Math.max(_,x,w),E=Math.min(_,x,w);M>.9&&E<.1&&(_<.2&&(o[v+0]+=1),x<.2&&(o[v+2]+=1),w<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new We(s,3)),this.setAttribute("normal",new We(s.slice(),3)),this.setAttribute("uv",new We(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Uo(e.vertices,e.indices,e.radius,e.details)}}class Od extends Uo{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Od(e.radius,e.detail)}}const pg=new D,mg=new D,tb=new D,gg=new ts;class ZI extends Nt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(ac*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,l=[0,0,0],u=["a","b","c"],f=new Array(3),d={},h=[];for(let m=0;m<c;m+=3){o?(l[0]=o.getX(m),l[1]=o.getX(m+1),l[2]=o.getX(m+2)):(l[0]=m,l[1]=m+1,l[2]=m+2);const{a:p,b:g,c:y}=gg;if(p.fromBufferAttribute(a,l[0]),g.fromBufferAttribute(a,l[1]),y.fromBufferAttribute(a,l[2]),gg.getNormal(tb),f[0]=`${Math.round(p.x*r)},${Math.round(p.y*r)},${Math.round(p.z*r)}`,f[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,f[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,f[0]!==f[1]&&f[1]!==f[2]&&f[2]!==f[0])for(let v=0;v<3;v++){const _=(v+1)%3,x=f[v],w=f[_],M=gg[u[v]],E=gg[u[_]],b=`${x}_${w}`,S=`${w}_${x}`;S in d&&d[S]?(tb.dot(d[S].normal)<=s&&(h.push(M.x,M.y,M.z),h.push(E.x,E.y,E.z)),d[S]=null):b in d||(d[b]={index0:l[v],index1:l[_],normal:tb.clone()})}}for(const m in d)if(d[m]){const{index0:p,index1:g}=d[m];pg.fromBufferAttribute(a,p),mg.fromBufferAttribute(a,g),h.push(pg.x,pg.y,pg.z),h.push(mg.x,mg.y,mg.z)}this.setAttribute("position",new We(h,3))}}}class _c extends Id{constructor(e){super(e),this.uuid=Pr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push((new Id).fromJSON(r))}return this}}function YI(i,e,t,n,r){let s,o;if(r===function j8(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}(i,e,t,n)>0)for(s=e;s<t;s+=n)o=QI(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=QI(s,i[s],i[s+1],o);return o&&_g(o,o.next)&&(kd(o),o=o.next),o}function yc(i,e){if(!i)return i;e||(e=i);let n,t=i;do{if(n=!1,t.steiner||!_g(t,t.next)&&0!==Gn(t.prev,t,t.next))t=t.next;else{if(kd(t),t=e=t.prev,t===t.next)break;n=!0}}while(n||t!==e);return e}function Nd(i,e,t,n,r,s,o){if(!i)return;!o&&s&&function U8(i,e,t,n){let r=i;do{0===r.z&&(r.z=nb(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,function z8(i){let e,t,n,r,s,o,a,c,l=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<l&&(a++,n=n.nextZ,n);e++);for(c=l;a>0||c>0&&n;)0!==a&&(0===c||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,c--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,l*=2}while(o>1)}(r)}(i,n,r,s);let c,l,a=i;for(;i.prev!==i.next;)if(c=i.prev,l=i.next,s?P8(i,n,r,s):I8(i))e.push(c.i/t|0),e.push(i.i/t|0),e.push(l.i/t|0),kd(i),i=l.next,a=l.next;else if((i=l)===a){o?1===o?Nd(i=R8(yc(i),e,t),e,t,n,r,s,2):2===o&&L8(i,e,t,n,r,s):Nd(yc(i),e,t,n,r,s,1);break}}function I8(i){const e=i.prev,t=i,n=i.next;if(Gn(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,a=e.y,c=t.y,l=n.y,u=r<s?r<o?r:o:s<o?s:o,f=a<c?a<l?a:l:c<l?c:l,d=r>s?r>o?r:o:s>o?s:o,h=a>c?a>l?a:l:c>l?c:l;let m=n.next;for(;m!==e;){if(m.x>=u&&m.x<=d&&m.y>=f&&m.y<=h&&vu(r,a,s,c,o,l,m.x,m.y)&&Gn(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function P8(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Gn(r,s,o)>=0)return!1;const a=r.x,c=s.x,l=o.x,u=r.y,f=s.y,d=o.y,h=a<c?a<l?a:l:c<l?c:l,m=u<f?u<d?u:d:f<d?f:d,p=a>c?a>l?a:l:c>l?c:l,g=u>f?u>d?u:d:f>d?f:d,y=nb(h,m,e,t,n),v=nb(p,g,e,t,n);let _=i.prevZ,x=i.nextZ;for(;_&&_.z>=y&&x&&x.z<=v;){if(_.x>=h&&_.x<=p&&_.y>=m&&_.y<=g&&_!==r&&_!==o&&vu(a,u,c,f,l,d,_.x,_.y)&&Gn(_.prev,_,_.next)>=0||(_=_.prevZ,x.x>=h&&x.x<=p&&x.y>=m&&x.y<=g&&x!==r&&x!==o&&vu(a,u,c,f,l,d,x.x,x.y)&&Gn(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;_&&_.z>=y;){if(_.x>=h&&_.x<=p&&_.y>=m&&_.y<=g&&_!==r&&_!==o&&vu(a,u,c,f,l,d,_.x,_.y)&&Gn(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=v;){if(x.x>=h&&x.x<=p&&x.y>=m&&x.y<=g&&x!==r&&x!==o&&vu(a,u,c,f,l,d,x.x,x.y)&&Gn(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function R8(i,e,t){let n=i;do{const r=n.prev,s=n.next.next;!_g(r,s)&&KI(r,n,n.next,s)&&Fd(r,s)&&Fd(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),kd(n),kd(n.next),n=i=s),n=n.next}while(n!==i);return yc(n)}function L8(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&H8(o,a)){let c=JI(o,a);return o=yc(o,o.next),c=yc(c,c.next),Nd(o,e,t,n,r,s,0),void Nd(c,e,t,n,r,s,0)}a=a.next}o=o.next}while(o!==i)}function N8(i,e){return i.x-e.x}function F8(i,e){const t=function k8(i,e){let r,t=e,n=-1/0;const s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>n&&(n=d,r=t.x<t.next.x?t:t.next,d===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,c=r.x,l=r.y;let f,u=1/0;t=r;do{s>=t.x&&t.x>=c&&s!==t.x&&vu(o<l?s:n,o,c,l,o<l?n:s,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(s-t.x),Fd(t,i)&&(f<u||f===u&&(t.x>r.x||t.x===r.x&&B8(r,t)))&&(r=t,u=f)),t=t.next}while(t!==a);return r}(i,e);if(!t)return e;const n=JI(t,i);return yc(n,n.next),yc(t,t.next)}function B8(i,e){return Gn(i.prev,i,e.prev)<0&&Gn(e.next,i,i.next)<0}function nb(i,e,t,n,r){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-t)*r|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function V8(i){let e=i,t=i;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==i);return t}function vu(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function H8(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function G8(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&KI(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}(i,e)&&(Fd(i,e)&&Fd(e,i)&&function W8(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==i);return n}(i,e)&&(Gn(i.prev,i,e.prev)||Gn(i,e.prev,e))||_g(i,e)&&Gn(i.prev,i,i.next)>0&&Gn(e.prev,e,e.next)>0)}function Gn(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function _g(i,e){return i.x===e.x&&i.y===e.y}function KI(i,e,t,n){const r=vg(Gn(i,e,t)),s=vg(Gn(i,e,n)),o=vg(Gn(t,n,i)),a=vg(Gn(t,n,e));return!!(r!==s&&o!==a||0===r&&yg(i,t,e)||0===s&&yg(i,n,e)||0===o&&yg(t,i,n)||0===a&&yg(t,e,n))}function yg(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function vg(i){return i>0?1:i<0?-1:0}function Fd(i,e){return Gn(i.prev,i,i.next)<0?Gn(i,e,i.next)>=0&&Gn(i,i.prev,e)>=0:Gn(i,e,i.prev)<0||Gn(i,i.next,e)<0}function JI(i,e){const t=new ib(i.i,i.x,i.y),n=new ib(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function QI(i,e,t,n){const r=new ib(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function kd(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ib(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class ro{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*n}static isClockWise(e){return ro.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];eP(e),tP(n,e);let o=e.length;t.forEach(eP);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,tP(n,t[c]);const a=function(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=YI(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,l,u,f,d,h;if(n&&(s=function O8(i,e,t,n){const r=[];let s,o,a,c,l;for(s=0,o=e.length;s<o;s++)a=e[s]*n,c=s<o-1?e[s+1]*n:i.length,l=YI(i,a,c,n,!1),l===l.next&&(l.steiner=!0),r.push(V8(l));for(r.sort(N8),s=0;s<r.length;s++)t=F8(r[s],t);return t}(i,e,s,t)),i.length>80*t){a=l=i[0],c=u=i[1];for(let m=t;m<r;m+=t)f=i[m],d=i[m+1],f<a&&(a=f),d<c&&(c=d),f>l&&(l=f),d>u&&(u=d);h=Math.max(l-a,u-c),h=0!==h?32767/h:0}return Nd(s,o,t,a,c,h,0),o}(n,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function eP(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function tP(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class Bd extends Nt{constructor(e=new _c([new oe(.5,.5),new oe(-.5,.5),new oe(-.5,-.5),new oe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++)o(e[a]);function o(a){const c=[],l=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1,f=void 0!==t.depth?t.depth:1;let d=void 0===t.bevelEnabled||t.bevelEnabled,h=void 0!==t.bevelThickness?t.bevelThickness:.2,m=void 0!==t.bevelSize?t.bevelSize:h-.1,p=void 0!==t.bevelOffset?t.bevelOffset:0,g=void 0!==t.bevelSegments?t.bevelSegments:3;const y=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:$8;let _,w,M,E,b,x=!1;y&&(_=y.getSpacedPoints(u),x=!0,d=!1,w=y.computeFrenetFrames(u,!1),M=new D,E=new D,b=new D),d||(g=0,h=0,m=0,p=0);const S=a.extractPoints(l);let A=S.shape;const O=S.holes;if(!ro.isClockWise(A)){A=A.reverse();for(let fe=0,ue=O.length;fe<ue;fe++){const De=O[fe];ro.isClockWise(De)&&(O[fe]=De.reverse())}}const k=ro.triangulateShape(A,O),L=A;for(let fe=0,ue=O.length;fe<ue;fe++)A=A.concat(O[fe]);function V(fe,ue,De){return ue||console.error("THREE.ExtrudeGeometry: vec does not exist"),ue.clone().multiplyScalar(De).add(fe)}const Z=A.length,ae=k.length;function J(fe,ue,De){let Xe,Pe,_t;const rt=fe.x-ue.x,Ye=fe.y-ue.y,yn=De.x-fe.x,cn=De.y-fe.y,P=rt*rt+Ye*Ye;if(Math.abs(rt*cn-Ye*yn)>Number.EPSILON){const te=Math.sqrt(P),be=Math.sqrt(yn*yn+cn*cn),Ee=ue.x-Ye/te,Oe=ue.y+rt/te,ce=((De.x-cn/be-Ee)*cn-(De.y+yn/be-Oe)*yn)/(rt*cn-Ye*yn);Xe=Ee+rt*ce-fe.x,Pe=Oe+Ye*ce-fe.y;const Ke=Xe*Xe+Pe*Pe;if(Ke<=2)return new oe(Xe,Pe);_t=Math.sqrt(Ke/2)}else{let te=!1;rt>Number.EPSILON?yn>Number.EPSILON&&(te=!0):rt<-Number.EPSILON?yn<-Number.EPSILON&&(te=!0):Math.sign(Ye)===Math.sign(cn)&&(te=!0),te?(Xe=-Ye,Pe=rt,_t=Math.sqrt(P)):(Xe=rt,Pe=Ye,_t=Math.sqrt(P/2))}return new oe(Xe/_t,Pe/_t)}const pe=[];for(let fe=0,ue=L.length,De=ue-1,Xe=fe+1;fe<ue;fe++,De++,Xe++)De===ue&&(De=0),Xe===ue&&(Xe=0),pe[fe]=J(L[fe],L[De],L[Xe]);const de=[];let Le,$=pe.concat();for(let fe=0,ue=O.length;fe<ue;fe++){const De=O[fe];Le=[];for(let Xe=0,Pe=De.length,_t=Pe-1,rt=Xe+1;Xe<Pe;Xe++,_t++,rt++)_t===Pe&&(_t=0),rt===Pe&&(rt=0),Le[Xe]=J(De[Xe],De[_t],De[rt]);de.push(Le),$=$.concat(Le)}for(let fe=0;fe<g;fe++){const ue=fe/g,De=h*Math.cos(ue*Math.PI/2),Xe=m*Math.sin(ue*Math.PI/2)+p;for(let Pe=0,_t=L.length;Pe<_t;Pe++){const rt=V(L[Pe],pe[Pe],Xe);Ze(rt.x,rt.y,-De)}for(let Pe=0,_t=O.length;Pe<_t;Pe++){const rt=O[Pe];Le=de[Pe];for(let Ye=0,yn=rt.length;Ye<yn;Ye++){const cn=V(rt[Ye],Le[Ye],Xe);Ze(cn.x,cn.y,-De)}}}const me=m+p;for(let fe=0;fe<Z;fe++){const ue=d?V(A[fe],$[fe],me):A[fe];x?(E.copy(w.normals[0]).multiplyScalar(ue.x),M.copy(w.binormals[0]).multiplyScalar(ue.y),b.copy(_[0]).add(E).add(M),Ze(b.x,b.y,b.z)):Ze(ue.x,ue.y,0)}for(let fe=1;fe<=u;fe++)for(let ue=0;ue<Z;ue++){const De=d?V(A[ue],$[ue],me):A[ue];x?(E.copy(w.normals[fe]).multiplyScalar(De.x),M.copy(w.binormals[fe]).multiplyScalar(De.y),b.copy(_[fe]).add(E).add(M),Ze(b.x,b.y,b.z)):Ze(De.x,De.y,f/u*fe)}for(let fe=g-1;fe>=0;fe--){const ue=fe/g,De=h*Math.cos(ue*Math.PI/2),Xe=m*Math.sin(ue*Math.PI/2)+p;for(let Pe=0,_t=L.length;Pe<_t;Pe++){const rt=V(L[Pe],pe[Pe],Xe);Ze(rt.x,rt.y,f+De)}for(let Pe=0,_t=O.length;Pe<_t;Pe++){const rt=O[Pe];Le=de[Pe];for(let Ye=0,yn=rt.length;Ye<yn;Ye++){const cn=V(rt[Ye],Le[Ye],Xe);x?Ze(cn.x,cn.y+_[u-1].y,_[u-1].x+De):Ze(cn.x,cn.y,f+De)}}}function q(fe,ue){let De=fe.length;for(;--De>=0;){const Xe=De;let Pe=De-1;Pe<0&&(Pe=fe.length-1);for(let _t=0,rt=u+2*g;_t<rt;_t++){const Ye=Z*_t,yn=Z*(_t+1);$e(ue+Xe+Ye,ue+Pe+Ye,ue+Pe+yn,ue+Xe+yn)}}}function Ze(fe,ue,De){c.push(fe),c.push(ue),c.push(De)}function Ue(fe,ue,De){Se(fe),Se(ue),Se(De);const Xe=r.length/3,Pe=v.generateTopUV(n,r,Xe-3,Xe-2,Xe-1);It(Pe[0]),It(Pe[1]),It(Pe[2])}function $e(fe,ue,De,Xe){Se(fe),Se(ue),Se(Xe),Se(ue),Se(De),Se(Xe);const Pe=r.length/3,_t=v.generateSideWallUV(n,r,Pe-6,Pe-3,Pe-2,Pe-1);It(_t[0]),It(_t[1]),It(_t[3]),It(_t[1]),It(_t[2]),It(_t[3])}function Se(fe){r.push(c[3*fe+0]),r.push(c[3*fe+1]),r.push(c[3*fe+2])}function It(fe){s.push(fe.x),s.push(fe.y)}(function ye(){const fe=r.length/3;if(d){let ue=0,De=Z*ue;for(let Xe=0;Xe<ae;Xe++){const Pe=k[Xe];Ue(Pe[2]+De,Pe[1]+De,Pe[0]+De)}ue=u+2*g,De=Z*ue;for(let Xe=0;Xe<ae;Xe++){const Pe=k[Xe];Ue(Pe[0]+De,Pe[1]+De,Pe[2]+De)}}else{for(let ue=0;ue<ae;ue++){const De=k[ue];Ue(De[2],De[1],De[0])}for(let ue=0;ue<ae;ue++){const De=k[ue];Ue(De[0]+Z*u,De[1]+Z*u,De[2]+Z*u)}}n.addGroup(fe,r.length/3-fe,0)})(),function xe(){const fe=r.length/3;let ue=0;q(L,ue),ue+=L.length;for(let De=0,Xe=O.length;De<Xe;De++){const Pe=O[De];q(Pe,ue),ue+=Pe.length}n.addGroup(fe,r.length/3-fe,1)}()}this.setAttribute("position",new We(r,3)),this.setAttribute("uv",new We(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function q8(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++)t.shapes.push(i[n].uuid);else t.shapes.push(i.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++)n.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new eb[r.type]).fromJSON(r)),new Bd(n,e.options)}}const $8={generateTopUV:function(i,e,t,n,r){const a=e[3*n],c=e[3*n+1],l=e[3*r],u=e[3*r+1];return[new oe(e[3*t],e[3*t+1]),new oe(a,c),new oe(l,u)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[3*t],a=e[3*t+1],c=e[3*t+2],l=e[3*n],u=e[3*n+1],f=e[3*n+2],d=e[3*r],h=e[3*r+1],m=e[3*r+2],p=e[3*s],g=e[3*s+1],y=e[3*s+2];return Math.abs(a-u)<Math.abs(o-l)?[new oe(o,1-c),new oe(l,1-f),new oe(d,1-m),new oe(p,1-y)]:[new oe(a,1-c),new oe(u,1-f),new oe(h,1-m),new oe(g,1-y)]}};class Ud extends Uo{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ud(e.radius,e.detail)}}class xu extends Uo{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new xu(e.radius,e.detail)}}class zd extends Nt{constructor(e=.5,t=1,n=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n);const a=[],c=[],l=[],u=[];let f=e;const d=(t-e)/(r=Math.max(1,r)),h=new D,m=new oe;for(let p=0;p<=r;p++){for(let g=0;g<=n;g++){const y=s+g/n*o;h.x=f*Math.cos(y),h.y=f*Math.sin(y),c.push(h.x,h.y,h.z),l.push(0,0,1),m.x=(h.x/t+1)/2,m.y=(h.y/t+1)/2,u.push(m.x,m.y)}f+=d}for(let p=0;p<r;p++){const g=p*(n+1);for(let y=0;y<n;y++){const v=y+g,x=v+n+1,w=v+n+2,M=v+1;a.push(v,x,M),a.push(x,w,M)}}this.setIndex(a),this.setAttribute("position",new We(c,3)),this.setAttribute("normal",new We(l,3)),this.setAttribute("uv",new We(u,2))}static fromJSON(e){return new zd(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Vd extends Nt{constructor(e=new _c([new oe(0,.5),new oe(-.5,-.5),new oe(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let a=0,c=0;if(!1===Array.isArray(e))l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(a,c,u),a+=c,c=0;function l(u){const f=r.length/3,d=u.extractPoints(t);let h=d.shape;const m=d.holes;!1===ro.isClockWise(h)&&(h=h.reverse());for(let g=0,y=m.length;g<y;g++){const v=m[g];!0===ro.isClockWise(v)&&(m[g]=v.reverse())}const p=ro.triangulateShape(h,m);for(let g=0,y=m.length;g<y;g++)h=h.concat(m[g]);for(let g=0,y=h.length;g<y;g++){const v=h[g];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,y=p.length;g<y;g++){const v=p[g];n.push(v[0]+f,v[1]+f,v[2]+f),c+=3}}this.setIndex(n),this.setAttribute("position",new We(r,3)),this.setAttribute("normal",new We(s,3)),this.setAttribute("uv",new We(o,2))}toJSON(){const e=super.toJSON();return function X8(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++)e.shapes.push(i[t].uuid);else e.shapes.push(i.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++)n.push(t[e.shapes[r]]);return new Vd(n,e.curveSegments)}}class bu extends Nt{constructor(e=1,t=32,n=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const c=Math.min(o+a,Math.PI);let l=0;const u=[],f=new D,d=new D,h=[],m=[],p=[],g=[];for(let y=0;y<=n;y++){const v=[],_=y/n;let x=0;0==y&&0==o?x=.5/t:y==n&&c==Math.PI&&(x=-.5/t);for(let w=0;w<=t;w++){const M=w/t;f.x=-e*Math.cos(r+M*s)*Math.sin(o+_*a),f.y=e*Math.cos(o+_*a),f.z=e*Math.sin(r+M*s)*Math.sin(o+_*a),m.push(f.x,f.y,f.z),d.copy(f).normalize(),p.push(d.x,d.y,d.z),g.push(M+x,1-_),v.push(l++)}u.push(v)}for(let y=0;y<n;y++)for(let v=0;v<t;v++){const x=u[y][v],w=u[y+1][v],M=u[y+1][v+1];(0!==y||o>0)&&h.push(u[y][v+1],x,M),(y!==n-1||c<Math.PI)&&h.push(x,w,M)}this.setIndex(h),this.setAttribute("position",new We(m,3)),this.setAttribute("normal",new We(p,3)),this.setAttribute("uv",new We(g,2))}static fromJSON(e){return new bu(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Hd extends Uo{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Hd(e.radius,e.detail)}}class Gd extends Nt{constructor(e=1,t=.4,n=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],c=[],l=[],u=new D,f=new D,d=new D;for(let h=0;h<=n;h++)for(let m=0;m<=r;m++){const p=m/r*s,g=h/n*Math.PI*2;f.x=(e+t*Math.cos(g))*Math.cos(p),f.y=(e+t*Math.cos(g))*Math.sin(p),f.z=t*Math.sin(g),a.push(f.x,f.y,f.z),u.x=e*Math.cos(p),u.y=e*Math.sin(p),d.subVectors(f,u).normalize(),c.push(d.x,d.y,d.z),l.push(m/r),l.push(h/n)}for(let h=1;h<=n;h++)for(let m=1;m<=r;m++){const g=(r+1)*(h-1)+m-1,y=(r+1)*(h-1)+m,v=(r+1)*h+m;o.push((r+1)*h+m-1,g,v),o.push(g,y,v)}this.setIndex(o),this.setAttribute("position",new We(a,3)),this.setAttribute("normal",new We(c,3)),this.setAttribute("uv",new We(l,2))}static fromJSON(e){return new Gd(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Wd extends Nt{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],c=[],l=[],u=[],f=new D,d=new D,h=new D,m=new D,p=new D,g=new D,y=new D;for(let _=0;_<=n;++_){const x=_/n*s*Math.PI*2;v(x,s,o,e,h),v(x+.01,s,o,e,m),g.subVectors(m,h),y.addVectors(m,h),p.crossVectors(g,y),y.crossVectors(p,g),p.normalize(),y.normalize();for(let w=0;w<=r;++w){const M=w/r*Math.PI*2,E=-t*Math.cos(M),b=t*Math.sin(M);f.x=h.x+(E*y.x+b*p.x),f.y=h.y+(E*y.y+b*p.y),f.z=h.z+(E*y.z+b*p.z),c.push(f.x,f.y,f.z),d.subVectors(f,h).normalize(),l.push(d.x,d.y,d.z),u.push(_/n),u.push(w/r)}}for(let _=1;_<=n;_++)for(let x=1;x<=r;x++){const M=(r+1)*_+(x-1),E=(r+1)*_+x,b=(r+1)*(_-1)+x;a.push((r+1)*(_-1)+(x-1),M,b),a.push(M,E,b)}function v(_,x,w,M,E){const b=Math.cos(_),S=Math.sin(_),A=w/x*_,O=Math.cos(A);E.x=M*(2+O)*.5*b,E.y=M*(2+O)*S*.5,E.z=M*Math.sin(A)*.5}this.setIndex(a),this.setAttribute("position",new We(c,3)),this.setAttribute("normal",new We(l,3)),this.setAttribute("uv",new We(u,2))}static fromJSON(e){return new Wd(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class jd extends Nt{constructor(e=new Jx(new D(-1,-1,0),new D(-1,1,0),new D(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new D,c=new D,l=new oe;let u=new D;const f=[],d=[],h=[],m=[];function g(_){u=e.getPointAt(_/t,u);const x=o.normals[_],w=o.binormals[_];for(let M=0;M<=r;M++){const E=M/r*Math.PI*2,b=Math.sin(E),S=-Math.cos(E);c.x=S*x.x+b*w.x,c.y=S*x.y+b*w.y,c.z=S*x.z+b*w.z,c.normalize(),d.push(c.x,c.y,c.z),a.x=u.x+n*c.x,a.y=u.y+n*c.y,a.z=u.z+n*c.z,f.push(a.x,a.y,a.z)}}(function p(){for(let _=0;_<t;_++)g(_);g(!1===s?t:0),function v(){for(let _=0;_<=t;_++)for(let x=0;x<=r;x++)l.x=_/t,l.y=x/r,h.push(l.x,l.y)}(),function y(){for(let _=1;_<=t;_++)for(let x=1;x<=r;x++){const M=(r+1)*_+(x-1),E=(r+1)*_+x,b=(r+1)*(_-1)+x;m.push((r+1)*(_-1)+(x-1),M,b),m.push(M,E,b)}}()})(),this.setIndex(m),this.setAttribute("position",new We(f,3)),this.setAttribute("normal",new We(d,3)),this.setAttribute("uv",new We(h,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new jd((new eb[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class nP extends Nt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new D,s=new D;if(null!==e.index){const o=e.attributes.position,a=e.index;let c=e.groups;0===c.length&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){const f=c[l],d=f.start;for(let m=d,p=d+f.count;m<p;m+=3)for(let g=0;g<3;g++){const y=a.getX(m+g),v=a.getX(m+(g+1)%3);r.fromBufferAttribute(o,y),s.fromBufferAttribute(o,v),!0===iP(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,c=o.count/3;a<c;a++)for(let l=0;l<3;l++){const f=3*a+(l+1)%3;r.fromBufferAttribute(o,3*a+l),s.fromBufferAttribute(o,f),!0===iP(r,s,n)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new We(t,3))}}}function iP(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return!0!==t.has(n)&&!0!==t.has(r)&&(t.add(n),t.add(r),!0)}var rP=Object.freeze({__proto__:null,BoxGeometry:ya,CapsuleGeometry:Pd,CircleGeometry:Rd,ConeGeometry:Ld,CylinderGeometry:gc,DodecahedronGeometry:Od,EdgesGeometry:ZI,ExtrudeGeometry:Bd,IcosahedronGeometry:Ud,LatheGeometry:yu,OctahedronGeometry:xu,PlaneGeometry:cu,PolyhedronGeometry:Uo,RingGeometry:zd,ShapeGeometry:Vd,SphereGeometry:bu,TetrahedronGeometry:Hd,TorusGeometry:Gd,TorusKnotGeometry:Wd,TubeGeometry:jd,WireframeGeometry:nP});class sP extends wi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Re(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class oP extends io{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class $d extends wi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Re(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fa,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class zo extends $d{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new oe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ri(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Re(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Re(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Re(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class aP extends wi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Re(16777215),this.specular=new Re(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fa,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=id,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cP extends wi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Re(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fa,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class lP extends wi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fa,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class uP extends wi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Re(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fa,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=id,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fP extends wi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Re(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fa,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class dP extends $i{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function is(i,e,t){return rb(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)}function vc(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)}function rb(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function hP(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n}function sb(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=i[a+c]}return r}function ob(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=i[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),t.push(o)),s=i[r++]}while(void 0!==s)}var K8=Object.freeze({__proto__:null,arraySlice:is,convertArray:vc,flattenJSON:ob,getKeyframeOrder:hP,isTypedArray:rb,makeClipAdditive:function Y8(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],c=a.ValueTypeName;if("bool"===c||"string"===c)continue;const l=i.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===c});if(void 0===l)continue;let u=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0;const h=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=h/3);const m=a.times.length-1;let p;if(s<=a.times[0])p=is(a.values,u,f-u);else if(s>=a.times[m]){const y=m*f+u;p=is(a.values,y,y+f-u)}else{const y=a.createInterpolant(),v=u,_=f-u;y.evaluate(s),p=is(y.resultBuffer,v,_)}"quaternion"===c&&(new Ci).fromArray(p).normalize().conjugate().toArray(p);const g=l.times.length;for(let y=0;y<g;++y){const v=y*h+d;if("quaternion"===c)Ci.multiplyQuaternionsFlat(l.values,v,p,0,l.values,v);else{const _=h-2*d;for(let x=0;x<_;++x)l.values[v+x]-=p[x]}}}return i.blendMode=J0,i},sortedArray:sb,subclip:function Z8(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let c=0;c<s.tracks.length;++c){const l=s.tracks[c],u=l.getValueSize(),f=[],d=[];for(let h=0;h<l.times.length;++h){const m=l.times[h]*r;if(!(m<t||m>=n)){f.push(l.times[h]);for(let p=0;p<u;++p)d.push(l.values[h*u+p])}}0!==f.length&&(l.times=vc(f,l.times.constructor),l.values=vc(d,l.values.constructor),o.push(l))}s.tracks=o;let a=1/0;for(let c=0;c<s.tracks.length;++c)a>s.tracks[c].times[0]&&(a=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*a);return s.resetDuration(),s}});class wu{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let c=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===c)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class pP extends wu{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:sc,endingEnd:sc}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case oc:s=e,a=2*t-n;break;case ad:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===c)switch(this.getSettings_().endingEnd){case oc:o=e,c=2*n-t;break;case ad:o=1,c=n+r[1]-r[0];break;default:o=e-1,c=t}const l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,h=this._weightNext,m=(n-t)/(r-t),p=m*m,g=p*m,y=-d*g+2*d*p-d*m,v=(1+d)*g+(-1.5-2*d)*p+(-.5+d)*m+1,_=(-1-h)*g+(1.5+h)*p+.5*m,x=h*g-h*p;for(let w=0;w!==a;++w)s[w]=y*o[u+w]+v*o[l+w]+_*o[c+w]+x*o[f+w];return s}}class ab extends wu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(n-t)/(r-t),f=1-u;for(let d=0;d!==a;++d)s[d]=o[l+d]*f+o[c+d]*u;return s}}class mP extends wu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ks{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vc(t,this.TimeBufferType),this.values=vc(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:vc(e.times,Array),values:vc(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new mP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ab(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pP(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case jl:t=this.InterpolantFactoryMethodDiscrete;break;case rc:t=this.InterpolantFactoryMethodLinear;break;case bm:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jl;case this.InterpolantFactoryMethodLinear:return rc;case this.InterpolantFactoryMethodSmooth:return bm}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=is(n,s,o),this.values=is(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=n[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==o&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(void 0!==r&&rb(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=is(this.times),t=is(this.values),n=this.getValueSize(),r=this.getInterpolation()===bm,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const f=a*n,d=f-n,h=f+n;for(let m=0;m!==n;++m){const p=t[f+m];if(p!==t[d+m]||p!==t[h+m]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const f=a*n,d=o*n;for(let h=0;h!==n;++h)t[d+h]=t[f+h]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,c=o*n,l=0;l!==n;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=is(e,0,o),this.values=is(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=is(this.times,0),t=is(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}ks.prototype.TimeBufferType=Float32Array,ks.prototype.ValueBufferType=Float32Array,ks.prototype.DefaultInterpolation=rc;class xc extends ks{}xc.prototype.ValueTypeName="bool",xc.prototype.ValueBufferType=Array,xc.prototype.DefaultInterpolation=jl,xc.prototype.InterpolantFactoryMethodLinear=void 0,xc.prototype.InterpolantFactoryMethodSmooth=void 0;class cb extends ks{}cb.prototype.ValueTypeName="color";class Mu extends ks{}Mu.prototype.ValueTypeName="number";class gP extends wu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(n-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)Ci.slerpFlat(s,0,o,l-a,o,l,c);return s}}class ba extends ks{InterpolantFactoryMethodLinear(e){return new gP(this.times,this.values,this.getValueSize(),e)}}ba.prototype.ValueTypeName="quaternion",ba.prototype.DefaultInterpolation=rc,ba.prototype.InterpolantFactoryMethodSmooth=void 0;class bc extends ks{}bc.prototype.ValueTypeName="string",bc.prototype.ValueBufferType=Array,bc.prototype.DefaultInterpolation=jl,bc.prototype.InterpolantFactoryMethodLinear=void 0,bc.prototype.InterpolantFactoryMethodSmooth=void 0;class Su extends ks{}Su.prototype.ValueTypeName="vector";class Eu{constructor(e,t=-1,n,r=wm){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Pr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(Q8(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(ks.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],l=[];c.push((a+s-1)%s,a,(a+1)%s),l.push(0,1,0);const u=hP(c);c=sb(c,1,u),l=sb(l,1,u),!r&&0===c[0]&&(c.push(s),l.push(l[0])),o.push(new Mu(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const l=e[a],u=l.name.match(s);if(u&&u.length>1){const f=u[1];let d=r[f];d||(r[f]=d=[]),d.push(l)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(f,d,h,m,p){if(0!==h.length){const g=[],y=[];ob(h,g,y,m),0!==g.length&&p.push(new f(d,g,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let f=0;f<l.length;f++){const d=l[f].keys;if(d&&0!==d.length)if(d[0].morphTargets){const h={};let m;for(m=0;m<d.length;m++)if(d[m].morphTargets)for(let p=0;p<d[m].morphTargets.length;p++)h[d[m].morphTargets[p]]=-1;for(const p in h){const g=[],y=[];for(let v=0;v!==d[m].morphTargets.length;++v){const _=d[m];g.push(_.time),y.push(_.morphTarget===p?1:0)}r.push(new Mu(".morphTargetInfluence["+p+"]",g,y))}c=h.length*o}else{const h=".bones["+t[f].name+"]";n(Su,h+".position",d,"pos",r),n(ba,h+".quaternion",d,"rot",r),n(Su,h+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,c,r,a)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Q8(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function J8(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Mu;case"vector":case"vector2":case"vector3":case"vector4":return Su;case"color":return cb;case"quaternion":return ba;case"bool":case"boolean":return xc;case"string":return bc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];ob(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const wc={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class lb{constructor(e,t,n){const r=this;let c,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,f){return l.push(u,f),this},this.removeHandler=function(u){const f=l.indexOf(u);return-1!==f&&l.splice(f,2),this},this.getHandler=function(u){for(let f=0,d=l.length;f<d;f+=2){const h=l[f],m=l[f+1];if(h.global&&(h.lastIndex=0),h.test(u))return m}return null}}}const _P=new lb;class vr{constructor(e){this.manager=void 0!==e?e:_P,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Vo={};class ej extends Error{constructor(e,t){super(e),this.response=t}}class Bs extends vr{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=wc.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Vo[e])return void Vo[e].push({onLoad:t,onProgress:n,onError:r});Vo[e]=[],Vo[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===l.body||void 0===l.body.getReader)return l;const u=Vo[e],f=l.body.getReader(),d=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),h=d?parseInt(d):0,m=0!==h;let p=0;const g=new ReadableStream({start(y){!function v(){f.read().then(({done:_,value:x})=>{if(_)y.close();else{p+=x.byteLength;const w=new ProgressEvent("progress",{lengthComputable:m,loaded:p,total:h});for(let M=0,E=u.length;M<E;M++){const b=u[M];b.onProgress&&b.onProgress(w)}y.enqueue(x),v()}})}()}});return new Response(g)}throw new ej(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return l.json();default:if(void 0===a)return l.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),d=f&&f[1]?f[1].toLowerCase():void 0,h=new TextDecoder(d);return l.arrayBuffer().then(m=>h.decode(m))}}}).then(l=>{wc.add(e,l);const u=Vo[e];delete Vo[e];for(let f=0,d=u.length;f<d;f++){const h=u[f];h.onLoad&&h.onLoad(l)}}).catch(l=>{const u=Vo[e];if(void 0===u)throw this.manager.itemError(e),l;delete Vo[e];for(let f=0,d=u.length;f<d;f++){const h=u[f];h.onError&&h.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class tj extends vr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Bs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Eu.parse(e[n]);t.push(r)}return t}}class nj extends vr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],a=new jx,c=new Bs(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let l=0;function u(f){c.load(e[f],function(d){const h=s.parse(d,!0);o[f]={width:h.width,height:h.height,format:h.format,mipmaps:h.mipmaps},l+=1,6===l&&(1===h.mipmapCount&&(a.minFilter=Hn),a.image=o,a.format=h.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let f=0,d=e.length;f<d;++f)u(f);else c.load(e,function(f){const d=s.parse(f,!0);if(d.isCubemap){const h=d.mipmaps.length/d.mipmapCount;for(let m=0;m<h;m++){o[m]={mipmaps:[]};for(let p=0;p<d.mipmapCount;p++)o[m].mipmaps.push(d.mipmaps[m*d.mipmapCount+p]),o[m].format=d.format,o[m].width=d.width,o[m].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;1===d.mipmapCount&&(a.minFilter=Hn),a.format=d.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class qd extends vr{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=wc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=fd("img");function c(){u(),wc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(f){u(),r&&r(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class ij extends vr{constructor(e){super(e)}load(e,t,n,r){const s=new xd,o=new qd(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(l){o.load(e[l],function(u){s.images[l]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return s}}class rj extends vr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new gu,a=new Bs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){const l=s.parse(c);l&&(void 0!==l.image?o.image=l.image:void 0!==l.data&&(o.image.width=l.width,o.image.height=l.height,o.image.data=l.data),o.wrapS=void 0!==l.wrapS?l.wrapS:ki,o.wrapT=void 0!==l.wrapT?l.wrapT:ki,o.magFilter=void 0!==l.magFilter?l.magFilter:Hn,o.minFilter=void 0!==l.minFilter?l.minFilter:Hn,o.anisotropy=void 0!==l.anisotropy?l.anisotropy:1,void 0!==l.encoding&&(o.encoding=l.encoding),void 0!==l.flipY&&(o.flipY=l.flipY),void 0!==l.format&&(o.format=l.format),void 0!==l.type&&(o.type=l.type),void 0!==l.mipmaps&&(o.mipmaps=l.mipmaps,o.minFilter=to),1===l.mipmapCount&&(o.minFilter=Hn),void 0!==l.generateMipmaps&&(o.generateMipmaps=l.generateMipmaps),o.needsUpdate=!0,t&&t(o,l))},n,r),o}}class yP extends vr{constructor(e){super(e)}load(e,t,n,r){const s=new Bi,o=new qd(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class wa extends wn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Re(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class vP extends wa{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(wn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Re(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const ub=new gt,xP=new D,bP=new D;class fb{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new oe(512,512),this.map=null,this.mapPass=null,this.matrix=new gt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $m,this._frameExtents=new oe(1,1),this._viewportCount=1,this._viewports=[new mn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;xP.setFromMatrixPosition(e.matrixWorld),t.position.copy(xP),bP.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(bP),t.updateMatrixWorld(),ub.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ub),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(ub)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class sj extends fb{constructor(){super(new Fn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*ld*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class db extends wa{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(wn.DEFAULT_UP),this.updateMatrix(),this.target=new wn,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new sj}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const wP=new gt,Xd=new D,hb=new D;class oj extends fb{constructor(){super(new Fn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new oe(4,2),this._viewportCount=6,this._viewports=[new mn(2,1,1,1),new mn(0,1,1,1),new mn(3,1,1,1),new mn(1,1,1,1),new mn(3,0,1,1),new mn(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Xd.setFromMatrixPosition(e.matrixWorld),n.position.copy(Xd),hb.copy(n.position),hb.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(hb),n.updateMatrixWorld(),r.makeTranslation(-Xd.x,-Xd.y,-Xd.z),wP.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wP)}}class pb extends wa{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new oj}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class aj extends fb{constructor(){super(new Fo(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class mb extends wa{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(wn.DEFAULT_UP),this.updateMatrix(),this.target=new wn,this.shadow=new aj}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class MP extends wa{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class SP extends wa{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class EP{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new D)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],n*s*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class xg extends wa{constructor(e=new EP,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class bg extends vr{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new Bs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=bg.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Re).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=(new Re).setHex(o.value);break;case"v2":r.uniforms[s].value=(new oe).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new D).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new mn).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new or).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new gt).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new oe).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new oe).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:sP,SpriteMaterial:kx,RawShaderMaterial:oP,ShaderMaterial:io,PointsMaterial:cg,MeshPhysicalMaterial:zo,MeshStandardMaterial:$d,MeshPhongMaterial:aP,MeshToonMaterial:cP,MeshNormalMaterial:lP,MeshLambertMaterial:uP,MeshDepthMaterial:Ox,MeshDistanceMaterial:Nx,MeshBasicMaterial:Lr,MeshMatcapMaterial:fP,LineDashedMaterial:dP,LineBasicMaterial:$i,Material:wi}[e]}}class Tu{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class TP extends Nt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class DP extends vr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Bs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(h,m){if(void 0!==t[m])return t[m];const g=h.interleavedBuffers[m],y=function s(h,m){if(void 0!==n[m])return n[m];const y=new Uint32Array(h.arrayBuffers[m]).buffer;return n[m]=y,y}(h,g.buffer),v=ql(g.type,y),_=new wd(v,g.stride);return _.uuid=g.uuid,t[m]=_,_}const o=e.isInstancedBufferGeometry?new TP:new Nt,a=e.data.index;if(void 0!==a){const h=ql(a.type,a.array);o.setIndex(new fn(h,1))}const c=e.data.attributes;for(const h in c){const m=c[h];let p;if(m.isInterleavedBufferAttribute){const g=r(e.data,m.data);p=new xa(g,m.itemSize,m.offset,m.normalized)}else{const g=ql(m.type,m.array);p=new(m.isInstancedBufferAttribute?_u:fn)(g,m.itemSize,m.normalized)}void 0!==m.name&&(p.name=m.name),void 0!==m.usage&&p.setUsage(m.usage),void 0!==m.updateRange&&(p.updateRange.offset=m.updateRange.offset,p.updateRange.count=m.updateRange.count),o.setAttribute(h,p)}const l=e.data.morphAttributes;if(l)for(const h in l){const m=l[h],p=[];for(let g=0,y=m.length;g<y;g++){const v=m[g];let _;if(v.isInterleavedBufferAttribute){const x=r(e.data,v.data);_=new xa(x,v.itemSize,v.offset,v.normalized)}else{const x=ql(v.type,v.array);_=new fn(x,v.itemSize,v.normalized)}void 0!==v.name&&(_.name=v.name),p.push(_)}o.morphAttributes[h]=p}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==f)for(let h=0,m=f.length;h!==m;++h){const p=f[h];o.addGroup(p.start,p.count,p.materialIndex)}const d=e.data.boundingSphere;if(void 0!==d){const h=new D;void 0!==d.center&&h.fromArray(d.center),o.boundingSphere=new ma(h,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class cj extends vr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===this.path?Tu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Bs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(f){return void 0!==r&&r(f),void console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message)}const u=l.metadata;if(void 0===u||void 0===u.type||"geometry"===u.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(l,t)},n,r)}loadAsync(e,t){var n=this;return nd(function*(){const r=n,s=""===n.path?Tu.extractUrlBase(e):n.path;n.resourcePath=n.resourcePath||s;const o=new Bs(n.manager);o.setPath(n.path),o.setRequestHeader(n.requestHeader),o.setWithCredentials(n.withCredentials);const a=yield o.loadAsync(e,t),c=JSON.parse(a),l=c.metadata;if(void 0===l||void 0===l.type||"geometry"===l.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(c)})()}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(l)}),a=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,s,c,a,n),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),void 0!==t){let f=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){f=!0;break}!1===f&&t(l)}return l}parseAsync(e){var t=this;return nd(function*(){const n=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),a=t.parseTextures(e.textures,o),c=t.parseMaterials(e.materials,a),l=t.parseObject(e.object,s,c,a,n),u=t.parseSkeletons(e.skeletons,l);return t.bindSkeletons(l,u),l})()}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const s=(new _c).fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=(new Td).fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new DP;for(let s=0,o=e.length;s<o;s++){let a;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(c);break;default:c.type in rP?a=rP[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,void 0!==c.name&&(a.name=c.name),!0===a.isBufferGeometry&&void 0!==c.userData&&(a.userData=c.userData),n[c.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const s=new bg;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const c=e[o];void 0===n[c.uuid]&&(n[c.uuid]=s.parse(c)),r[c.uuid]=n[c.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const s=Eu.parse(e[n]);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function a(c){if("string"==typeof c){const l=c;return function o(c){return n.manager.itemStart(c),s.load(c,function(){n.manager.itemEnd(c)},void 0,function(){n.manager.itemError(c),n.manager.itemEnd(c)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:n.resourcePath+l)}return c.data?{data:ql(c.type,c.data),width:c.width,height:c.height}:null}if(void 0!==e&&e.length>0){const c=new lb(t);s=new qd(c),s.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const f=e[l],d=f.url;if(Array.isArray(d)){const h=[];for(let m=0,p=d.length;m<p;m++){const y=a(d[m]);null!==y&&(y instanceof HTMLImageElement?h.push(y):h.push(new gu(y.data,y.width,y.height)))}r[f.uuid]=new lc(h)}else{const h=a(f.url);r[f.uuid]=new lc(h)}}}return r}parseImagesAsync(e){var t=this;return nd(function*(){const n=t,r={};let s;function o(c){return a.apply(this,arguments)}function a(){return(a=nd(function*(c){if("string"==typeof c){const l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:n.resourcePath+l;return yield s.loadAsync(u)}return c.data?{data:ql(c.type,c.data),width:c.width,height:c.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new qd(t.manager),s.setCrossOrigin(t.crossOrigin);for(let c=0,l=e.length;c<l;c++){const u=e[c],f=u.url;if(Array.isArray(f)){const d=[];for(let h=0,m=f.length;h<m;h++){const p=f[h],g=yield o(p);null!==g&&(g instanceof HTMLImageElement?d.push(g):d.push(new gu(g.data,g.width,g.height)))}r[u.uuid]=new lc(d)}else{const d=yield o(u.url);r[u.uuid]=new lc(d)}}}return r})()}parseTextures(e,t){function n(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=e[s];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const c=t[a.image],l=c.data;let u;Array.isArray(l)?(u=new xd,6===l.length&&(u.needsUpdate=!0)):(u=l&&l.data?new gu:new Bi,l&&(u.needsUpdate=!0)),u.source=c,u.uuid=a.uuid,void 0!==a.name&&(u.name=a.name),void 0!==a.mapping&&(u.mapping=n(a.mapping,lj)),void 0!==a.offset&&u.offset.fromArray(a.offset),void 0!==a.repeat&&u.repeat.fromArray(a.repeat),void 0!==a.center&&u.center.fromArray(a.center),void 0!==a.rotation&&(u.rotation=a.rotation),void 0!==a.wrap&&(u.wrapS=n(a.wrap[0],CP),u.wrapT=n(a.wrap[1],CP)),void 0!==a.format&&(u.format=a.format),void 0!==a.type&&(u.type=a.type),void 0!==a.encoding&&(u.encoding=a.encoding),void 0!==a.minFilter&&(u.minFilter=n(a.minFilter,AP)),void 0!==a.magFilter&&(u.magFilter=n(a.magFilter,AP)),void 0!==a.anisotropy&&(u.anisotropy=a.anisotropy),void 0!==a.flipY&&(u.flipY=a.flipY),void 0!==a.generateMipmaps&&(u.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(u.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(u.unpackAlignment=a.unpackAlignment),void 0!==a.userData&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,n,r,s){let o,u,f;function a(d){return void 0===t[d]&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function c(d){if(void 0!==d){if(Array.isArray(d)){const h=[];for(let m=0,p=d.length;m<p;m++){const g=d[m];void 0===n[g]&&console.warn("THREE.ObjectLoader: Undefined material",g),h.push(n[g])}return h}return void 0===n[d]&&console.warn("THREE.ObjectLoader: Undefined material",d),n[d]}}function l(d){return void 0===r[d]&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}switch(e.type){case"Scene":o=new eg,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new Re(e.background):l(e.background)),void 0!==e.environment&&(o.environment=l(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new Qm(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new Jm(e.fog.color,e.fog.density))),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new Fn(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Fo(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new MP(e.color,e.intensity);break;case"DirectionalLight":o=new mb(e.color,e.intensity);break;case"PointLight":o=new pb(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new SP(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new db(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new vP(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new xg).fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),f=c(e.material),o=new Ux(u,f),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),f=c(e.material),o=new Kn(u,f);break;case"InstancedMesh":u=a(e.geometry),f=c(e.material);const h=e.instanceMatrix,m=e.instanceColor;o=new zx(u,f,e.count),o.instanceMatrix=new _u(new Float32Array(h.array),16),void 0!==m&&(o.instanceColor=new _u(new Float32Array(m.array),m.itemSize));break;case"LOD":o=new CI;break;case"Line":o=new Bo(a(e.geometry),c(e.material));break;case"LineLoop":o=new Hx(a(e.geometry),c(e.material));break;case"LineSegments":o=new Ns(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new Wx(a(e.geometry),c(e.material));break;case"Sprite":o=new TI(c(e.material));break;case"Group":o=new ko;break;case"Bone":o=new sg;break;default:o=new wn}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const d=e.children;for(let h=0;h<d.length;h++)o.add(this.parseObject(d[h],t,n,r,s))}if(void 0!==e.animations){const d=e.animations;for(let h=0;h<d.length;h++)o.animations.push(s[d[h]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let h=0;h<d.length;h++){const m=d[h],p=o.getObjectByProperty("uuid",m.object);void 0!==p&&o.addLevel(p,m.distance,m.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(n){if(!0===n.isSkinnedMesh&&void 0!==n.skeleton){const r=t[n.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const lj={UVMapping:pm,CubeReflectionMapping:sa,CubeRefractionMapping:oa,EquirectangularReflectionMapping:rd,EquirectangularRefractionMapping:sd,CubeUVReflectionMapping:Vl},CP={RepeatWrapping:aa,ClampToEdgeWrapping:ki,MirroredRepeatWrapping:Hl},AP={NearestFilter:Yn,NearestMipmapNearestFilter:od,NearestMipmapLinearFilter:Gl,LinearFilter:Hn,LinearMipmapNearestFilter:mm,LinearMipmapLinearFilter:to};class IP extends vr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=wc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){wc.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let wg;class gb{static getContext(){return void 0===wg&&(wg=new(window.AudioContext||window.webkitAudioContext)),wg}static setContext(e){wg=e}}class uj extends vr{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new Bs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const c=a.slice(0);gb.getContext().decodeAudioData(c,function(u){t(u)})}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}}class fj extends xg{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=(new Re).set(e),s=(new Re).set(t),o=new D(r.r,r.g,r.b),a=new D(s.r,s.g,s.b),c=Math.sqrt(Math.PI),l=c*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(c),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(l)}}class dj extends xg{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=(new Re).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const PP=new gt,RP=new gt,Mc=new gt;class hj{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Fn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Fn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Mc.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(ac*t.fov*.5)/t.zoom;let a,c;RP.elements[12]=-r,PP.elements[12]=r,a=-o*t.aspect+s,c=o*t.aspect+s,Mc.elements[0]=2*t.near/(c-a),Mc.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(Mc),a=-o*t.aspect-s,c=o*t.aspect-s,Mc.elements[0]=2*t.near/(c-a),Mc.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(Mc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(RP),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(PP)}}class _b{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=LP(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=LP();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function LP(){return(typeof performance>"u"?Date:performance).now()}const Sc=new D,OP=new Ci,pj=new D,Ec=new D;class mj extends wn{constructor(){super(),this.type="AudioListener",this.context=gb.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new _b}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Sc,OP,pj),Ec.set(0,0,-1).applyQuaternion(OP),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Sc.x,r),t.positionY.linearRampToValueAtTime(Sc.y,r),t.positionZ.linearRampToValueAtTime(Sc.z,r),t.forwardX.linearRampToValueAtTime(Ec.x,r),t.forwardY.linearRampToValueAtTime(Ec.y,r),t.forwardZ.linearRampToValueAtTime(Ec.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(Sc.x,Sc.y,Sc.z),t.setOrientation(Ec.x,Ec.y,Ec.z,n.x,n.y,n.z)}}class NP extends wn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Tc=new D,FP=new Ci,gj=new D,Dc=new D;class _j extends NP{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Tc,FP,gj),Dc.set(0,0,1).applyQuaternion(FP);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Tc.x,n),t.positionY.linearRampToValueAtTime(Tc.y,n),t.positionZ.linearRampToValueAtTime(Tc.z,n),t.orientationX.linearRampToValueAtTime(Dc.x,n),t.orientationY.linearRampToValueAtTime(Dc.y,n),t.orientationZ.linearRampToValueAtTime(Dc.z,n)}else t.setPosition(Tc.x,Tc.y,Tc.z),t.setOrientation(Dc.x,Dc.y,Dc.z)}}class yj{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class kP{constructor(e,t,n){let r,s,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else o+=t,this._mixBufferRegion(n,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(n,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let c=t,l=t+t;c!==l;++c)if(n[c]!==n[c+t]){a.setValue(n,r);break}}saveOriginalState(){const t=this.buffer,n=this.valueSize,r=n*this._origIndex;this.binding.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){Ci.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;Ci.multiplyQuaternionsFlat(e,o,e,t,e,n),Ci.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[n+o]*r}}}const yb="\\[\\]\\.:\\/",vj=new RegExp("["+yb+"]","g"),vb="[^"+yb+"]",xj="[^"+yb.replace("\\.","")+"]",Ej=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",vb)+/(WCOD+)?/.source.replace("WCOD",xj)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vb)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vb)+"$"),Tj=["material","materials","bones","map"];class Dj{constructor(e,t,n){const r=n||Mn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Mn=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(vj,"")}static parseTrackName(t){const n=Ej.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Tj.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const c=o[a];if(c.name===n||c.uuid===n)return c;const l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let f=0;f<t.length;f++)if(t[f].name===u){u=f;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=Dj,i})();Mn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Mn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Mn.prototype.GetterByBindingType=[Mn.prototype._getValue_direct,Mn.prototype._getValue_array,Mn.prototype._getValue_arrayElement,Mn.prototype._getValue_toArray],Mn.prototype.SetterByBindingTypeAndVersioning=[[Mn.prototype._setValue_direct,Mn.prototype._setValue_direct_setNeedsUpdate,Mn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Mn.prototype._setValue_array,Mn.prototype._setValue_array_setNeedsUpdate,Mn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Mn.prototype._setValue_arrayElement,Mn.prototype._setValue_arrayElement_setNeedsUpdate,Mn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Mn.prototype._setValue_fromArray,Mn.prototype._setValue_fromArray_setNeedsUpdate,Mn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Cj{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Pr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,c=e.length,l=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],h=d.uuid;let m=t[h];if(void 0===m){m=c++,t[h]=m,e.push(d);for(let p=0,g=o;p!==g;++p)s[p].push(new Mn(d,n[p],r[p]))}else if(m<l){a=e[m];const p=--l,g=e[p];t[g.uuid]=m,e[m]=g,t[h]=p,e[p]=d;for(let y=0,v=o;y!==v;++y){const _=s[y];let w=_[m];_[m]=_[p],void 0===w&&(w=new Mn(d,n[y],r[y])),_[p]=w}}else e[m]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const c=arguments[o],l=c.uuid,u=t[l];if(void 0!==u&&u>=s){const f=s++,d=e[f];t[d.uuid]=u,e[u]=d,t[l]=f,e[f]=c;for(let h=0,m=r;h!==m;++h){const p=n[h],y=p[u];p[u]=p[f],p[f]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,c=arguments.length;a!==c;++a){const u=arguments[a].uuid,f=t[u];if(void 0!==f)if(delete t[u],f<s){const d=--s,h=e[d],m=--o,p=e[m];t[h.uuid]=f,e[f]=h,t[p.uuid]=d,e[d]=p,e.pop();for(let g=0,y=r;g!==y;++g){const v=n[g],x=v[m];v[f]=v[d],v[d]=x,v.pop()}}else{const d=--o,h=e[d];d>0&&(t[h.uuid]=f),e[f]=h,e.pop();for(let m=0,p=r;m!==p;++m){const g=n[m];g[f]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(void 0!==r)return s[r];const o=this._paths,a=this._parsedPaths,c=this._objects,u=this.nCachedObjects_,f=new Array(c.length);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(f);for(let d=u,h=c.length;d!==h;++d)f[d]=new Mn(c[d],e,t);return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,c=o[a];t[e[a]]=n,o[n]=c,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class Aj{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:sc,endingEnd:sc};for(let l=0;l!==o;++l){const u=s[l].createInterpolant(null);a[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bA,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,l=a.sampleValues;return c[0]=s,c[1]=s+n,l[0]=e/o,l[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const c=(e-s)*n;c<0||0===n?t=0:(this._startTime=null,t=n*c)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,l=this._propertyBindings;if(this.blendMode===J0)for(let u=0,f=c.length;u!==f;++u)c[u].evaluate(o),l[u].accumulateAdditive(a);else for(let u=0,f=c.length;u!==f;++u)c[u].evaluate(o),l[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===wA;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(n===xA){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===c){const l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=oc,r.endingEnd=oc):(r.endingStart=e?this.zeroSlopeAtStart?oc:sc:ad,r.endingEnd=t?this.zeroSlopeAtEnd?oc:sc:ad)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=n,this}}const Ij=new Float32Array(1);class Pj extends no{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,c=n.uuid,l=this._bindingsByRootAndName;let u=l[c];void 0===u&&(u={},l[c]=u);for(let f=0;f!==s;++f){const d=r[f],h=d.name;let m=u[h];if(void 0!==m)++m.referenceCount,o[f]=m;else{if(m=o[f],void 0!==m){null===m._cacheIndex&&(++m.referenceCount,this._addInactiveBinding(m,c,h));continue}m=new kP(Mn.create(n,h,t&&t._propertyBindings[f].binding.parsedPath),d.ValueTypeName,d.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,c,h),o[f]=m}a[f].resultBuffer=m.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===c.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],c=t[t.length-1],l=e._cacheIndex;c._cacheIndex=l,t[l]=c,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new ab(new Float32Array(2),new Float32Array(2),1,Ij),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o="string"==typeof e?Eu.findByName(r,e):e;const a=null!==o?o.uuid:e,c=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:wm),void 0!==c){const f=c.actionByRoot[s];if(void 0!==f&&f.blendMode===n)return f;l=c.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const u=new Aj(this,o,t,n);return this._bindAction(u,l),this._addInactiveAction(u,a,s),u}existingAction(e,t){const n=t||this._root,r=n.uuid,s="string"==typeof e?Eu.findByName(n,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)e[n].stop();return this}update(e){const t=this._actions,n=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(r,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)a[l].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(void 0!==s){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const l=o[a];this._deactivateAction(l);const u=l._cacheIndex,f=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,f._cacheIndex=u,t[u]=f,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const c=n[o].actionByRoot[t];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class xb{constructor(e){this.value=e}clone(){return new xb(void 0===this.value.clone?this.value:this.value.clone())}}let Rj=0;class Lj extends no{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Rj++}),this.name="",this.usage=cd,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++)this.uniforms.push(t[n].clone());return this}clone(){return(new this.constructor).copy(this)}}class Oj extends wd{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Nj{constructor(e,t,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class bb{constructor(e,t,n=0,r=1/0){this.ray=new pd(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new hc,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return wb(e,this,n,t),n.sort(BP),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)wb(e[r],this,n,t);return n.sort(BP),n}}function BP(i,e){return i.distance-e.distance}function wb(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),!0===n){const r=i.children;for(let s=0,o=r.length;s<o;s++)wb(r[s],e,t,!0)}}class Mb{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ri(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Fj{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const UP=new oe;class kj{constructor(e=new oe(1/0,1/0),t=new oe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=UP.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return UP.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const zP=new D,Mg=new D;class Bj{constructor(e=new D,t=new D){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){zP.subVectors(e,this.start),Mg.subVectors(this.end,this.start);const n=Mg.dot(Mg);let s=Mg.dot(zP)/n;return t&&(s=ri(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const VP=new D;class Uj extends wn{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Nt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){const l=o/c*Math.PI*2,u=a/c*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new We(r,3));const s=new $i({fog:!1,toneMapped:!1});this.cone=new Ns(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),VP.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VP),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ma=new D,Sg=new gt,Sb=new gt;class zj extends Ns{constructor(e){const t=HP(e),n=new Nt,r=[],s=[],o=new Re(0,0,1),a=new Re(0,1,0);for(let l=0;l<t.length;l++){const u=t[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new We(r,3)),n.setAttribute("color",new We(s,3)),super(n,new $i({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Sb.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Sg.multiplyMatrices(Sb,a.matrixWorld),Ma.setFromMatrixPosition(Sg),r.setXYZ(o,Ma.x,Ma.y,Ma.z),Sg.multiplyMatrices(Sb,a.parent.matrixWorld),Ma.setFromMatrixPosition(Sg),r.setXYZ(o+1,Ma.x,Ma.y,Ma.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function HP(i){const e=[];!0===i.isBone&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,HP(i.children[t]));return e}class Vj extends Kn{constructor(e,t,n){super(new bu(t,4,2),new Lr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Hj=new D,GP=new Re,WP=new Re;class Gj extends wn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new xu(t);r.rotateY(.5*Math.PI),this.material=new Lr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(3*s.count);r.setAttribute("color",new fn(o,3)),this.add(new Kn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");GP.copy(this.light.color),WP.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?GP:WP;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Hj.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Wj extends Ns{constructor(e=10,t=10,n=4473924,r=8947848){n=new Re(n),r=new Re(r);const s=t/2,o=e/t,a=e/2,c=[],l=[];for(let d=0,h=0,m=-a;d<=t;d++,m+=o){c.push(-a,0,m,a,0,m),c.push(m,0,-a,m,0,a);const p=d===s?n:r;p.toArray(l,h),h+=3,p.toArray(l,h),h+=3,p.toArray(l,h),h+=3,p.toArray(l,h),h+=3}const u=new Nt;u.setAttribute("position",new We(c,3)),u.setAttribute("color",new We(l,3)),super(u,new $i({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class jj extends Ns{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new Re(s),o=new Re(o);const a=[],c=[];if(t>1)for(let f=0;f<t;f++){const d=f/t*(2*Math.PI),h=Math.sin(d)*e,m=Math.cos(d)*e;a.push(0,0,0),a.push(h,0,m);const p=1&f?s:o;c.push(p.r,p.g,p.b),c.push(p.r,p.g,p.b)}for(let f=0;f<n;f++){const d=1&f?s:o,h=e-e/n*f;for(let m=0;m<r;m++){let p=m/r*(2*Math.PI),g=Math.sin(p)*h,y=Math.cos(p)*h;a.push(g,0,y),c.push(d.r,d.g,d.b),p=(m+1)/r*(2*Math.PI),g=Math.sin(p)*h,y=Math.cos(p)*h,a.push(g,0,y),c.push(d.r,d.g,d.b)}}const l=new Nt;l.setAttribute("position",new We(a,3)),l.setAttribute("color",new We(c,3)),super(l,new $i({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const jP=new D,Eg=new D,$P=new D;class $j extends wn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new Nt;r.setAttribute("position",new We([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new $i({fog:!1,toneMapped:!1});this.lightPlane=new Bo(r,s),this.add(this.lightPlane),r=new Nt,r.setAttribute("position",new We([0,0,0,0,0,1],3)),this.targetLine=new Bo(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),jP.setFromMatrixPosition(this.light.matrixWorld),Eg.setFromMatrixPosition(this.light.target.matrixWorld),$P.subVectors(Eg,jP),this.lightPlane.lookAt(Eg),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Eg),this.targetLine.scale.z=$P.length()}}const Tg=new D,Jn=new Wm;class qj extends Ns{constructor(e){const t=new Nt,n=new $i({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};function a(m,p){c(m),c(p)}function c(m){r.push(0,0,0),s.push(0,0,0),void 0===o[m]&&(o[m]=[]),o[m].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new We(r,3)),t.setAttribute("color",new We(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const l=new Re(16755200),u=new Re(16711680),f=new Re(43775),d=new Re(16777215),h=new Re(3355443);this.setColors(l,u,f,d,h)}setColors(e,t,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;Jn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),si("c",t,e,Jn,0,0,-1),si("t",t,e,Jn,0,0,1),si("n1",t,e,Jn,-1,-1,-1),si("n2",t,e,Jn,1,-1,-1),si("n3",t,e,Jn,-1,1,-1),si("n4",t,e,Jn,1,1,-1),si("f1",t,e,Jn,-1,-1,1),si("f2",t,e,Jn,1,-1,1),si("f3",t,e,Jn,-1,1,1),si("f4",t,e,Jn,1,1,1),si("u1",t,e,Jn,.7,1.1,-1),si("u2",t,e,Jn,-.7,1.1,-1),si("u3",t,e,Jn,0,2,-1),si("cf1",t,e,Jn,-1,0,1),si("cf2",t,e,Jn,1,0,1),si("cf3",t,e,Jn,0,-1,1),si("cf4",t,e,Jn,0,1,1),si("cn1",t,e,Jn,-1,0,-1),si("cn2",t,e,Jn,1,0,-1),si("cn3",t,e,Jn,0,-1,-1),si("cn4",t,e,Jn,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function si(i,e,t,n,r,s,o){Tg.set(r,s,o).unproject(n);const a=e[i];if(void 0!==a){const c=t.getAttribute("position");for(let l=0,u=a.length;l<u;l++)c.setXYZ(a[l],Tg.x,Tg.y,Tg.z)}}const Dg=new da;class Xj extends Ns{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Nt;s.setIndex(new fn(n,1)),s.setAttribute("position",new fn(r,3)),super(s,new $i({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Dg.setFromObject(this.object),Dg.isEmpty())return;const t=Dg.min,n=Dg.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Zj extends Ns{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Nt;s.setIndex(new fn(n,1)),s.setAttribute("position",new We([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new $i({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Yj extends Bo{constructor(e,t=1,n=16776960){const r=n,o=new Nt;o.setAttribute("position",new We([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),o.computeBoundingSphere(),super(o,new $i({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=new Nt;c.setAttribute("position",new We([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),c.computeBoundingSphere(),this.add(new Kn(c,new Lr({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const qP=new D;let Cg,Eb;class Kj extends wn{constructor(e=new D(0,0,1),t=new D(0,0,0),n=1,r=16776960,s=.2*n,o=.2*s){super(),this.type="ArrowHelper",void 0===Cg&&(Cg=new Nt,Cg.setAttribute("position",new We([0,0,0,0,1,0],3)),Eb=new gc(0,.5,1,5,1),Eb.translate(0,-.5,0)),this.position.copy(t),this.line=new Bo(Cg,new $i({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Kn(Eb,new Lr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{qP.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(qP,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Jj extends Ns{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Nt;r.setAttribute("position",new We(t,3)),r.setAttribute("color",new We([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new $i({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Re,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Qj{constructor(){this.type="ShapePath",this.color=new Re,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Id,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(y,v){const _=v.length;let x=!1;for(let w=_-1,M=0;M<_;w=M++){let E=v[w],b=v[M],S=b.x-E.x,A=b.y-E.y;if(Math.abs(A)>Number.EPSILON){if(A<0&&(E=v[M],S=-S,b=v[w],A=-A),y.y<E.y||y.y>b.y)continue;if(y.y===E.y){if(y.x===E.x)return!0}else{const O=A*(y.x-E.x)-S*(y.y-E.y);if(0===O)return!0;if(O<0)continue;x=!x}}else{if(y.y!==E.y)continue;if(b.x<=y.x&&y.x<=E.x||E.x<=y.x&&y.x<=b.x)return!0}}return x}const r=ro.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,a,c;const l=[];if(1===s.length)return a=s[0],c=new _c,c.curves=a.curves,l.push(c),l;let u=!r(s[0].getPoints());u=e?!u:u;const f=[],d=[];let p,g,h=[],m=0;d[m]=void 0,h[m]=[];for(let y=0,v=s.length;y<v;y++)a=s[y],p=a.getPoints(),o=r(p),o=e?!o:o,o?(!u&&d[m]&&m++,d[m]={s:new _c,p},d[m].s.curves=a.curves,u&&m++,h[m]=[]):h[m].push({h:a,p:p[0]});if(!d[0])return function t(y){const v=[];for(let _=0,x=y.length;_<x;_++){const w=y[_],M=new _c;M.curves=w.curves,v.push(M)}return v}(s);if(d.length>1){let y=!1,v=0;for(let _=0,x=d.length;_<x;_++)f[_]=[];for(let _=0,x=d.length;_<x;_++){const w=h[_];for(let M=0;M<w.length;M++){const E=w[M];let b=!0;for(let S=0;S<d.length;S++)n(E.p,d[S].p)&&(_!==S&&v++,b?(b=!1,f[S].push(E)):y=!0);b&&f[_].push(E)}}v>0&&!1===y&&(h=f)}for(let y=0,v=d.length;y<v;y++){c=d[y].s,l.push(c),g=h[y];for(let _=0,x=g.length;_<x;_++)c.holes.push(g[_].h)}return l}}const Ho=e9();function e9(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const l=c-127;l<-27?(n[c]=0,n[256|c]=32768,r[c]=24,r[256|c]=24):l<-14?(n[c]=1024>>-l-14,n[256|c]=1024>>-l-14|32768,r[c]=-l-1,r[256|c]=-l-1):l<=15?(n[c]=l+15<<10,n[256|c]=l+15<<10|32768,r[c]=13,r[256|c]=13):l<128?(n[c]=31744,n[256|c]=64512,r[c]=24,r[256|c]=24):(n[c]=31744,n[256|c]=64512,r[c]=13,r[256|c]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;!(8388608&l);)l<<=1,u-=8388608;l&=-8388609,u+=947912704,s[c]=l|u}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)32!==c&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}var i9=Object.freeze({__proto__:null,fromHalfFloat:function n9(i){const e=i>>10;return Ho.uint32View[0]=Ho.mantissaTable[Ho.offsetTable[e]+(1023&i)]+Ho.exponentTable[e],Ho.floatView[0]},toHalfFloat:function t9(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=ri(i,-65504,65504),Ho.floatView[0]=i;const e=Ho.uint32View[0],t=e>>23&511;return Ho.baseTable[t]+((8388607&e)>>Ho.shiftTable[t])}});class r9 extends ya{constructor(e,t,n,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,r,s,o)}}class s9 extends Pd{constructor(e,t,n,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,r)}}class o9 extends Rd{constructor(e,t,n,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,r)}}class a9 extends Ld{constructor(e,t,n,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,r,s,o,a)}}class c9 extends gc{constructor(e,t,n,r,s,o,a,c){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,r,s,o,a,c)}}class l9 extends Od{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class u9 extends Bd{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class f9 extends Ud{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class d9 extends yu{constructor(e,t,n,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,r)}}class h9 extends xu{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class p9 extends cu{constructor(e,t,n,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,r)}}class m9 extends Uo{constructor(e,t,n,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,r)}}class g9 extends zd{constructor(e,t,n,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,r,s,o)}}class _9 extends Vd{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class y9 extends bu{constructor(e,t,n,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,r,s,o,a)}}class v9 extends Hd{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class x9 extends Gd{constructor(e,t,n,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,r,s)}}class b9 extends Wd{constructor(e,t,n,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,r,s,o)}}class w9 extends jd{constructor(e,t,n,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:dm}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=dm);const Ag=new class S9 extends _C{}(class M9 extends gC{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}});class A9 extends gn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Th(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new kn;const t=this.getSubject();e.add(this.source.subscribe(vn(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=kn.EMPTY)}return e}refCount(){return function C9(){return Tn((i,e)=>{let t=null;i._refCount++;const n=vn(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}()(this)}}const P9={connector:()=>new fr};function XP(i,e=P9){const{connector:t}=e;return Tn((n,r)=>{const s=t();Ti(i(function I9(i){return new gn(e=>i.subscribe(e))}(s))).subscribe(r),r.add(n.subscribe(s))})}function ZP(i,e){const t=Mt(i)?i:()=>i;return Mt(e)?XP(e,{connector:t}):n=>new A9(n,t)}const F9=(i,e)=>Object.assign(Object.assign({},i),e);function k9(i=new fr,e=new fr,t=new fm(F9)){const n=At(i.pipe(Bl(),Ie(),St(Ag)),e.pipe(St(Ag))).pipe(function E9(...i){const e=Ln(i);return Tn((t,n)=>{const r=i.length,s=new Array(r);let o=i.map(()=>!1),a=!1;for(let c=0;c<r;c++)Ti(i[c]).subscribe(vn(n,l=>{s[c]=l,!a&&!o[c]&&(o[c]=!0,(a=o.every(ms))&&(o=null))},Ki));t.subscribe(vn(n,c=>{if(a){const l=[c,...s];n.next(e?e(...l):l)}}))})}(t.pipe(St(Ag))),function D9(i,e){return Tn(function T9(i,e,t,n,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(vn(o,u=>{const f=l++;c=a?i(c,u,f):(a=!0,u),n&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}(i,e,arguments.length>=2,!0))}((u,[f,d])=>d(u,f),{}),td(u=>s.state=u,u=>console.error(u)),um(u=>Ge),function R9(i){return i?e=>XP(i)(e):e=>ZP(new fr)(e)}()),r=n.pipe(function L9(i,e,t,n){t&&!Mt(t)&&(n=t);const r=Mt(t)?t:void 0;return s=>ZP(new kl(i,e,n),r)(s)}(1)),s={state:{},signal$:n,state$:r,nextSlice:function a(u){e.next(u)},nextSliceObservable:function c(u){i.next(u)},nextAccumulator:function o(u){t.next(u)},subscribe:function l(){const u=s.signal$.connect();return u.add(s.state$.connect()),u.add(()=>{t.complete(),i.complete(),e.complete()}),u}};return s}function YP(i){return!!Array.isArray(i)&&i.length>0&&i.every(e=>"function"==typeof e)}function KP(i){return!!Array.isArray(i)&&i.length>0&&i.every(e=>"string"==typeof e)}function Zd(i){return null!=i&&["string","symbol","number"].includes(typeof i)}function JP(i){return null!=i&&"object"==typeof i&&!Array.isArray(i)}function QP(i){return null!=i}function eR(i){return i?1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}:Ki}function Yd(...i){return e=>e.pipe(Bl(),t=>YP(i)?t.pipe(eR(i)):t,Ul(t=>void 0!==t),Bl(),function O9(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=i??1/0,st({connector:()=>new kl(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}({bufferSize:1,refCount:!0}))}function Kd(i,e){if(!QP(i))return i;if(!QP(e))return;const t=(Array.isArray(e)?e:[e]).filter(r=>Zd(r));if(0===t.length||!JP(i)||0===Object.keys(i).length)return;let n=i[t.shift()];return t.forEach(r=>{JP(n)&&Zd(r)&&(n=n[r])}),n}function tR(i,e){return i===e}function nR(i,e){return t=>t.pipe(Ul(n=>void 0!==n),Dn(n=>{if(null===n)return null;const r=i.filter(s=>n.hasOwnProperty(s)&&void 0!==n[s]);return r.length<i.length?void 0:r.reduce((s,o)=>(s[o]=n[o],s),{})}),Ul(n=>void 0!==n),function z9(i,e){let t=(n,r)=>i.some(s=>!tR(Kd(n,[s]),Kd(r,[s])));if(void 0!==e){const n=r=>e.hasOwnProperty(r)&&void 0!==e[r]?e[r]:tR;t=(r,s)=>i.some(o=>!n(o)(Kd(r,[o]),Kd(s,[o])))}return Bl((n,r)=>!t(n,r))}(i,e))}let G9=(()=>{class i{constructor(){this.subscription=new kn,this.accumulator=k9(),this.effectObservable=function H9(i=new fr){const e=At(i.pipe(Ie(),St(Ag)));return{effects$:e,nextEffectObservable:function t(r){i.next(r)},subscribe:function n(){return e.subscribe()}}}(),this.$=this.accumulator.signal$,this.subscription.add(this.subscribe())}ngOnDestroy(){this.subscription.unsubscribe()}setAccumulator(t){this.accumulator.nextAccumulator(t)}get(...t){const n=Object.keys(this.accumulator.state).length>0;return t&&t.length?Kd(this.accumulator.state,t):n?this.accumulator.state:void 0}set(t,n){if("object"!=typeof t||void 0!==n){if("function"!=typeof t||void 0!==n){if(Zd(t)&&"function"==typeof n){const r={};return r[t]=n(this.accumulator.state),void this.accumulator.nextSlice(r)}throw new Error("wrong params passed to set")}this.accumulator.nextSlice(t(this.accumulator.state))}else this.accumulator.nextSlice(t)}connect(t,n,r){if(void 0===r&&void 0===n&&Ka(t))this.accumulator.nextSliceObservable(t);else if(void 0!==r||"function"!=typeof n||!Ka(t)||Ka(n))if(void 0===r&&Zd(t)&&Ka(n)){const s=t,o=n.pipe(Dn(a=>Object.assign({},{[s]:a})));this.accumulator.nextSliceObservable(o)}else{if("function"!=typeof r||!Zd(t)||!Ka(n))throw new Error("wrong params passed to connect");{const s=t,o=n.pipe(Dn(a=>Object.assign({},{[s]:r(this.get(),a)})));this.accumulator.nextSliceObservable(o)}}else{const s=n,o=t.pipe(Dn(a=>s(this.get(),a)));this.accumulator.nextSliceObservable(o)}}select(...t){return this.accumulator.state$.pipe(function V9(...i){return e=>{if(!i||0===i.length)return e.pipe(Yd());if(function B9(i){return"string"==typeof i[0]&&"function"==typeof i[1]}(i))return e.pipe(Yd(Dn(t=>i[1](t[i[0]]))));if(function U9(i){return KP(i[0])&&"function"==typeof i[1]&&(void 0===i[2]||"object"==typeof i[2])}(i))return e.pipe(nR(i[0],i[2]),Yd(Dn(i[1])));if(KP(i))return e.pipe(Yd(function N9(...i){const e=i.length;if(0===e)throw new Error("list of properties cannot be empty.");return Dn(t=>{let n=t;for(let r=0;r<e;r++){const s=n?.[i[r]];if(!(typeof s<"u"))return;n=s}return n})}(...i)));if(YP(i))return e.pipe(Yd(eR(i)));throw new Error("wrong params passed to select")}}(...t))}hold(t,n){const r=t.pipe(um(s=>Ge));this.effectObservable.nextEffectObservable("function"!=typeof n?r:r.pipe(td(n)))}subscribe(){const t=new kn;return t.add(this.accumulator.subscribe()),t.add(this.effectObservable.subscribe()),t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();const rR=["glCanvas"],j9=["portalContentAnchor"];function $9(i,e){if(1&i){const t=qy();wo(0,"ngt-portal-before-render",2),Al("beforeRender",function(r){return M_(t),S_(Pp().onBeforeRender(r))}),ta()}if(2&i){const t=Pp();Kr("renderPriority",t.autoRenderPriority)("parentScene",t.parentScene)("parentCamera",t.parentCamera)}}const sR={};function Jd(i){if(i)return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId;const e=ix.generateUUID();return sR[e]?Jd():(sR[e]=!0,e)}function Db(i,e){const t=e?.devicePixelRatio||1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}const Ig=new Map;function Pg(i,e,t,n){const r=Ka(e)?e:g0(e),s=Un(Eo);return r.pipe(Dn(o=>{const c=new(i(o));return t&&t(c),[(Array.isArray(o)?o:"string"==typeof o?[o]:Object.values(o)).map(u=>(Ig.has(u)||Ig.set(u,et(c.loadAsync(u,n)).pipe(td(f=>{f.scene&&Object.assign(f,function Z9(i){const e={nodes:{},materials:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),"material"in t&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}(f.scene))}),function qH(i=1/0){let e;e=i&&"object"==typeof i?i:{count:i};const{count:t=1/0,delay:n,resetOnSuccess:r=!1}=e;return t<=0?ms:Tn((s,o)=>{let c,a=0;const l=()=>{let u=!1;c=s.subscribe(vn(o,f=>{r&&(a=0),o.next(f)},void 0,f=>{if(a++<t){const d=()=>{c?(c.unsubscribe(),c=null,l()):u=!0};if(null!=n){const h="number"==typeof n?function $H(i=0,e,t=RH){let n=-1;return null!=e&&(yt(e)?t=e:n=e),new gn(r=>{let s=function jH(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}(n):Ti(n(f,a)),m=vn(o,()=>{m.unsubscribe(),d()},()=>{o.complete()});h.subscribe(m)}else d()}else o.error(f)})),u&&(c.unsubscribe(),c=null,l())};l()})}(2),um(f=>(console.error(`[NGT] Error loading ${u}: ${f.message}`),g0([]))),st({connector:()=>new kl(1)}))),Ig.get(u))),o]}),EC(([o,a])=>function QH(...i){const e=Ln(i),{args:t,keys:n}=TC(i),r=new gn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let u=0;u<o;u++){let f=!1;Ti(t[u]).subscribe(vn(s,d=>{f||(f=!0,l--),a[u]=d},()=>c--,void 0,()=>{(!c||!f)&&(l||s.next(n?DC(n,a):a),s.complete())}))}});return e?r.pipe(p0(e)):r}(o).pipe(Dn(c=>{if(Array.isArray(a))return c;if("string"==typeof a)return c[0];const l=Object.keys(a);return l.reduce((u,f)=>(u[f]=c[l.indexOf(f)],u),{})}),td(()=>{requestAnimationFrame(()=>s.detectChanges())}))))}Pg.destroy=()=>{Ig.clear()},Pg.preLoad=(i,e,t)=>{Pg(i,e,t).pipe(function eG(i){return i<=0?()=>Ge:Tn((e,t)=>{let n=0;e.subscribe(vn(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}(1)).subscribe()};const oR=Pg,aR=new Set,cR=new Set,lR=new Set;function Ab(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function Qd(i,e){switch(i){case"before":return Ab(aR,e);case"after":return Ab(cR,e);case"tail":return Ab(lR,e)}}function Ib(i,e,t){const n=e.get();let r=n.clock.getDelta();"never"===n.frameloop&&"number"==typeof i&&(r=i-n.clock.elapsedTime,n.clock.oldTime=n.clock.elapsedTime,n.clock.elapsedTime=i);for(let s=0;s<n.internal.subscribers.length;s++)n.internal.subscribers[s].callback({...n,delta:r,frame:t});return!n.internal.priority&&n.gl.render&&n.gl.render(n.scene,n.camera),n.internal.frames=Math.max(0,n.internal.frames-1),"always"===n.frameloop?1:n.internal.frames}const Yt={obj:i=>i===Object(i)&&!Array.isArray(i)&&"function"!=typeof i,material:i=>!!i&&i.isMaterial,geometry:i=>!!i&&i.isBufferGeometry,orthographicCamera:i=>!!i&&i.isOrthographicCamera,perspectiveCamera:i=>!!i&&i.isPerspectiveCamera,camera:i=>!!i&&i.isCamera,renderer:i=>!!i&&i instanceof Km,scene:i=>!!i&&i.isScene,object3D:i=>!!i&&i.isObject3D,instance:i=>!!i&&!!i.__ngt__,ref:i=>i instanceof Xs,equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if("string"==typeof i||"number"==typeof i)return i===e;const s=Yt.obj(i);if(s&&"reference"===n)return i===e;const o=Array.isArray(i);if(o&&"reference"===t)return i===e;if((o||s)&&i===e)return!0;let a;for(a in i)if(!(a in e))return!1;for(a in r?e:i)if(i[a]!==e[a])return!1;if(void 0===a){if(o&&0===i.length&&0===e.length||s&&0===Object.keys(i).length&&0===Object.keys(e).length)return!0;if(i!==e)return!1}return!0}};function uR(i){null!==i&&Yt.obj(i)&&"needsUpdate"in i&&(i.needsUpdate=!0,"uniformsNeedUpdate"in i&&(i.uniformsNeedUpdate=!0))}function fR(i){Yt.object3D(i)&&i.updateMatrix(),Yt.camera(i)&&((Yt.perspectiveCamera(i)||Yt.orthographicCamera(i))&&i.updateProjectionMatrix(),i.updateMatrixWorld()),uR(i)}function Pb(i,e){i.manual||(Yt.orthographicCamera(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix(),i.updateMatrixWorld())}function Kt(i){return i&&i.__ngt__||{}}function eh(i){const e=Kt(i).store?.get();e&&0===e.internal.frames&&e.invalidate(),fR(i)}function th(i,e){const t="function"==typeof i?i():i;if(e?.primitive||!t.__ngt__){const{objects:n=new fm([]),nonObjects:r=new fm([]),...s}=e||{};t.__ngt__={previousAttach:null,store:null,parent:null,memoized:{},eventCount:0,handlers:{},objects:n,nonObjects:r,add:(o,a)=>{const c=t.__ngt__[a].value,l=c.indexOf(u=>u===o);l>-1?(c.splice(l,1,o),t.__ngt__[a].next(c)):t.__ngt__[a].next([...t.__ngt__[a].value,o]),Rb(t.__ngt__.parent)},remove:(o,a)=>{t.__ngt__[a].next(t.__ngt__[a].value.filter(c=>c!==o)),Rb(t.__ngt__.parent)},...s}}return t}function Rb(i){if(!i)return;const e=Kt(i);e.objects&&e.objects.next(e.objects.value),e.nonObjects&&e.nonObjects.next(e.nonObjects.value),Rb(e.parent)}function Cc(i,e){if(!Object.keys(e).length)return i;const t=Kt(i),n=t.store?.get(),r=function K9(i,e){const t=Object.entries(e),n=[];for(const[r,s]of t)Yt.equ(s,i[r])||n.push([r,s]);return n}(i,e);for(let o=0;o<r.length;o++){const a=r[o][0],c=i,l=c[a],u=r[o][1];if(l&&l.set&&(l.copy||l instanceof hc)){const f=l instanceof Re;if(Array.isArray(u))l.fromArray?l.fromArray(u):l.set(...u);else if(l.copy&&u&&u.constructor&&l.constructor.name===u.constructor.name)l.copy(u),!fi&&!n.linear&&f&&l.convertSRGBToLinear();else if(void 0!==u){const d=l instanceof Re;!d&&l.setScalar?l.setScalar(u):l instanceof hc&&u instanceof hc?l.mask=u.mask:l.set(u),!fi&&!n?.linear&&d&&l.convertSRGBToLinear()}}else c[a]=u,!n?.linear&&c[a]instanceof Bi&&(c[a].encoding=rn);fR(l),eh(i)}return t.parent&&n.internal&&i.raycast&&t.eventCount!=t.eventCount&&(n.removeInteraction(i.uuid),t.eventCount&&n.addInteraction(i)),t.parent&&t.afterUpdate&&t.afterUpdate.observed&&r.length&&t.afterUpdate.emit(i),i}let Lb=(()=>{class i extends G9{constructor(){super(),this.cache={},this.set({__ngt_dummy__:"__ngt_dummy__"}),this.initialize();const t=this.set.bind(this);Object.defineProperty(this,"set",{get:()=>(...n)=>{const r=n[0];if(Yt.obj(r)){const s=Object.entries(r).reduce((o,[a,c])=>(o[a]=void 0===c?this.get(a):c,o),{});return t(s)}return t(...n)}})}initialize(){}effect(t,n){return this.hold(t.pipe(function J9(i){let n,e=()=>{},t=!1;const r=s=>()=>{e&&e({prev:n,complete:!0,error:s})};return td({next:s=>{e&&t&&e({prev:n,complete:!1,error:!1});const o=i(s);o&&(e=o),n=s,t||(t=!0)},complete:r(!1),unsubscribe:r(!1),error:r(!0)})}(n)))}triggerChangeDetection(t,n=[]){let r=this.$;n.length&&(r=function tG(...i){const e=Gt(i),t=Ln(i),{args:n,keys:r}=TC(i);if(0===n.length)return et([],e);const s=new gn(function nG(i,e,t=ms){return n=>{CC(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)CC(e,()=>{const l=et(i[c],e);let u=!1;l.subscribe(vn(n,f=>{s[c]=f,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>DC(r,o):ms));return t?s.pipe(p0(t)):s}(n.map(s=>this.select(s).pipe(IC(this.get(s)??void 0))))),this.hold(r,()=>{requestAnimationFrame(()=>{t.detectChanges()})})}key$(...t){const n=t.join(".");return this.cache[n]||(this.cache[n]=this.select(...t).pipe(IC(this.get(...t)??void 0),Bl())),this.cache[n]}ngOnDestroy(){this.cache={},super.ngOnDestroy()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();const Ob=new Map,{invalidate:Nb,advance:dR}=function Y9(i){let t,n,e=!1;function r(a){n=requestAnimationFrame(r),e=!0,t=0,Qd("before",a);for(const c of i.values()){const l=c.get();l.internal.active&&("always"===l.frameloop||l.internal.frames>0)&&!l.gl.xr?.isPresenting&&(t+=Ib(a,c))}if(Qd("after",a),0===t)return Qd("tail",a),e=!1,cancelAnimationFrame(n)}return{loop:r,invalidate:function s(a,c=1){const l=a?.get();if(!l)return i.forEach(u=>s(u,c));l.gl.xr?.isPresenting||!l.internal.active||"never"===l.frameloop||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(r)))},advance:function o(a,c=!0,l,u){const f=l?.get();if(c&&Qd("before",a),f)Ib(a,l,u);else for(const d of i.values())Ib(a,d);c&&Qd("after",a)}}}(Ob),Du={objects:"shallow",strict:!1};let rs=(()=>{class i extends Lb{constructor(){super(...arguments),this.parentStore=Un(i,{optional:!0,skipSelf:!0}),this.window=Un(Jr).defaultView,this.isInit=!1}init(){if(!this.isInit){const t=new D,n=new D,r=new D,s=(l=this.get("camera"),u=n,f=this.get("size"))=>{const{width:d,height:h,top:m,left:p}=f,g=d/h;u instanceof D?r.copy(u):r.set(...u);const y=l.getWorldPosition(t).distanceTo(r);if(Yt.orthographicCamera(l))return{width:d/l.zoom,height:h/l.zoom,top:m,left:p,factor:1,distance:y,aspect:g};const v=l.fov*Math.PI/180,_=2*Math.tan(v/2)*y,x=_*g;return{width:x,height:_,top:m,left:p,factor:d/x,distance:y,aspect:g}},o=new oe;let a;const c=l=>{this.set(u=>({performance:{...u.performance,current:l}}))};this.set({get:this.get.bind(this),set:this.set.bind(this),select:this.select.bind(this),ready:!1,scene:th(new eg,{store:this}),events:{priority:1,enabled:!0,connected:!1},invalidate:(l=1)=>Nb(this,l),advance:(l,u)=>dR(l,u,this),legacy:!1,linear:!1,flat:!1,controls:null,clock:new _b,pointer:o,frameloop:"always",performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const l=this.get();a&&clearTimeout(a),l.performance.current!==l.performance.min&&c(l.performance.min),a=setTimeout(()=>c(this.get("performance","max")||1),l.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:s},previousStore:this.parentStore,internal:{active:!1,priority:0,frames:0,lastEvent:null,interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(l,u=0,f=this)=>{const d=this.get("internal");return d.priority=d.priority+(u>0?1:0),d.subscribers.push({priority:u,store:f,callback:l}),d.subscribers.sort((h,m)=>(h.priority||0)-(m.priority||0)),()=>{const h=this.get("internal");h?.subscribers&&(h.priority=h.priority-(u>0?1:0),h.subscribers=h.subscribers.filter(m=>m.callback!==l))}}},setEvents:l=>{this.set(u=>({events:{...u.events,...l}}))},setSize:(l,u,f,d)=>{const h=this.get("camera"),m={width:l,height:u,top:f||0,left:d||0};this.set(p=>({size:m,viewport:{...p.viewport,...s(h,n,m)}}))},setDpr:l=>{const u=Db(l,this.window);this.set(f=>({viewport:{...f.viewport,dpr:u,initialDpr:f.viewport.initialDpr||u}}))},setFrameloop:(l="always")=>{const u=this.get("clock");u.stop(),u.elapsedTime=0,"never"!==l&&(u.start(),u.elapsedTime=0),this.set({frameloop:l})},addInteraction:l=>{this.set(u=>({internal:{...u.internal,interaction:[...u.internal.interaction,l]}}))},removeInteraction:l=>{this.set(u=>({internal:{...u.internal,interaction:u.internal.interaction.filter(f=>f.uuid!==l)}}))}}),this.isInit=!0,this.resize()}}configure(t,n){const{gl:r,size:s,camera:o,raycaster:a,events:c,orthographic:l,lookAt:u,shadows:f,linear:d,legacy:h,flat:m,dpr:p,frameloop:g,performance:y}=t,v=this.get(),_={};let x=v.gl;v.gl||(_.gl=x=function X9(i,e){const t="function"==typeof i?i(e):i;return null!=t?.render?t:new Km({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...i||{}})}(r,n));let w=v.raycaster;w||(_.raycaster=w=new bb);const{params:M,...E}=a||{};if(Yt.equ(E,w,Du)||Cc(w,{...E}),Yt.equ(M,w.params,Du)||Cc(w,{params:{...w.params,...M||{}}}),!v.camera){const O=Yt.camera(o);let U=O?o:function q9(i,e){return i?new Fo(0,0,0,0,.1,1e3):new Fn(75,e.width/e.height,.1,1e3)}(l||!1,v.size);O||(o&&Cc(U,o),o?.position||(U.position.z=5),o?.rotation||(Array.isArray(u)?U.lookAt(u[0],u[1],u[2]):u instanceof D?U.lookAt(u):U.lookAt(0,0,0)),U.updateProjectionMatrix()),Yt.instance(U)||(U=th(U,{store:this})),_.camera=U}if(!v.xr){const O=(L,V)=>{"never"!==this.get().frameloop&&dR(L,!0,this,V)},U=()=>{const L=this.get();L.gl.xr.enabled=L.gl.xr.isPresenting,L.gl.xr.setAnimationLoop(L.gl.xr.isPresenting?O:null),L.gl.xr.isPresenting||Nb(this)},k={connect:()=>{x.xr.addEventListener("sessionstart",U),x.xr.addEventListener("sessionend",U)},disconnect:()=>{x.xr.removeEventListener("sessionstart",U),x.xr.removeEventListener("sessionend",U)}};x.xr&&k.connect(),_.xr=k}if(x.shadowMap){const O="boolean"==typeof f;if(O&&x.shadowMap.enabled!==f||!Yt.equ(f,x.shadowMap,Du)){const U=x.shadowMap.enabled;x.shadowMap.enabled=!!f,O?x.shadowMap.type=v0:Object.assign(x.shadowMap,f),U!==x.shadowMap.enabled&&uR(x.shadowMap)}}fi&&(fi.legacyMode=h??!0);const b=d?Ao:rn,S=m?Cs:D0;x.outputEncoding!==b&&(x.outputEncoding=b),x.toneMapping!==S&&(x.toneMapping=S),v.legacy!==h&&(_.legacy=h),v.linear!==d&&(_.linear=d),v.flat!==m&&(_.flat=m),x.setClearAlpha(0),x.setPixelRatio(Db(v.viewport.dpr)),x.setSize(v.size.width,v.size.height),Yt.obj(r)&&"function"!=typeof r&&!Yt.renderer(r)&&!Yt.equ(r,x,Du)&&Cc(x,r),c&&!v.events.handlers&&(_.events=c(this)),y&&!Yt.equ(y,v.performance,Du)&&(_.performance={...v.performance,...y}),this.set(_),p&&v.viewport.dpr!==Db(p)&&v.setDpr(p);const A=function Q9(i,e){if(e)return e;if(i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}return{width:0,height:0,top:0,left:0}}(n,s);Yt.equ(A,v.size,Du)||v.setSize(A.width,A.height,A.top,A.left),v.frameloop!==g&&v.setFrameloop(g),this.get("ready")||this.set({ready:!0}),this.invalidate()}destroy(t){this.set(n=>({internal:{...n.internal,active:!1}})),setTimeout(()=>{const{gl:n,xr:r,events:s}=this.get();n&&(s.disconnect&&s.disconnect(),n.renderLists.dispose(),n.forceContextLoss(),n.xr&&n.xr.enabled&&(n.xr.setAnimationLoop(null),r.disconnect()),function e$(i){i.dispose&&!Yt.scene(i)&&i.dispose();for(const e in i)e.dispose?.(),delete i[e]}(this.get()),Ob.delete(t))},500)}resize(){const t=this.get();let n=t.size,r=t.viewport.dpr,s=t.camera;this.hold(this.select(nR(["camera","size","viewport","gl"])),()=>{const{camera:o,size:a,viewport:c,gl:l,set:u}=this.get();(a!==n||c.dpr!==r)&&(n=a,r=c.dpr,Pb(o,a),l.setPixelRatio(c.dpr),l.setSize(a.width,a.height)),o!==s&&(Pb(o,a),s=o,u(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(o)}})))})}invalidate(){this.hold(this.select(),()=>Nb(this))}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=_f(i)))(n||i)}}(),i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();const hR=new Et("NgtCompoundPrefixes"),pR={};function mR(i){Object.assign(pR,i)}const t$=new Et("THREE Constructors Catalogue",{factory:()=>pR});let n$=(()=>{class i{constructor(){this.vcr=Un(rr),this.template=Un(Ss),this.injected=!1,this.shouldCreateView=!0;const t=this.vcr.element.nativeElement;t.__ngt_renderer_add_comment__&&(t.__ngt_renderer_add_comment__(),delete t.__ngt_renderer_add_comment__)}createView(){this.shouldCreateView&&(this.view&&!this.view.destroyed&&this.view.destroy(),this.view=this.vcr.createEmbeddedView(this.template),this.view.detectChanges())}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Li({type:i}),i})(),gR=(()=>{class i extends n${constructor(){super(...arguments),this.injectedArgs=[]}set args(t){null==t||!Array.isArray(t)||1===t.length&&null===t[0]||(this.injected=!1,this.injectedArgs=t,this.createView())}get args(){return this.validate()?(this.injected=!0,this.injectedArgs):null}validate(){return!this.injected&&!!this.injectedArgs.length}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=_f(i)))(n||i)}}(),i.\u0275dir=Li({type:i,selectors:[["","args",""]],inputs:{args:"args"},standalone:!0,features:[Rf]}),i})();function _R(i,e,t,n){const r=t.get(e);r&&(t.delete(e),0===t.size&&(i.delete(n),r.target.releasePointerCapture(n)))}function yR(i,e){const t=i.get("internal");t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{_R(t.capturedMap,e,n,r)}),i.get("previousStore")&&yR(i.get("previousStore"),e)}function Rg(i,e,t=[]){const[n,...r]=t;n&&(0===r.length?Cc(i,{[n]:e}):(function s$(i,e){(!Object.hasOwn(i,e)&&Reflect&&Reflect.has&&!Reflect.has(i,e)||void 0===i[e])&&(i[e]={})}(i,n),Rg(i[n],e,r)))}const kb_BEFORE_RENDER="beforeRender",kb_AFTER_UPDATE="afterUpdate",kb_AFTER_ATTACH="afterAttach";function Bb(i,e){const t=Kt(i),n=Kt(e);if(!t||!n)throw new Error("[NGT] THREE instances need to be prepared with local state.");let r=!1;if((!n.store||n.store===t.store.get("previousStore"))&&(n.store=t.store),n.attach){const s=n.attach;if("function"==typeof s){const o=s(i,e,n.store);o&&(n.previousAttach=o)}else{if("none"===s[0])return void eh(e);if("material"===s[0]&&s[1]&&"number"==typeof Number(s[1])&&Yt.material(e)&&!Array.isArray(i.material)&&(i.material=[]),n.isRaw){if(n.parent=i,void 0===e.__ngt_renderer__[10])return;Rg(i,e.__ngt_renderer__[10],s)}else Rg(i,e,s);n.previousAttach=s.reduce((o,a)=>o[a],i)}}else Yt.object3D(i)&&Yt.object3D(e)&&(i.add(e),r=!0);t.add(e,r?"objects":"nonObjects"),n.parent=i,n.afterAttach&&n.afterAttach.emit({parent:i,node:e}),eh(e),eh(i)}function Ub(i,e,t){const n=Kt(i),r=Kt(e);r.parent=null,n.objects&&n.remove(e,"objects"),n.nonObjects&&n.remove(e,"nonObjects"),r.attach?function r$(i,e,t){const n=Kt(e);Array.isArray(t)?Rg(i,n.previousAttach,t):n.previousAttach()}(i,e,r.attach):Yt.object3D(i)&&Yt.object3D(e)&&(i.remove(e),yR(r.store||n.store,e));const s=r.primitive;s||(vR(r.objects?.value||[],e,!!t),vR(e.childre,e,!!t)),!s&&e.dispose&&!Yt.scene(e)&&queueMicrotask(()=>e.dispose()),eh(i)}function vR(i,e,t){i&&[...i].forEach(n=>Ub(e,n,t))}function a$(i,e,t){return n=>{i(n),t&&t.detectChanges(),e.detectChanges()}}class l${constructor(e){this.root=e,this.comments=[]}createNode(e,t){const n=[e,null,[],!1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],r=Object.assign(t,{__ngt_renderer__:n});return r.ownerDocument||(r.ownerDocument=this.root.document),"three"!==n[0]&&(n[13]=()=>Fl(r).injector),"comment"===n[0]?(r.__ngt_renderer_add_comment__=s=>{s&&"portal"===s.__ngt_renderer__[0]?this.portals.push(s):this.comments.push(r)},r):("compound"===n[0]&&(n[7]=new Set,n[8]={},n[9]={}),r)}setParent(e,t){e.__ngt_renderer__[1]||(e.__ngt_renderer__[1]=t)}addChild(e,t){e.__ngt_renderer__[2].includes(t)||e.__ngt_renderer__[2].push(t)}removeChild(e,t){const n=e.__ngt_renderer__[2].findIndex(r=>t===r);n>=0&&e.__ngt_renderer__[2].splice(n,1)}setCompound(e,t){const n=e.__ngt_renderer__;n[6]=t;const r=Object.keys(n[8]),s=Object.keys(n[9]);if(r.length)for(const o of r)this.applyAttribute(t,o,n[8][o]);if(s.length)for(const o of s)this.applyProperty(t,o,n[9][o]);this.executeOperation(e)}queueOperation(e,t){e.__ngt_renderer__[7].add(t)}executeOperation(e,t="op"){const n=e.__ngt_renderer__;n[7]?.size&&n[7].forEach(r=>{r[0]===t&&(r[1](),n[7].delete(r))})}processPortalContainer(e){const n=(0,e.__ngt_renderer__[13])?.();if(!n)return;const r=n.get(rs,null);if(!r)return;const s=r.get("scene");s&&(e.__ngt_renderer__[12]=this.createNode("three",s))}applyAttribute(e,t,n){const r=e.__ngt_renderer__;if(!r[3]){if("priority"===t){let s=Number(n);isNaN(s)&&(s=0,console.warn('[NGT] "priority" is an invalid number, default to 0')),Kt(e).priority=s}if("ngtCompound"===t)return void(r[4]=[""===n||"first"===n,{}]);if("attach"===t){const s=n.split(".");return void(s.length&&(Kt(e).attach=s))}if("rawValue"===t){let s=n;return""===s||"true"===s||"false"===s?s="true"===s||""===s:isNaN(Number(s))||(s=Number(s)),void(r[10]=s)}Cc(e,{[t]:n})}}applyProperty(e,t,n){const r=e.__ngt_renderer__;if(r[3])return;if("ref"===t&&Yt.ref(n))return r[11]=n,void(n.nativeElement=e);const s=Kt(e).parent||r[1];if(Kt(e).isRaw&&"rawValue"===t)return r[10]=n,void(s&&Bb(s,e));if("attach"===t)return Kt(e).attach=Array.isArray(n)?n.map(a=>a.toString()):n,void(s&&Bb(s,e));const o=r[4];o?.[1]&&t in o[1]&&!o[0]&&(n=o[1][t]),Cc(e,{[t]:n})}isCompound(e){return this.root.compoundPrefixes.some(t=>e.startsWith(t))}isDOM(e){const t=e.__ngt_renderer__;return!t||"compound"!==t[0]&&(e instanceof Element||e instanceof Document||e instanceof Window)}get rootScene(){return this.root.store.get("scene")}get rootCdr(){return this.root.cdr}get portals(){return this.root.portals}getClosestParentWithInstance(e){let t=e.__ngt_renderer__[1];for(;t&&"three"!==t.__ngt_renderer__[0];)t=t.__ngt_renderer__[12]?t.__ngt_renderer__[12]:t.__ngt_renderer__[1];return t}getClosestParentWithCompound(e){if(e.__ngt_renderer__[5])return e.__ngt_renderer__[5];let t=e.__ngt_renderer__[1];if(t&&"compound"===t.__ngt_renderer__[0]&&!t.__ngt_renderer__[6])return t;for(;t&&("three"===t.__ngt_renderer__[0]||!t.__ngt_renderer__[5]||"compound"!==t.__ngt_renderer__[0]);)t=t.__ngt_renderer__[1];return t?"three"===t.__ngt_renderer__[0]&&t.__ngt_renderer__[5]?t.__ngt_renderer__[5]:t.__ngt_renderer__[6]?null:t:void 0}getCreationState(){return{injectedArgs:this.firstNonInjectedDirective(gR)?.args||[],store:this.tryGetPortalStore()}}destroy(e,t){const n=e.__ngt_renderer__;if(!n[3]){if("three"===n[0]){n[4]=void 0,n[5]=void 0;const r=Kt(e);r.objects&&(r.objects.value.forEach(s=>this.destroy(s,t)),r.objects.complete()),r.nonObjects&&(r.nonObjects.value.forEach(s=>this.destroy(s,t)),r.nonObjects.complete()),r.afterUpdate&&r.afterUpdate.complete(),r.afterAttach&&r.afterAttach.complete(),delete r.objects,delete r.nonObjects,delete r.add,delete r.remove,delete r.afterUpdate,delete r.afterAttach,delete r.store,delete r.handlers,r.primitive||delete e.__ngt__}if("comment"===n[0]){n[13]=null,delete e.__ngt_renderer_add_comment__;const r=this.comments.findIndex(s=>s===e);r>-1&&this.comments.splice(r,1)}if("portal"===n[0]){n[13]=null;const r=this.portals.findIndex(s=>s===e);r>-1&&this.portals.splice(r,1)}"compound"===n[0]&&(n[6]=void 0,n[8]=null,n[9]=null,this.executeOperation(e,"cleanUp"),n[7].clear(),n[7]=null),n[11]&&(n[11].nativeElement=null,n[11]=void 0),n[1]=null;for(const r of n[2]||[])"three"===r.__ngt_renderer__[0]&&t&&Ub(t,r,!0),this.destroy(r,t);n[2]=[],n[3]=!0,t&&this.removeChild(t,e)}}firstNonInjectedDirective(e){let t,n=this.comments.length-1;for(;n>=0;){const r=this.comments[n];if(r.__ngt_renderer__[3]){n--;continue}const s=r.__ngt_renderer__[13]();if(!s){n--;continue}const o=s.get(e,null);if(o&&o.validate()){t=o;break}n--}return t}tryGetPortalStore(){let e,t=this.portals.length-1;for(;t>=0;){const n=this.portals[t];if(n.__ngt_renderer__[3]){t--;continue}const r=n.__ngt_renderer__[13]();if(!r){t--;continue}const s=r.get(rs,null);if(s&&s.get("previousStore")){e=s;break}t--}return e||this.root.store}}let u$=(()=>{class i{constructor(){this.delegateRendererFactory=Un(_p,{skipSelf:!0}),this.cdr=Un(Eo),this.store=Un(rs),this.catalogue=Un(t$),this.compoundPrefixes=Un(hR),this.document=Un(Jr),this.rendererMap=new Map,this.portals=[],this.rendererStore=new l$({store:this.store,cdr:this.cdr,portals:this.portals,compoundPrefixes:this.compoundPrefixes,document:this.document})}createRenderer(t,n){const r=this.delegateRendererFactory.createRenderer(t,n);if(!n)return r;let s=this.rendererMap.get(n.id);return s||(s=new f$(r,this.rendererStore,this.catalogue,!t),this.rendererMap.set(n.id,s)),s}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Xt({token:i,factory:i.\u0275fac}),i})();class f${constructor(e,t,n,r=!0){this.delegate=e,this.store=t,this.catalogue=n,this.root=r,this.createText=this.delegate.createText.bind(this.delegate),this.destroy=this.delegate.destroy.bind(this.delegate),this.destroyNode=null,this.selectRootElement=this.delegate.selectRootElement.bind(this.delegate),this.nextSibling=this.delegate.nextSibling.bind(this.delegate),this.removeAttribute=this.delegate.removeAttribute.bind(this.delegate),this.addClass=this.delegate.addClass.bind(this.delegate),this.removeClass=this.delegate.removeClass.bind(this.delegate),this.setStyle=this.delegate.setStyle.bind(this.delegate),this.removeStyle=this.delegate.removeStyle.bind(this.delegate),this.setValue=this.delegate.setValue.bind(this.delegate)}createElement(e,t){const n=this.delegate.createElement(e,t);if(this.root){this.root=!1;const l=this.store.createNode("three",this.store.rootScene);return l.__ngt_renderer__[13]=()=>Fl(n).injector,l}if(this.store.isCompound(e))return this.store.createNode("compound",n);if("ngt-portal"===e)return this.store.createNode("portal",n);if("ngt-value"===e)return this.store.createNode("three",Object.assign({__ngt_renderer__:{rawValue:void 0}},{__ngt__:{isRaw:!0}}));const{injectedArgs:r,store:s}=this.store.getCreationState();if("ngt-primitive"===e){if(!r[0])throw new Error("[NGT] ngt-primitive without args is invalid");const l=r[0];let u=Kt(l);return Object.keys(u).length||(th(l,{store:s,args:r,primitive:!0}),u=Kt(l)),u.store||(u.store=s),this.store.createNode("three",l)}const a=function c$(i){return i.split("-").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join("")}(e.startsWith("ngt")?e.slice(4):e),c=this.catalogue[a];if(c){const l=th(new c(...r),{store:s,args:r}),u=this.store.createNode("three",l),f=Kt(l);return Yt.geometry(l)?f.attach=["geometry"]:Yt.material(l)&&(f.attach=["material"]),u}return this.store.createNode("dom",n)}createComment(e){return this.store.createNode("comment",this.delegate.createComment(e))}appendChild(e,t){if(t instanceof Text)return;const n=t.__ngt_renderer__,r=e.__ngt_renderer__;if("comment"!==n[0]){if(this.store.setParent(t,e),this.store.addChild(e,t),"portal"===n[0])return this.store.processPortalContainer(t),void(n[12]&&this.appendChild(e,n[12]));if("portal"===r[0])return this.store.processPortalContainer(e),void(r[12]&&this.appendChild(r[12],t));if("three"!==r[0]||"three"!==n[0]){if("three"===r[0])for(const o of n[2])this.appendChild(e,o);if("compound"===r[0]&&(!r[6]&&"three"===n[0]&&(n[4]?this.store.setCompound(e,t):n[5]||(n[5]=e)),r[6]&&"three"===n[0]&&n[4]&&r[6]!==t&&this.store.setCompound(e,t)),"three"===n[0]&&!Kt(t).parent||("dom"===r[0]||"compound"===r[0]&&!r[6])&&("dom"===n[0]||"compound"===n[0]&&!n[6])){const o=this.store.getClosestParentWithInstance(e);o&&this.appendChild(o,t)}}else{if(Kt(t).parent||(Bb(e,t),!n[4]))return;const o=this.store.getClosestParentWithCompound(e);if(!o)return;this.appendChild(o,t)}}else this.store.setParent(t,e)}insertBefore(e,t){!e.__ngt_renderer__||e===t||this.appendChild(e,t)}removeChild(e,t,n){const r=e.__ngt_renderer__;if("three"===r[0]&&"three"===t.__ngt_renderer__[0])return Ub(e,t,!0),void this.store.destroy(t,e);if("compound"===r[0]&&r[1])return void this.removeChild(r[1],t,n);if("three"===r[0])return void this.store.destroy(t,e);const o=this.store.getClosestParentWithInstance(e);o&&this.removeChild(o,t,n),this.store.destroy(t,o)}parentNode(e){const t=e.__ngt_renderer__;return t?.[1]?t[1]:this.delegate.parentNode(e)}setAttribute(e,t,n,r){const s=e.__ngt_renderer__;if("compound"===s[0])return s[8][t]=n,s[6]?void this.setAttribute(s[6],t,n,r):void this.store.queueOperation(e,["op",()=>this.setAttribute(e,t,n,r)]);"three"===s[0]&&this.store.applyAttribute(e,t,n)}setProperty(e,t,n){const r=e.__ngt_renderer__;if("compound"===r[0])return r[9][t]=n,r[6]?(r[6].__ngt_renderer__[4]&&Object.assign(r[6].__ngt_renderer__[4],{props:{...r[6].__ngt_renderer__[4],[t]:n}}),void this.setProperty(r[6],t,n)):void this.store.queueOperation(e,["op",()=>this.setProperty(e,t,n)]);"three"===r[0]&&this.store.applyProperty(e,t,n)}listen(e,t,n){const r=e.__ngt_renderer__,s=r?.[13]?.().get(Eo,null),o=a=>{const c=n(a);return s&&s.detectChanges(),this.store.rootCdr.detectChanges(),c};if(this.store.isDOM(e))return this.delegate.listen(e,t,o);if(e===this.store.rootScene){let[a,c]=t.split(":");return null==c&&(c=a,a=""),this.delegate.listen("window"===a?e.ownerDocument.defaultView:e.ownerDocument,c,o)}return"three"===r[0]||"compound"===r[0]&&r[6]?function o$(i,e,t,n,r,s){const o=Kt(i);if(t===kb_BEFORE_RENDER)return o.store.get("internal").subscribe(l=>n({state:l,object:i}),e||o.priority||0);if(t===kb_AFTER_UPDATE||t===kb_AFTER_ATTACH){o[t]||(o[t]=new ir);const l=o[t]?.subscribe(n);return l.unsubscribe.bind(l)}o.handlers||(o.handlers={});const a=o.handlers[t];return o.handlers={...o.handlers,[t]:a$(l=>{a&&a(l),n(l)},r,s)},o.eventCount+=1,1===o.eventCount&&i.raycast&&o.store.get("addInteraction")(i),()=>{const l=Kt(i);l&&l.eventCount&&l.store.get("removeInteraction")(i.uuid)}}(r[6]||e,Kt(e).priority||0,t,n,this.store.rootCdr,s):("compound"===r[0]&&!r[6]&&this.store.queueOperation(e,["op",()=>this.store.queueOperation(e,["cleanUp",this.listen(e,t,n)])]),()=>{})}get data(){return this.delegate.data}}function d$({store:i,changeDetectorRef:e,compoundPrefixes:t=[]}){return t.includes("ngts")||t.push("ngts"),t.includes("ngtp")||t.push("ngtp"),function E2(i){return{\u0275providers:i}}([{provide:_p,useClass:u$},{provide:rs,useValue:i},{provide:Eo,useValue:e},{provide:hR,useValue:t}])}const xR={click:!1,contextmenu:!1,dblclick:!1,wheel:!1,pointerdown:!0,pointerup:!0,pointerleave:!0,pointermove:!0,pointercancel:!0,lostpointercapture:!0};function h$(i){const{handlePointer:e}=function i$(i){function t(c){return c.filter(l=>["move","over","enter","out","leave"].some(u=>{const f=`pointer${u}`;return Kt(l).handlers?.[f]}))}function s(c){const{internal:l}=i.get();for(const u of l.hovered.values())if(!c.length||!c.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const d=Kt(u.eventObject),h=d?.handlers;if(l.hovered.delete(Jd(u)),d?.eventCount){const m={...u,intersections:c};h?.pointerout?.(m),h?.pointerleave?.(m)}}}function o(c,l){for(let u=0;u<l.length;u++)Kt(l[u])?.handlers.pointermissed?.(c)}return{handlePointer:function a(c){switch(c){case"pointerleave":case"pointercancel":return()=>s([]);case"lostpointercapture":return l=>{const{internal:u}=i.get();"pointerId"in l&&u.capturedMap.has(l.pointerId)&&(u.capturedMap.delete(l.pointerId),s([]))}}return function(u){const{onPointerMissed:f,internal:d}=i.get();d.lastEvent=u;const h="pointermove"===c,m="click"===c||"contextmenu"===c||"dblclick"===c,g=function n(c,l){const u=i.get(),f=new Set,d=[],h=l?l(u.internal.interaction):u.internal.interaction;for(let g=0;g<h.length;g++){const y=Kt(h[g]).store?.get();y&&(y.raycaster.camera=void 0)}u.previousStore||u.events.compute?.(c,i);let p=h.flatMap(function m(g){const v=Kt(g).store,_=v?.get();return _&&_.events.enabled&&null!==_.raycaster.camera?(void 0===_.raycaster.camera&&(_.events.compute?.(c,v,_.previousStore),void 0===_.raycaster.camera&&(_.raycaster.camera=null)),_.raycaster.camera?_.raycaster.intersectObject(g,!0):[]):[]}).sort((g,y)=>{const v=Kt(g.object).store.get(),_=Kt(y.object).store.get();return v&&_&&_.events.priority-v.events.priority||g.distance-y.distance}).filter(g=>{const y=Jd(g);return!f.has(y)&&(f.add(y),!0)});u.events.filter&&(p=u.events.filter(p,i));for(const g of p){let y=g.object;for(;y;)Kt(y).eventCount&&d.push({...g,eventObject:y}),y=y.parent}if("pointerId"in c&&u.internal.capturedMap.has(c.pointerId))for(const g of u.internal.capturedMap.get(c.pointerId).values())f.has(Jd(g.intersection))||d.push(g.intersection);return d}(u,h?t:void 0),y=m?function e(c){const l=i.get("internal"),u=c.offsetX-l.initialClick[0],f=c.offsetY-l.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}(u):0;"pointerdown"===c&&(d.initialClick=[u.offsetX,u.offsetY],d.initialHits=g.map(_=>_.eventObject)),m&&!g.length&&y<=2&&(o(u,d.interaction),f&&f(u)),h&&s(g),function r(c,l,u,f){const d=i.get();if(c.length){const h={stopped:!1};for(const m of c){const p=Kt(m.object).store?.get()||d,{raycaster:g,pointer:y,camera:v,internal:_}=p,x=new D(y.x,y.y,0).unproject(v),w=A=>_.capturedMap.get(A)?.has(m.eventObject)??!1,M=A=>{const O={intersection:m,target:l.target};_.capturedMap.has(A)?_.capturedMap.get(A).set(m.eventObject,O):_.capturedMap.set(A,new Map([[m.eventObject,O]])),l.target.setPointerCapture(A)},E=A=>{const O=_.capturedMap.get(A);O&&_R(_.capturedMap,m.eventObject,O,A)},b={};for(const A in l){const O=l[A];"function"!=typeof O&&(b[A]=O)}const S={...m,...b,pointer:y,intersections:c,stopped:h.stopped,delta:u,unprojectedPoint:x,ray:g.ray,camera:v,stopPropagation(){const A="pointerId"in l&&_.capturedMap.get(l.pointerId);(!A||A.has(m.eventObject))&&(S.stopped=h.stopped=!0,_.hovered.size&&Array.from(_.hovered.values()).find(O=>O.eventObject===m.eventObject))&&s([...c.slice(0,c.indexOf(m)),m])},target:{hasPointerCapture:w,setPointerCapture:M,releasePointerCapture:E},currentTarget:{hasPointerCapture:w,setPointerCapture:M,releasePointerCapture:E},nativeEvent:l};if(f(S),!0===h.stopped)break}}}(g,u,y,function v(_){const x=_.eventObject,w=Kt(x),M=w?.handlers;if(w?.eventCount)if(h){if(M?.pointerover||M?.pointerenter||M?.pointerout||M?.pointerleave){const E=Jd(_),b=d.hovered.get(E);b?b.stopped&&_.stopPropagation():(d.hovered.set(E,_),M.pointerover?.(_),M.pointerenter?.(_))}M?.pointermove?.(_)}else{const E=M?.[c];E?(!m||d.initialHits.includes(x))&&(o(u,d.interaction.filter(b=>!d.initialHits.includes(b))),E(_)):m&&d.initialHits.includes(x)&&o(u,d.interaction.filter(b=>!d.initialHits.includes(b)))}})}}}}(i);return{priority:1,enabled:!0,compute:(t,n)=>{const r=n.get();r.pointer.set(t.offsetX/r.size.width*2-1,-t.offsetY/r.size.height*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(xR).reduce((t,n)=>(t[n]=e(n),t),{}),connect:t=>{const n=i.get();n.events.disconnect?.(),n.setEvents({connected:t}),Object.entries(n.events.handlers??{}).forEach(([r,s])=>{t.addEventListener(r,s,{passive:xR[r]})})},disconnect:()=>{const{events:t,setEvents:n}=i.get();t.connected&&(Object.entries(t.handlers??{}).forEach(([r,s])=>{t.connected instanceof HTMLElement&&t.connected.removeEventListener(r,s)}),n({connected:void 0}))}}}let p$=(()=>{class i extends Lb{constructor(){super(...arguments),this.cdr=Un(Eo),this.envInjector=Un(Wa),this.host=Un(Xs),this.store=Un(rs),this.hostClass=!0,this.sceneGraphInputs={},this.compoundPrefixes=[],this.created=new ir,this.pointerMissed=new ir}initialize(){super.initialize(),this.set({shadows:!1,linear:!1,flat:!1,legacy:!1,orthographic:!1,frameloop:"always",dpr:[1,2],events:h$})}get pointerEvents(){return this.get("eventSource")!==this.host.nativeElement?"none":"auto"}set linear(t){this.set({linear:t})}set legacy(t){this.set({legacy:t})}set flat(t){this.set({flat:t})}set orthographic(t){this.set({orthographic:t})}set frameloop(t){this.set({frameloop:t})}set dpr(t){this.set({dpr:t})}set raycaster(t){this.set({raycaster:t})}set shadows(t){this.set({shadows:t})}set camera(t){this.set({camera:t})}set gl(t){this.set({gl:t})}set eventSource(t){this.set({eventSource:t})}set eventPrefix(t){this.set({eventPrefix:t})}set lookAt(t){this.set({lookAt:t})}set performance(t){this.set({performance:t})}ngOnChanges(t){t.sceneGraphInputs&&this.glRef&&this.setSceneGraphInputs()}ngOnInit(){this.get("eventSource")||(this.eventSource=this.host.nativeElement),this.pointerMissed.observed&&this.store.set({onPointerMissed:t=>{this.pointerMissed.emit(t),this.cdr.detectChanges()}}),this.store.init(),Ob.set(this.glCanvas.nativeElement,this.store),this.hold(this.store.select("ready").pipe(Ul(t=>t)),()=>this.storeReady())}onResize({width:t,height:n}){t>0&&n>0&&(this.store.isInit||this.store.init(),this.store.configure(this.get(),this.glCanvas.nativeElement))}storeReady(){this.store.set(r=>({internal:{...r.internal,active:!0}}));const t=this.get(),n=this.store.get();n.events.connect?.(Yt.ref(t.eventSource)?t.eventSource.nativeElement:t.eventSource),t.eventPrefix&&n.setEvents({compute:(r,s)=>{const o=s.get();o.pointer.set(r[t.eventPrefix+"X"]/o.size.width*2-1,-r[t.eventPrefix+"Y"]/o.size.height*2+1),o.raycaster.setFromCamera(o.pointer,o.camera)}}),this.created.observed&&(this.created.emit(this.store.get()),this.cdr.detectChanges()),this.glRef&&this.glRef.destroy(),requestAnimationFrame(()=>{this.glEnvInjector=dv([d$({store:this.store,changeDetectorRef:this.cdr,compoundPrefixes:this.compoundPrefixes})],this.envInjector),this.glRef=this.glAnchor.createComponent(this.sceneGraph,{environmentInjector:this.glEnvInjector}),this.glRef.changeDetectorRef.detach(),this.setSceneGraphInputs(),this.overrideDetectChanges(),this.cdr.detectChanges()})}ngOnDestroy(){this.glRef&&this.glRef.destroy(),this.glEnvInjector&&this.glEnvInjector.destroy(),oR.destroy(),this.store.destroy(this.glCanvas.nativeElement),super.ngOnDestroy()}overrideDetectChanges(){const t=this.cdr.detectChanges.bind(this.cdr);this.cdr.detectChanges=()=>{t(),this.glRef?.changeDetectorRef.detectChanges()}}setSceneGraphInputs(){for(const t of Object.keys(this.sceneGraphInputs))this.glRef?.setInput(t,this.sceneGraphInputs[t]);this.cdr.detectChanges()}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=_f(i)))(n||i)}}(),i.\u0275cmp=af({type:i,selectors:[["ngt-canvas"]],viewQuery:function(t,n){if(1&t&&(Up(rR,7),Up(rR,7,rr)),2&t){let r;Wf(r=jf())&&(n.glCanvas=r.first),Wf(r=jf())&&(n.glAnchor=r.first)}},hostVars:4,hostBindings:function(t,n){2&t&&(Qy("pointer-events",n.pointerEvents),ev("ngt-canvas",n.hostClass))},inputs:{sceneGraph:"sceneGraph",sceneGraphInputs:"sceneGraphInputs",compoundPrefixes:"compoundPrefixes",linear:"linear",legacy:"legacy",flat:"flat",orthographic:"orthographic",frameloop:"frameloop",dpr:"dpr",raycaster:"raycaster",shadows:"shadows",camera:"camera",gl:"gl",eventSource:"eventSource",eventPrefix:"eventPrefix",lookAt:"lookAt",performance:"performance"},outputs:{created:"created",pointerMissed:"pointerMissed"},standalone:!0,features:[uv([rs,VH({emitInZone:!1})]),Rf,hf,Vf],decls:3,vars:0,consts:[[2,"height","100%","width","100%",3,"ngxResize"],[2,"display","block"],["glCanvas",""]],template:function(t,n){1&t&&(wo(0,"div",0),Al("ngxResize",function(s){return n.onResize(s)}),Of(1,"canvas",1,2),ta())},dependencies:[HH],styles:["[_nghost-%COMP%]{display:block;position:relative;width:100%;height:100%;overflow:hidden}"]}),i})();function m$(i){if(i)try{i.context&&i.detectChanges()}catch{i.markForCheck()}}function g$(i=null){const e=Yt.ref(i)?i:new Xs(i);let t=e.nativeElement;const n=[],r=new fm(t),{destroy$:s,cdr:o}=function bR(i){try{const e=Un(Eo),t=new kl;return queueMicrotask(()=>{e.onDestroy(()=>{t.next(),t.complete(),i?.()})}),{destroy$:t,cdr:e}}catch{throw new Error("[NGT] injectNgtDestroy is being called outside of Constructor Context")}}(()=>{r.complete()});n.push(o);const a=r.asObservable().pipe(Bl(),lm(s)),l=a.pipe(Ul((f,d)=>d>0||null!=f),lm(s));return Object.defineProperty(e,"nativeElement",{set:f=>{if(e.nativeElement!==f){r.next(f),t=e.nativeElement,e.nativeElement=f;const d=[...n];for(let h=0;h<d.length;h++){const m=d[h];m.destroyed?n.splice(h,1):m$(m)}}},get:()=>r.value}),Object.assign(e,{subscribe:f=>a.subscribe(d=>{f(d,t),t=d}),$:l,children$:(f="objects")=>l.pipe(EC(d=>{const h=Kt(d);return h.objects&&h.nonObjects?At(h.objects,h.nonObjects).pipe(Dn(()=>{try{return"both"===f?[...h.objects.value,...h.nonObjects.value]:h[f].value}catch{return console.error(`[NGT] Exception in accessing children of ${d}`),[]}})):g0([])}),Ul((d,h)=>h>0||d.length>0),lm(s)),useCDR:f=>{n.push(f)}})}let y$=(()=>{class i{constructor(){this.cdr=Un(Eo),this.parentCdr=Un(Eo,{skipSelf:!0,optional:!0})}transform(t,n=null){if(this.obj===t)return this.latestValue;if(this.obj=t,this.latestValue=n,this.sub&&this.sub.unsubscribe(),Ka(this.obj))this.sub=this.obj.subscribe(this.updateValue.bind(this));else{if(!function _$(i){return(i instanceof Promise||"[object Promise]"===Object.prototype.toString.call(i))&&"function"==typeof i.then}(this.obj))throw new Error("[NGT] Invalid value passed to ngtPush pipe");this.obj.then(this.updateValue.bind(this))}return this.latestValue}updateValue(t){this.latestValue=t,this.cdr.detectChanges(),this.parentCdr&&this.parentCdr.detectChanges()}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.latestValue=void 0,this.obj=void 0}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=Ji({name:"ngtPush",type:i,pure:!1,standalone:!0}),i})();var Lg,zb;const v$=["get","set","select","setSize","setDpr","setFrameloop","events","invalidate","advance","size","viewport","addInteraction","removeInteraction"];let x$=(()=>{class i{constructor(){this.portalStore=Un(rs),this.renderPriority=1,this.beforeRender=new ir}ngOnInit(){let t;this.subscription=this.portalStore.get("internal").subscribe(({delta:n,frame:r})=>{this.beforeRender.emit({...this.portalStore.get(),delta:n,frame:r});const{gl:s,scene:o,camera:a}=this.portalStore.get();t=s.autoClear,1===this.renderPriority&&(s.autoClear=!0,s.render(this.parentScene,this.parentCamera)),s.autoClear=!1,s.clearDepth(),s.render(o,a),s.autoClear=t},this.renderPriority,this.portalStore)}ngOnDestroy(){this.subscription?.()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Li({type:i,selectors:[["ngt-portal-before-render"]],inputs:{renderPriority:"renderPriority",parentScene:"parentScene",parentCamera:"parentCamera"},outputs:{beforeRender:"beforeRender"},standalone:!0}),i})(),b$=(()=>{class i{constructor(t,n){const r=t.element.nativeElement;r.__ngt_renderer_add_comment__&&(r.__ngt_renderer_add_comment__(n.element.nativeElement),delete r.__ngt_renderer_add_comment__)}}return i.\u0275fac=function(t){return new(t||i)(xt(rr),xt(rr,4))},i.\u0275dir=Li({type:i,selectors:[["ng-template","ngtPortalContent",""]],standalone:!0}),i})();class nh extends Lb{constructor(){super(...arguments),Lg.add(this),this.autoRender=!0,this.autoRenderPriority=1,this.beforeRender=new ir,this.parentStore=Un(rs,{skipSelf:!0}),this.parentScene=this.parentStore.get("scene"),this.parentCamera=this.parentStore.get("camera"),this.portalStore=Un(rs,{self:!0}),this.raycaster=new bb,this.pointer=new oe,this.portalContentRendered=!1}set container(e){this.set({container:e})}set state(e){this.set({state:e})}initialize(){super.initialize(),this.set({container:g$(th(new eg))})}ngOnInit(){const e=this.parentStore.get(),t=this.get();!t.state&&this.autoRender&&(t.state={events:{priority:this.autoRenderPriority+1}});const{events:n,size:r,...s}=t.state||{},o=t.container,a=Yt.ref(o)?o.nativeElement:o,c=Kt(a);c.store||(c.store=this.portalStore),this.portalStore.set({...e,scene:a,raycaster:this.raycaster,pointer:this.pointer,previousStore:this.parentStore,events:{...e.events,...n||{}},size:{...e.size,...r||{}},...s,get:this.portalStore.get.bind(this.portalStore),set:this.portalStore.set.bind(this.portalStore),select:this.portalStore.select.bind(this.portalStore),setEvents:l=>this.portalStore.set(u=>({...u,events:{...u.events,...l}}))}),this.hold(this.parentStore.select(),l=>this.portalStore.set(u=>Ah(this,Lg,"m",zb).call(this,l,u))),requestAnimationFrame(()=>{this.portalStore.set(l=>Ah(this,Lg,"m",zb).call(this,this.parentStore.get(),l))}),this.portalContentView=this.portalContentAnchor.createEmbeddedView(this.portalContentTemplate),this.portalContentView.detectChanges(),this.portalContentRendered=!0}onBeforeRender(e){this.beforeRender.emit({root:{...this.parentStore.get(),delta:e.delta,frame:e.frame},portal:e})}ngOnDestroy(){this.portalContentView&&!this.portalContentView.destroyed&&this.portalContentView.destroy(),super.ngOnDestroy()}}function ih(i){return(ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(i)}function Tt(i,e,t){return(e=function M$(i){var e=function w$(i,e){if("object"!==ih(i)||null===i)return i;var t=i[Symbol.toPrimitive];if(void 0!==t){var n=t.call(i,e||"default");if("object"!==ih(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(i)}(i,"string");return"symbol"===ih(e)?e:String(e)}(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}Lg=new WeakSet,zb=function(e,t){const n={...e};Object.keys(n).forEach(l=>{(v$.includes(l)||e[l]!==t[l])&&delete n[l]});const r=this.get(),{size:s,events:o,...a}=r.state||{};let c;if(t&&s){const l=t.camera;c=e.viewport.getCurrentViewport(l,new D,s),l!==e.camera&&Pb(l,s)}return{...n,scene:Yt.ref(r.container)?r.container.nativeElement:r.container,raycaster:this.raycaster,pointer:this.pointer,previousStore:this.parentStore,events:{...e.events,...t?.events||{},...o},size:{...e.size,...s},viewport:{...e.viewport,...c||{}},...a}},nh.\u0275fac=function(){let i;return function(t){return(i||(i=_f(nh)))(t||nh)}}(),nh.\u0275cmp=af({type:nh,selectors:[["ngt-portal"]],contentQueries:function(e,t,n){if(1&e&&function FD(i,e,t,n){const r=Zt();if(r.firstCreatePass){const s=Ni();BD(r,new OD(e,t,n),s.index),function iU(i,e){const t=i.contentQueries||(i.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(i.queries.length-1,e)}(r,i),2==(2&t)&&(r.staticContentQueries=!0)}kD(r,he(),t)}(n,b$,7,Ss),2&e){let r;Wf(r=jf())&&(t.portalContentTemplate=r.first)}},viewQuery:function(e,t){if(1&e&&Up(j9,7,rr),2&e){let n;Wf(n=jf())&&(t.portalContentAnchor=n.first)}},inputs:{container:"container",state:"state",autoRender:"autoRender",autoRenderPriority:"autoRenderPriority"},outputs:{beforeRender:"beforeRender"},standalone:!0,features:[uv([rs]),Rf,Vf],decls:3,vars:1,consts:[["portalContentAnchor",""],[3,"renderPriority","parentScene","parentCamera","beforeRender",4,"ngIf"],[3,"renderPriority","parentScene","parentCamera","beforeRender"]],template:function(e,t){1&e&&(Ap(0,null,0),Cp(2,$9,1,3,"ngt-portal-before-render",1),Ip()),2&e&&(ja(2),Kr("ngIf",t.autoRender&&t.portalContentRendered))},dependencies:[j1,x$],encapsulation:2});const wR=(i,e)=>(i%e+e)%e;function Go(i){if(void 0===i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function MR(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e}var Vb,qi,hi,Wn,os,$b,qb,IR,LR,Lu,fh,c,l,u,f,d,h,i,e,t,n,r,s,o,a,m,Nr={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Cu={duration:.5,overwrite:!1,delay:0},ss=1e8,Sn=1/ss,Hb=2*Math.PI,E$=Hb/4,T$=0,SR=Math.sqrt,D$=Math.cos,C$=Math.sin,Ii=function(e){return"string"==typeof e},Qn=function(e){return"function"==typeof e},Wo=function(e){return"number"==typeof e},Gb=function(e){return typeof e>"u"},so=function(e){return"object"==typeof e},xr=function(e){return!1!==e},ER=function(){return typeof window<"u"},Og=function(e){return Qn(e)||Ii(e)},TR="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Xi=Array.isArray,Wb=/(?:-?\.?\d|\.)+/gi,DR=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Au=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,jb=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,CR=/[+-]=-?[.\d]+/,AR=/[^,'"\[\]\s]+/gi,A$=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Fr={},Ng={},PR=function(e){return(Ng=Pc(e,Fr))&&Ur},Xb=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Fg=function(e,t){return!t&&console.warn(e)},RR=function(e,t){return e&&(Fr[e]=t)&&Ng&&(Ng[e]=t)||Fr},rh=function(){return 0},I$={suppressEvents:!0,isStart:!0,kill:!1},kg={suppressEvents:!0,kill:!1},P$={suppressEvents:!0},Zb={},Sa=[],Yb={},kr={},Kb={},OR=30,Bg=[],Jb="",Qb=function(e){var n,r,t=e[0];if(so(t)||Qn(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(r=Bg.length;r--&&!Bg[r].targetTest(t););n=Bg[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new aL(e[r],n)))||e.splice(r,1);return e},Ic=function(e){return e._gsap||Qb(ls(e))[0]._gsap},NR=function(e,t,n){return(n=e[t])&&Qn(n)?e[t]():Gb(n)&&e.getAttribute&&e.getAttribute(t)||n},br=function(e,t){return(e=e.split(",")).forEach(t)||e},oi=function(e){return Math.round(1e5*e)/1e5||0},Ui=function(e){return Math.round(1e7*e)/1e7||0},Iu=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+r:"-"===n?e-r:"*"===n?e*r:e/r},R$=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},Ug=function(){var n,r,e=Sa.length,t=Sa.slice(0);for(Yb={},Sa.length=0,n=0;n<e;n++)(r=t[n])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},FR=function(e,t,n,r){Sa.length&&!qi&&Ug(),e.render(t,n,r||qi&&t<0&&(e._initted||e._startAt)),Sa.length&&!qi&&Ug()},kR=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(AR).length<2?t:Ii(e)?e.trim():e},BR=function(e){return e},as=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Pc=function(e,t){for(var n in t)e[n]=t[n];return e},UR=function i(e,t){for(var n in t)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(e[n]=so(t[n])?i(e[n]||(e[n]={}),t[n]):t[n]);return e},zg=function(e,t){var r,n={};for(r in e)r in t||(n[r]=e[r]);return n},sh=function(e){var t=e.parent||Wn,n=e.keyframes?function(e){return function(t,n){for(var r in n)r in t||"duration"===r&&e||"ease"===r||(t[r]=n[r])}}(Xi(e.keyframes)):as;if(xr(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},zR=function(e,t,n,r,s){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,o=e[r];if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},Vg=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[n]===t&&(e[n]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},Ea=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Rc=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},N$=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},ew=function(e,t,n,r){return e._startAt&&(qi?e._startAt.revert(kg):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},F$=function i(e){return!e||e._ts&&i(e.parent)},VR=function(e){return e._repeat?Pu(e._tTime,e=e.duration()+e._rDelay)*e:0},Pu=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},Hg=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Gg=function(e){return e._end=Ui(e._start+(e._tDur/Math.abs(e._ts||e._rts||Sn)||0))},Wg=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Ui(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Gg(e),n._dirty||Rc(n,e)),e},HR=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=Hg(e.rawTime(),t),(!t._dur||ah(0,t.totalDuration(),n)-t._tTime>Sn)&&t.render(n,!0)),Rc(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Sn}},oo=function(e,t,n,r){return t.parent&&Ea(t),t._start=Ui((Wo(n)?n:n||e!==Wn?cs(e,n,t):e._time)+t._delay),t._end=Ui(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),zR(e,t,"_first","_last",e._sort?"_start":0),tw(t)||(e._recent=t),r||HR(e,t),e._ts<0&&Wg(e,e._tTime),e},GR=function(e,t){return(Fr.ScrollTrigger||Xb("scrollTrigger",t))&&Fr.ScrollTrigger.create(t,e)},WR=function(e,t,n,r,s){return uw(e,t,s),e._initted?!n&&e._pt&&!qi&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&LR!==Br.frame?(Sa.push(e),e._lazy=[s,r],1):void 0:1},k$=function i(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||i(t))},tw=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},Ru=function(e,t,n,r){var s=e._repeat,o=Ui(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:Ui(o*(s+1)+e._rDelay*s):o,a>0&&!r&&Wg(e,e._tTime=e._tDur*a),e.parent&&Gg(e),n||Rc(e.parent,e),e},jR=function(e){return e instanceof wr?Rc(e):Ru(e,e._dur)},z$={_start:0,endTime:rh,totalDuration:rh},cs=function i(e,t,n){var a,c,l,r=e.labels,s=e._recent||z$,o=e.duration()>=ss?s.endTime(!1):e._dur;return Ii(t)&&(isNaN(t)||t in r)?(c=t.charAt(0),l="%"===t.substr(-1),a=t.indexOf("="),"<"===c||">"===c?(a>=0&&(t=t.replace(/=/,"")),("<"===c?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?s:n).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&n&&(c=c/100*(Xi(n)?n[0]:n).totalDuration()),a>1?i(e,t.substr(0,a-1),n)+c:o+c)):null==t?o:+t},oh=function(e,t,n){var a,c,r=Wo(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s];if(r&&(o.duration=t[1]),o.parent=n,e){for(a=o,c=n;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=xr(c.vars.inherit)&&c.parent;o.immediateRender=xr(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new Ei(t[0],o,t[s+1])},Ta=function(e,t){return e||0===e?t(e):t},ah=function(e,t,n){return n<e?e:n>t?t:n},Zi=function(e,t){return Ii(e)&&(t=A$.exec(e))?t[1]:""},nw=[].slice,$R=function(e,t){return e&&so(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&so(e[0]))&&!e.nodeType&&e!==os},ls=function(e,t,n){return hi&&!t&&hi.selector?hi.selector(e):!Ii(e)||n||!$b&&Ou()?Xi(e)?function(e,t,n){return void 0===n&&(n=[]),e.forEach(function(r){var s;return Ii(r)&&!t||$R(r,1)?(s=n).push.apply(s,ls(r)):n.push(r)})||n}(e,n):$R(e)?nw.call(e,0):e?[e]:[]:nw.call((t||qb).querySelectorAll(e),0)},iw=function(e){return e=ls(e)[0]||Fg("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return ls(t,n.querySelectorAll?n:n===e?Fg("Invalid scope")||qb.createElement("div"):e)}},qR=function(e){return e.sort(function(){return.5-Math.random()})},XR=function(e){if(Qn(e))return e;var t=so(e)?e:{each:e},n=Lc(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,c=isNaN(r)||a,l=t.axis,u=r,f=r;return Ii(r)?u=f={center:.5,edges:.5,end:1}[r]||0:!a&&c&&(u=r[0],f=r[1]),function(d,h,m){var y,v,_,x,w,M,E,b,S,p=(m||t).length,g=o[p];if(!g){if(!(S="auto"===t.grid?0:(t.grid||[1,ss])[1])){for(E=-ss;E<(E=m[S++].getBoundingClientRect().left)&&S<p;);S--}for(g=o[p]=[],y=c?Math.min(S,p)*u-.5:r%S,v=S===ss?0:c?p*f/S-.5:r/S|0,E=0,b=ss,M=0;M<p;M++)_=M%S-y,x=v-(M/S|0),g[M]=w=l?Math.abs("y"===l?x:_):SR(_*_+x*x),w>E&&(E=w),w<b&&(b=w);"random"===r&&qR(g),g.max=E-b,g.min=b,g.v=p=(parseFloat(t.amount)||parseFloat(t.each)*(S>p?p-1:l?"y"===l?p/S:S:Math.max(S,p/S))||0)*("edges"===r?-1:1),g.b=p<0?s-p:s,g.u=Zi(t.amount||t.each)||0,n=n&&p<0?rL(n):n}return p=(g[d]-g.min)/g.max||0,Ui(g.b+(n?n(p):p)*g.v)+g.u}},rw=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=Ui(Math.round(parseFloat(n)/e)*e*t);return(r-r%1)/t+(Wo(n)?0:Zi(n))}},ZR=function(e,t){var r,s,n=Xi(e);return!n&&so(e)&&(r=n=e.radius||ss,e.values?(e=ls(e.values),(s=!Wo(e[0]))&&(r*=r)):e=rw(e.increment)),Ta(t,n?Qn(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var d,h,a=parseFloat(s?o.x:o),c=parseFloat(s?o.y:0),l=ss,u=0,f=e.length;f--;)(d=s?(d=e[f].x-a)*d+(h=e[f].y-c)*h:Math.abs(e[f]-a))<l&&(l=d,u=f);return u=!r||l<=r?e[u]:o,s||u===o||Wo(o)?u:u+Zi(o)}:rw(e))},YR=function(e,t,n,r){return Ta(Xi(e)?!t:!0===n?!!(n=0):!r,function(){return Xi(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r})},KR=function(e,t,n){return Ta(n,function(r){return e[~~t(r)]})},ch=function(e){for(var r,s,o,a,t=0,n="";~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a="["===e.charAt(r+7),s=e.substr(r+7,o-r-7).match(a?AR:Wb),n+=e.substr(t,r-t)+YR(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return n+e.substr(t,e.length-t)},JR=function(e,t,n,r,s){var o=t-e,a=r-n;return Ta(s,function(c){return n+((c-e)/o*a||0)})},QR=function(e,t,n){var o,a,c,r=e.labels,s=ss;for(o in r)(a=r[o]-t)<0==!!n&&a&&s>(a=Math.abs(a))&&(c=o,s=a);return c},us=function(e,t,n){var c,l,u,r=e.vars,s=r[t],o=hi,a=e._ctx;if(s)return c=r[t+"Params"],l=r.callbackScope||e,n&&Sa.length&&Ug(),a&&(hi=a),u=c?s.apply(l,c):s.call(l),hi=o,u},lh=function(e){return Ea(e),e.scrollTrigger&&e.scrollTrigger.kill(!!qi),e.progress()<1&&us(e,"onInterrupt"),e},Z$=function(e){var t=(e=!e.name&&e.default||e).name,n=Qn(e),r=t&&!n&&e.init?function(){this._props=[]}:e,s={init:rh,render:hw,add:cw,kill:f7,modifier:u7,rawVars:0},o={targetTest:0,get:0,getSetter:dw,aliases:{},register:0};if(Ou(),e!==r){if(kr[t])return;as(r,as(zg(e,s),o)),Pc(r.prototype,Pc(s,zg(e,o))),kr[r.prop=t]=r,e.targetTest&&(Bg.push(r),Zb[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}RR(t,r),e.register&&e.register(Ur,r,Mr)},En=255,uh={aqua:[0,En,En],lime:[0,En,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,En],navy:[0,0,128],white:[En,En,En],olive:[128,128,0],yellow:[En,En,0],orange:[En,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[En,0,0],pink:[En,192,203],cyan:[0,En,En],transparent:[En,En,En,0]},sw=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*En+.5|0},eL=function(e,t,n){var s,o,a,c,l,u,f,d,h,m,r=e?Wo(e)?[e>>16,e>>8&En,e&En]:0:uh.black;if(!r){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),uh[e])r=uh[e];else if("#"===e.charAt(0)){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(r=parseInt(e.substr(1,6),16))>>16,r>>8&En,r&En,parseInt(e.substr(7),16)/255];r=[(e=parseInt(e.substr(1),16))>>16,e>>8&En,e&En]}else if("hsl"===e.substr(0,3))if(r=m=e.match(Wb),t){if(~e.indexOf("="))return r=e.match(DR),n&&r.length<4&&(r[3]=1),r}else c=+r[0]%360/360,l=+r[1]/100,s=2*(u=+r[2]/100)-(o=u<=.5?u*(l+1):u+l-u*l),r.length>3&&(r[3]*=1),r[0]=sw(c+1/3,s,o),r[1]=sw(c,s,o),r[2]=sw(c-1/3,s,o);else r=e.match(Wb)||uh.transparent;r=r.map(Number)}return t&&!m&&(s=r[0]/En,o=r[1]/En,a=r[2]/En,u=((f=Math.max(s,o,a))+(d=Math.min(s,o,a)))/2,f===d?c=l=0:(h=f-d,l=u>.5?h/(2-f-d):h/(f+d),c=f===s?(o-a)/h+(o<a?6:0):f===o?(a-s)/h+2:(s-o)/h+4,c*=60),r[0]=~~(c+.5),r[1]=~~(100*l+.5),r[2]=~~(100*u+.5)),n&&r.length<4&&(r[3]=1),r},tL=function(e){var t=[],n=[],r=-1;return e.split(Da).forEach(function(s){var o=s.match(Au)||[];t.push.apply(t,o),n.push(r+=o.length+1)}),t.c=n,t},nL=function(e,t,n){var c,l,u,f,r="",s=(e+r).match(Da),o=t?"hsla(":"rgba(",a=0;if(!s)return e;if(s=s.map(function(d){return(d=eL(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),n&&(u=tL(e),(c=n.c).join(r)!==u.c.join(r)))for(f=(l=e.replace(Da,"1").split(Au)).length-1;a<f;a++)r+=l[a]+(~c.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:n).shift());if(!l)for(f=(l=e.split(Da)).length-1;a<f;a++)r+=l[a]+s[a];return r+l[f]},Da=function(){var e,i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in uh)i+="|"+e+"\\b";return new RegExp(i+")","gi")}(),Y$=/hsl[a]?\(/,iL=function(e){var n,t=e.join(" ");if(Da.lastIndex=0,Da.test(t))return n=Y$.test(t),e[1]=nL(e[1],n),e[0]=nL(e[0],n,tL(e[1])),!0},Br=(i=Date.now,e=500,t=33,n=i(),r=n,o=s=1e3/240,m=function p(g){var _,x,w,M,y=i()-r,v=!0===g;if(y>e&&(n+=y-t),((_=(w=(r+=y)-n)-o)>0||v)&&(M=++f.frame,d=w-1e3*f.time,f.time=w/=1e3,o+=_+(_>=s?4:s-_),x=1),v||(c=l(p)),x)for(h=0;h<a.length;h++)a[h](w,d,M,g)},f={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){IR&&(!$b&&ER()&&(os=$b=window,qb=os.document||{},Fr.gsap=Ur,(os.gsapVersions||(os.gsapVersions=[])).push(Ur.version),PR(Ng||os.GreenSockGlobals||!os.gsap&&os||{}),u=os.requestAnimationFrame),c&&f.sleep(),l=u||function(g){return setTimeout(g,o-1e3*f.time+1|0)},fh=1,m(2))},sleep:function(){(u?os.cancelAnimationFrame:clearTimeout)(c),fh=0,l=rh},lagSmoothing:function(g,y){e=g||1/0,t=Math.min(y||33,e)},fps:function(g){o=1e3*f.time+(s=1e3/(g||240))},add:function(g,y,v){var _=y?function(x,w,M,E){g(x,w,M,E),f.remove(_)}:g;return f.remove(g),a[v?"unshift":"push"](_),Ou(),_},remove:function(g,y){~(y=a.indexOf(g))&&a.splice(y,1)&&h>=y&&h--},_listeners:a=[]}),Ou=function(){return!fh&&Br.wake()},jt={},K$=/^[\d.\-M][\d.\-,\s]/,J$=/["']/g,Q$=function(e){for(var a,c,l,t={},n=e.substr(1,e.length-3).split(":"),r=n[0],s=1,o=n.length;s<o;s++)c=n[s],a=s!==o-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[r]=isNaN(l)?l.replace(J$,"").trim():+l,r=c.substr(a+1).trim();return t},rL=function(e){return function(t){return 1-e(1-t)}},sL=function i(e,t){for(var r,n=e._first;n;)n instanceof wr?i(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?i(n.timeline,t):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=t)),n=n._next},Lc=function(e,t){return e&&(Qn(e)?e:jt[e]||function(e){var t=(e+"").split("("),n=jt[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[Q$(t[1])]:function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<n?e.indexOf(")",n+1):n)}(e).split(",").map(kR)):jt._CE&&K$.test(e)?jt._CE("",e):n}(e))||t},Oc=function(e,t,n,r){void 0===n&&(n=function(c){return 1-t(1-c)}),void 0===r&&(r=function(c){return c<.5?t(2*c)/2:1-t(2*(1-c))/2});var o,s={easeIn:t,easeOut:n,easeInOut:r};return br(e,function(a){for(var c in jt[a]=Fr[a]=s,jt[o=a.toLowerCase()]=n,s)jt[o+("easeIn"===c?".in":"easeOut"===c?".out":".inOut")]=jt[a+"."+c]=s[c]}),s},oL=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},ow=function i(e,t,n){var r=t>=1?t:1,s=(n||(e?.3:.45))/(t<1?t:1),o=s/Hb*(Math.asin(1/r)||0),a=function(u){return 1===u?1:r*Math.pow(2,-10*u)*C$((u-o)*s)+1},c="out"===e?a:"in"===e?function(l){return 1-a(1-l)}:oL(a);return s=Hb/s,c.config=function(l,u){return i(e,l,u)},c},aw=function i(e,t){void 0===t&&(t=1.70158);var n=function(o){return o?--o*o*((t+1)*o+t)+1:0},r="out"===e?n:"in"===e?function(s){return 1-n(1-s)}:oL(n);return r.config=function(s){return i(e,s)},r};br("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,e){var t=e<5?e+1:e;Oc(i+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(2*n,t)/2:1-Math.pow(2*(1-n),t)/2})}),jt.Linear.easeNone=jt.none=jt.Linear.easeIn,Oc("Elastic",ow("in"),ow("out"),ow()),function(i,e){var s=function(a){return a<.36363636363636365?i*a*a:a<.7272727272727273?i*Math.pow(a-1.5/e,2)+.75:a<.9090909090909092?i*(a-=2.25/e)*a+.9375:i*Math.pow(a-2.625/e,2)+.984375};Oc("Bounce",function(o){return 1-s(1-o)},s)}(7.5625,2.75),Oc("Expo",function(i){return i?Math.pow(2,10*(i-1)):0}),Oc("Circ",function(i){return-(SR(1-i*i)-1)}),Oc("Sine",function(i){return 1===i?1:1-D$(i*E$)}),Oc("Back",aw("in"),aw("out"),aw()),jt.SteppedEase=jt.steps=Fr.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),s=t?1:0,o=1-Sn;return function(a){return((r*ah(0,o,a)|0)+s)*n}}},Cu.ease=jt["quad.out"],br("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return Jb+=i+","+i+"Params,"});var aL=function(e,t){this.id=T$++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:NR,this.set=t?t.getSetter:dw},Nu=function(){function i(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ru(this,+t.duration,1,1),this.data=t.data,hi&&(this._ctx=hi,hi.data.push(this)),fh||Br.wake()}var e=i.prototype;return e.delay=function(n){return n||0===n?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,Ru(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,r){if(Ou(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Wg(this,n),!s._dp||s.parent||HR(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&oo(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Sn||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),FR(this,n,r)),this},e.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+VR(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},e.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?n:1-n)+VR(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?Pu(this._tTime,s)+1:1},e.timeScale=function(n){if(!arguments.length)return this._rts===-Sn?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?Hg(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Sn?0:this._rts,this.totalTime(ah(-this._delay,this._tDur,r),!0),Gg(this),N$(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ou(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Sn&&(this._tTime-=Sn)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&oo(r,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(xr(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Hg(r.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){void 0===n&&(n=P$);var r=qi;return qi=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),"nested"!==this.data&&!1!==n.kill&&this.kill(),qi=r,this},e.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,jR(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,jR(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,r){return this.totalTime(cs(this,n),xr(r))},e.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,xr(r))},e.play=function(n,r){return null!=n&&this.seek(n,r),this.reversed(!1).paused(!1)},e.reverse=function(n,r){return null!=n&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(n,r){return null!=n&&this.seek(n,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Sn:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Sn,this},e.isActive=function(){var s,n=this.parent||this._dp,r=this._start;return!(n&&!(this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-Sn))},e.eventCallback=function(n,r,s){var o=this.vars;return arguments.length>1?(r?(o[n]=r,s&&(o[n+"Params"]=s),"onUpdate"===n&&(this._onUpdate=r)):delete o[n],this):o[n]},e.then=function(n){var r=this;return new Promise(function(s){var o=Qn(n)?n:BR,a=function(){var l=r.then;r.then=null,Qn(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),s(o),r.then=l};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){lh(this)},i}();as(Nu.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Sn,_prom:0,_ps:!1,_rts:1});var wr=function(i){function e(n,r){var s;return void 0===n&&(n={}),(s=i.call(this,n)||this).labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=xr(n.sortChildren),Wn&&oo(n.parent||Wn,Go(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&GR(Go(s),n.scrollTrigger),s}MR(e,i);var t=e.prototype;return t.to=function(r,s,o){return oh(0,arguments,this),this},t.from=function(r,s,o){return oh(1,arguments,this),this},t.fromTo=function(r,s,o,a){return oh(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,sh(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Ei(r,s,cs(this,o),1),this},t.call=function(r,s,o){return oo(this,Ei.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,c,l,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new Ei(r,o,cs(this,c)),this},t.staggerFrom=function(r,s,o,a,c,l,u){return o.runBackwards=1,sh(o).immediateRender=xr(o.immediateRender),this.staggerTo(r,s,o,a,c,l,u)},t.staggerFromTo=function(r,s,o,a,c,l,u,f){return a.startAt=o,sh(a).immediateRender=xr(a.immediateRender),this.staggerTo(r,s,a,c,l,u,f)},t.render=function(r,s,o){var d,h,m,p,g,y,v,_,x,w,M,E,a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=r<=0?0:Ui(r),f=this._zTime<0!=r<0&&(this._initted||!l);if(this!==Wn&&u>c&&r>=0&&(u=c),u!==this._tTime||o||f){if(a!==this._time&&l&&(u+=this._time-a,r+=this._time-a),d=u,x=this._start,y=!(_=this._ts),f&&(l||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(M=this._yoyo,g=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(100*g+r,s,o);if(d=Ui(u%g),u===c?(p=this._repeat,d=l):((p=~~(u/g))&&p===u/g&&(d=l,p--),d>l&&(d=l)),w=Pu(this._tTime,g),!a&&this._tTime&&w!==p&&(w=p),M&&1&p&&(d=l-d,E=1),p!==w&&!this._lock){var b=M&&1&w,S=b===(M&&1&p);if(p<w&&(b=!b),a=b?0:l,this._lock=1,this.render(a||(E?0:Ui(p*g)),s,!l)._lock=0,this._tTime=u,!s&&this.parent&&us(this,"onRepeat"),this.vars.repeatRefresh&&!E&&(this.invalidate()._lock=1),a&&a!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,S&&(this._lock=2,this.render(a=b?l:-1e-4,!0),this.vars.repeatRefresh&&!E&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;sL(this,E)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,Ui(a),Ui(d)),v&&(u-=d-(d=v._start))),this._tTime=u,this._time=d,this._act=!_,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!s&&(us(this,"onStart"),this._tTime!==u))return this;if(d>=a&&r>=0)for(h=this._first;h;){if(m=h._next,(h._act||d>=h._start)&&h._ts&&v!==h){if(h.parent!==this)return this.render(r,s,o);if(h.render(h._ts>0?(d-h._start)*h._ts:(h._dirty?h.totalDuration():h._tDur)+(d-h._start)*h._ts,s,o),d!==this._time||!this._ts&&!y){v=0,m&&(u+=this._zTime=-Sn);break}}h=m}else{h=this._last;for(var A=r<0?r:d;h;){if(m=h._prev,(h._act||A<=h._end)&&h._ts&&v!==h){if(h.parent!==this)return this.render(r,s,o);if(h.render(h._ts>0?(A-h._start)*h._ts:(h._dirty?h.totalDuration():h._tDur)+(A-h._start)*h._ts,s,o||qi&&(h._initted||h._startAt)),d!==this._time||!this._ts&&!y){v=0,m&&(u+=this._zTime=A?-Sn:Sn);break}}h=m}}if(v&&!s&&(this.pause(),v.render(d>=a?0:-Sn)._zTime=d>=a?1:-1,this._ts))return this._start=x,Gg(this),this.render(r,s,o);this._onUpdate&&!s&&us(this,"onUpdate",!0),(u===c&&this._tTime>=this.totalDuration()||!u&&a)&&(x===this._start||Math.abs(_)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&Ea(this,1),!s&&(!(r<0)||a)&&(u||a||!c)&&(us(this,u===c&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(Wo(s)||(s=cs(this,s,r)),!(r instanceof Nu)){if(Xi(r))return r.forEach(function(a){return o.add(a,s)}),this;if(Ii(r))return this.addLabel(r,s);if(!Qn(r))return this;r=Ei.delayedCall(0,r)}return this!==r?oo(this,r,s):this},t.getChildren=function(r,s,o,a){void 0===r&&(r=!0),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=-ss);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof Ei?s&&c.push(l):(o&&c.push(l),r&&c.push.apply(c,l.getChildren(!0,s,o)))),l=l._next;return c},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return Ii(r)?this.removeLabel(r):Qn(r)?this.killTweensOf(r):(Vg(this,r),r===this._recent&&(this._recent=this._last),Rc(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ui(Br.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=cs(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=Ei.delayedCall(0,s||rh,o);return a.data="isPause",this._hasPause=1,oo(this,a,cs(this,r))},t.removePause=function(r){var s=this._first;for(r=cs(this,r);s;)s._start===r&&"isPause"===s.data&&Ea(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),c=a.length;c--;)Ca!==a[c]&&a[c].kill(r,s);return this},t.getTweensOf=function(r,s){for(var u,o=[],a=ls(r),c=this._first,l=Wo(s);c;)c instanceof Ei?R$(c._targets,a)&&(l?(!Ca||c._initted&&c._ts)&&c.globalTime(0)<=s&&c.globalTime(c.totalDuration())>s:!s||c.isActive())&&o.push(c):(u=c.getTweensOf(a,s)).length&&o.push.apply(o,u),c=c._next;return o},t.tweenTo=function(r,s){s=s||{};var h,o=this,a=cs(o,r),l=s.startAt,u=s.onStart,f=s.onStartParams,d=s.immediateRender,m=Ei.to(o,as({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||Sn,onStart:function(){if(o.pause(),!h){var g=s.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());m._dur!==g&&Ru(m,g,0,1).render(m._time,!0,!0),h=1}u&&u.apply(m,f||[])}},s));return d?m.render(0):m},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,as({startAt:{time:cs(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return void 0===r&&(r=this._time),QR(this,cs(this,r))},t.previousLabel=function(r){return void 0===r&&(r=this._time),QR(this,cs(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Sn)},t.shiftChildren=function(r,s,o){void 0===o&&(o=0);for(var l,a=this._first,c=this.labels;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(l in c)c[l]>=o&&(c[l]+=r);return Rc(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return i.prototype.invalidate.call(this,r)},t.clear=function(r){void 0===r&&(r=!0);for(var o,s=this._first;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Rc(this)},t.totalDuration=function(r){var l,u,f,s=0,o=this,a=o._last,c=ss;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(f=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),(u=a._start)>c&&o._sort&&a._ts&&!o._lock?(o._lock=1,oo(o,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(s-=u,(!f&&!o._dp||f&&f.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),c=0),a._end>s&&a._ts&&(s=a._end),a=l;Ru(o,o===Wn&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(Wn._ts&&(FR(Wn,Hg(r,Wn)),LR=Br.frame),Br.frame>=OR){OR+=Nr.autoSleep||120;var s=Wn._first;if((!s||!s._ts)&&Nr.autoSleep&&Br._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Br.sleep()}}},e}(Nu);as(wr.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ca,lw,n7=function(e,t,n,r,s,o,a){var f,d,h,m,p,g,y,v,c=new Mr(this._pt,e,t,0,1,hL,null,s),l=0,u=0;for(c.b=n,c.e=r,n+="",(y=~(r+="").indexOf("random("))&&(r=ch(r)),o&&(o(v=[n,r],e,t),n=v[0],r=v[1]),d=n.match(jb)||[];f=jb.exec(r);)m=f[0],p=r.substring(l,f.index),h?h=(h+1)%5:"rgba("===p.substr(-5)&&(h=1),m!==d[u++]&&(g=parseFloat(d[u-1])||0,c._pt={_next:c._pt,p:p||1===u?p:",",s:g,c:"="===m.charAt(1)?Iu(g,m)-g:parseFloat(m)-g,m:h&&h<4?Math.round:0},l=jb.lastIndex);return c.c=l<r.length?r.substring(l,r.length):"",c.fp=a,(CR.test(r)||y)&&(c.e=0),this._pt=c,c},cw=function(e,t,n,r,s,o,a,c,l,u){Qn(r)&&(r=r(s||0,e,o));var m,f=e[t],d="get"!==n?n:Qn(f)?l?e[t.indexOf("set")||!Qn(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():f,h=Qn(f)?l?a7:fL:fw;if(Ii(r)&&(~r.indexOf("random(")&&(r=ch(r)),"="===r.charAt(1)&&((m=Iu(d,r)+(Zi(d)||0))||0===m)&&(r=m)),!u||d!==r||lw)return isNaN(d*r)||""===r?(!f&&!(t in e)&&Xb(t,r),n7.call(this,e,t,d,r,h,c||Nr.stringFilter,l)):(m=new Mr(this._pt,e,t,+d||0,r-(d||0),"boolean"==typeof f?l7:dL,0,h),l&&(m.fp=l),a&&m.modifier(a,this,e),this._pt=m)},cL=function(e,t,n,r,s,o){var a,c,l,u;if(kr[e]&&!1!==(a=new kr[e]).init(s,a.rawVars?t[e]:function(e,t,n,r,s){if(Qn(e)&&(e=dh(e,s,t,n,r)),!so(e)||e.style&&e.nodeType||Xi(e)||TR(e))return Ii(e)?dh(e,s,t,n,r):e;var a,o={};for(a in e)o[a]=dh(e[a],s,t,n,r);return o}(t[e],r,s,o,n),n,r,o)&&(n._pt=c=new Mr(n._pt,s,e,0,1,a.render,a,0,a.priority),n!==Lu))for(l=n._ptLookup[n._targets.indexOf(s)],u=a._props.length;u--;)l[a._props[u]]=c;return a},uw=function i(e,t,n){var E,b,S,A,O,U,k,L,V,Z,ae,J,pe,r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,c=r.lazy,l=r.onUpdate,u=r.onUpdateParams,f=r.callbackScope,d=r.runBackwards,h=r.yoyoEase,m=r.keyframes,p=r.autoRevert,g=e._dur,y=e._startAt,v=e._targets,_=e.parent,x=_&&"nested"===_.data?_.vars.targets:v,w="auto"===e._overwrite&&!Vb,M=e.timeline;if(M&&(!m||!s)&&(s="none"),e._ease=Lc(s,Cu.ease),e._yEase=h?rL(Lc(!0===h?s:h,Cu.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!M&&!!r.runBackwards,!M||m&&!r.stagger){if(J=(L=v[0]?Ic(v[0]).harness:0)&&r[L.prop],E=zg(r,Zb),y&&(y._zTime<0&&y.progress(1),t<0&&d&&a&&!p?y.render(-1,!0):y.revert(d&&g?kg:I$),y._lazy=0),o){if(Ea(e._startAt=Ei.set(v,as({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:!y&&xr(c),startAt:null,delay:0,onUpdate:l,onUpdateParams:u,callbackScope:f,stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(qi||!a&&!p)&&e._startAt.revert(kg),a&&g&&t<=0&&n<=0)return void(t&&(e._zTime=t))}else if(d&&g&&!y)if(t&&(a=!1),S=as({overwrite:!1,data:"isFromStart",lazy:a&&!y&&xr(c),immediateRender:a,stagger:0,parent:_},E),J&&(S[L.prop]=J),Ea(e._startAt=Ei.set(v,S)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(qi?e._startAt.revert(kg):e._startAt.render(-1,!0)),e._zTime=t,a){if(!t)return}else i(e._startAt,Sn,Sn);for(e._pt=e._ptCache=0,c=g&&xr(c)||c&&!g,b=0;b<v.length;b++){if(k=(O=v[b])._gsap||Qb(v)[b]._gsap,e._ptLookup[b]=Z={},Yb[k.id]&&Sa.length&&Ug(),ae=x===v?b:x.indexOf(O),L&&!1!==(V=new L).init(O,J||E,e,ae,x)&&(e._pt=A=new Mr(e._pt,O,V.name,0,1,V.render,V,0,V.priority),V._props.forEach(function(de){Z[de]=A}),V.priority&&(U=1)),!L||J)for(S in E)kr[S]&&(V=cL(S,E,e,ae,O,x))?V.priority&&(U=1):Z[S]=A=cw.call(e,O,S,"get",E[S],ae,x,0,r.stringFilter);e._op&&e._op[b]&&e.kill(O,e._op[b]),w&&e._pt&&(Ca=e,Wn.killTweensOf(O,Z,e.globalTime(t)),pe=!e.parent,Ca=0),e._pt&&c&&(Yb[k.id]=1)}U&&pL(e),e._onInit&&e._onInit(e)}e._onUpdate=l,e._initted=(!e._op||e._pt)&&!pe,m&&t<=0&&M.render(ss,!0,!0)},o7=function(e,t,n,r){var o,a,s=t.ease||r||"power1.inOut";if(Xi(t))a=n[e]||(n[e]=[]),t.forEach(function(c,l){return a.push({t:l/(t.length-1)*100,v:c,e:s})});else for(o in t)a=n[o]||(n[o]=[]),"ease"===o||a.push({t:parseFloat(e),v:t[o],e:s})},dh=function(e,t,n,r,s){return Qn(e)?e.call(t,n,r,s):Ii(e)&&~e.indexOf("random(")?ch(e):e},lL=Jb+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",uL={};br(lL+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return uL[i]=1});var Ei=function(i){function e(n,r,s,o){var a;"number"==typeof r&&(s.duration=r,r=s,s=null);var x,w,M,E,b,S,A,O,c=(a=i.call(this,o?r:sh(r))||this).vars,l=c.duration,u=c.delay,f=c.immediateRender,d=c.stagger,h=c.overwrite,m=c.keyframes,p=c.defaults,g=c.scrollTrigger,y=c.yoyoEase,v=r.parent||Wn,_=(Xi(n)||TR(n)?Wo(n[0]):"length"in r)?[n]:ls(n);if(a._targets=_.length?Qb(_):Fg("GSAP target "+n+" not found. https://greensock.com",!Nr.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=h,m||d||Og(l)||Og(u)){if(r=a.vars,(x=a.timeline=new wr({data:"nested",defaults:p||{},targets:v&&"nested"===v.data?v.vars.targets:_})).kill(),x.parent=x._dp=Go(a),x._start=0,d||Og(l)||Og(u)){if(E=_.length,A=d&&XR(d),so(d))for(b in d)~lL.indexOf(b)&&(O||(O={}),O[b]=d[b]);for(w=0;w<E;w++)(M=zg(r,uL)).stagger=0,y&&(M.yoyoEase=y),O&&Pc(M,O),S=_[w],M.duration=+dh(l,Go(a),w,S,_),M.delay=(+dh(u,Go(a),w,S,_)||0)-a._delay,!d&&1===E&&M.delay&&(a._delay=u=M.delay,a._start+=u,M.delay=0),x.to(S,M,A?A(w,S,_):0),x._ease=jt.none;x.duration()?l=u=0:a.timeline=0}else if(m){sh(as(x.vars.defaults,{ease:"none"})),x._ease=Lc(m.ease||r.ease||"none");var k,L,V,U=0;if(Xi(m))m.forEach(function(Z){return x.to(_,Z,">")}),x.duration();else{for(b in M={},m)"ease"===b||"easeEach"===b||o7(b,m[b],M,m.easeEach);for(b in M)for(k=M[b].sort(function(Z,ae){return Z.t-ae.t}),U=0,w=0;w<k.length;w++)(V={ease:(L=k[w]).e,duration:(L.t-(w?k[w-1].t:0))/100*l})[b]=L.v,x.to(_,V,U),U+=V.duration;x.duration()<l&&x.to({},{duration:l-x.duration()})}}l||a.duration(l=x.duration())}else a.timeline=0;return!0===h&&!Vb&&(Ca=Go(a),Wn.killTweensOf(_),Ca=0),oo(v,Go(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(f||!l&&!m&&a._start===Ui(v._time)&&xr(f)&&F$(Go(a))&&"nested"!==v.data)&&(a._tTime=-Sn,a.render(Math.max(0,-u)||0)),g&&GR(Go(a),g),a}MR(e,i);var t=e.prototype;return t.render=function(r,s,o){var d,h,m,p,g,y,v,_,x,a=this._time,c=this._tDur,l=this._dur,u=r<0,f=r>c-Sn&&!u?c:r<Sn?0:r;if(l){if(f!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=f,_=this.timeline,this._repeat){if(p=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(100*p+r,s,o);if(d=Ui(f%p),f===c?(m=this._repeat,d=l):((m=~~(f/p))&&m===f/p&&(d=l,m--),d>l&&(d=l)),(y=this._yoyo&&1&m)&&(x=this._yEase,d=l-d),g=Pu(this._tTime,p),d===a&&!o&&this._initted)return this._tTime=f,this;m!==g&&(_&&this._yEase&&sL(_,y),this.vars.repeatRefresh&&!y&&!this._lock&&(this._lock=o=1,this.render(Ui(p*m),!0).invalidate()._lock=0))}if(!this._initted){if(WR(this,u?r:d,o,s,f))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(r,s,o)}if(this._tTime=f,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(x||this._ease)(d/l),this._from&&(this.ratio=v=1-v),d&&!a&&!s&&(us(this,"onStart"),this._tTime!==f))return this;for(h=this._pt;h;)h.r(v,h.d),h=h._next;_&&_.render(r<0?r:!d&&y?-Sn:_._dur*_._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&ew(this,r,0,o),us(this,"onUpdate")),this._repeat&&m!==g&&this.vars.onRepeat&&!s&&this.parent&&us(this,"onRepeat"),(f===this._tDur||!f)&&this._tTime===f&&(u&&!this._onUpdate&&ew(this,r,0,!0),(r||!l)&&(f===this._tDur&&this._ts>0||!f&&this._ts<0)&&Ea(this,1),!s&&(!u||a)&&(f||a||y)&&(us(this,f===c?"onComplete":"onReverseComplete",!0),this._prom&&!(f<c&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var l,u,f,s=e.ratio,o=t<0||!t&&(!e._start&&k$(e)&&(e._initted||!tw(e))||(e._ts<0||e._dp._ts<0)&&!tw(e))?0:1,a=e._rDelay,c=0;if(a&&e._repeat&&(c=ah(0,e._tDur,t),u=Pu(c,a),e._yoyo&&1&u&&(o=1-o),u!==Pu(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||qi||r||e._zTime===Sn||!t&&e._zTime){if(!e._initted&&WR(e,t,r,n,c))return;for(f=e._zTime,e._zTime=t||(n?Sn:0),n||(n=t&&!f),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=c,l=e._pt;l;)l.r(o,l.d),l=l._next;t<0&&ew(e,t,0,!0),e._onUpdate&&!n&&us(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&us(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Ea(e,1),!n&&!qi&&(us(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,r,s,o);return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a){fh||Br.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||uw(this,c),function(e,t,n,r,s,o,a){var l,u,f,d,c=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!c)for(c=e._ptCache[t]=[],f=e._ptLookup,d=e._targets.length;d--;){if((l=f[d][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return lw=1,e.vars[t]="+=0",uw(e,a),lw=0,1;c.push(l)}for(d=c.length;d--;)(l=(u=c[d])._pt||u).s=!r&&0!==r||s?l.s+(r||0)+o*l.c:r,l.c=n-l.s,u.e&&(u.e=oi(n)+Zi(u.e)),u.b&&(u.b=l.s+Zi(u.b))}(this,r,s,o,a,this._ease(c/this._dur),c)?this.resetTo(r,s,o,a):(Wg(this,0),this.parent||zR(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(void 0===s&&(s="all"),!(r||s&&"all"!==s))return this._lazy=this._pt=0,this.parent?lh(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Ca&&!0!==Ca.vars.overwrite)._first||lh(this),this.parent&&o!==this.timeline.totalDuration()&&Ru(this,this._dur*this.timeline._tDur/o,0,1),this}var f,d,h,m,p,g,y,a=this._targets,c=r?ls(r):a,l=this._ptLookup,u=this._pt;if((!s||"all"===s)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(a,c))return"all"===s&&(this._pt=0),lh(this);for(f=this._op=this._op||[],"all"!==s&&(Ii(s)&&(p={},br(s,function(v){return p[v]=1}),s=p),s=function(e,t){var s,o,a,c,n=e[0]?Ic(e[0]).harness:0,r=n&&n.aliases;if(!r)return t;for(o in s=Pc({},t),r)if(o in s)for(a=(c=r[o].split(",")).length;a--;)s[c[a]]=s[o];return s}(a,s)),y=a.length;y--;)if(~c.indexOf(a[y]))for(p in d=l[y],"all"===s?(f[y]=s,m=d,h={}):(h=f[y]=f[y]||{},m=s),m)(g=d&&d[p])&&((!("kill"in g.d)||!0===g.d.kill(p))&&Vg(this,g,"_pt"),delete d[p]),"all"!==h&&(h[p]=1);return this._initted&&!this._pt&&u&&lh(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return oh(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return oh(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return Wn.killTweensOf(r,s,o)},e}(Nu);as(Ei.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),br("staggerTo,staggerFrom,staggerFromTo",function(i){Ei[i]=function(){var e=new wr,t=nw.call(arguments,0);return t.splice("staggerFromTo"===i?5:4,0,0),e[i].apply(e,t)}});var fw=function(e,t,n){return e[t]=n},fL=function(e,t,n){return e[t](n)},a7=function(e,t,n,r){return e[t](r.fp,n)},c7=function(e,t,n){return e.setAttribute(t,n)},dw=function(e,t){return Qn(e[t])?fL:Gb(e[t])&&e.setAttribute?c7:fw},dL=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},l7=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},hL=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},hw=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},u7=function(e,t,n,r){for(var o,s=this._pt;s;)o=s._next,s.p===r&&s.modifier(e,t,n),s=o},f7=function(e){for(var n,r,t=this._pt;t;)r=t._next,t.p===e&&!t.op||t.op===e?Vg(this,t,"_pt"):t.dep||(n=1),t=r;return!n},d7=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},pL=function(e){for(var n,r,s,o,t=e._pt;t;){for(n=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=n}e._pt=s},Mr=function(){function i(t,n,r,s,o,a,c,l,u){this.t=n,this.s=s,this.c=o,this.p=r,this.r=a||dL,this.d=c||this,this.set=l||fw,this.pr=u||0,this._next=t,t&&(t._prev=this)}return i.prototype.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=d7,this.m=n,this.mt=s,this.tween=r},i}();br(Jb+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return Zb[i]=1}),Fr.TweenMax=Fr.TweenLite=Ei,Fr.TimelineLite=Fr.TimelineMax=wr,Wn=new wr({sortChildren:!1,defaults:Cu,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Nr.stringFilter=iL;var Fu=[],jg={},h7=[],mL=0,pw=function(e){return(jg[e]||h7).map(function(t){return t()})},mw=function(){var e=Date.now(),t=[];e-mL>2&&(pw("matchMediaInit"),Fu.forEach(function(n){var o,a,c,l,r=n.queries,s=n.conditions;for(a in r)(o=os.matchMedia(r[a]).matches)&&(c=1),o!==s[a]&&(s[a]=o,l=1);l&&(n.revert(),c&&t.push(n))}),pw("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n)}),mL=e,pw("matchMedia"))},gL=function(){function i(t,n){this.selector=n&&iw(n),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=i.prototype;return e.add=function(n,r,s){Qn(n)&&(s=r,r=n,n=Qn);var o=this,a=function(){var f,l=hi,u=o.selector;return l&&l!==o&&l.data.push(o),s&&(o.selector=iw(s)),hi=o,f=r.apply(o,arguments),Qn(f)&&o._r.push(f),hi=l,o.selector=u,o.isReverted=!1,f};return o.last=a,n===Qn?a(o):n?o[n]=a:a},e.ignore=function(n){var r=hi;hi=null,n(this),hi=r},e.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof i?n.push.apply(n,r.getTweens()):r instanceof Ei&&!(r.parent&&"nested"===r.parent.data)&&n.push(r)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,r){var s=this;if(n){var o=this.getTweens();this.data.forEach(function(c){"isFlip"===c.data&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}))}),o.map(function(c){return{g:c.globalTime(0),t:c}}).sort(function(c,l){return l.g-c.g||-1}).forEach(function(c){return c.t.revert(n)}),this.data.forEach(function(c){return!(c instanceof Nu)&&c.revert&&c.revert(n)}),this._r.forEach(function(c){return c(n,s)}),this.isReverted=!0}else this.data.forEach(function(c){return c.kill&&c.kill()});if(this.clear(),r){var a=Fu.indexOf(this);~a&&Fu.splice(a,1)}},e.revert=function(n){this.kill(n||{})},i}(),p7=function(){function i(t){this.contexts=[],this.scope=t}var e=i.prototype;return e.add=function(n,r,s){so(n)||(n={matches:n});var c,l,u,o=new gL(0,s||this.scope),a=o.conditions={};for(l in this.contexts.push(o),r=o.add("onMatch",r),o.queries=n,n)"all"===l?u=1:(c=os.matchMedia(n[l]))&&(Fu.indexOf(o)<0&&Fu.push(o),(a[l]=c.matches)&&(u=1),c.addListener?c.addListener(mw):c.addEventListener("change",mw));return u&&r(o),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},i}(),$g={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(r){return Z$(r)})},timeline:function(e){return new wr(e)},getTweensOf:function(e,t){return Wn.getTweensOf(e,t)},getProperty:function(e,t,n,r){Ii(e)&&(e=ls(e)[0]);var s=Ic(e||{}).get,o=n?BR:kR;return"native"===n&&(n=""),e&&(t?o((kr[t]&&kr[t].get||s)(e,t,n,r)):function(a,c,l){return o((kr[a]&&kr[a].get||s)(e,a,c,l))})},quickSetter:function(e,t,n){if((e=ls(e)).length>1){var r=e.map(function(u){return Ur.quickSetter(u,t,n)}),s=r.length;return function(u){for(var f=s;f--;)r[f](u)}}var o=kr[t],a=Ic(e=e[0]||{}),c=a.harness&&(a.harness.aliases||{})[t]||t,l=o?function(u){var f=new o;Lu._pt=0,f.init(e,n?u+n:u,Lu,0,[e]),f.render(1,f),Lu._pt&&hw(1,Lu)}:a.set(e,c);return o?l:function(u){return l(e,c,n?u+n:u,a,1)}},quickTo:function(e,t,n){var r,s=Ur.to(e,Pc(((r={})[t]="+=0.1",r.paused=!0,r),n||{})),o=function(c,l,u){return s.resetTo(t,c,l,u)};return o.tween=s,o},isTweening:function(e){return Wn.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Lc(e.ease,Cu.ease)),UR(Cu,e||{})},config:function(e){return UR(Nr,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,s=e.defaults,o=e.extendTimeline;(e.plugins||"").split(",").forEach(function(a){return a&&!kr[a]&&!Fr[a]&&Fg(t+" effect requires "+a+" plugin.")}),Kb[t]=function(a,c,l){return n(ls(a),as(c||{},s),l)},o&&(wr.prototype[t]=function(a,c,l){return this.add(Kb[t](a,so(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){jt[e]=Lc(t)},parseEase:function(e,t){return arguments.length?Lc(e,t):jt},getById:function(e){return Wn.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,s,n=new wr(e);for(n.smoothChildTiming=xr(e.smoothChildTiming),Wn.remove(n),n._dp=0,n._time=n._tTime=Wn._time,r=Wn._first;r;)s=r._next,(t||!(!r._dur&&r instanceof Ei&&r.vars.onComplete===r._targets[0]))&&oo(n,r,r._start-r._delay),r=s;return oo(Wn,n,0),n},context:function(e,t){return e?new gL(e,t):hi},matchMedia:function(e){return new p7(e)},matchMediaRefresh:function(){return Fu.forEach(function(e){var n,r,t=e.conditions;for(r in t)t[r]&&(t[r]=!1,n=1);n&&e.revert()})||mw()},addEventListener:function(e,t){var n=jg[e]||(jg[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=jg[e],r=n&&n.indexOf(t);r>=0&&n.splice(r,1)},utils:{wrap:function i(e,t,n){var r=t-e;return Xi(e)?KR(e,i(0,e.length),t):Ta(n,function(s){return(r+(s-e)%r)%r+e})},wrapYoyo:function i(e,t,n){var r=t-e,s=2*r;return Xi(e)?KR(e,i(0,e.length-1),t):Ta(n,function(o){return e+((o=(s+(o-e)%s)%s||0)>r?s-o:o)})},distribute:XR,random:YR,snap:ZR,normalize:function(e,t,n){return JR(e,t,0,1,n)},getUnit:Zi,clamp:function(e,t,n){return Ta(n,function(r){return ah(e,t,r)})},splitColor:eL,toArray:ls,selector:iw,mapRange:JR,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduce(function(s,o){return o(s)},r)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||Zi(n))}},interpolate:function i(e,t,n,r){var s=isNaN(e+t)?0:function(h){return(1-h)*e+h*t};if(!s){var c,l,u,f,d,o=Ii(e),a={};if(!0===n&&(r=1)&&(n=null),o)e={p:e},t={p:t};else if(Xi(e)&&!Xi(t)){for(u=[],d=(f=e.length)-2,l=1;l<f;l++)u.push(i(e[l-1],e[l]));f--,s=function(m){m*=f;var p=Math.min(d,~~m);return u[p](m-p)},n=t}else r||(e=Pc(Xi(e)?[]:{},e));if(!u){for(c in t)cw.call(a,e,c,"get",t[c]);s=function(m){return hw(m,a)||(o?e.p:e)}}}return Ta(n,s)},shuffle:qR},install:PR,effects:Kb,ticker:Br,updateRoot:wr.updateRoot,plugins:kr,globalTimeline:Wn,core:{PropTween:Mr,globals:RR,Tween:Ei,Timeline:wr,Animation:Nu,getCache:Ic,_removeLinkedListItem:Vg,reverting:function(){return qi},context:function(e){return e&&hi&&(hi.data.push(e),e._ctx=hi),hi},suppressOverwrites:function(e){return Vb=e}}};br("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return $g[i]=Ei[i]}),Br.add(wr.updateRoot),Lu=$g.to({},{duration:0});var m7=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},gw=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var c,l;if(Ii(s)&&(c={},br(s,function(u){return c[u]=1}),s=c),t){for(l in c={},s)c[l]=t(s[l]);s=c}!function(e,t){var r,s,o,n=e._targets;for(r in t)for(s=n.length;s--;)(o=e._ptLookup[s][r])&&(o=o.d)&&(o._pt&&(o=m7(o,r)),o&&o.modifier&&o.modifier(t[r],e,n[s],r))}(a,s)}}}},Ur=$g.registerPlugin({name:"attr",init:function(e,t,n,r,s){var o,a,c;for(o in this.tween=n,t)c=e.getAttribute(o)||"",(a=this.add(e,"setAttribute",(c||0)+"",t[o],r,s,0,0,o)).op=o,a.b=c,this._props.push(o)},render:function(e,t){for(var n=t._pt;n;)qi?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},gw("roundProps",rw),gw("modifiers"),gw("snap",ZR))||$g;Ei.version=wr.version=Ur.version="3.11.4",IR=1,ER()&&Ou();var _L,Aa,ku,_w,Nc,yL,yw,SL,jo={},Fc=180/Math.PI,Bu=Math.PI/180,Uu=Math.atan2,vL=1e8,vw=/([A-Z])/g,v7=/(left|right|width|margin|padding|x)/i,x7=/[\s,\(]\S/,$o={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},xw=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},b7=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},w7=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},M7=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},xL=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},bL=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},S7=function(e,t,n){return e.style[t]=n},E7=function(e,t,n){return e.style.setProperty(t,n)},T7=function(e,t,n){return e._gsap[t]=n},D7=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},C7=function(e,t,n,r,s){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},A7=function(e,t,n,r,s){var o=e._gsap;o[t]=n,o.renderTransform(s,o)},jn="transform",Us=jn+"Origin",I7=function(e,t){var n=this,r=this.target,s=r.style;if(e in jo){if(this.tfm=this.tfm||{},"transform"!==e&&(~(e=$o[e]||e).indexOf(",")?e.split(",").forEach(function(o){return n.tfm[o]=qo(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:qo(r,e)),this.props.indexOf(jn)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Us,t,"")),e=jn}(s||t)&&this.props.push(e,t,s[e])},wL=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},P7=function(){var s,o,e=this.props,t=this.target,n=t.style,r=t._gsap;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].replace(vw,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),(s=yw())&&!s.isStart&&!n[jn]&&(wL(n),r.uncache=1)}},ML=function(e,t){var n={target:e,props:[],revert:P7,save:I7};return t&&t.split(",").forEach(function(r){return n.save(r)}),n},bw=function(e,t){var n=Aa.createElementNS?Aa.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Aa.createElement(e);return n.style?n:Aa.createElement(e)},ao=function i(e,t,n){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(vw,"-$1").toLowerCase())||r.getPropertyValue(t)||!n&&i(e,zu(t)||t,1)||""},EL="O,Moz,ms,Ms,Webkit".split(","),zu=function(e,t,n){var s=(t||Nc).style,o=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(EL[o]+e in s););return o<0?null:(3===o?"ms":o>=0?EL[o]:"")+e},ww=function(){typeof window<"u"&&window.document&&(_L=window,ku=(Aa=_L.document).documentElement,Nc=bw("div")||{style:{}},bw("div"),jn=zu(jn),Us=jn+"Origin",Nc.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",SL=!!zu("perspective"),yw=Ur.core.reverting,_w=1)},Mw=function i(e){var o,t=bw("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,s=this.style.cssText;if(ku.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),ku.removeChild(t),this.style.cssText=s,o},TL=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},DL=function(e){var t;try{t=e.getBBox()}catch{t=Mw.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Mw||(t=Mw.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+TL(e,["x","cx","x1"])||0,y:+TL(e,["y","cy","y1"])||0,width:0,height:0}},CL=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!DL(e))},hh=function(e,t){if(t){var n=e.style;t in jo&&t!==Us&&(t=jn),n.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),n.removeProperty(t.replace(vw,"-$1").toLowerCase())):n.removeAttribute(t)}},Ia=function(e,t,n,r,s,o){var a=new Mr(e._pt,t,n,0,1,o?bL:xL);return e._pt=a,a.b=r,a.e=s,e._props.push(n),a},AL={deg:1,rad:1,turn:1},R7={grid:1,flex:1},Pa=function i(e,t,n,r){var m,p,g,y,s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=Nc.style,c=v7.test(t),l="svg"===e.tagName.toLowerCase(),u=(l?"client":"offset")+(c?"Width":"Height"),f=100,d="px"===r,h="%"===r;return r===o||!s||AL[r]||AL[o]?s:("px"!==o&&!d&&(s=i(e,t,n,"px")),y=e.getCTM&&CL(e),!h&&"%"!==o||!jo[t]&&!~t.indexOf("adius")?(a[c?"width":"height"]=f+(d?o:r),p=~t.indexOf("adius")||"em"===r&&e.appendChild&&!l?e:e.parentNode,y&&(p=(e.ownerSVGElement||{}).parentNode),(!p||p===Aa||!p.appendChild)&&(p=Aa.body),(g=p._gsap)&&h&&g.width&&c&&g.time===Br.time&&!g.uncache?oi(s/g.width*f):((h||"%"===o)&&!R7[ao(p,"display")]&&(a.position=ao(e,"position")),p===e&&(a.position="static"),p.appendChild(Nc),m=Nc[u],p.removeChild(Nc),a.position="absolute",c&&h&&((g=Ic(p)).time=Br.time,g.width=p[u]),oi(d?m*s/f:m&&s?f/m*s:0))):(m=y?e.getBBox()[c?"width":"height"]:e[u],oi(h?s/m*f:s/100*m)))},qo=function(e,t,n,r){var s;return _w||ww(),t in $o&&"transform"!==t&&~(t=$o[t]).indexOf(",")&&(t=t.split(",")[0]),jo[t]&&"transform"!==t?(s=mh(e,r),s="transformOrigin"!==t?s[t]:s.svg?s.origin:Xg(ao(e,Us))+" "+s.zOrigin+"px"):(!(s=e.style[t])||"auto"===s||r||~(s+"").indexOf("calc("))&&(s=qg[t]&&qg[t](e,t,n)||ao(e,t)||NR(e,t)||("opacity"===t?1:0)),n&&!~(s+"").trim().indexOf(" ")?Pa(e,t,s,n)+n:s},L7=function(e,t,n,r){if(!n||"none"===n){var s=zu(t,e,1),o=s&&ao(e,s,1);o&&o!==n?(t=s,n=o):"borderColor"===t&&(n=ao(e,"borderTopColor"))}var u,f,d,h,m,p,g,y,v,_,x,a=new Mr(this._pt,e.style,t,0,1,hL),c=0,l=0;if(a.b=n,a.e=r,n+="","auto"==(r+="")&&(e.style[t]=r,r=ao(e,t)||r,e.style[t]=n),iL(u=[n,r]),r=u[1],d=(n=u[0]).match(Au)||[],(r.match(Au)||[]).length){for(;f=Au.exec(r);)g=f[0],v=r.substring(c,f.index),m?m=(m+1)%5:("rgba("===v.substr(-5)||"hsla("===v.substr(-5))&&(m=1),g!==(p=d[l++]||"")&&(h=parseFloat(p)||0,x=p.substr((h+"").length),"="===g.charAt(1)&&(g=Iu(h,g)+x),y=parseFloat(g),_=g.substr((y+"").length),c=Au.lastIndex-_.length,_||(_=_||Nr.units[t]||x,c===r.length&&(r+=_,a.e+=_)),x!==_&&(h=Pa(e,t,p,_)||0),a._pt={_next:a._pt,p:v||1===l?v:",",s:h,c:y-h,m:m&&m<4||"zIndex"===t?Math.round:0});a.c=c<r.length?r.substring(c,r.length):""}else a.r="display"===t&&"none"===r?bL:xL;return CR.test(r)&&(a.e=0),this._pt=a,a},IL={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},O7=function(e){var t=e.split(" "),n=t[0],r=t[1]||"50%";return("top"===n||"bottom"===n||"left"===r||"right"===r)&&(e=n,n=r,r=e),t[0]=IL[n]||n,t[1]=IL[r]||r,t.join(" ")},N7=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var a,c,l,n=t.t,r=n.style,s=t.u,o=n._gsap;if("all"===s||!0===s)r.cssText="",c=1;else for(l=(s=s.split(",")).length;--l>-1;)jo[a=s[l]]&&(c=1,a="transformOrigin"===a?Us:jn),hh(n,a);c&&(hh(n,jn),o&&(o.svg&&n.removeAttribute("transform"),mh(n,1),o.uncache=1,wL(r)))}},qg={clearProps:function(e,t,n,r,s){if("isFromStart"!==s.data){var o=e._pt=new Mr(e._pt,t,n,0,0,N7);return o.u=r,o.pr=-10,o.tween=s,e._props.push(n),1}}},ph=[1,0,0,1,0,0],PL={},RL=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},LL=function(e){var t=ao(e,jn);return RL(t)?ph:t.substr(7).match(DR).map(oi)},Sw=function(e,t){var o,a,c,l,n=e._gsap||Ic(e),r=e.style,s=LL(e);return n.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(s=[(c=e.transform.baseVal.consolidate().matrix).a,c.b,c.c,c.d,c.e,c.f]).join(",")?ph:s:(s===ph&&!e.offsetParent&&e!==ku&&!n.svg&&(c=r.display,r.display="block",(!(o=e.parentNode)||!e.offsetParent)&&(l=1,a=e.nextElementSibling,ku.appendChild(e)),s=LL(e),c?r.display=c:hh(e,"display"),l&&(a?o.insertBefore(e,a):o?o.appendChild(e):ku.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},Ew=function(e,t,n,r,s,o){var M,E,S,a=e._gsap,c=s||Sw(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,f=a.xOffset||0,d=a.yOffset||0,h=c[0],m=c[1],p=c[2],g=c[3],y=c[4],v=c[5],_=t.split(" "),x=parseFloat(_[0])||0,w=parseFloat(_[1])||0;n?c!==ph&&(E=h*g-m*p)&&(S=x*(-m/E)+w*(h/E)-(h*v-m*y)/E,x=x*(g/E)+w*(-p/E)+(p*v-g*y)/E,w=S):(x=(M=DL(e)).x+(~_[0].indexOf("%")?x/100*M.width:x),w=M.y+(~(_[1]||_[0]).indexOf("%")?w/100*M.height:w)),r||!1!==r&&a.smooth?(a.xOffset=f+((y=x-l)*h+(v=w-u)*p)-y,a.yOffset=d+(y*m+v*g)-v):a.xOffset=a.yOffset=0,a.xOrigin=x,a.yOrigin=w,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!n,e.style[Us]="0px 0px",o&&(Ia(o,a,"xOrigin",l,x),Ia(o,a,"yOrigin",u,w),Ia(o,a,"xOffset",f,a.xOffset),Ia(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",x+" "+w)},mh=function(e,t){var n=e._gsap||new aL(e);if("x"in n&&!t&&!n.uncache)return n;var u,f,d,h,m,p,g,y,v,_,x,w,M,E,b,S,A,O,U,k,L,V,Z,ae,J,pe,de,Le,$,me,ye,xe,r=e.style,s=n.scaleX<0,o="px",a="deg",c=getComputedStyle(e),l=ao(e,Us)||"0";return u=f=d=p=g=y=v=_=x=0,h=m=1,n.svg=!(!e.getCTM||!CL(e)),c.translate&&(("none"!==c.translate||"none"!==c.scale||"none"!==c.rotate)&&(r[jn]=("none"!==c.translate?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==c.rotate?"rotate("+c.rotate+") ":"")+("none"!==c.scale?"scale("+c.scale.split(" ").join(",")+") ":"")+("none"!==c[jn]?c[jn]:"")),r.scale=r.rotate=r.translate="none"),E=Sw(e,n.svg),n.svg&&(n.uncache?(J=e.getBBox(),l=n.xOrigin-J.x+"px "+(n.yOrigin-J.y)+"px",ae=""):ae=!t&&e.getAttribute("data-svg-origin"),Ew(e,ae||l,!!ae||n.originIsAbsolute,!1!==n.smooth,E)),w=n.xOrigin||0,M=n.yOrigin||0,E!==ph&&(O=E[0],U=E[1],k=E[2],L=E[3],u=V=E[4],f=Z=E[5],6===E.length?(h=Math.sqrt(O*O+U*U),m=Math.sqrt(L*L+k*k),p=O||U?Uu(U,O)*Fc:0,(v=k||L?Uu(k,L)*Fc+p:0)&&(m*=Math.abs(Math.cos(v*Bu))),n.svg&&(u-=w-(w*O+M*k),f-=M-(w*U+M*L))):(me=E[7],de=E[8],Le=E[9],ye=E[11],u=E[12],f=E[13],d=E[14],g=(b=Uu(xe=E[6],$=E[10]))*Fc,b&&(ae=V*(S=Math.cos(-b))+de*(A=Math.sin(-b)),J=Z*S+Le*A,pe=xe*S+$*A,de=V*-A+de*S,Le=Z*-A+Le*S,$=xe*-A+$*S,ye=me*-A+ye*S,V=ae,Z=J,xe=pe),y=(b=Uu(-k,$))*Fc,b&&(S=Math.cos(-b),ye=L*(A=Math.sin(-b))+ye*S,O=ae=O*S-de*A,U=J=U*S-Le*A,k=pe=k*S-$*A),p=(b=Uu(U,O))*Fc,b&&(ae=O*(S=Math.cos(b))+U*(A=Math.sin(b)),J=V*S+Z*A,U=U*S-O*A,Z=Z*S-V*A,O=ae,V=J),g&&Math.abs(g)+Math.abs(p)>359.9&&(g=p=0,y=180-y),h=oi(Math.sqrt(O*O+U*U+k*k)),m=oi(Math.sqrt(Z*Z+xe*xe)),b=Uu(V,Z),v=Math.abs(b)>2e-4?b*Fc:0,x=ye?1/(ye<0?-ye:ye):0),n.svg&&(ae=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!RL(ao(e,jn)),ae&&e.setAttribute("transform",ae))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(h*=-1,v+=p<=0?180:-180,p+=p<=0?180:-180):(m*=-1,v+=v<=0?180:-180)),t=t||n.uncache,n.x=u-((n.xPercent=u&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=f-((n.yPercent=f&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-f)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=d+o,n.scaleX=oi(h),n.scaleY=oi(m),n.rotation=oi(p)+a,n.rotationX=oi(g)+a,n.rotationY=oi(y)+a,n.skewX=v+a,n.skewY=_+a,n.transformPerspective=x+o,(n.zOrigin=parseFloat(l.split(" ")[2])||0)&&(r[Us]=Xg(l)),n.xOffset=n.yOffset=0,n.force3D=Nr.force3D,n.renderTransform=n.svg?k7:SL?OL:F7,n.uncache=0,n},Xg=function(e){return(e=e.split(" "))[0]+" "+e[1]},Tw=function(e,t,n){var r=Zi(t);return oi(parseFloat(t)+parseFloat(Pa(e,"x",n+"px",r)))+r},F7=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,OL(e,t)},kc="0deg",gh="0px",Bc=") ",OL=function(e,t){var n=t||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,c=n.z,l=n.rotation,u=n.rotationY,f=n.rotationX,d=n.skewX,h=n.skewY,m=n.scaleX,p=n.scaleY,g=n.transformPerspective,y=n.force3D,v=n.target,_=n.zOrigin,x="",w="auto"===y&&e&&1!==e||!0===y;if(_&&(f!==kc||u!==kc)){var S,M=parseFloat(u)*Bu,E=Math.sin(M),b=Math.cos(M);M=parseFloat(f)*Bu,S=Math.cos(M),o=Tw(v,o,E*S*-_),a=Tw(v,a,-Math.sin(M)*-_),c=Tw(v,c,b*S*-_+_)}g!==gh&&(x+="perspective("+g+Bc),(r||s)&&(x+="translate("+r+"%, "+s+"%) "),(w||o!==gh||a!==gh||c!==gh)&&(x+=c!==gh||w?"translate3d("+o+", "+a+", "+c+") ":"translate("+o+", "+a+Bc),l!==kc&&(x+="rotate("+l+Bc),u!==kc&&(x+="rotateY("+u+Bc),f!==kc&&(x+="rotateX("+f+Bc),(d!==kc||h!==kc)&&(x+="skew("+d+", "+h+Bc),(1!==m||1!==p)&&(x+="scale("+m+", "+p+Bc),v.style[jn]=x||"translate(0, 0)"},k7=function(e,t){var w,M,E,b,S,n=t||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,c=n.rotation,l=n.skewX,u=n.skewY,f=n.scaleX,d=n.scaleY,h=n.target,m=n.xOrigin,p=n.yOrigin,g=n.xOffset,y=n.yOffset,v=n.forceCSS,_=parseFloat(o),x=parseFloat(a);c=parseFloat(c),l=parseFloat(l),(u=parseFloat(u))&&(l+=u=parseFloat(u),c+=u),c||l?(c*=Bu,l*=Bu,w=Math.cos(c)*f,M=Math.sin(c)*f,E=Math.sin(c-l)*-d,b=Math.cos(c-l)*d,l&&(u*=Bu,S=Math.tan(l-u),E*=S=Math.sqrt(1+S*S),b*=S,u&&(S=Math.tan(u),w*=S=Math.sqrt(1+S*S),M*=S)),w=oi(w),M=oi(M),E=oi(E),b=oi(b)):(w=f,b=d,M=E=0),(_&&!~(o+"").indexOf("px")||x&&!~(a+"").indexOf("px"))&&(_=Pa(h,"x",o,"px"),x=Pa(h,"y",a,"px")),(m||p||g||y)&&(_=oi(_+m-(m*w+p*E)+g),x=oi(x+p-(m*M+p*b)+y)),(r||s)&&(S=h.getBBox(),_=oi(_+r/100*S.width),x=oi(x+s/100*S.height)),h.setAttribute("transform",S="matrix("+w+","+M+","+E+","+b+","+_+","+x+")"),v&&(h.style[jn]=S)},B7=function(e,t,n,r,s){var f,d,o=360,a=Ii(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?Fc:1)-r,u=r+l+"deg";return a&&("short"===(f=s.split("_")[1])&&(l%=o)!=l%180&&(l+=l<0?o:-o),"cw"===f&&l<0?l=(l+o*vL)%o-~~(l/o)*o:"ccw"===f&&l>0&&(l=(l-o*vL)%o-~~(l/o)*o)),e._pt=d=new Mr(e._pt,t,n,r,l,b7),d.e=u,d.u="deg",e._props.push(n),d},NL=function(e,t){for(var n in t)e[n]=t[n];return e},U7=function(e,t,n){var a,c,l,u,f,d,m,r=NL({},n._gsap),o=n.style;for(c in r.svg?(l=n.getAttribute("transform"),n.setAttribute("transform",""),o[jn]=t,a=mh(n,1),hh(n,jn),n.setAttribute("transform",l)):(l=getComputedStyle(n)[jn],o[jn]=t,a=mh(n,1),o[jn]=l),jo)(l=r[c])!==(u=a[c])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(c)<0&&(f=Zi(l)!==(m=Zi(u))?Pa(n,c,l,m):parseFloat(l),d=parseFloat(u),e._pt=new Mr(e._pt,a,c,f,d-f,xw),e._pt.u=m||0,e._props.push(c));NL(a,r)};br("padding,margin,Width,Radius",function(i,e){var t="Top",n="Right",r="Bottom",s="Left",o=(e<3?[t,n,r,s]:[t+s,t+n,r+n,r+s]).map(function(a){return e<2?i+a:"border"+a+i});qg[e>1?"border"+i:i]=function(a,c,l,u,f){var d,h;if(arguments.length<4)return d=o.map(function(m){return qo(a,m,l)}),5===(h=d.join(" ")).split(d[0]).length?d[0]:h;d=(u+"").split(" "),h={},o.forEach(function(m,p){return h[m]=d[p]=d[p]||d[(p-1)/2|0]}),a.init(c,h,f)}});var FL={name:"css",register:ww,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,s){var l,u,f,d,h,m,p,g,y,v,_,x,w,M,E,b,o=this._props,a=e.style,c=n.vars.startAt;for(p in _w||ww(),this.styles=this.styles||ML(e),b=this.styles.props,this.tween=n,t)if("autoRound"!==p&&(u=t[p],!kr[p]||!cL(p,t,n,r,e,s)))if(m=qg[p],"function"==(h=typeof u)&&(h=typeof(u=u.call(n,r,e,s))),"string"===h&&~u.indexOf("random(")&&(u=ch(u)),m)m(this,e,p,u,n)&&(E=1);else if("--"===p.substr(0,2))l=(getComputedStyle(e).getPropertyValue(p)+"").trim(),u+="",Da.lastIndex=0,Da.test(l)||(g=Zi(l),y=Zi(u)),y?g!==y&&(l=Pa(e,p,l,y)+y):g&&(u+=g),this.add(a,"setProperty",l,u,r,s,0,0,p),o.push(p),b.push(p,0,a[p]);else if("undefined"!==h){if(c&&p in c?(l="function"==typeof c[p]?c[p].call(n,r,e,s):c[p],Ii(l)&&~l.indexOf("random(")&&(l=ch(l)),Zi(l+"")||(l+=Nr.units[p]||Zi(qo(e,p))||""),"="===(l+"").charAt(1)&&(l=qo(e,p))):l=qo(e,p),d=parseFloat(l),(v="string"===h&&"="===u.charAt(1)&&u.substr(0,2))&&(u=u.substr(2)),f=parseFloat(u),p in $o&&("autoAlpha"===p&&(1===d&&"hidden"===qo(e,"visibility")&&f&&(d=0),b.push("visibility",0,a.visibility),Ia(this,a,"visibility",d?"inherit":"hidden",f?"inherit":"hidden",!f)),"scale"!==p&&"transform"!==p&&~(p=$o[p]).indexOf(",")&&(p=p.split(",")[0])),_=p in jo)if(this.styles.save(p),x||((w=e._gsap).renderTransform&&!t.parseTransform||mh(e,t.parseTransform),M=!1!==t.smoothOrigin&&w.smooth,(x=this._pt=new Mr(this._pt,a,jn,0,1,w.renderTransform,w,0,-1)).dep=1),"scale"===p)this._pt=new Mr(this._pt,w,"scaleY",w.scaleY,(v?Iu(w.scaleY,v+f):f)-w.scaleY||0,xw),this._pt.u=0,o.push("scaleY",p),p+="X";else{if("transformOrigin"===p){b.push(Us,0,a[Us]),u=O7(u),w.svg?Ew(e,u,0,M,0,this):((y=parseFloat(u.split(" ")[2])||0)!==w.zOrigin&&Ia(this,w,"zOrigin",w.zOrigin,y),Ia(this,a,p,Xg(l),Xg(u)));continue}if("svgOrigin"===p){Ew(e,u,1,M,0,this);continue}if(p in PL){B7(this,w,p,d,v?Iu(d,v+u):u);continue}if("smoothOrigin"===p){Ia(this,w,"smooth",w.smooth,u);continue}if("force3D"===p){w[p]=u;continue}if("transform"===p){U7(this,u,e);continue}}else p in a||(p=zu(p)||p);if(_||(f||0===f)&&(d||0===d)&&!x7.test(u)&&p in a)f||(f=0),(g=(l+"").substr((d+"").length))!==(y=Zi(u)||(p in Nr.units?Nr.units[p]:g))&&(d=Pa(e,p,l,y)),this._pt=new Mr(this._pt,_?w:a,p,d,(v?Iu(d,v+f):f)-d,_||"px"!==y&&"zIndex"!==p||!1===t.autoRound?xw:M7),this._pt.u=y||0,g!==y&&"%"!==y&&(this._pt.b=l,this._pt.r=w7);else if(p in a)L7.call(this,e,p,l,v?v+u:u);else if(p in e)this.add(e,p,l||e[p],v?v+u:u,r,s);else if("parseTransform"!==p){Xb(p,u);continue}_||(p in a?b.push(p,0,a[p]):b.push(p,1,l||e[p])),o.push(p)}E&&pL(this)},render:function(e,t){if(t.tween._time||!yw())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:qo,aliases:$o,getSetter:function(e,t,n){var r=$o[t];return r&&r.indexOf(",")<0&&(t=r),t in jo&&t!==Us&&(e._gsap.x||qo(e,"x"))?n&&yL===n?"scale"===t?D7:T7:(yL=n||{})&&("scale"===t?C7:A7):e.style&&!Gb(e.style[t])?S7:~t.indexOf("-")?E7:dw(e,t)},core:{_removeProperty:hh,_getMatrix:Sw}};Ur.utils.checkPrefix=zu,Ur.core.getStyleSaver=ML,function(i,e,t,n){var r=br(i+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(s){jo[s]=1});br(e,function(s){Nr.units[s]="deg",PL[s]=1}),$o[r[13]]=i+","+e,br("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(s){var o=s.split(":");$o[o[1]]=r[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),br("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){Nr.units[i]="px"}),Ur.registerPlugin(FL);var _h=Ur.registerPlugin(FL)||Ur;function BL(i,e){if(e===MA)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===Mm||e===Q0){let t=i.getIndex();if(null===t){const o=[],a=i.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let c=0;c<a.count;c++)o.push(c);i.setIndex(o),t=i.getIndex()}const n=t.count-2,r=[];if(e===Mm)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}class z7 extends vr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new j7(t)}),this.register(function(t){return new J7(t)}),this.register(function(t){return new Q7(t)}),this.register(function(t){return new q7(t)}),this.register(function(t){return new X7(t)}),this.register(function(t){return new Z7(t)}),this.register(function(t){return new Y7(t)}),this.register(function(t){return new W7(t)}),this.register(function(t){return new K7(t)}),this.register(function(t){return new $7(t)}),this.register(function(t){return new H7(t)}),this.register(function(t){return new eq(t)}),this.register(function(t){return new tq(t)})}load(e,t,n,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Tu.extractUrlBase(e),this.manager.itemStart(e);const a=function(l){r?r(l):console.error(l),s.manager.itemError(e),s.manager.itemEnd(e)},c=new Bs(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{s.parse(l,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={},c=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===UL){try{o[sn.KHR_BINARY_GLTF]=new nq(e)}catch(f){return void(r&&r(f))}s=JSON.parse(o[sn.KHR_BINARY_GLTF].content)}else s=JSON.parse(c.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new mq(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const f=this.pluginCallbacks[u](l);a[f.name]=f,o[f.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const f=s.extensionsUsed[u],d=s.extensionsRequired||[];switch(f){case sn.KHR_MATERIALS_UNLIT:o[f]=new G7;break;case sn.KHR_DRACO_MESH_COMPRESSION:o[f]=new iq(s,this.dracoLoader);break;case sn.KHR_TEXTURE_TRANSFORM:o[f]=new rq;break;case sn.KHR_MESH_QUANTIZATION:o[f]=new sq;break;default:d.indexOf(f)>=0&&void 0===a[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function V7(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const sn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class H7{constructor(e){this.parser=e,this.name=sn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let l;const u=new Re(16777215);void 0!==c.color&&u.fromArray(c.color);const f=void 0!==c.range?c.range:0;switch(c.type){case"directional":l=new mb(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new pb(u),l.distance=f;break;case"spot":l=new db(u),l.distance=f,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,La(l,c),void 0!==c.intensity&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(c){return n._getNodeRef(t.cache,a,c)})}}class G7{constructor(){this.name=sn.KHR_MATERIALS_UNLIT}getMaterialType(){return Lr}extendParams(e,t,n){const r=[];e.color=new Re(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,rn))}return Promise.all(r)}}class W7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class j7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new oe(a,a)}return Promise.all(s)}}class $7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class q7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Re(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,rn)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class X7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Z7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Re(a[0],a[1],a[2]),Promise.all(s)}}class Y7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class K7{constructor(e){this.parser=e,this.name=sn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?zo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Re(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,rn)),Promise.all(s)}}class J7{constructor(e){this.parser=e,this.name=sn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class Q7{constructor(e){this.parser=e,this.name=sn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=n.textureLoader;if(a.uri){const l=n.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return n.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class eq{constructor(e){this.name=sn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,f=r.byteStride,d=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,f,d,r.mode,r.filter).then(function(h){return h.buffer}):o.ready.then(function(){const h=new ArrayBuffer(u*f);return o.decodeGltfBuffer(new Uint8Array(h),u,f,d,r.mode,r.filter),h})})}return null}}class tq{constructor(e){this.name=sn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const l of r.primitives)if(l.mode!==fs.TRIANGLES&&l.mode!==fs.TRIANGLE_STRIP&&l.mode!==fs.TRIANGLE_FAN&&void 0!==l.mode)return null;const o=n.extensions[this.name].attributes,a=[],c={};for(const l in o)a.push(this.parser.getDependency("accessor",o[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{const u=l.pop(),f=u.isGroup?u.children:[u],d=l[0].count,h=[];for(const m of f){const p=new gt,g=new D,y=new Ci,v=new D(1,1,1),_=new zx(m.geometry,m.material,d);for(let x=0;x<d;x++)c.TRANSLATION&&g.fromBufferAttribute(c.TRANSLATION,x),c.ROTATION&&y.fromBufferAttribute(c.ROTATION,x),c.SCALE&&v.fromBufferAttribute(c.SCALE,x),_.setMatrixAt(x,p.compose(g,y,v));for(const x in c)"TRANSLATION"!==x&&"ROTATION"!==x&&"SCALE"!==x&&m.geometry.setAttribute(x,c[x]);wn.prototype.copy.call(_,m),_.frustumCulled=!1,this.parser.assignFinalMaterial(_),h.push(_)}return u.isGroup?(u.clear(),u.add(...h),u):h[0]}))}}const UL="glTF";class nq{constructor(e){this.name=sn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==UL)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const c=s.getUint32(o,!0);if(o+=4,1313821514===c){const l=new Uint8Array(e,12+o,a);this.content=n.decode(l)}else if(5130562===c){const l=12+o;this.body=e.slice(l,l+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class iq{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=sn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},l={};for(const u in o){const f=Aw[u]||u.toLowerCase();a[f]=o[u]}for(const u in e.attributes){const f=Aw[u]||u.toLowerCase();if(void 0!==o[u]){const d=n.accessors[e.attributes[u]];l[f]=Vu[d.componentType].name,c[f]=!0===d.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(f){r.decodeDracoFile(u,function(d){for(const h in d.attributes){const p=c[h];void 0!==p&&(d.attributes[h].normalized=p)}f(d)},a,l)})})}}class rq{constructor(){this.name=sn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class sq{constructor(){this.name=sn.KHR_MESH_QUANTIZATION}}class VL extends wu{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=2*a,l=3*a,u=r-t,f=(n-t)/u,d=f*f,h=d*f,m=e*l,p=m-l,g=-2*h+3*d,y=h-d,v=1-g,_=y-d+f;for(let x=0;x!==a;x++)s[x]=v*o[p+x+a]+_*(o[p+x+c]*u)+g*o[m+x+a]+y*(o[m+x]*u);return s}}const oq=new Ci;class aq extends VL{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return oq.fromArray(s).normalize().toArray(s),s}}const fs={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Vu={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},HL={9728:Yn,9729:Hn,9984:od,9985:mm,9986:Gl,9987:to},GL={33071:ki,33648:Hl,10497:aa},Cw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Aw={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ra={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},cq={CUBICSPLINE:void 0,LINEAR:rc,STEP:jl};function lq(i){return void 0===i.DefaultMaterial&&(i.DefaultMaterial=new $d({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Qs})),i.DefaultMaterial}function vh(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function La(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function fq(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function dq(i){const e=i.extensions&&i.extensions[sn.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+WL(e.attributes):i.indices+":"+WL(i.attributes)+":"+i.mode,t}function WL(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function Pw(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const pq=new gt;class mq{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new V7,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||n||r&&s<98?new yP(this.options.manager):new IP(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Bs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};vh(s,a,r),La(a,r),Promise.all(n._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const c=this.associations.get(o);null!=c&&this.associations.set(a,c);for(const[l,u]of o.children.entries())s(u,a.children[l])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[sn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(Tu.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=Cw[r.type],c=!0===r.normalized,l=new(0,Vu[r.componentType])(r.count*o);return Promise.resolve(new fn(l,o,c))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],c=Cw[r.type],l=Vu[r.componentType],u=l.BYTES_PER_ELEMENT,d=r.byteOffset||0,h=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;let p,g;if(h&&h!==u*c){const y=Math.floor(d/h),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let _=t.cache.get(v);_||(p=new l(a,y*h,r.count*h/u),_=new wd(p,h/u),t.cache.add(v,_)),g=new xa(_,c,d%h/u,m)}else p=null===a?new l(r.count*c):new l(a,d,r.count*c),g=new fn(p,c,m);if(void 0!==r.sparse){const x=r.sparse.values.byteOffset||0,w=new(0,Vu[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*Cw.SCALAR),M=new l(o[2],x,r.sparse.count*c);null!==a&&(g=new fn(g.array.slice(),g.itemSize,g.normalized));for(let E=0,b=w.length;E<b;E++){const S=w[E];if(g.setX(S,M[E*c]),c>=2&&g.setY(S,M[E*c+1]),c>=3&&g.setZ(S,M[E*c+2]),c>=4&&g.setW(S,M[E*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const c=this.options.manager.getHandler(o.uri);null!==c&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const l=this.loadImageSource(t,n).then(function(u){u.flipY=!1,u.name=o.name||a.name||"";const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=HL[d.magFilter]||Hn,u.minFilter=HL[d.minFilter]||to,u.wrapS=GL[d.wrapS]||aa,u.wrapT=GL[d.wrapT]||aa,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(f=>f.clone());const o=r.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",l=!1;if(void 0!==o.bufferView)c=this.getDependency("bufferView",o.bufferView).then(function(f){l=!0;const d=new Blob([f],{type:o.mimeType});return c=a.createObjectURL(d),c});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(c).then(function(f){return new Promise(function(d,h){let m=d;!0===t.isImageBitmapLoader&&(m=function(p){const g=new Bi(p);g.needsUpdate=!0,d(g)}),t.load(Tu.resolveURL(f,s.path),m,void 0,h)})}).then(function(f){return!0===l&&a.revokeObjectURL(c),f.userData.mimeType=o.mimeType||function hq(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),f});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[sn.KHR_TEXTURE_TRANSFORM]){const a=void 0!==n.extensions?n.extensions[sn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(o);o=s.extensions[sn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new cg,wi.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(a,c)),n=c}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new $i,wi.prototype.copy.call(c,n),c.color.copy(n.color),this.cache.add(a,c)),n=c}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=n.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(n))),n=c}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return $d}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=[];if((s.extensions||{})[sn.KHR_MATERIALS_UNLIT]){const f=r[sn.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),l.push(f.extendParams(a,s,t))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new Re(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const d=f.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}void 0!==f.baseColorTexture&&l.push(t.assignTexture(a,"map",f.baseColorTexture,rn)),a.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,a.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(l.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=eo);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Lr&&(l.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new oe(1,1),void 0!==s.normalTexture.scale)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}return void 0!==s.occlusionTexture&&o!==Lr&&(l.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Lr&&(a.emissive=(new Re).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Lr&&l.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,rn)),Promise.all(l).then(function(){const f=new o(a);return s.name&&(f.name=s.name),La(f,s),t.associations.set(f,{materials:e}),s.extensions&&vh(r,f,s),f})}createUniqueName(e){const t=Mn.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[sn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return jL(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const l=e[a],u=dq(l),f=r[u];if(f)o.push(f.promise);else{let d;d=l.extensions&&l.extensions[sn.KHR_DRACO_MESH_COMPRESSION]?s(l):jL(new Nt,l,t),r[u]={primitive:l,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let c=0,l=o.length;c<l;c++){const u=void 0===o[c].material?lq(this.cache):this.getDependency("material",o[c].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const l=c.slice(0,c.length-1),u=c[c.length-1],f=[];for(let h=0,m=u.length;h<m;h++){const p=u[h],g=o[h];let y;const v=l[h];if(g.mode===fs.TRIANGLES||g.mode===fs.TRIANGLE_STRIP||g.mode===fs.TRIANGLE_FAN||void 0===g.mode)y=!0===s.isSkinnedMesh?new Ux(p,v):new Kn(p,v),!0===y.isSkinnedMesh&&!y.geometry.attributes.skinWeight.normalized&&y.normalizeSkinWeights(),g.mode===fs.TRIANGLE_STRIP?y.geometry=BL(y.geometry,Q0):g.mode===fs.TRIANGLE_FAN&&(y.geometry=BL(y.geometry,Mm));else if(g.mode===fs.LINES)y=new Ns(p,v);else if(g.mode===fs.LINE_STRIP)y=new Bo(p,v);else if(g.mode===fs.LINE_LOOP)y=new Hx(p,v);else{if(g.mode!==fs.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);y=new Wx(p,v)}Object.keys(y.geometry.morphAttributes).length>0&&fq(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),La(y,s),g.extensions&&vh(r,y,g),t.assignFinalMaterial(y),f.push(y)}for(let h=0,m=f.length;h<m;h++)t.associations.set(f[h],{meshes:e,primitives:h});if(1===f.length)return f[0];const d=new ko;t.associations.set(d,{meshes:e});for(let h=0,m=f.length;h<m;h++)d.add(f[h]);return d})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Fn(ix.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Fo(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),La(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this.getDependency("node",t.joints[r]));return n.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],c=[];for(let l=0,u=o.length;l<u;l++){const f=o[l];if(f){a.push(f);const d=new gt;null!==s&&d.fromArray(s.array,16*l),c.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Td(a,c)})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],o=[],a=[],c=[];for(let l=0,u=n.channels.length;l<u;l++){const f=n.channels[l],d=n.samplers[f.sampler],h=f.target,p=void 0!==n.parameters?n.parameters[d.input]:d.input,g=void 0!==n.parameters?n.parameters[d.output]:d.output;r.push(this.getDependency("node",h.node)),s.push(this.getDependency("accessor",p)),o.push(this.getDependency("accessor",g)),a.push(d),c.push(h)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(l){const u=l[0],f=l[1],d=l[2],h=l[3],m=l[4],p=[];for(let y=0,v=u.length;y<v;y++){const _=u[y],x=f[y],w=d[y],M=h[y],E=m[y];if(void 0===_)continue;let b;switch(_.updateMatrix(),Ra[E.path]){case Ra.weights:b=Mu;break;case Ra.rotation:b=ba;break;default:b=Su}const S=_.name?_.name:_.uuid,A=void 0!==M.interpolation?cq[M.interpolation]:rc,O=[];Ra[E.path]===Ra.weights?_.traverse(function(k){k.morphTargetInfluences&&O.push(k.name?k.name:k.uuid)}):O.push(S);let U=w.array;if(w.normalized){const k=Pw(U.constructor),L=new Float32Array(U.length);for(let V=0,Z=U.length;V<Z;V++)L[V]=U[V]*k;U=L}for(let k=0,L=O.length;k<L;k++){const V=new b(O[k]+"."+Ra[E.path],x.array,U,A);"CUBICSPLINE"===M.interpolation&&(V.createInterpolant=function(ae){return new(this instanceof ba?aq:VL)(this.times,this.values,this.getValueSize()/3,ae)},V.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),p.push(V)}}return new Eu(n.name?n.name:"animation_"+e,void 0,p)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){const n=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],c=r._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});c&&a.push(c),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(d){return r._getNodeRef(r.cameraCache,s.camera,d)})),r._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){a.push(d)});const l=[],u=s.children||[];for(let d=0,h=u.length;d<h;d++)l.push(r.getDependency("node",u[d]));const f=void 0===s.skin?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([Promise.all(a),Promise.all(l),f])}().then(function(a){const c=a[0],l=a[1],u=a[2];let f;if(f=!0===s.isBone?new sg:c.length>1?new ko:1===c.length?c[0]:new wn,f!==c[0])for(let d=0,h=c.length;d<h;d++)f.add(c[d]);if(s.name&&(f.userData.name=s.name,f.name=o),La(f,s),s.extensions&&vh(n,f,s),void 0!==s.matrix){const d=new gt;d.fromArray(s.matrix),f.applyMatrix4(d)}else void 0!==s.translation&&f.position.fromArray(s.translation),void 0!==s.rotation&&f.quaternion.fromArray(s.rotation),void 0!==s.scale&&f.scale.fromArray(s.scale);r.associations.has(f)||r.associations.set(f,{}),r.associations.get(f).nodes=e,null!==u&&f.traverse(function(d){d.isSkinnedMesh&&d.bind(u,pq)});for(let d=0,h=l.length;d<h;d++)f.add(l[d]);return f})}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new ko;n.name&&(s.name=r.createUniqueName(n.name)),La(s,n),n.extensions&&vh(t,s,n);const o=n.nodes||[],a=[];for(let c=0,l=o.length;c<l;c++)a.push(r.getDependency("node",o[c]));return Promise.all(a).then(function(c){for(let u=0,f=c.length;u<f;u++)s.add(c[u]);return r.associations=(u=>{const f=new Map;for(const[d,h]of r.associations)(d instanceof wi||d instanceof Bi)&&f.set(d,h);return u.traverse(d=>{const h=r.associations.get(d);null!=h&&f.set(d,h)}),f})(s),s})}}function jL(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){i.setAttribute(a,c)})}for(const o in n){const a=Aw[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(void 0!==e.indices&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return La(i,e),function gq(i,e,t){const n=e.attributes,r=new da;if(void 0===n.POSITION)return;{const a=t.json.accessors[n.POSITION],c=a.min,l=a.max;if(void 0===c||void 0===l)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new D(c[0],c[1],c[2]),new D(l[0],l[1],l[2])),a.normalized){const u=Pw(Vu[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new D,c=new D;for(let l=0,u=s.length;l<u;l++){const f=s[l];if(void 0!==f.POSITION){const d=t.json.accessors[f.POSITION],h=d.min,m=d.max;if(void 0!==h&&void 0!==m){if(c.setX(Math.max(Math.abs(h[0]),Math.abs(m[0]))),c.setY(Math.max(Math.abs(h[1]),Math.abs(m[1]))),c.setZ(Math.max(Math.abs(h[2]),Math.abs(m[2]))),d.normalized){const p=Pw(Vu[d.componentType]);c.multiplyScalar(p)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new ma;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function uq(i,e,t){let n=!1,r=!1,s=!1;for(let l=0,u=e.length;l<u;l++){const f=e[l];if(void 0!==f.POSITION&&(n=!0),void 0!==f.NORMAL&&(r=!0),void 0!==f.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){const f=e[l];if(n){const d=void 0!==f.POSITION?t.getDependency("accessor",f.POSITION):i.attributes.position;o.push(d)}if(r){const d=void 0!==f.NORMAL?t.getDependency("accessor",f.NORMAL):i.attributes.normal;a.push(d)}if(s){const d=void 0!==f.COLOR_0?t.getDependency("accessor",f.COLOR_0):i.attributes.color;c.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(l){const f=l[1],d=l[2];return n&&(i.morphAttributes.position=l[0]),r&&(i.morphAttributes.normal=f),s&&(i.morphAttributes.color=d),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}function _q(i,e){if(1&i){const t=qy();wo(0,"ngt-primitive",4,5),Al("beforeRender",function(r){return M_(t),S_(Pp().onBeforeRender(r))}),ta()}2&i&&Kr("scale",1)}function yq(i,e){1&i&&(wo(0,"ngt-orbit-controls",6),Al("beforeRender",function(n){return n.object.update()}),ta()),2&i&&Kr("enableDamping",!0)}const vq=function(i){return[0,10,i]},xq=function(){return[0,10,10]},bq=function(i){return[i]},wq=function(i,e){return[i,e]};mR(zs),mR({OrbitControls:class S$ extends no{constructor(e,t){super(),Tt(this,"object",void 0),Tt(this,"domElement",void 0),Tt(this,"enabled",!0),Tt(this,"target",new D),Tt(this,"minDistance",0),Tt(this,"maxDistance",1/0),Tt(this,"minZoom",0),Tt(this,"maxZoom",1/0),Tt(this,"minPolarAngle",0),Tt(this,"maxPolarAngle",Math.PI),Tt(this,"minAzimuthAngle",-1/0),Tt(this,"maxAzimuthAngle",1/0),Tt(this,"enableDamping",!1),Tt(this,"dampingFactor",.05),Tt(this,"enableZoom",!0),Tt(this,"zoomSpeed",1),Tt(this,"enableRotate",!0),Tt(this,"rotateSpeed",1),Tt(this,"enablePan",!0),Tt(this,"panSpeed",1),Tt(this,"screenSpacePanning",!0),Tt(this,"keyPanSpeed",7),Tt(this,"autoRotate",!1),Tt(this,"autoRotateSpeed",2),Tt(this,"reverseOrbit",!1),Tt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Tt(this,"mouseButtons",{LEFT:Ja.ROTATE,MIDDLE:Ja.DOLLY,RIGHT:Ja.PAN}),Tt(this,"touches",{ONE:Qa.ROTATE,TWO:Qa.DOLLY_PAN}),Tt(this,"target0",void 0),Tt(this,"position0",void 0),Tt(this,"zoom0",void 0),Tt(this,"_domElementKeyEvents",null),Tt(this,"getPolarAngle",void 0),Tt(this,"getAzimuthalAngle",void 0),Tt(this,"setPolarAngle",void 0),Tt(this,"setAzimuthalAngle",void 0),Tt(this,"getDistance",void 0),Tt(this,"listenToKeyEvents",void 0),Tt(this,"saveState",void 0),Tt(this,"reset",void 0),Tt(this,"update",void 0),Tt(this,"connect",void 0),Tt(this,"dispose",void 0),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object instanceof Fn?this.object.zoom:1,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=N=>{let Q=wR(N,2*Math.PI),ve=u.phi;ve<0&&(ve+=2*Math.PI),Q<0&&(Q+=2*Math.PI);let Te=Math.abs(Q-ve);2*Math.PI-Te<Te&&(Q<ve?Q+=2*Math.PI:ve+=2*Math.PI),f.phi=Q-ve,n.update()},this.setAzimuthalAngle=N=>{let Q=wR(N,2*Math.PI),ve=u.theta;ve<0&&(ve+=2*Math.PI),Q<0&&(Q+=2*Math.PI);let Te=Math.abs(Q-ve);2*Math.PI-Te<Te&&(Q<ve?Q+=2*Math.PI:ve+=2*Math.PI),f.theta=Q-ve,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=N=>{N.addEventListener("keydown",te),this._domElementKeyEvents=N},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object instanceof Fn?n.object.zoom:1},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object instanceof Fn&&(n.object.zoom=n.zoom0,n.object.updateProjectionMatrix()),n.dispatchEvent(r),n.update(),c=a.NONE},this.update=(()=>{const N=new D,Q=(new Ci).setFromUnitVectors(e.up,new D(0,1,0)),ve=Q.clone().invert(),Te=new D,ut=new Ci,$t=2*Math.PI;return function(){const z=n.object.position;N.copy(z).sub(n.target),N.applyQuaternion(Q),u.setFromVector3(N),n.autoRotate&&c===a.NONE&&U(function A(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(u.theta+=f.theta*n.dampingFactor,u.phi+=f.phi*n.dampingFactor):(u.theta+=f.theta,u.phi+=f.phi);let ne=n.minAzimuthAngle,ge=n.maxAzimuthAngle;return isFinite(ne)&&isFinite(ge)&&(ne<-Math.PI?ne+=$t:ne>Math.PI&&(ne-=$t),ge<-Math.PI?ge+=$t:ge>Math.PI&&(ge-=$t),u.theta=ne<=ge?Math.max(ne,Math.min(ge,u.theta)):u.theta>(ne+ge)/2?Math.max(ne,u.theta):Math.min(ge,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=d,u.radius=Math.max(n.minDistance,Math.min(n.maxDistance,u.radius)),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),N.setFromSpherical(u),N.applyQuaternion(ve),z.copy(n.target).add(N),n.object.lookAt(n.target),!0===n.enableDamping?(f.theta*=1-n.dampingFactor,f.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(f.set(0,0,0),h.set(0,0,0)),d=1,!!(m||Te.distanceToSquared(n.object.position)>l||8*(1-ut.dot(n.object.quaternion))>l)&&(n.dispatchEvent(r),Te.copy(n.object.position),ut.copy(n.object.quaternion),m=!1,!0)}})(),this.connect=N=>{N===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=N,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Oe),n.domElement.addEventListener("pointerdown",_t),n.domElement.addEventListener("pointercancel",yn),n.domElement.addEventListener("wheel",T)},this.dispose=()=>{var N,Q,ve,Te,ut,$t;null===(N=n.domElement)||void 0===N||N.removeEventListener("contextmenu",Oe),null===(Q=n.domElement)||void 0===Q||Q.removeEventListener("pointerdown",_t),null===(ve=n.domElement)||void 0===ve||ve.removeEventListener("pointercancel",yn),null===(Te=n.domElement)||void 0===Te||Te.removeEventListener("wheel",T),null===(ut=n.domElement)||void 0===ut||ut.ownerDocument.removeEventListener("pointermove",rt),null===($t=n.domElement)||void 0===$t||$t.ownerDocument.removeEventListener("pointerup",Ye),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",te)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const l=1e-6,u=new Mb,f=new Mb;let d=1;const h=new D;let m=!1;const p=new oe,g=new oe,y=new oe,v=new oe,_=new oe,x=new oe,w=new oe,M=new oe,E=new oe,b=[],S={};function O(){return Math.pow(.95,n.zoomSpeed)}function U(N){n.reverseOrbit?f.theta+=N:f.theta-=N}function k(N){n.reverseOrbit?f.phi+=N:f.phi-=N}const L=(()=>{const N=new D;return function(ve,Te){N.setFromMatrixColumn(Te,0),N.multiplyScalar(-ve),h.add(N)}})(),V=(()=>{const N=new D;return function(ve,Te){!0===n.screenSpacePanning?N.setFromMatrixColumn(Te,1):(N.setFromMatrixColumn(Te,0),N.crossVectors(n.object.up,N)),N.multiplyScalar(ve),h.add(N)}})(),Z=(()=>{const N=new D;return function(ve,Te){const ut=n.domElement;if(ut&&n.object instanceof Fn&&n.object.isPerspectiveCamera){N.copy(n.object.position).sub(n.target);let $n=N.length();$n*=Math.tan(n.object.fov/2*Math.PI/180),L(2*ve*$n/ut.clientHeight,n.object.matrix),V(2*Te*$n/ut.clientHeight,n.object.matrix)}else ut&&n.object instanceof Fo&&n.object.isOrthographicCamera?(L(ve*(n.object.right-n.object.left)/n.object.zoom/ut.clientWidth,n.object.matrix),V(Te*(n.object.top-n.object.bottom)/n.object.zoom/ut.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ae(N){n.object instanceof Fn&&n.object.isPerspectiveCamera?d/=N:n.object instanceof Fo&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*N)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function J(N){n.object instanceof Fn&&n.object.isPerspectiveCamera?d*=N:n.object instanceof Fo&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/N)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function pe(N){p.set(N.clientX,N.clientY)}function Le(N){v.set(N.clientX,N.clientY)}function Ze(){1==b.length?p.set(b[0].pageX,b[0].pageY):p.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function Ue(){1==b.length?v.set(b[0].pageX,b[0].pageY):v.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function $e(){const N=b[0].pageX-b[1].pageX,Q=b[0].pageY-b[1].pageY,ve=Math.sqrt(N*N+Q*Q);w.set(0,ve)}function fe(N){if(1==b.length)g.set(N.pageX,N.pageY);else{const ve=Ke(N);g.set(.5*(N.pageX+ve.x),.5*(N.pageY+ve.y))}y.subVectors(g,p).multiplyScalar(n.rotateSpeed);const Q=n.domElement;Q&&(U(2*Math.PI*y.x/Q.clientHeight),k(2*Math.PI*y.y/Q.clientHeight)),p.copy(g)}function ue(N){if(1==b.length)_.set(N.pageX,N.pageY);else{const Q=Ke(N);_.set(.5*(N.pageX+Q.x),.5*(N.pageY+Q.y))}x.subVectors(_,v).multiplyScalar(n.panSpeed),Z(x.x,x.y),v.copy(_)}function De(N){const Q=Ke(N),ve=N.pageX-Q.x,Te=N.pageY-Q.y,ut=Math.sqrt(ve*ve+Te*Te);M.set(0,ut),E.set(0,Math.pow(M.y/w.y,n.zoomSpeed)),ae(E.y),w.copy(M)}function _t(N){var Q,ve;!1!==n.enabled&&(0===b.length&&(null===(Q=n.domElement)||void 0===Q||Q.ownerDocument.addEventListener("pointermove",rt),null===(ve=n.domElement)||void 0===ve||ve.ownerDocument.addEventListener("pointerup",Ye)),function dt(N){b.push(N)}(N),"touch"===N.pointerType?function be(N){switch(ce(N),b.length){case 1:switch(n.touches.ONE){case Qa.ROTATE:if(!1===n.enableRotate)return;Ze(),c=a.TOUCH_ROTATE;break;case Qa.PAN:if(!1===n.enablePan)return;Ue(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(n.touches.TWO){case Qa.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Se(){n.enableZoom&&$e(),n.enablePan&&Ue()})(),c=a.TOUCH_DOLLY_PAN;break;case Qa.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function It(){n.enableZoom&&$e(),n.enableRotate&&Ze()})(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(s)}(N):function cn(N){let Q;switch(N.button){case 0:Q=n.mouseButtons.LEFT;break;case 1:Q=n.mouseButtons.MIDDLE;break;case 2:Q=n.mouseButtons.RIGHT;break;default:Q=-1}switch(Q){case Ja.DOLLY:if(!1===n.enableZoom)return;(function de(N){w.set(N.clientX,N.clientY)})(N),c=a.DOLLY;break;case Ja.ROTATE:if(N.ctrlKey||N.metaKey||N.shiftKey){if(!1===n.enablePan)return;Le(N),c=a.PAN}else{if(!1===n.enableRotate)return;pe(N),c=a.ROTATE}break;case Ja.PAN:if(N.ctrlKey||N.metaKey||N.shiftKey){if(!1===n.enableRotate)return;pe(N),c=a.ROTATE}else{if(!1===n.enablePan)return;Le(N),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(s)}(N))}function rt(N){!1!==n.enabled&&("touch"===N.pointerType?function Ee(N){switch(ce(N),c){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;fe(N),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;ue(N),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Xe(N){n.enableZoom&&De(N),n.enablePan&&ue(N)})(N),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function Pe(N){n.enableZoom&&De(N),n.enableRotate&&fe(N)})(N),n.update();break;default:c=a.NONE}}(N):function P(N){if(!1!==n.enabled)switch(c){case a.ROTATE:if(!1===n.enableRotate)return;!function $(N){g.set(N.clientX,N.clientY),y.subVectors(g,p).multiplyScalar(n.rotateSpeed);const Q=n.domElement;Q&&(U(2*Math.PI*y.x/Q.clientHeight),k(2*Math.PI*y.y/Q.clientHeight)),p.copy(g),n.update()}(N);break;case a.DOLLY:if(!1===n.enableZoom)return;!function me(N){M.set(N.clientX,N.clientY),E.subVectors(M,w),E.y>0?ae(O()):E.y<0&&J(O()),w.copy(M),n.update()}(N);break;case a.PAN:if(!1===n.enablePan)return;!function ye(N){_.set(N.clientX,N.clientY),x.subVectors(_,v).multiplyScalar(n.panSpeed),Z(x.x,x.y),v.copy(_),n.update()}(N)}}(N))}function Ye(N){var Q,ve,Te;Fe(N),0===b.length&&(null===(Q=n.domElement)||void 0===Q||Q.releasePointerCapture(N.pointerId),null===(ve=n.domElement)||void 0===ve||ve.ownerDocument.removeEventListener("pointermove",rt),null===(Te=n.domElement)||void 0===Te||Te.ownerDocument.removeEventListener("pointerup",Ye)),n.dispatchEvent(o),c=a.NONE}function yn(N){Fe(N)}function T(N){!1===n.enabled||!1===n.enableZoom||c!==a.NONE&&c!==a.ROTATE||(N.preventDefault(),n.dispatchEvent(s),function xe(N){N.deltaY<0?J(O()):N.deltaY>0&&ae(O()),n.update()}(N),n.dispatchEvent(o))}function te(N){!1===n.enabled||!1===n.enablePan||function q(N){let Q=!1;switch(N.code){case n.keys.UP:Z(0,n.keyPanSpeed),Q=!0;break;case n.keys.BOTTOM:Z(0,-n.keyPanSpeed),Q=!0;break;case n.keys.LEFT:Z(n.keyPanSpeed,0),Q=!0;break;case n.keys.RIGHT:Z(-n.keyPanSpeed,0),Q=!0}Q&&(N.preventDefault(),n.update())}(N)}function Oe(N){!1!==n.enabled&&N.preventDefault()}function Fe(N){delete S[N.pointerId];for(let Q=0;Q<b.length;Q++)if(b[Q].pointerId==N.pointerId)return void b.splice(Q,1)}function ce(N){let Q=S[N.pointerId];void 0===Q&&(Q=new oe,S[N.pointerId]=Q),Q.set(N.pageX,N.pageY)}function Ke(N){return S[(N.pointerId===b[0].pointerId?b[1]:b[0]).pointerId]}void 0!==t&&this.connect(t),this.update()}}});let Mq=(()=>{class i{constructor(){this.store=Un(rs),this.camera=this.store.get("camera"),this.glDom=this.store.get("gl","domElement"),this.events=this.store.get("events"),this.render_count=0,this.positionAdded=!1,this.model$=oR(()=>z7,"assets/smooth_sphere_7.glb").pipe(Dn(t=>(t.scene.traverse(n=>{n instanceof Kn&&n.name.includes("001")&&(n.material.transparent=!0,n.material.opacity=1),n instanceof Kn&&n.name.includes("002")&&(n.material.transparent=!0,n.material.opacity=0),n instanceof Kn&&n.name.includes("003")&&(n.material.transparent=!0,n.material.opacity=0),n instanceof Kn&&n.name.includes("004")&&(n.material.transparent=!0,n.material.opacity=0)}),t.scene)))}onBeforeRender(t){t.object.rotation.y+=.01,_h.timeline().to(t.object.children[1].material,{onStart:()=>{_h.to(t.object.children[0].material,{opacity:"-=0.1"})},opacity:1,delay:3}).to(t.object.children[2].material,{onStart:()=>{_h.to(t.object.children[1].material,{opacity:0,duration:1})},opacity:1,delay:4}).to(t.object.children[4].material,{onStart:()=>{_h.to(t.object.children[2].material,{opacity:0,duration:1}),console.log(t.object)},opacity:1,delay:6})}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=af({type:i,selectors:[["ng-component"]],standalone:!0,features:[Vf],decls:6,vars:15,consts:[["angle","0.15","penumbra","1","color","white",3,"position"],[3,"position"],[3,"scale","beforeRender",4,"args"],[3,"enableDamping","beforeRender",4,"args"],[3,"scale","beforeRender"],["primitive",""],[3,"enableDamping","beforeRender"]],template:function(t,n){1&t&&(Of(0,"ngt-spot-light",0)(1,"ngt-point-light",1)(2,"ngt-point-light",1),Cp(3,_q,2,1,"ngt-primitive",2),function AD(i,e){const t=Zt();let n;const r=i+Nn;t.firstCreatePass?(n=function zB(i,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(i===n.name)return n}}(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks??(t.destroyHooks=[])).push(r,n.onDestroy)):n=t.data[r];const s=n.factory||(n.factory=Ba(n.type)),o=qr(xt);try{const a=Qh(!1),c=s();return Qh(a),function D3(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}(t,he(),r,c),c}finally{qr(o)}}(4,"ngtPush"),Cp(5,yq,1,1,"ngt-orbit-controls",3)),2&t&&(Kr("position",10),ja(1),Kr("position",pv(7,vq,-10)),ja(1),Kr("position",function wD(i,e,t){const n=er()+i,r=he();return r[n]===wt?Ys(r,n,t?e.call(t):e()):function Lf(i,e){return i[e]}(r,n)}(9,xq)),ja(1),Kr("args",pv(10,bq,ID(4,5,n.model$))),ja(2),Kr("args",MD(12,wq,n.camera,n.glDom)))},dependencies:[gR,y$],encapsulation:2}),i})();(function gH(i,e){return VU({rootComponent:i,...hC(e)})})((()=>{class i{constructor(){this.Scene=Mq}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=af({type:i,selectors:[["my-app"]],standalone:!0,features:[Vf],decls:5,vars:1,consts:[[1,"topDiv"],[3,"sceneGraph"]],template:function(t,n){1&t&&(wo(0,"div",0),nv(1," Vanta"),wo(2,"b"),nv(3,"Black"),ta()(),Of(4,"ngt-canvas",1)),2&t&&(ja(4),Kr("sceneGraph",n.Scene))},dependencies:[p$],encapsulation:2}),i})()).then(i=>{}).catch(i=>console.error(i))},609:function(Gc,Hu,Wc){var zs,bh,Mt=this&&this.__spreadArray||function(Hr,Sr,Vs){if(Vs||2===arguments.length)for(var Gr,kn=0,jc=Sr.length;kn<jc;kn++)(Gr||!(kn in Sr))&&(Gr||(Gr=Array.prototype.slice.call(Sr,0,kn)),Gr[kn]=Sr[kn]);return Hr.concat(Gr||Array.prototype.slice.call(Sr))};zs=function(){!function(C){var R=C.performance;function B(Me){R&&R.mark&&R.mark(Me)}function G(Me,H){R&&R.measure&&R.measure(Me,H)}B("Zone");var ee=C.__Zone_symbol_prefix||"__zone_symbol__";function ie(Me){return ee+Me}var _e=!0===C[ie("forceDuplicateZoneCheck")];if(C.Zone){if(_e||"function"!=typeof C.Zone.__symbol__)throw new Error("Zone already loaded.");return C.Zone}var we=function(){function Me(H,F){this._parent=H,this._name=F?F.name||"unnamed":"<root>",this._properties=F&&F.properties||{},this._zoneDelegate=new He(this,this._parent&&this._parent._zoneDelegate,F)}return Me.assertZonePatched=function(){if(C.Promise!==st.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")},Object.defineProperty(Me,"root",{get:function(){for(var H=Me.current;H.parent;)H=H.parent;return H},enumerable:!1,configurable:!0}),Object.defineProperty(Me,"current",{get:function(){return tt.zone},enumerable:!1,configurable:!0}),Object.defineProperty(Me,"currentTask",{get:function(){return Di},enumerable:!1,configurable:!0}),Me.__load_patch=function(H,F,Y){if(void 0===Y&&(Y=!1),st.hasOwnProperty(H)){if(!Y&&_e)throw Error("Already loaded patch: "+H)}else if(!C["__Zone_disable_"+H]){var nt="Zone:"+H;B(nt),st[H]=F(C,Me,hn),G(nt,nt)}},Object.defineProperty(Me.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(Me.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Me.prototype.get=function(H){var F=this.getZoneWith(H);if(F)return F._properties[H]},Me.prototype.getZoneWith=function(H){for(var F=this;F;){if(F._properties.hasOwnProperty(H))return F;F=F._parent}return null},Me.prototype.fork=function(H){if(!H)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,H)},Me.prototype.wrap=function(H,F){if("function"!=typeof H)throw new Error("Expecting function got: "+H);var Y=this._zoneDelegate.intercept(this,H,F),nt=this;return function(){return nt.runGuarded(Y,this,arguments,F)}},Me.prototype.run=function(H,F,Y,nt){tt={parent:tt,zone:this};try{return this._zoneDelegate.invoke(this,H,F,Y,nt)}finally{tt=tt.parent}},Me.prototype.runGuarded=function(H,F,Y,nt){void 0===F&&(F=null),tt={parent:tt,zone:this};try{try{return this._zoneDelegate.invoke(this,H,F,Y,nt)}catch(An){if(this._zoneDelegate.handleError(this,An))throw An}}finally{tt=tt.parent}},Me.prototype.runTask=function(H,F,Y){if(H.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(H.zone||je).name+"; Execution: "+this.name+")");if(H.state!==_n||H.type!==At&&H.type!==et){var nt=H.state!=qt;nt&&H._transitionTo(qt,Wt),H.runCount++;var An=Di;Di=H,tt={parent:tt,zone:this};try{H.type==et&&H.data&&!H.data.isPeriodic&&(H.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,H,F,Y)}catch(dr){if(this._zoneDelegate.handleError(this,dr))throw dr}}finally{H.state!==_n&&H.state!==xn&&(H.type==At||H.data&&H.data.isPeriodic?nt&&H._transitionTo(Wt,qt):(H.runCount=0,this._updateTaskCount(H,-1),nt&&H._transitionTo(_n,qt,_n))),tt=tt.parent,Di=An}}},Me.prototype.scheduleTask=function(H){if(H.zone&&H.zone!==this)for(var F=this;F;){if(F===H.zone)throw Error("can not reschedule task to ".concat(this.name," which is descendants of the original zone ").concat(H.zone.name));F=F.parent}H._transitionTo(zt,_n);var Y=[];H._zoneDelegates=Y,H._zone=this;try{H=this._zoneDelegate.scheduleTask(this,H)}catch(nt){throw H._transitionTo(xn,zt,_n),this._zoneDelegate.handleError(this,nt),nt}return H._zoneDelegates===Y&&this._updateTaskCount(H,1),H.state==zt&&H._transitionTo(Wt,zt),H},Me.prototype.scheduleMicroTask=function(H,F,Y,nt){return this.scheduleTask(new Ie(Ct,H,F,Y,nt,void 0))},Me.prototype.scheduleMacroTask=function(H,F,Y,nt,An){return this.scheduleTask(new Ie(et,H,F,Y,nt,An))},Me.prototype.scheduleEventTask=function(H,F,Y,nt,An){return this.scheduleTask(new Ie(At,H,F,Y,nt,An))},Me.prototype.cancelTask=function(H){if(H.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(H.zone||je).name+"; Execution: "+this.name+")");if(H.state===Wt||H.state===qt){H._transitionTo(Qe,Wt,qt);try{this._zoneDelegate.cancelTask(this,H)}catch(F){throw H._transitionTo(xn,Qe),this._zoneDelegate.handleError(this,F),F}return this._updateTaskCount(H,-1),H._transitionTo(_n,Qe),H.runCount=0,H}},Me.prototype._updateTaskCount=function(H,F){var Y=H._zoneDelegates;-1==F&&(H._zoneDelegates=null);for(var nt=0;nt<Y.length;nt++)Y[nt]._updateTaskCount(H.type,F)},Me}();we.__symbol__=ie;var Ln,ke={name:"",onHasTask:function(Me,H,F,Y){return Me.hasTask(F,Y)},onScheduleTask:function(Me,H,F,Y){return Me.scheduleTask(F,Y)},onInvokeTask:function(Me,H,F,Y,nt,An){return Me.invokeTask(F,Y,nt,An)},onCancelTask:function(Me,H,F,Y){return Me.cancelTask(F,Y)}},He=function(){function Me(H,F,Y){this._taskCounts={microTask:0,macroTask:0,eventTask:0},this.zone=H,this._parentDelegate=F,this._forkZS=Y&&(Y&&Y.onFork?Y:F._forkZS),this._forkDlgt=Y&&(Y.onFork?F:F._forkDlgt),this._forkCurrZone=Y&&(Y.onFork?this.zone:F._forkCurrZone),this._interceptZS=Y&&(Y.onIntercept?Y:F._interceptZS),this._interceptDlgt=Y&&(Y.onIntercept?F:F._interceptDlgt),this._interceptCurrZone=Y&&(Y.onIntercept?this.zone:F._interceptCurrZone),this._invokeZS=Y&&(Y.onInvoke?Y:F._invokeZS),this._invokeDlgt=Y&&(Y.onInvoke?F:F._invokeDlgt),this._invokeCurrZone=Y&&(Y.onInvoke?this.zone:F._invokeCurrZone),this._handleErrorZS=Y&&(Y.onHandleError?Y:F._handleErrorZS),this._handleErrorDlgt=Y&&(Y.onHandleError?F:F._handleErrorDlgt),this._handleErrorCurrZone=Y&&(Y.onHandleError?this.zone:F._handleErrorCurrZone),this._scheduleTaskZS=Y&&(Y.onScheduleTask?Y:F._scheduleTaskZS),this._scheduleTaskDlgt=Y&&(Y.onScheduleTask?F:F._scheduleTaskDlgt),this._scheduleTaskCurrZone=Y&&(Y.onScheduleTask?this.zone:F._scheduleTaskCurrZone),this._invokeTaskZS=Y&&(Y.onInvokeTask?Y:F._invokeTaskZS),this._invokeTaskDlgt=Y&&(Y.onInvokeTask?F:F._invokeTaskDlgt),this._invokeTaskCurrZone=Y&&(Y.onInvokeTask?this.zone:F._invokeTaskCurrZone),this._cancelTaskZS=Y&&(Y.onCancelTask?Y:F._cancelTaskZS),this._cancelTaskDlgt=Y&&(Y.onCancelTask?F:F._cancelTaskDlgt),this._cancelTaskCurrZone=Y&&(Y.onCancelTask?this.zone:F._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;var nt=Y&&Y.onHasTask;(nt||F&&F._hasTaskZS)&&(this._hasTaskZS=nt?Y:ke,this._hasTaskDlgt=F,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=H,Y.onScheduleTask||(this._scheduleTaskZS=ke,this._scheduleTaskDlgt=F,this._scheduleTaskCurrZone=this.zone),Y.onInvokeTask||(this._invokeTaskZS=ke,this._invokeTaskDlgt=F,this._invokeTaskCurrZone=this.zone),Y.onCancelTask||(this._cancelTaskZS=ke,this._cancelTaskDlgt=F,this._cancelTaskCurrZone=this.zone))}return Me.prototype.fork=function(H,F){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,H,F):new we(H,F)},Me.prototype.intercept=function(H,F,Y){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,H,F,Y):F},Me.prototype.invoke=function(H,F,Y,nt,An){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,H,F,Y,nt,An):F.apply(Y,nt)},Me.prototype.handleError=function(H,F){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,H,F)},Me.prototype.scheduleTask=function(H,F){var Y=F;if(this._scheduleTaskZS)this._hasTaskZS&&Y._zoneDelegates.push(this._hasTaskDlgtOwner),(Y=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,H,F))||(Y=F);else if(F.scheduleFn)F.scheduleFn(F);else{if(F.type!=Ct)throw new Error("Task is missing scheduleFn.");Cn(F)}return Y},Me.prototype.invokeTask=function(H,F,Y,nt){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,H,F,Y,nt):F.callback.apply(Y,nt)},Me.prototype.cancelTask=function(H,F){var Y;if(this._cancelTaskZS)Y=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,H,F);else{if(!F.cancelFn)throw Error("Task is not cancelable");Y=F.cancelFn(F)}return Y},Me.prototype.hasTask=function(H,F){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,H,F)}catch(Y){this.handleError(H,Y)}},Me.prototype._updateTaskCount=function(H,F){var Y=this._taskCounts,nt=Y[H],An=Y[H]=nt+F;if(An<0)throw new Error("More tasks executed then were scheduled.");0!=nt&&0!=An||this.hasTask(this.zone,{microTask:Y.microTask>0,macroTask:Y.macroTask>0,eventTask:Y.eventTask>0,change:H})},Me}(),Ie=function(){function Me(H,F,Y,nt,An,dr){if(this._zone=null,this.runCount=0,this._zoneDelegates=null,this._state="notScheduled",this.type=H,this.source=F,this.data=nt,this.scheduleFn=An,this.cancelFn=dr,!Y)throw new Error("callback is not defined");this.callback=Y;var W=this;this.invoke=H===At&&nt&&nt.useG?Me.invokeTask:function(){return Me.invokeTask.call(C,W,this,arguments)}}return Me.invokeTask=function(H,F,Y){H||(H=this),ot++;try{return H.runCount++,H.zone.runTask(H,F,Y)}finally{1==ot&&St(),ot--}},Object.defineProperty(Me.prototype,"zone",{get:function(){return this._zone},enumerable:!1,configurable:!0}),Object.defineProperty(Me.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Me.prototype.cancelScheduleRequest=function(){this._transitionTo(_n,zt)},Me.prototype._transitionTo=function(H,F,Y){if(this._state!==F&&this._state!==Y)throw new Error("".concat(this.type," '").concat(this.source,"': can not transition to '").concat(H,"', expecting state '").concat(F,"'").concat(Y?" or '"+Y+"'":"",", was '").concat(this._state,"'."));this._state=H,H==_n&&(this._zoneDelegates=null)},Me.prototype.toString=function(){return this.data&&typeof this.data.handleId<"u"?this.data.handleId.toString():Object.prototype.toString.call(this)},Me.prototype.toJSON=function(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}},Me}(),Ge=ie("setTimeout"),qe=ie("Promise"),ht=ie("then"),yt=[],kt=!1;function Gt(Me){if(Ln||C[qe]&&(Ln=C[qe].resolve(0)),Ln){var H=Ln[ht];H||(H=Ln.then),H.call(Ln,Me)}else C[Ge](Me,0)}function Cn(Me){0===ot&&0===yt.length&&Gt(St),Me&&yt.push(Me)}function St(){if(!kt){for(kt=!0;yt.length;){var Me=yt;yt=[];for(var H=0;H<Me.length;H++){var F=Me[H];try{F.zone.runTask(F,null,null)}catch(Y){hn.onUnhandledError(Y)}}}hn.microtaskDrainDone(),kt=!1}}var je={name:"NO ZONE"},_n="notScheduled",zt="scheduling",Wt="scheduled",qt="running",Qe="canceling",xn="unknown",Ct="microTask",et="macroTask",At="eventTask",st={},hn={symbol:ie,currentZoneFrame:function(){return tt},onUnhandledError:pn,microtaskDrainDone:pn,scheduleMicroTask:Cn,showUncaughtError:function(){return!we[ie("ignoreConsoleErrorUncaughtError")]},patchEventTarget:function(){return[]},patchOnProperties:pn,patchMethod:function(){return pn},bindArguments:function(){return[]},patchThen:function(){return pn},patchMacroTask:function(){return pn},patchEventPrototype:function(){return pn},isIEOrEdge:function(){return!1},getGlobalObjects:function(){},ObjectDefineProperty:function(){return pn},ObjectGetOwnPropertyDescriptor:function(){},ObjectCreate:function(){},ArraySlice:function(){return[]},patchClass:function(){return pn},wrapWithCurrentZone:function(){return pn},filterProperties:function(){return[]},attachOriginToPatched:function(){return pn},_redefineProperty:function(){return pn},patchCallbacks:function(){return pn},nativeScheduleMicroTask:Gt},tt={parent:null,zone:new we(null,null)},Di=null,ot=0;function pn(){}G("Zone","Zone"),C.Zone=we}(typeof window<"u"&&window||typeof self<"u"&&self||global);var Hr=Object.getOwnPropertyDescriptor,Sr=Object.defineProperty,Vs=Object.getPrototypeOf,kn=Object.create,jc=Array.prototype.slice,Gr="addEventListener",$c="removeEventListener",hs=Zone.__symbol__(Gr),Yo=Zone.__symbol__($c),Wr="true",Ki="false",Oa=Zone.__symbol__("");function Gu(C,R){return Zone.current.wrap(C,R)}function Wu(C,R,B,G,ee){return Zone.current.scheduleMacroTask(C,R,B,G,ee)}var tn=Zone.__symbol__,jr=typeof window<"u",ps=jr?window:void 0,ai=jr&&ps||"object"==typeof self&&self||global,ju="removeAttribute";function $u(C,R){for(var B=C.length-1;B>=0;B--)"function"==typeof C[B]&&(C[B]=Gu(C[B],R+"_"+B));return C}function wh(C){return!C||!1!==C.writable&&!("function"==typeof C.get&&typeof C.set>"u")}var Ko=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,co=!("nw"in ai)&&typeof ai.process<"u"&&"[object process]"==={}.toString.call(ai.process),Xu=!co&&!Ko&&!(!jr||!ps.HTMLElement),qc=typeof ai.process<"u"&&"[object process]"==={}.toString.call(ai.process)&&!Ko&&!(!jr||!ps.HTMLElement),Xc={},Zc=function(C){if(C=C||ai.event){var R=Xc[C.type];R||(R=Xc[C.type]=tn("ON_PROPERTY"+C.type));var ee,B=this||C.target||ai,G=B[R];return Xu&&B===ps&&"error"===C.type?!0===(ee=G&&G.call(this,C.message,C.filename,C.lineno,C.colno,C.error))&&C.preventDefault():null!=(ee=G&&G.apply(this,arguments))&&!ee&&C.preventDefault(),ee}};function ms(C,R,B){var G=Hr(C,R);if(!G&&B&&Hr(B,R)&&(G={enumerable:!0,configurable:!0}),G&&G.configurable){var ie=tn("on"+R+"patched");if(!C.hasOwnProperty(ie)||!C[ie]){delete G.writable,delete G.value;var _e=G.get,we=G.set,ke=R.slice(2),He=Xc[ke];He||(He=Xc[ke]=tn("ON_PROPERTY"+ke)),G.set=function(Ie){var Ge=this;!Ge&&C===ai&&(Ge=ai),Ge&&("function"==typeof Ge[He]&&Ge.removeEventListener(ke,Zc),we&&we.call(Ge,null),Ge[He]=Ie,"function"==typeof Ie&&Ge.addEventListener(ke,Zc,!1))},G.get=function(){var Ie=this;if(!Ie&&C===ai&&(Ie=ai),!Ie)return null;var Ge=Ie[He];if(Ge)return Ge;if(_e){var qe=_e.call(this);if(qe)return G.set.call(this,qe),"function"==typeof Ie[ju]&&Ie.removeAttribute(R),qe}return null},Sr(C,R,G),C[ie]=!0}}}function Mh(C,R,B){if(R)for(var G=0;G<R.length;G++)ms(C,"on"+R[G],B);else{var ee=[];for(var ie in C)"on"==ie.slice(0,2)&&ee.push(ie);for(var _e=0;_e<ee.length;_e++)ms(C,ee[_e],B)}}var ur=tn("originalInstance");function gn(C){var R=ai[C];if(R){ai[tn(C)]=R,ai[C]=function(){var ee=$u(arguments,C);switch(ee.length){case 0:this[ur]=new R;break;case 1:this[ur]=new R(ee[0]);break;case 2:this[ur]=new R(ee[0],ee[1]);break;case 3:this[ur]=new R(ee[0],ee[1],ee[2]);break;case 4:this[ur]=new R(ee[0],ee[1],ee[2],ee[3]);break;default:throw new Error("Arg list too long.")}},gs(ai[C],R);var G,B=new R(function(){});for(G in B)"XMLHttpRequest"===C&&"responseBlob"===G||function(ee){"function"==typeof B[ee]?ai[C].prototype[ee]=function(){return this[ur][ee].apply(this[ur],arguments)}:Sr(ai[C].prototype,ee,{set:function(ie){"function"==typeof ie?(this[ur][ee]=Gu(ie,C+"."+ee),gs(this[ur][ee],ie)):this[ur][ee]=ie},get:function(){return this[ur][ee]}})}(G);for(G in R)"prototype"!==G&&R.hasOwnProperty(G)&&(ai[C][G]=R[G])}}function $r(C,R,B){for(var G=C;G&&!G.hasOwnProperty(R);)G=Vs(G);!G&&C[R]&&(G=C);var ee=tn(R),ie=null;if(G&&(!(ie=G[ee])||!G.hasOwnProperty(ee))&&(ie=G[ee]=G[R],wh(G&&Hr(G,R)))){var we=B(ie,ee,R);G[R]=function(){return we(this,arguments)},gs(G[R],ie)}return ie}function Zg(C,R,B){var G=null;function ee(ie){var _e=ie.data;return _e.args[_e.cbIdx]=function(){ie.invoke.apply(this,arguments)},G.apply(_e.target,_e.args),ie}G=$r(C,R,function(ie){return function(_e,we){var ke=B(_e,we);return ke.cbIdx>=0&&"function"==typeof we[ke.cbIdx]?Wu(ke.name,we[ke.cbIdx],ke,ee):ie.apply(_e,we)}})}function gs(C,R){C[tn("OriginalDelegate")]=R}var Sh=!1,fr=!1;function Th(){if(Sh)return fr;Sh=!0;try{var C=ps.navigator.userAgent;(-1!==C.indexOf("MSIE ")||-1!==C.indexOf("Trident/")||-1!==C.indexOf("Edge/"))&&(fr=!0)}catch{}return fr}Zone.__load_patch("ZoneAwarePromise",function(C,R,B){var G=Object.getOwnPropertyDescriptor,ee=Object.defineProperty;var _e=B.symbol,we=[],ke=!0===C[_e("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],He=_e("Promise"),Ie=_e("then"),Ge="__creationTrace__";B.onUnhandledError=function(W){if(B.showUncaughtError()){var Ce=W&&W.rejection;Ce?console.error("Unhandled Promise rejection:",Ce instanceof Error?Ce.message:Ce,"; Zone:",W.zone.name,"; Task:",W.task&&W.task.source,"; Value:",Ce,Ce instanceof Error?Ce.stack:void 0):console.error(W)}},B.microtaskDrainDone=function(){for(var W=function(){var Ce=we.shift();try{Ce.zone.runGuarded(function(){throw Ce.throwOriginal?Ce.rejection:Ce})}catch(re){!function ht(W){B.onUnhandledError(W);try{var Ce=R[qe];"function"==typeof Ce&&Ce.call(this,W)}catch{}}(re)}};we.length;)W()};var qe=_e("unhandledPromiseRejectionHandler");function yt(W){return W&&W.then}function kt(W){return W}function Ln(W){return F.reject(W)}var Gt=_e("state"),Cn=_e("value"),St=_e("finally"),je=_e("parentPromiseValue"),_n=_e("parentPromiseState"),zt="Promise.then",Wt=null,qt=!0,Qe=!1,xn=0;function Ct(W,Ce){return function(re){try{hn(W,Ce,re)}catch(K){hn(W,!1,K)}}}var et=function(){var W=!1;return function(re){return function(){W||(W=!0,re.apply(null,arguments))}}},At="Promise resolved with itself",st=_e("currentTaskTrace");function hn(W,Ce,re){var K=et();if(W===re)throw new TypeError(At);if(W[Gt]===Wt){var Ve=null;try{("object"==typeof re||"function"==typeof re)&&(Ve=re&&re.then)}catch(Lt){return K(function(){hn(W,!1,Lt)})(),W}if(Ce!==Qe&&re instanceof F&&re.hasOwnProperty(Gt)&&re.hasOwnProperty(Cn)&&re[Gt]!==Wt)Di(re),hn(W,re[Gt],re[Cn]);else if(Ce!==Qe&&"function"==typeof Ve)try{Ve.call(re,K(Ct(W,Ce)),K(Ct(W,!1)))}catch(Lt){K(function(){hn(W,!1,Lt)})()}else{W[Gt]=Ce;var pt=W[Cn];if(W[Cn]=re,W[St]===St&&Ce===qt&&(W[Gt]=W[_n],W[Cn]=W[je]),Ce===Qe&&re instanceof Error){var lt=R.currentTask&&R.currentTask.data&&R.currentTask.data[Ge];lt&&ee(re,st,{configurable:!0,enumerable:!1,writable:!0,value:lt})}for(var vt=0;vt<pt.length;)ot(W,pt[vt++],pt[vt++],pt[vt++],pt[vt++]);if(0==pt.length&&Ce==Qe){W[Gt]=xn;var it=re;try{throw new Error("Uncaught (in promise): "+function ie(W){return W&&W.toString===Object.prototype.toString?(W.constructor&&W.constructor.name||"")+": "+JSON.stringify(W):W?W.toString():Object.prototype.toString.call(W)}(re)+(re&&re.stack?"\n"+re.stack:""))}catch(Lt){it=Lt}ke&&(it.throwOriginal=!0),it.rejection=re,it.promise=W,it.zone=R.current,it.task=R.currentTask,we.push(it),B.scheduleMicroTask()}}}return W}var tt=_e("rejectionHandledHandler");function Di(W){if(W[Gt]===xn){try{var Ce=R[tt];Ce&&"function"==typeof Ce&&Ce.call(this,{rejection:W[Cn],promise:W})}catch{}W[Gt]=Qe;for(var re=0;re<we.length;re++)W===we[re].promise&&we.splice(re,1)}}function ot(W,Ce,re,K,Ve){Di(W);var pt=W[Gt],lt=pt?"function"==typeof K?K:kt:"function"==typeof Ve?Ve:Ln;Ce.scheduleMicroTask(zt,function(){try{var vt=W[Cn],it=!!re&&St===re[St];it&&(re[je]=vt,re[_n]=pt);var Lt=Ce.run(lt,void 0,it&&lt!==Ln&&lt!==kt?[]:[vt]);hn(re,!0,Lt)}catch(Bt){hn(re,!1,Bt)}},re)}var Me=function(){},H=C.AggregateError,F=function(){function W(Ce){var re=this;if(!(re instanceof W))throw new Error("Must be an instanceof Promise.");re[Gt]=Wt,re[Cn]=[];try{var K=et();Ce&&Ce(K(Ct(re,qt)),K(Ct(re,Qe)))}catch(Ve){hn(re,!1,Ve)}}return W.toString=function(){return"function ZoneAwarePromise() { [native code] }"},W.resolve=function(Ce){return hn(new this(null),qt,Ce)},W.reject=function(Ce){return hn(new this(null),Qe,Ce)},W.any=function(Ce){if(!Ce||"function"!=typeof Ce[Symbol.iterator])return Promise.reject(new H([],"All promises were rejected"));var re=[],K=0;try{for(var Ve=0,pt=Ce;Ve<pt.length;Ve++)K++,re.push(W.resolve(pt[Ve]))}catch{return Promise.reject(new H([],"All promises were rejected"))}if(0===K)return Promise.reject(new H([],"All promises were rejected"));var vt=!1,it=[];return new W(function(Lt,Bt){for(var In=0;In<re.length;In++)re[In].then(function(Pn){vt||(vt=!0,Lt(Pn))},function(Pn){it.push(Pn),0==--K&&(vt=!0,Bt(new H(it,"All promises were rejected")))})})},W.race=function(Ce){var re,K,Ve=new this(function(Bt,In){re=Bt,K=In});function pt(Bt){re(Bt)}function lt(Bt){K(Bt)}for(var vt=0,it=Ce;vt<it.length;vt++){var Lt=it[vt];yt(Lt)||(Lt=this.resolve(Lt)),Lt.then(pt,lt)}return Ve},W.all=function(Ce){return W.allWithCallback(Ce)},W.allSettled=function(Ce){return(this&&this.prototype instanceof W?this:W).allWithCallback(Ce,{thenCallback:function(K){return{status:"fulfilled",value:K}},errorCallback:function(K){return{status:"rejected",reason:K}}})},W.allWithCallback=function(Ce,re){for(var K,Ve,pt=new this(function(ei,gi){K=ei,Ve=gi}),lt=2,vt=0,it=[],Lt=function(ei){yt(ei)||(ei=Bt.resolve(ei));var gi=vt;try{ei.then(function(qn){it[gi]=re?re.thenCallback(qn):qn,0==--lt&&K(it)},function(qn){re?(it[gi]=re.errorCallback(qn),0==--lt&&K(it)):Ve(qn)})}catch(qn){Ve(qn)}lt++,vt++},Bt=this,In=0,Pn=Ce;In<Pn.length;In++)Lt(Pn[In]);return 0==(lt-=2)&&K(it),pt},Object.defineProperty(W.prototype,Symbol.toStringTag,{get:function(){return"Promise"},enumerable:!1,configurable:!0}),Object.defineProperty(W.prototype,Symbol.species,{get:function(){return W},enumerable:!1,configurable:!0}),W.prototype.then=function(Ce,re){var K,Ve=null===(K=this.constructor)||void 0===K?void 0:K[Symbol.species];(!Ve||"function"!=typeof Ve)&&(Ve=this.constructor||W);var pt=new Ve(Me),lt=R.current;return this[Gt]==Wt?this[Cn].push(lt,pt,Ce,re):ot(this,lt,pt,Ce,re),pt},W.prototype.catch=function(Ce){return this.then(null,Ce)},W.prototype.finally=function(Ce){var re,K=null===(re=this.constructor)||void 0===re?void 0:re[Symbol.species];(!K||"function"!=typeof K)&&(K=W);var Ve=new K(Me);Ve[St]=St;var pt=R.current;return this[Gt]==Wt?this[Cn].push(pt,Ve,Ce,Ce):ot(this,pt,Ve,Ce,Ce),Ve},W}();F.resolve=F.resolve,F.reject=F.reject,F.race=F.race,F.all=F.all;var Y=C[He]=C.Promise;C.Promise=F;var nt=_e("thenPatched");function An(W){var Ce=W.prototype,re=G(Ce,"then");if(!re||!1!==re.writable&&re.configurable){var K=Ce.then;Ce[Ie]=K,W.prototype.then=function(Ve,pt){var lt=this;return new F(function(it,Lt){K.call(lt,it,Lt)}).then(Ve,pt)},W[nt]=!0}}return B.patchThen=An,Y&&(An(Y),$r(C,"fetch",function(W){return function dr(W){return function(Ce,re){var K=W.apply(Ce,re);if(K instanceof F)return K;var Ve=K.constructor;return Ve[nt]||An(Ve),K}}(W)})),Promise[R.__symbol__("uncaughtPromiseErrors")]=we,F}),Zone.__load_patch("toString",function(C){var R=Function.prototype.toString,B=tn("OriginalDelegate"),G=tn("Promise"),ee=tn("Error"),ie=function(){if("function"==typeof this){var He=this[B];if(He)return"function"==typeof He?R.call(He):Object.prototype.toString.call(He);if(this===Promise){var Ie=C[G];if(Ie)return R.call(Ie)}if(this===Error){var Ge=C[ee];if(Ge)return R.call(Ge)}}return R.call(this)};ie[B]=R,Function.prototype.toString=ie;var _e=Object.prototype.toString;Object.prototype.toString=function(){return"function"==typeof Promise&&this instanceof Promise?"[object Promise]":_e.call(this)}});var Tn=!1;if(typeof window<"u")try{var vn=Object.defineProperty({},"passive",{get:function(){Tn=!0}});window.addEventListener("test",vn,vn),window.removeEventListener("test",vn,vn)}catch{Tn=!1}var Yu,Na,i_,Ku,lo,Yg={useG:!0},Dn={},Yc={},Kg=new RegExp("^"+Oa+"(\\w+)(true|false)$"),Zu=tn("propagationStopped");function Jg(C,R){var B=(R?R(C):C)+Ki,G=(R?R(C):C)+Wr,ee=Oa+B,ie=Oa+G;Dn[C]={},Dn[C][Ki]=ee,Dn[C][Wr]=ie}function Fw(C,R,B,G){var ee=G&&G.add||Gr,ie=G&&G.rm||$c,_e=G&&G.listeners||"eventListeners",we=G&&G.rmAll||"removeAllListeners",ke=tn(ee),He="."+ee+":",Ie="prependListener",Ge="."+Ie+":",qe=function(St,je,_n){if(!St.isRemoved){var Wt,zt=St.callback;"object"==typeof zt&&zt.handleEvent&&(St.callback=function(xn){return zt.handleEvent(xn)},St.originalDelegate=zt);try{St.invoke(St,je,[_n])}catch(xn){Wt=xn}var qt=St.options;return qt&&"object"==typeof qt&&qt.once&&je[ie].call(je,_n.type,St.originalDelegate?St.originalDelegate:St.callback,qt),Wt}};function ht(St,je,_n){if(je=je||C.event){var zt=St||je.target||C,Wt=zt[Dn[je.type][_n?Wr:Ki]];if(Wt){var qt=[];if(1===Wt.length)(Qe=qe(Wt[0],zt,je))&&qt.push(Qe);else for(var xn=Wt.slice(),Ct=0;Ct<xn.length&&(!je||!0!==je[Zu]);Ct++){var Qe;(Qe=qe(xn[Ct],zt,je))&&qt.push(Qe)}if(1===qt.length)throw qt[0];var et=function(At){var st=qt[At];R.nativeScheduleMicroTask(function(){throw st})};for(Ct=0;Ct<qt.length;Ct++)et(Ct)}}}var yt=function(St){return ht(this,St,!1)},kt=function(St){return ht(this,St,!0)};function Ln(St,je){if(!St)return!1;var _n=!0;je&&void 0!==je.useG&&(_n=je.useG);var zt=je&&je.vh,Wt=!0;je&&void 0!==je.chkDup&&(Wt=je.chkDup);var qt=!1;je&&void 0!==je.rt&&(qt=je.rt);for(var Qe=St;Qe&&!Qe.hasOwnProperty(ee);)Qe=Vs(Qe);if(!Qe&&St[ee]&&(Qe=St),!Qe||Qe[ke])return!1;var tt,xn=je&&je.eventNameToString,Ct={},et=Qe[ke]=Qe[ee],At=Qe[tn(ie)]=Qe[ie],st=Qe[tn(_e)]=Qe[_e],hn=Qe[tn(we)]=Qe[we];je&&je.prepend&&(tt=Qe[tn(je.prepend)]=Qe[je.prepend]);var Y=_n?function(K){if(!Ct.isExisting)return et.call(Ct.target,Ct.eventName,Ct.capture?kt:yt,Ct.options)}:function(K){return et.call(Ct.target,Ct.eventName,K.invoke,Ct.options)},nt=_n?function(K){if(!K.isRemoved){var Ve=Dn[K.eventName],pt=void 0;Ve&&(pt=Ve[K.capture?Wr:Ki]);var lt=pt&&K.target[pt];if(lt)for(var vt=0;vt<lt.length;vt++)if(lt[vt]===K){lt.splice(vt,1),K.isRemoved=!0,0===lt.length&&(K.allRemoved=!0,K.target[pt]=null);break}}if(K.allRemoved)return At.call(K.target,K.eventName,K.capture?kt:yt,K.options)}:function(K){return At.call(K.target,K.eventName,K.invoke,K.options)},dr=je&&je.diff?je.diff:function(K,Ve){var pt=typeof Ve;return"function"===pt&&K.callback===Ve||"object"===pt&&K.originalDelegate===Ve},W=Zone[tn("UNPATCHED_EVENTS")],Ce=C[tn("PASSIVE_EVENTS")],re=function(K,Ve,pt,lt,vt,it){return void 0===vt&&(vt=!1),void 0===it&&(it=!1),function(){var Lt=this||C,Bt=arguments[0];je&&je.transferEventName&&(Bt=je.transferEventName(Bt));var In=arguments[1];if(!In)return K.apply(this,arguments);if(co&&"uncaughtException"===Bt)return K.apply(this,arguments);var Pn=!1;if("function"!=typeof In){if(!In.handleEvent)return K.apply(this,arguments);Pn=!0}if(!zt||zt(K,In,Lt,arguments)){var Hs=Tn&&!!Ce&&-1!==Ce.indexOf(Bt),ei=function Di(K,Ve){return!Tn&&"object"==typeof K&&K?!!K.capture:Tn&&Ve?"boolean"==typeof K?{capture:K,passive:!0}:K?"object"==typeof K&&!1!==K.passive?Object.assign(Object.assign({},K),{passive:!0}):K:{passive:!0}:K}(arguments[2],Hs);if(W)for(var gi=0;gi<W.length;gi++)if(Bt===W[gi])return Hs?K.call(Lt,Bt,In,ei):K.apply(this,arguments);var qn=!!ei&&("boolean"==typeof ei||ei.capture),Jo=!(!ei||"object"!=typeof ei)&&ei.once,qw=Zone.current,ef=Dn[Bt];ef||(Jg(Bt,xn),ef=Dn[Bt]);var c_=ef[qn?Wr:Ki],_i=Lt[c_],nn=!1;if(_i){if(nn=!0,Wt)for(gi=0;gi<_i.length;gi++)if(dr(_i[gi],In))return}else _i=Lt[c_]=[];var tf,l_=Lt.constructor.name,u_=Yc[l_];u_&&(tf=u_[Bt]),tf||(tf=l_+Ve+(xn?xn(Bt):Bt)),Ct.options=ei,Jo&&(Ct.options.once=!1),Ct.target=Lt,Ct.capture=qn,Ct.eventName=Bt,Ct.isExisting=nn;var Xt=_n?Yg:void 0;Xt&&(Xt.taskData=Ct);var fo=qw.scheduleEventTask(tf,In,Xt,pt,lt);if(Ct.target=null,Xt&&(Xt.taskData=null),Jo&&(ei.once=!0),!Tn&&"boolean"==typeof fo.options||(fo.options=ei),fo.target=Lt,fo.capture=qn,fo.eventName=Bt,Pn&&(fo.originalDelegate=In),it?_i.unshift(fo):_i.push(fo),vt)return Lt}}};return Qe[ee]=re(et,He,Y,nt,qt),tt&&(Qe[Ie]=re(tt,Ge,function(K){return tt.call(Ct.target,Ct.eventName,K.invoke,Ct.options)},nt,qt,!0)),Qe[ie]=function(){var K=this||C,Ve=arguments[0];je&&je.transferEventName&&(Ve=je.transferEventName(Ve));var pt=arguments[2],lt=!!pt&&("boolean"==typeof pt||pt.capture),vt=arguments[1];if(!vt)return At.apply(this,arguments);if(!zt||zt(At,vt,K,arguments)){var Lt,it=Dn[Ve];it&&(Lt=it[lt?Wr:Ki]);var Bt=Lt&&K[Lt];if(Bt)for(var In=0;In<Bt.length;In++){var Pn=Bt[In];if(dr(Pn,vt))return Bt.splice(In,1),Pn.isRemoved=!0,0===Bt.length&&(Pn.allRemoved=!0,K[Lt]=null,"string"==typeof Ve)&&(K[Oa+"ON_PROPERTY"+Ve]=null),Pn.zone.cancelTask(Pn),qt?K:void 0}return At.apply(this,arguments)}},Qe[_e]=function(){var K=this||C,Ve=arguments[0];je&&je.transferEventName&&(Ve=je.transferEventName(Ve));for(var pt=[],lt=Qg(K,xn?xn(Ve):Ve),vt=0;vt<lt.length;vt++){var it=lt[vt];pt.push(it.originalDelegate?it.originalDelegate:it.callback)}return pt},Qe[we]=function(){var K=this||C,Ve=arguments[0];if(Ve){je&&je.transferEventName&&(Ve=je.transferEventName(Ve));var Bt=Dn[Ve];if(Bt){var Hs=K[Bt[Ki]],ei=K[Bt[Wr]];if(Hs)for(var gi=Hs.slice(),lt=0;lt<gi.length;lt++)this[ie].call(this,Ve,(qn=gi[lt]).originalDelegate?qn.originalDelegate:qn.callback,qn.options);if(ei)for(gi=ei.slice(),lt=0;lt<gi.length;lt++){var qn;this[ie].call(this,Ve,(qn=gi[lt]).originalDelegate?qn.originalDelegate:qn.callback,qn.options)}}}else{var pt=Object.keys(K);for(lt=0;lt<pt.length;lt++){var it=Kg.exec(pt[lt]),Lt=it&&it[1];Lt&&"removeListener"!==Lt&&this[we].call(this,Lt)}this[we].call(this,"removeListener")}if(qt)return this},gs(Qe[ee],et),gs(Qe[ie],At),hn&&gs(Qe[we],hn),st&&gs(Qe[_e],st),!0}for(var Gt=[],Cn=0;Cn<B.length;Cn++)Gt[Cn]=Ln(B[Cn],G);return Gt}function Qg(C,R){if(!R){var B=[];for(var G in C){var ee=Kg.exec(G),ie=ee&&ee[1];if(ie&&(!R||ie===R)){var _e=C[G];if(_e)for(var we=0;we<_e.length;we++)B.push(_e[we])}}return B}var ke=Dn[R];ke||(Jg(R),ke=Dn[R]);var He=C[ke[Ki]],Ie=C[ke[Wr]];return He?Ie?He.concat(Ie):He.slice():Ie?Ie.slice():[]}function kw(C,R){var B=C.Event;B&&B.prototype&&R.patchMethod(B.prototype,"stopImmediatePropagation",function(G){return function(ee,ie){ee[Zu]=!0,G&&G.apply(ee,ie)}})}function Bw(C,R,B,G,ee){var ie=Zone.__symbol__(G);if(!R[ie]){var _e=R[ie]=R[G];R[G]=function(we,ke,He){return ke&&ke.prototype&&ee.forEach(function(Ie){var Ge="".concat(B,".").concat(G,"::")+Ie,qe=ke.prototype;try{if(qe.hasOwnProperty(Ie)){var ht=C.ObjectGetOwnPropertyDescriptor(qe,Ie);ht&&ht.value?(ht.value=C.wrapWithCurrentZone(ht.value,Ge),C._redefineProperty(ke.prototype,Ie,ht)):qe[Ie]&&(qe[Ie]=C.wrapWithCurrentZone(qe[Ie],Ge))}else qe[Ie]&&(qe[Ie]=C.wrapWithCurrentZone(qe[Ie],Ge))}catch{}}),_e.call(R,we,ke,He)},C.attachOriginToPatched(R[G],_e)}}function e_(C,R,B){if(!B||0===B.length)return R;var G=B.filter(function(ie){return ie.target===C});if(!G||0===G.length)return R;var ee=G[0].ignoreProperties;return R.filter(function(ie){return-1===ee.indexOf(ie)})}function t_(C,R,B,G){C&&Mh(C,e_(C,R,B),G)}function Dh(C){return Object.getOwnPropertyNames(C).filter(function(R){return R.startsWith("on")&&R.length>2}).map(function(R){return R.substring(2)})}function n_(C,R){if((!co||qc)&&!Zone[C.symbol("patchEvents")]){var B=R.__Zone_ignore_on_properties,G=[];if(Xu){var ee=window;G=G.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);var ie=function Eh(){try{var C=ps.navigator.userAgent;if(-1!==C.indexOf("MSIE ")||-1!==C.indexOf("Trident/"))return!0}catch{}return!1}()?[{target:ee,ignoreProperties:["error"]}]:[];t_(ee,Dh(ee),B&&B.concat(ie),Vs(ee))}G=G.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(var _e=0;_e<G.length;_e++){var we=R[G[_e]];we&&we.prototype&&t_(we.prototype,Dh(we.prototype),B)}}}function zw(C,R,B){var G=B.configurable;return Ch(C,R,B=_s(C,R,B),G)}function r_(C,R){return C&&C[lo]&&C[lo][R]}function _s(C,R,B){return Object.isFrozen(B)||(B.configurable=!0),B.configurable||(!C[lo]&&!Object.isFrozen(C)&&Na(C,lo,{writable:!0,value:{}}),C[lo]&&(C[lo][R]=!0)),B}function Ch(C,R,B,G){try{return Na(C,R,B)}catch(_e){if(!B.configurable)throw _e;typeof G>"u"?delete B.configurable:B.configurable=G;try{return Na(C,R,B)}catch(we){var ee=!1;if(("createdCallback"===R||"attachedCallback"===R||"detachedCallback"===R||"attributeChangedCallback"===R)&&(ee=!0),!ee)throw we;var ie=null;try{ie=JSON.stringify(B)}catch{ie=B.toString()}console.log("Attempting to configure '".concat(R,"' with descriptor '").concat(ie,"' on object '").concat(C,"' and got error, giving up: ").concat(we))}}}function Hw(C,R){var B=C.getGlobalObjects();if((!B.isNode||B.isMix)&&!function o_(C,R){var B=C.getGlobalObjects();if((B.isBrowser||B.isMix)&&!C.ObjectGetOwnPropertyDescriptor(HTMLElement.prototype,"onclick")&&typeof Element<"u"){var ie=C.ObjectGetOwnPropertyDescriptor(Element.prototype,"onclick");if(ie&&!ie.configurable)return!1;if(ie){C.ObjectDefineProperty(Element.prototype,"onclick",{enumerable:!0,configurable:!0,get:function(){return!0}});var we=!!document.createElement("div").onclick;return C.ObjectDefineProperty(Element.prototype,"onclick",ie),we}}var ke=R.XMLHttpRequest;if(!ke)return!1;var He="onreadystatechange",Ie=ke.prototype,Ge=C.ObjectGetOwnPropertyDescriptor(Ie,He);if(Ge)return C.ObjectDefineProperty(Ie,He,{enumerable:!0,configurable:!0,get:function(){return!0}}),we=!!(qe=new ke).onreadystatechange,C.ObjectDefineProperty(Ie,He,Ge||{}),we;var ht=C.symbol("fake");C.ObjectDefineProperty(Ie,He,{enumerable:!0,configurable:!0,get:function(){return this[ht]},set:function(Gt){this[ht]=Gt}});var qe,yt=function(){};return(qe=new ke).onreadystatechange=yt,we=qe[ht]===yt,qe.onreadystatechange=null,we}(C,R)){var ie=typeof WebSocket<"u";(function Rh(C){for(var R=C.symbol("unbound"),B=function(ee){var ie=Qu[ee],_e="on"+ie;self.addEventListener(ie,function(we){var He,Ie,ke=we.target;for(Ie=ke?ke.constructor.name+"."+_e:"unknown."+_e;ke;)ke[_e]&&!ke[_e][R]&&((He=C.wrapWithCurrentZone(ke[_e],Ie))[R]=ke[_e],ke[_e]=He),ke=ke.parentElement},!0)},G=0;G<Qu.length;G++)B(G)})(C),C.patchClass("XMLHttpRequest"),ie&&function s_(C,R){var B=C.getGlobalObjects(),G=B.ADD_EVENT_LISTENER_STR,ee=B.REMOVE_EVENT_LISTENER_STR,ie=R.WebSocket;R.EventTarget||C.patchEventTarget(R,C,[ie.prototype]),R.WebSocket=function(ke,He){var Ge,qe,Ie=arguments.length>1?new ie(ke,He):new ie(ke),ht=C.ObjectGetOwnPropertyDescriptor(Ie,"onmessage");return ht&&!1===ht.configurable?(Ge=C.ObjectCreate(Ie),qe=Ie,[G,ee,"send","close"].forEach(function(yt){Ge[yt]=function(){var kt=C.ArraySlice.call(arguments);if(yt===G||yt===ee){var Ln=kt.length>0?kt[0]:void 0;if(Ln){var Gt=Zone.__symbol__("ON_PROPERTY"+Ln);Ie[Gt]=Ge[Gt]}}return Ie[yt].apply(Ie,kt)}})):Ge=Ie,C.patchOnProperties(Ge,["close","error","message","open"],qe),Ge};var _e=R.WebSocket;for(var we in ie)_e[we]=ie[we]}(C,R),Zone[C.symbol("patchEvents")]=!0}}Zone.__load_patch("util",function(C,R,B){var G=Dh(C);B.patchOnProperties=Mh,B.patchMethod=$r,B.bindArguments=$u,B.patchMacroTask=Zg;var ee=R.__symbol__("BLACK_LISTED_EVENTS"),ie=R.__symbol__("UNPATCHED_EVENTS");C[ie]&&(C[ee]=C[ie]),C[ee]&&(R[ee]=R[ie]=C[ee]),B.patchEventPrototype=kw,B.patchEventTarget=Fw,B.isIEOrEdge=Th,B.ObjectDefineProperty=Sr,B.ObjectGetOwnPropertyDescriptor=Hr,B.ObjectCreate=kn,B.ArraySlice=jc,B.patchClass=gn,B.wrapWithCurrentZone=Gu,B.filterProperties=e_,B.attachOriginToPatched=gs,B._redefineProperty=Object.defineProperty,B.patchCallbacks=Bw,B.getGlobalObjects=function(){return{globalSources:Yc,zoneSymbolEventNames:Dn,eventNames:G,isBrowser:Xu,isMix:qc,isNode:co,TRUE_STR:Wr,FALSE_STR:Ki,ZONE_SYMBOL_PREFIX:Oa,ADD_EVENT_LISTENER_STR:Gr,REMOVE_EVENT_LISTENER_STR:$c}}});var C,R,Qu=Mt(Mt(Mt(Mt(Mt(Mt(Mt(Mt([],["abort","animationcancel","animationend","animationiteration","auxclick","beforeinput","blur","cancel","canplay","canplaythrough","change","compositionstart","compositionupdate","compositionend","cuechange","click","close","contextmenu","curechange","dblclick","drag","dragend","dragenter","dragexit","dragleave","dragover","drop","durationchange","emptied","ended","error","focus","focusin","focusout","gotpointercapture","input","invalid","keydown","keypress","keyup","load","loadstart","loadeddata","loadedmetadata","lostpointercapture","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","orientationchange","pause","play","playing","pointercancel","pointerdown","pointerenter","pointerleave","pointerlockchange","mozpointerlockchange","webkitpointerlockerchange","pointerlockerror","mozpointerlockerror","webkitpointerlockerror","pointermove","pointout","pointerover","pointerup","progress","ratechange","reset","resize","scroll","seeked","seeking","select","selectionchange","selectstart","show","sort","stalled","submit","suspend","timeupdate","volumechange","touchcancel","touchmove","touchstart","touchend","transitioncancel","transitionend","waiting","wheel"],!0),["webglcontextrestored","webglcontextlost","webglcontextcreationerror"],!0),["autocomplete","autocompleteerror"],!0),["toggle"],!0),["afterscriptexecute","beforescriptexecute","DOMContentLoaded","freeze","fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange","fullscreenerror","mozfullscreenerror","webkitfullscreenerror","msfullscreenerror","readystatechange","visibilitychange","resume"],!0),["absolutedeviceorientation","afterinput","afterprint","appinstalled","beforeinstallprompt","beforeprint","beforeunload","devicelight","devicemotion","deviceorientation","deviceorientationabsolute","deviceproximity","hashchange","languagechange","message","mozbeforepaint","offline","online","paint","pageshow","pagehide","popstate","rejectionhandled","storage","unhandledrejection","unload","userproximity","vrdisplayconnected","vrdisplaydisconnected","vrdisplaypresentchange"],!0),["beforecopy","beforecut","beforepaste","copy","cut","paste","dragstart","loadend","animationstart","search","transitionrun","transitionstart","webkitanimationend","webkitanimationiteration","webkitanimationstart","webkittransitionend"],!0),["activate","afterupdate","ariarequest","beforeactivate","beforedeactivate","beforeeditfocus","beforeupdate","cellchange","controlselect","dataavailable","datasetchanged","datasetcomplete","errorupdate","filterchange","layoutcomplete","losecapture","move","moveend","movestart","propertychange","resizeend","resizestart","rowenter","rowexit","rowsdelete","rowsinserted","command","compassneedscalibration","deactivate","help","mscontentzoom","msmanipulationstatechanged","msgesturechange","msgesturedoubletap","msgestureend","msgesturehold","msgesturestart","msgesturetap","msgotpointercapture","msinertiastart","mslostpointercapture","mspointercancel","mspointerdown","mspointerenter","mspointerhover","mspointerleave","mspointermove","mspointerout","mspointerover","mspointerup","pointerout","mssitemodejumplistitemremoved","msthumbnailclick","stop","storagecommit"],!0);C=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},R=C.__Zone_symbol_prefix||"__zone_symbol__",C[function B(G){return R+G}("legacyPatch")]=function(){var G=C.Zone;G.__load_patch("defineProperty",function(ee,ie,_e){_e._redefineProperty=zw,function Uw(){Yu=Zone.__symbol__,Na=Object[Yu("defineProperty")]=Object.defineProperty,i_=Object[Yu("getOwnPropertyDescriptor")]=Object.getOwnPropertyDescriptor,Ku=Object.create,lo=Yu("unconfigurables"),Object.defineProperty=function(C,R,B){if(r_(C,R))throw new TypeError("Cannot assign to read only property '"+R+"' of "+C);var G=B.configurable;return"prototype"!==R&&(B=_s(C,R,B)),Ch(C,R,B,G)},Object.defineProperties=function(C,R){Object.keys(R).forEach(function(_e){Object.defineProperty(C,_e,R[_e])});for(var B=0,G=Object.getOwnPropertySymbols(R);B<G.length;B++){var ee=G[B];Object.getOwnPropertyDescriptor(R,ee)?.enumerable&&Object.defineProperty(C,ee,R[ee])}return C},Object.create=function(C,R){return"object"==typeof R&&!Object.isFrozen(R)&&Object.keys(R).forEach(function(B){R[B]=_s(C,B,R[B])}),Ku(C,R)},Object.getOwnPropertyDescriptor=function(C,R){var B=i_(C,R);return B&&r_(C,R)&&(B.configurable=!1),B}}()}),G.__load_patch("registerElement",function(ee,ie,_e){!function a_(C,R){var B=R.getGlobalObjects();(B.isBrowser||B.isMix)&&"registerElement"in C.document&&R.patchCallbacks(R,document,"Document","registerElement",["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback"])}(ee,_e)}),G.__load_patch("EventTargetLegacy",function(ee,ie,_e){(function Vw(C,R){var B=R.getGlobalObjects(),G=B.eventNames,ee=B.globalSources,ie=B.zoneSymbolEventNames,_e=B.TRUE_STR,we=B.FALSE_STR,ke=B.ZONE_SYMBOL_PREFIX,Ie="ApplicationCache,EventSource,FileReader,InputMethodContext,MediaController,MessagePort,Node,Performance,SVGElementInstance,SharedWorker,TextTrack,TextTrackCue,TextTrackList,WebKitNamedFlow,Window,Worker,WorkerGlobalScope,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload,IDBRequest,IDBOpenDBRequest,IDBDatabase,IDBTransaction,IDBCursor,DBIndex,WebSocket".split(","),Ge="EventTarget",qe=[],ht=C.wtf,yt="Anchor,Area,Audio,BR,Base,BaseFont,Body,Button,Canvas,Content,DList,Directory,Div,Embed,FieldSet,Font,Form,Frame,FrameSet,HR,Head,Heading,Html,IFrame,Image,Input,Keygen,LI,Label,Legend,Link,Map,Marquee,Media,Menu,Meta,Meter,Mod,OList,Object,OptGroup,Option,Output,Paragraph,Pre,Progress,Quote,Script,Select,Source,Span,Style,TableCaption,TableCell,TableCol,Table,TableRow,TableSection,TextArea,Title,Track,UList,Unknown,Video".split(",");ht?qe=yt.map(function(ot){return"HTML"+ot+"Element"}).concat(Ie):C[Ge]?qe.push(Ge):qe=Ie;for(var kt=C.__Zone_disable_IE_check||!1,Ln=C.__Zone_enable_cross_context_check||!1,Gt=R.isIEOrEdge(),St="[object FunctionWrapper]",je="function __BROWSERTOOLS_CONSOLE_SAFEFUNC() { [native code] }",_n={MSPointerCancel:"pointercancel",MSPointerDown:"pointerdown",MSPointerEnter:"pointerenter",MSPointerHover:"pointerhover",MSPointerLeave:"pointerleave",MSPointerMove:"pointermove",MSPointerOut:"pointerout",MSPointerOver:"pointerover",MSPointerUp:"pointerup"},zt=0;zt<G.length;zt++){var xn=ke+((Wt=G[zt])+we),Ct=ke+(Wt+_e);ie[Wt]={},ie[Wt][we]=xn,ie[Wt][_e]=Ct}for(zt=0;zt<yt.length;zt++)for(var et=yt[zt],At=ee[et]={},st=0;st<G.length;st++){var Wt;At[Wt=G[st]]=et+".addEventListener:"+Wt}var tt=[];for(zt=0;zt<qe.length;zt++){var Di=C[qe[zt]];tt.push(Di&&Di.prototype)}return R.patchEventTarget(C,R,tt,{vh:function(ot,pn,Me,H){if(!kt&&Gt)if(Ln)try{if((F=pn.toString())===St||F==je)return ot.apply(Me,H),!1}catch{return ot.apply(Me,H),!1}else{var F;if((F=pn.toString())===St||F==je)return ot.apply(Me,H),!1}else if(Ln)try{pn.toString()}catch{return ot.apply(Me,H),!1}return!0},transferEventName:function(ot){return _n[ot]||ot}}),Zone[R.symbol("patchEventTarget")]=!!C[Ge],!0})(ee,_e),Hw(_e,ee)})};var Fa=tn("zoneTask");function uo(C,R,B,G){var ee=null,ie=null;B+=G;var _e={};function we(He){var Ie=He.data;return Ie.args[0]=function(){return He.invoke.apply(this,arguments)},Ie.handleId=ee.apply(C,Ie.args),He}function ke(He){return ie.call(C,He.data.handleId)}ee=$r(C,R+=G,function(He){return function(Ie,Ge){if("function"==typeof Ge[0]){var qe={isPeriodic:"Interval"===G,delay:"Timeout"===G||"Interval"===G?Ge[1]||0:void 0,args:Ge},ht=Ge[0];Ge[0]=function(){try{return ht.apply(this,arguments)}finally{qe.isPeriodic||("number"==typeof qe.handleId?delete _e[qe.handleId]:qe.handleId&&(qe.handleId[Fa]=null))}};var yt=Wu(R,Ge[0],qe,we,ke);if(!yt)return yt;var kt=yt.data.handleId;return"number"==typeof kt?_e[kt]=yt:kt&&(kt[Fa]=yt),kt&&kt.ref&&kt.unref&&"function"==typeof kt.ref&&"function"==typeof kt.unref&&(yt.ref=kt.ref.bind(kt),yt.unref=kt.unref.bind(kt)),"number"==typeof kt||kt?kt:yt}return He.apply(C,Ge)}}),ie=$r(C,B,function(He){return function(Ie,Ge){var ht,qe=Ge[0];"number"==typeof qe?ht=_e[qe]:(ht=qe&&qe[Fa])||(ht=qe),ht&&"string"==typeof ht.type?"notScheduled"!==ht.state&&(ht.cancelFn&&ht.data.isPeriodic||0===ht.runCount)&&("number"==typeof qe?delete _e[qe]:qe&&(qe[Fa]=null),ht.zone.cancelTask(ht)):He.apply(C,Ge)}})}Zone.__load_patch("legacy",function(C){var R=C[Zone.__symbol__("legacyPatch")];R&&R()}),Zone.__load_patch("queueMicrotask",function(C,R,B){B.patchMethod(C,"queueMicrotask",function(G){return function(ee,ie){R.current.scheduleMicroTask("queueMicrotask",ie[0])}})}),Zone.__load_patch("timers",function(C){var R="set",B="clear";uo(C,R,B,"Timeout"),uo(C,R,B,"Interval"),uo(C,R,B,"Immediate")}),Zone.__load_patch("requestAnimationFrame",function(C){uo(C,"request","cancel","AnimationFrame"),uo(C,"mozRequest","mozCancel","AnimationFrame"),uo(C,"webkitRequest","webkitCancel","AnimationFrame")}),Zone.__load_patch("blocking",function(C,R){for(var B=["alert","prompt","confirm"],G=0;G<B.length;G++)$r(C,B[G],function(ie,_e,we){return function(ke,He){return R.current.run(ie,C,He,we)}})}),Zone.__load_patch("EventTarget",function(C,R,B){(function Ti(C,R){R.patchEventPrototype(C,R)})(C,B),function Oh(C,R){if(!Zone[R.symbol("patchEventTarget")]){for(var B=R.getGlobalObjects(),G=B.eventNames,ee=B.zoneSymbolEventNames,ie=B.TRUE_STR,_e=B.FALSE_STR,we=B.ZONE_SYMBOL_PREFIX,ke=0;ke<G.length;ke++){var He=G[ke],qe=we+(He+_e),ht=we+(He+ie);ee[He]={},ee[He][_e]=qe,ee[He][ie]=ht}var yt=C.EventTarget;if(yt&&yt.prototype)return R.patchEventTarget(C,R,[yt&&yt.prototype]),!0}}(C,B);var G=C.XMLHttpRequestEventTarget;G&&G.prototype&&B.patchEventTarget(C,B,[G.prototype])}),Zone.__load_patch("MutationObserver",function(C,R,B){gn("MutationObserver"),gn("WebKitMutationObserver")}),Zone.__load_patch("IntersectionObserver",function(C,R,B){gn("IntersectionObserver")}),Zone.__load_patch("FileReader",function(C,R,B){gn("FileReader")}),Zone.__load_patch("on_property",function(C,R,B){n_(B,C)}),Zone.__load_patch("customElements",function(C,R,B){!function Lh(C,R){var B=R.getGlobalObjects();(B.isBrowser||B.isMix)&&C.customElements&&"customElements"in C&&R.patchCallbacks(R,C.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback"])}(C,B)}),Zone.__load_patch("XHR",function(C,R){!function ke(He){var Ie=He.XMLHttpRequest;if(Ie){var Ge=Ie.prototype,ht=Ge[hs],yt=Ge[Yo];if(!ht){var kt=He.XMLHttpRequestEventTarget;if(kt){var Ln=kt.prototype;ht=Ln[hs],yt=Ln[Yo]}}var Gt="readystatechange",Cn="scheduled",zt=$r(Ge,"open",function(){return function(et,At){return et[G]=0==At[2],et[_e]=At[1],zt.apply(et,At)}}),qt=tn("fetchTaskAborting"),Qe=tn("fetchTaskScheduling"),xn=$r(Ge,"send",function(){return function(et,At){if(!0===R.current[Qe]||et[G])return xn.apply(et,At);var st={target:et,url:et[_e],isPeriodic:!1,args:At,aborted:!1},hn=Wu("XMLHttpRequest.send",je,st,St,_n);et&&!0===et[we]&&!st.aborted&&hn.state===Cn&&hn.invoke()}}),Ct=$r(Ge,"abort",function(){return function(et,At){var st=function qe(et){return et[B]}(et);if(st&&"string"==typeof st.type){if(null==st.cancelFn||st.data&&st.data.aborted)return;st.zone.cancelTask(st)}else if(!0===R.current[qt])return Ct.apply(et,At)}})}function St(et){var At=et.data,st=At.target;st[ie]=!1,st[we]=!1;var hn=st[ee];ht||(ht=st[hs],yt=st[Yo]),hn&&yt.call(st,Gt,hn);var tt=st[ee]=function(){if(st.readyState===st.DONE)if(!At.aborted&&st[ie]&&et.state===Cn){var ot=st[R.__symbol__("loadfalse")];if(0!==st.status&&ot&&ot.length>0){var pn=et.invoke;et.invoke=function(){for(var Me=st[R.__symbol__("loadfalse")],H=0;H<Me.length;H++)Me[H]===et&&Me.splice(H,1);!At.aborted&&et.state===Cn&&pn.call(et)},ot.push(et)}else et.invoke()}else!At.aborted&&!1===st[ie]&&(st[we]=!0)};return ht.call(st,Gt,tt),st[B]||(st[B]=et),xn.apply(st,At.args),st[ie]=!0,et}function je(){}function _n(et){var At=et.data;return At.aborted=!0,Ct.apply(At.target,At.args)}}(C);var B=tn("xhrTask"),G=tn("xhrSync"),ee=tn("xhrListener"),ie=tn("xhrScheduled"),_e=tn("xhrURL"),we=tn("xhrErrorBeforeScheduled")}),Zone.__load_patch("geolocation",function(C){C.navigator&&C.navigator.geolocation&&function qu(C,R){for(var B=C.constructor.name,G=function(ie){var He,Ie,_e=R[ie],we=C[_e];if(we){if(!wh(Hr(C,_e)))return"continue";C[_e]=(Ie=function(){return He.apply(this,$u(arguments,B+"."+_e))},gs(Ie,He=we),Ie)}},ee=0;ee<R.length;ee++)G(ee)}(C.navigator.geolocation,["getCurrentPosition","watchPosition"])}),Zone.__load_patch("PromiseRejectionEvent",function(C,R){function B(G){return function(ee){Qg(C,G).forEach(function(_e){var we=C.PromiseRejectionEvent;if(we){var ke=new we(G,{promise:ee.promise,reason:ee.rejection});_e.invoke(ke)}})}}C.PromiseRejectionEvent&&(R[tn("unhandledPromiseRejectionHandler")]=B("unhandledrejection"),R[tn("rejectionHandledHandler")]=B("rejectionhandled"))})},void 0!==(bh=zs.call(Hu,Wc,Hu,Gc))&&(Gc.exports=bh)}},Gc=>{Gc(Gc.s=606)}]);